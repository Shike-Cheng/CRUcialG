{"doc_key": "102", "sentences": [["In", "a", "normal", "ad", "campaign", ",", "ad", "agencies", "buy", "ad", "space", "on", "publications", "and", "other", "trafficked", "websites", ",", "and", "the", "ad", "agency", "then", "tries", "to", "get", "those", "ads", "served", "to", "users", "that", "fit", "some", "criteria", "in", "the", "hopes", "that", "users", "click", "on", "the", "ads", ",", "which", "take", "the", "user", "to", "(", "for", "example", ")", "a", "product", "page", "."], ["It", "may", "be", "that", "the", "content", "of", "the", "mal-ad", "itself", "can", "infect", "a", "user", "'s", "computer", ",", "or", "it", "may", "be", "that", "a", "user", "who", "clicks", "on", "the", "enticing", "mal-ad", "is", "taken", "somewhere", "which", "then", "infects", "the", "user", "'s", "computer", "."], ["The", "initial", "infection", "will", "often", "download", "another", "payload", "."], ["One", "solution", "to", "this", "is", "to", "infect", "a", "popular", "website", "."], ["Once", "a", "popular", "site", "is", "infected", ",", "a", "hacker", "has", "the", "opportunity", "to", "try", "to", "infect", "every", "user", "as", "they", "come", "to", "the", "site", "."], ["By", "buying", "an", "ad", "on", "such", "a", "site", "a", "hacker", "can", "avoid", "the", "difficulty", "of", "hacking", "and", "hiding", ",", "while", "getting", "access", "to", "a", "site", "'s", "users", ",", "for", "very", "little", "money", "."], ["Buried", "in", "the", "code", "behind", "the", "ad", "is", "a", "link", "to", "a", "javascript", "."], ["Capturing", "the", "HTTP", "headers", "associated", "with", "this", "transaction", "revealed", "the", "following", ":", "This", "should", "look", "familiar", "to", "those", "that", "hunt", "exploit", "kits", ":", "it", "is", "a", "link", "to", "an", "Angler", "landing", "page", "."], ["By", "hosting", "the", "actual", "malicious", "redirection", "on", "a", "different", "system", "the", "adversaries", "are", "able", "to", "change", "the", "target", "quickly", "."], ["The", "basic", "operation", "we", "saw", "repeatedly", "throughout", "this", "campaign", "was", "a", "script", "being", "retrieved", "from", "the", "hard", "coded", "IP", "of", "217.23.5.123", "named", "cookie.php", "."], ["Below", "are", "a", "couple", "of", "examples", "of", "the", "different", "folder", "structures", "we", "saw", "hosting", "the", "cookie.php", "file:217.23.5.123/switch/cookie.php", "217.23.5.123/socket/cookie.php", "217.23.5.123/php/cookie.php", "217.23.5.123/xml/cookie.phpOne", "other", "thing", "to", "note", "is", "the", "use", "of", "position", "."], ["They", "are", "consistently", "using", "[", "position", ":", "absolute", ";", "left", ":", "-10000px", ";", "]", "this", "will", "effectively", "render", "the", "iframe", "off", "screen", "."], ["While", "working", "through", "the", "network", "traffic", "the", "following", "popped", "out", ":", "We", "started", "seeing", "repeated", "randomstring.php", "HTTP", "requests", "outbound", "from", "the", "infected", "system", "."], ["The", "first", "thing", "we", "noticed", "was", "that", "it", "was", "calling", "out", "to", "a", "hard", "coded", "IP", "address", "(", "84.19.27.27", ")", "and", "that", "these", "HTTP", "codes", "were", "related", "to", "the", "C2", "activity", "for", "the", "payload", "."], ["Upon", "further", "investigation", "it", "was", "determined", "that", "the", "payload", "was", "creating", "a", "64-bit", "XOR", "value", "based", "on", "a", "combination", "of", "the", "following", ":", "volume", "name", ",", "serial", "number", ",", "username", ",", "and", "computer", "name", "."], ["This", "value", "was", "then", "used", "to", "create", "a", "copy", "of", "the", "file", "in", "a", "log", "folder", "and", "to", "start", "itself", "as", "a", "service", "."], ["After", "the", "service", "was", "created", "successfully", "the", "original", "executable", "was", "deleted", "from", "the", "file", "system", "."], ["It", "then", "created", "a", "pair", "of", "mutex", "values", "of", "random", "numbers", "that", "are", "used", "to", "determine", "the", "frequency", "and", "timing", "of", "the", "communication", "between", "the", "infected", "system", "and", "the", "C2", "server", "."], ["Once", "these", "were", "established", "the", "C2", "communication", "began", "."], ["The", "host", "is", "always", "using", "a", "random", "string", "appended", "with", ".php", "in", "the", "request", "and", "is", "looking", "for", "the", "HTTP", "code", "the", "server", "is", "responding", "."], ["If", "a", "503", "code", "is", "returned", "the", "activity", "stops", "immediately", "."], ["Otherwise", "the", "system", "is", "doing", "a", "couple", "checks", ",", "the", "first", "being", "the", "end", "of", "the", "request", "."], ["The", "request", "needs", "to", "end", "with", "the", "hex", "value", "of", "0x0D0A0D0A", ",", "as", "shown", "below", "."], ["This", "check", "is", "done", "on", "both", "sides", "of", "the", "communication", "so", "the", "infected", "host", "appends", "0x0D0A0D0A", "to", "its", "request", "and", "the", "C2", "server", "appends", "it", "to", "its", "initial", "HTTP", "response", "."], ["If", "the", "C2", "server", "responds", "with", "an", "HTTP", "200", "then", "the", "infected", "host", "uses", "the", "value", "in", "the", "date", "field", "as", "an", "XOR", "key", "to", "decode", "the", "response", "from", "the", "C2", "server", "."], ["If", "any", "other", "HTTP", "code", "is", "encountered", ",", "like", "the", "404", "OK", "instance", "above", ",", "then", "seed", "data", "is", "returned", "."], ["This", "seed", "data", "is", "used", "to", "create", "a", "thread", "that", "repeatedly", "contacts", "the", "C2", "server", "using", "the", "ping", "technique", "described", "."], ["They", "then", "chose", "a", "specific", "episode", "to", "watch", "and", "began", "streaming", "."], ["While", "the", "streaming", "video", "began", "an", "ad", "from", "adcash.com", "was", "being", "served", "."], ["Below", "is", "a", "graphic", "detailing", "the", "behavior", ":", "Movie", "Streaming", "to", "Exploit", "Kit", "Another", "example", "we", "witnessed", ",", "this", "time", "using", "a", "site", "for", "movie", "streaming", ",", "similarly", "began", "with", "a", "Google", "search", "for", "a", "streaming", "movie", "and", "ended", "up", "with", "something", "different", "."], ["This", "begins", ",", "just", "like", "the", "previous", "example", ",", "with", "a", "web", "search", "."], ["This", "is", "the", "link", "the", "users", "click", "which", "gave", "them", "this", "page", ":", "The", "first", "link", "leads", "to", "a", "file", "sharing", "site", "known", "as", "Filenuke", "."], ["After", "the", "user", "clicks", "the", "link", "for", "Filenuke", "they", "move", "to", "a", "new", "page", "like", "the", "one", "below", ":", "Clicking", "on", "the", "``", "watch", "now", "''", "link", "takes", "the", "user", "to", ":", "szbek.filenuke.com/003b22cf3981bc1406ad502df111dd30a47d1df44a0a45965d245f59", "is", "the", "actual", "page", "hosting", "the", "malicious", "ad", "."], ["In", "this", "particular", "case", "the", "malicious", "javascript", "directed", "the", "user", "to", "a", "Rig", "landing", "page", "hosted", "at", "gf.bookbeauty.in", "."], ["No", "ads", "are", "clicked", "all", "that", "is", "required", "is", "for", "the", "user", "to", "view", "a", "page", "where", "this", "ad", "is", "hosted", "and", "have", "a", "system", "that", "contains", "a", "vulnerability", "that", "an", "exploit", "kit", "can", "compromise", "."], ["The", "basic", "path", "would", "involve", "a", "user", "starting", "on", "some", "large", "aggregate", "sports", "streaming", "site", "."], ["They", "would", "then", "try", "and", "view", "a", "specific", "stream", "which", "would", "eventually", "redirect", "them", "to", "a", "site", "like", "delta.xyz", "for", "the", "actual", "streaming", "."], ["When", "the", "stream", "started", "the", "malicious", "ad", "would", "be", "delivered", "which", "would", "load", "the", "casino", "themed", "advertisement", "with", "an", "exploit", "kit", "iframe", "."], ["IOC", "'s", "Angler", "IP", "Addresses", "Rig", "IP", "Addresses:188.227.16.93188.227.74.21746.30.46.38Malvertising", "campaign", "IOCs", "gamingclub350.com", "217.23.5.123404", "Malware", "84.19.27.27Online", "Advertising", "Challenges", "Although", "the", "majority", "of", "the", "activity", "associated", "with", "this", "particular", "malvertising", "campaign", "was", "tied", "to", "streaming", ",", "there", "are", "other", "examples", "where", "larger", "sites", "are", "impacted", "."]], "ner": [[[30, 30, "TP"], [39, 39, "TP"], [48, 48, "TP"]], [[66, 66, "MF"], [71, 73, "TP"], [81, 81, "TP"], [87, 87, "MF"]], [[106, 106, "MF"]], [[116, 117, "SO"]], [[121, 122, "SO"], [127, 127, "MP"], [136, 136, "TP"]], [[147, 147, "MF"], [153, 153, "MP"], [165, 165, "SF"], [168, 170, "TP"]], [[183, 183, "MF"], [186, 186, "SO"], [189, 189, "MF"]], [[211, 212, "MF"], [217, 217, "SO"]], [[235, 235, "MP"]], [[255, 255, "MF"], [264, 264, "SO"]], [], [], [[337, 338, "TP"], [342, 343, "TP"]], [[352, 352, "MP"], [363, 363, "SO"], [368, 369, "MF"], [378, 378, "MP"]], [[388, 388, "MP"], [393, 394, "TF"], [403, 404, "SF"], [406, 407, "SF"], [409, 409, "SF"], [412, 413, "SF"]], [[416, 416, "TF"], [426, 429, "TF"], [437, 437, "TP"]], [[441, 441, "TP"], [446, 447, "MF"]], [[455, 455, "TP"], [461, 462, "TF"], [472, 472, "TF"], [474, 474, "TF"], [484, 485, "SO"]], [[492, 492, "SO"]], [[497, 497, "MP"], [506, 506, "MF"], [515, 516, "MF"]], [[524, 525, "MF"]], [], [], [[579, 580, "TP"], [582, 582, "TF"], [585, 585, "TF"], [588, 589, "SO"], [595, 596, "MF"]], [[600, 601, "SO"], [605, 606, "MF"], [609, 610, "TP"], [620, 621, "TP"], [625, 625, "MF"]], [[634, 635, "MF"], [641, 641, "MF"], [647, 648, "MF"]], [[653, 654, "MP"], [660, 660, "MP"], [665, 666, "SO"], [669, 669, "TP"]], [], [[693, 693, "SO"]], [[729, 729, "TP"]], [], [[759, 759, "SO"]], [[784, 784, "TP"], [787, 787, "SO"], [808, 808, "SO"], [821, 822, "MF"]], [[829, 830, "MF"], [833, 833, "TP"], [841, 841, "SO"]], [[854, 854, "TP"], [874, 875, "MF"]], [[885, 885, "TP"]], [[913, 913, "SO"]], [[924, 925, "MF"], [938, 939, "MF"]], [[945, 946, "SO"]]], "relations": [[[39, 39, 66, 66, "WR"], [48, 48, 66, 66, "WR"], [30, 30, 39, 39, "CO"], [30, 30, 48, 48, "CO"], [30, 30, 81, 81, "CO"], [30, 30, 136, 136, "CO"], [30, 30, 784, 784, "CO"], [30, 30, 833, 833, "CO"]], [[71, 73, 66, 66, "WR"], [81, 81, 87, 87, "WR"], [81, 81, 87, 87, "WR"], [71, 73, 106, 106, "WR"], [81, 81, 71, 73, "CO"]], [], [[116, 117, 121, 122, "CO"]], [[127, 127, 87, 87, "WR"], [136, 136, 121, 122, "ST"], [136, 136, 168, 170, "CO"], [127, 127, 153, 153, "CO"]], [[153, 153, 147, 147, "WR"], [153, 153, 165, 165, "RD"], [168, 170, 147, 147, "RD"], [168, 170, 186, 186, "ST"], [168, 170, 211, 212, "WR"], [147, 147, 183, 183, "CO"], [147, 147, 189, 189, "CO"]], [[186, 186, 217, 217, "CO"], [186, 186, 264, 264, "CO"]], [], [[235, 235, 211, 212, "RD"], [235, 235, 255, 255, "WR"], [235, 235, 255, 255, "WR"]], [], [], [], [[342, 343, 337, 338, "FR"], [337, 338, 255, 255, "WR"], [337, 338, 352, 352, "FR"]], [[352, 352, 363, 363, "ST"], [352, 352, 363, 363, "RF"], [352, 352, 368, 369, "EX"], [378, 378, 403, 404, "RD"], [378, 378, 406, 407, "RD"], [378, 378, 409, 409, "RD"], [378, 378, 412, 413, "RD"], [352, 352, 378, 378, "CO"], [352, 352, 388, 388, "CO"]], [[388, 388, 393, 394, "WR"], [388, 388, 426, 429, "WR"], [388, 388, 437, 437, "FR"], [388, 388, 446, 447, "UK"]], [[437, 437, 426, 429, "EX"], [437, 437, 441, 441, "CO"], [437, 437, 455, 455, "CO"], [416, 416, 393, 394, "CO"]], [], [[455, 455, 461, 462, "WR"], [455, 455, 484, 485, "ST"], [455, 455, 484, 485, "RF"], [472, 472, 474, 474, "CO"], [472, 472, 461, 462, "CO"], [484, 485, 492, 492, "CO"]], [], [[497, 497, 492, 492, "ST"], [497, 497, 492, 492, "RF"], [497, 497, 506, 506, "EX"], [497, 497, 515, 516, "RD"]], [], [], [], [[579, 580, 524, 525, "RD"], [579, 580, 582, 582, "WR"], [579, 580, 588, 589, "ST"], [579, 580, 588, 589, "RF"], [579, 580, 595, 596, "WR"], [582, 582, 585, 585, "CO"]], [[609, 610, 595, 596, "WR"], [609, 610, 600, 601, "ST"], [609, 610, 600, 601, "RF"], [609, 610, 605, 606, "RD"], [609, 610, 620, 621, "FR"], [620, 621, 625, 625, "RD"], [609, 610, 641, 641, "RD"], [609, 610, 647, 648, "WR"], [609, 610, 653, 654, "FR"]], [[634, 635, 641, 641, "CO"]], [[653, 654, 647, 648, "EX"], [653, 654, 660, 660, "FR"], [660, 660, 669, 669, "FR"], [669, 669, 665, 666, "ST"], [669, 669, 665, 666, "RF"], [669, 669, 693, 693, "ST"], [669, 669, 693, 693, "RF"]], [], [], [[729, 729, 693, 693, "ST"], [729, 729, 693, 693, "RF"], [729, 729, 693, 693, "ST"], [729, 729, 693, 693, "RF"], [729, 729, 759, 759, "ST"], [729, 729, 759, 759, "RF"], [729, 729, 759, 759, "ST"], [729, 729, 759, 759, "RF"]], [], [], [[784, 784, 759, 759, "ST"], [784, 784, 759, 759, "RF"], [784, 784, 787, 787, "ST"], [784, 784, 787, 787, "RF"], [784, 784, 808, 808, "ST"], [784, 784, 808, 808, "RF"], [784, 784, 821, 822, "RD"], [821, 822, 829, 830, "CO"]], [[833, 833, 829, 830, "RD"], [833, 833, 841, 841, "ST"], [833, 833, 841, 841, "RF"], [833, 833, 854, 854, "CO"]], [[854, 854, 874, 875, "WR"]], [], [], [], []]}