{"doc_key": "012", "sentences": [["MagicRAT", "is", "designed", "using", "C++", "programming", "language", "and", "the", "Qt", "Framework", "for", "static", "linking", "to", "RAT", "on", "32-", "and", "64-bit", "versions", "."], ["Qt", "classes", "are", "extensively", "utilized", "throughout", "the", "RAT", "'s", "code", "."], ["Dynamic", "storage", "of", "configuration", "is", "possible", "through", "QSettings", "class", ",", "with", "data", "eventually", "being", "saved", "to", "disk", "as", "per", "class", "functionality", "."], ["Malware", "configuration", ",", "which", "contains", "author-defined", "QSettings", ",", "is", "deliberately", "stored", "in", "``", "\\ProgramData\\WindowsSoftwareToolkit", "''", "directory", "with", "the", "file", "name", "``", "visual.1991-06.com.microsoft_sd.kit", "''", "to", "deceive", "victims", "into", "assuming", "it", "is", "a", "legitimate", "system", "file", "."], ["Os", "contains", "the", "C2", "URLs", ",", "with", "all", "samples", "analyzed", "having", "three", "encoded", "C2", "URLs", ",", "used", "to", "register", "infections", "and", "execute", "commands", "on", "the", "infected", "endpoint", "."], ["With", "``", "windows", ",", "''", "``", "linux", ",", "''", "and", "``", "mac", "''", "keys", ",", "URLs", "are", "stored", "in", "the", "configuration", "file", "."], ["Persistence", "is", "achieved", "by", "executing", "a", "hardcoded", "command", "to", "create", "scheduled", "tasks", "on", "the", "victim", "machine", ",", "which", "includes", "Scheduled", "task", "starting", "at", "a", "specific", "time", "[", "T1053/005", "]", ",", "Scheduled", "task", "starting", "at", "a", "different", "time", "an", "path", "[", "T1053/005", "]", ",", "and", "Link", "created", "on", "startup", "folder", "[", "T1547/001", "]", ",", "among", "others", "."], ["Once", "persistence", "is", "achieved", ",", "the", "RAT", "establishes", "contact", "with", "the", "C2", "."], ["System", "reconnaissance", "is", "performed", "during", "pre-execution", "stages", "of", "MagicRAT", "to", "identify", "the", "operating", "environment", "and", "system", "in", "which", "attackers", "are", "operating", "."], ["For", "this", "purpose", ",", "commands", "like", "whoami", ",", "systeminfo", ",", "and", "ipconfig", "/all", "are", "executed", ",", "and", "results", "for", "the", "last", "one", "are", "sent", "to", "C2", "using", "the", "file", "zero_dump.mix", "to", "get", "system", "information", "."], ["Operators", "can", "control", "implant", "timing", ",", "change", "C2", "URLs", "and", "delete", "the", "implant", "from", "infected", "systems", "."], ["In", "addition", ",", "the", "sample", "has", "the", "ability", "to", "delete", "itself", "from", "the", "infected", "endpoint", "using", "a", "BAT", "file", "."]], "ner": [[[0, 0, "MF"]], [[29, 29, "MF"]], [], [], [[98, 98, "MF"]], [], [[148, 148, "MF"]], [[203, 203, "MP"], [208, 208, "SO"]], [[218, 218, "MP"]], [[236, 236, "MF"], [238, 238, "TP"], [240, 240, "TP"], [243, 243, "TP"], [257, 257, "SO"], [261, 261, "MF"], [264, 265, "SF"]], [[267, 267, "MP"], [270, 271, "MF"]], [[294, 294, "MF"], [301, 302, "MF"]]], "relations": [[[0, 0, 29, 29, "CO"], [0, 0, 98, 98, "CO"]], [], [], [], [], [], [], [[203, 203, 98, 98, "EX"], [203, 203, 148, 148, "EX"], [203, 203, 208, 208, "ST"], [203, 203, 208, 208, "RF"], [203, 203, 218, 218, "CO"]], [[218, 218, 236, 236, "EX"], [218, 218, 238, 238, "FR"], [218, 218, 240, 240, "FR"], [218, 218, 243, 243, "FR"], [218, 218, 257, 257, "ST"], [218, 218, 261, 261, "WR"], [218, 218, 264, 265, "RD"], [218, 218, 301, 302, "UK"]], [], [[267, 267, 257, 257, "RF"], [267, 267, 270, 271, "RD"], [267, 267, 270, 271, "WR"], [267, 267, 294, 294, "WR"]], []]}