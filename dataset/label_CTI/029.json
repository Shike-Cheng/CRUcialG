{"doc_key": "029", "sentences": [["In", "the", "BlackMatter", "attack", ",", "the", "perpetrator", "potentially", "exploited", "vulnerabilities", "in", "Microsoft", "Exchange", "to", "gain", "initial", "access", "."], ["Once", "inside", ",", "the", "attackers", "ensured", "additional", "remote", "access", "to", "several", "internal", "systems", "beyond", "the", "first", "vector", "of", "exploitation", "."], ["Meanwhile", ",", "during", "the", "BlackCat", "attack", ",", "reverse-ssh", "was", "the", "tool", "employed", "by", "the", "actors", "."], ["With", "the", "C2", "server", "address", "embedded", ",", "they", "used", "it", "for", "setting", "up", "reverse", "SSH", "tunnels", "and", "providing", "reverse", "shells", "to", "the", "attacker", "."], ["Reverse-ssh", "was", "named", "as", "``", "system", "''", ",", "``", "Windows", "''", "or", "``", "cache", "task", "''", ",", "and", "deployed", "to", "the", "C", ":", "\\", "directory", "."], ["Additionally", ",", "the", "attackers", "hid", "it", "using", "an", "alternate", "data", "stream", "(", "ADS", ")", "of", "the", "same", "directory", "with", "a", "specific", "command", "."], ["The", "command", "is", "as", "follows", ":"], ["c", ":", "\\windows\\system32\\schtasks.exe", "/run", "/tn", "microsoft\\windows\\wininet\\cachetask"], ["To", "ensure", "persistent", "execution", "of", "the", "malicious", "file", "on", "a", "system", ",", "attackers", "also", "made", "use", "of", "the", "``", "image", "file", "execution", "option", "''", "debugger", "registry", "key", "."], ["By", "adding", "this", "key", "to", "the", "system", "'s", "registry", "with", "a", "specific", "command", ",", "they", "ensured", "that", "the", "malicious", "file", "would", "be", "executed", "continuously", "."], ["Specifically", ",", "the", "command", "used", "was", ":"], ["c", ":", "\\windows\\system32\\reg.exe", "add", "hklm\\software\\microsoft\\windows", "nt\\currentversion\\image", "file", "execution", "options\\taskmgr.exe", "/v", "debugger", "/t", "reg_sz", "/d", "c", ":", "\\system"], ["During", "the", "BlackMatter", "attack", ",", "the", "group", "utilized", "GO", "Simple", "Tunnel", "(", "GOST", ")", "to", "perform", "a", "similar", "technique", "."], ["GOST", "is", "a", "Go-based", "tunneling", "tool", "that", "was", "employed", "to", "establish", "a", "reverse", "SSH", "tunnel", "to", "an", "attacker-controlled", "C2", "server", "."], ["The", "deployed", "Gost", "file", "was", "named", "``", "system.exe", "''", ",", "which", "was", "similar", "to", "the", "file", "name", "used", "during", "the", "BlackCat", "attack", "for", "reverse-ssh", "."], ["Before", "setting", "up", "the", "reverse-ssh", "scheduled", "task", "tool", ",", "the", "attackers", "disabled", "logs", "for", "the", "task", "scheduler", ",", "as", "shown", "in", "the", "provided", "IOC", "section", "below", "."], ["Finally", ",", "the", "anti-rootkit", "tool", "Gmer", "was", "loaded", "into", "a", "limited", "number", "of", "key", "systems", "with", "the", "following", "command", ":"], ["c", ":", "\\users", "<", "username", ">", "\\downloads\\gmer\\gmer.exe"], ["The", "LSASS", "process", "memory", "was", "analyzed", "on", "several", "critical", "systems", "to", "retrieve", "both", "local", "and", "domain", "user", "credentials", "by", "utilizing", "Microsoft", "Sysinternals", "Procdump", "and", "Dumpert", "."], ["The", "following", "commands", "were", "used", "for", "this", "purpose", ":"], ["c", ":", "\\windows\\system\\procdump.exe", "-accepteula", "-ma", "lsass.exe", "lsass.dmp"], ["c", ":", "\\windows\\system\\dumpert.exe", "lsass.exe"], ["During", "the", "BlackMatter", "attack", ",", "the", "comsvcs.dll", "was", "employed", "to", "directly", "dump", "the", "LSASS", "memory", "with", "the", "help", "of", "the", "following", "PowerShell", "command", ":"], ["powershell", "rundll32.exe", "c", ":", "\\windows\\system32\\comsvcs.dll", ",", "minidump", "(", "get-process", "lsass", ")", ".id", "c", ":", "\\temp\\lsass.dmp", "full"], ["Apart", "from", "Windows", "login", "credentials", ",", "the", "attackers", "behind", "the", "BlackCat", "attack", "utilized", "``", "steal.exe", "''", "tool", "to", "collect", "additional", "data", "."], ["Additionally", ",", "they", "employed", "ADRecon", "to", "gather", "information", "from", "Active", "Directory", "and", "its", "key", "servers", "via", "the", "following", "PowerShell", "command", ":"], ["c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\adrecon.ps1"], ["In", "addition", "to", "compromising", "TeamViewer", "installation", ",", "the", "BlackMatter", "attackers", "sought", "out", "other", "ways", "to", "sustain", "access", "during", "their", "attack", "."], ["They", "explored", "the", "keepass", "password", "manager", "configuration", "using", "the", "following", "commands", ":"], ["It", "is", "possible", "to", "detect", "the", "tool", "'s", "activity", "by", "monitoring", "processes", "created", "by", "wmipsrv.exe", "that", "terminate", "with", "the", "following", "string", ":"], ["Furthermore", ",", "the", "tool", "was", "frequently", "used", "to", "enable", "WinRM", "service", "network", "connections", "through", "the", "firewall", ",", "which", "may", "have", "been", "for", "the", "convenience", "of", "accessing", "prepared", "scripts", "."], ["Attackers", "can", "utilize", "WinRM", "to", "execute", "PowerShell", "commands", "on", "remote", "machines", "."], ["This", "tool", "'s", "presence", "can", "be", "detected", "by", "searching", "for", "processes", "initiated", "by", "``", "wsmprovhost.exe", "''", "."], ["The", "attackers", "used", "the", "following", "commands", "to", "disable", "logging", "for", "active", "directory", "web", "services", ",", "hardware", "events", ",", "and", "internet", "explorer", "respectively", ":"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "active", "directory", "web", "services", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "hardwareevents", "/enabled", ":", "false"], ["c", ":", "\\windows\\system32\\wevtutil.exe", "set-log", "internet", "explorer", "/enabled", ":", "false"], ["The", "attackers", "utilized", "Microsoft", "Remote", "Desktop", "to", "gain", "GUI", "access", "to", "various", "systems", "."], ["Before", "gaining", "remote", "admin", "access", ",", "the", "following", "impacket", "command", "was", "executed", ":"], ["cmd.exe", "/q", "/c", "reg", "add", "hkey_local_machine\\system\\currentcontrolset\\control\\lsa", "/v", "disablerestrictedadmin", "/t", "reg_dword", "/d", "0", "1", ">", "\\127.0.0.1\\admin", "$", "__", "<", "timestamp", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["Interestingly", ",", "an", "OPSEC", "mistake", "revealed", "the", "use", "of", "Kali", "Linux", "by", "the", "attackers", "to", "execute", "remote", "commands", "through", "their", "shell", "upload", "and", "download", "commands", ",", "as", "shown", "below", ":"], ["cmd.exe", "/q", "/c", "#", "upload", "c", ":", "\\users", "<", "user", ">", "\\documents", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\127.0.0.1\\admin\\", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["cmd.exe", "/q", "/c", "#", "download", "c", ":", "\\users\\", "<", "user", ">", "\\documents\\", "<", "doc", ">", "/home/kali/desktop/", "<", "doc", ">", "1", ">", "\\\\127.0.0.1\\admin", "<", "num", ">", ".", "<", "num", ">", "2", ">", "&", "1"], ["It", "is", "improbable", "that", "the", "attackers", "had", "installed", "Kali", "Linux", "within", "the", "victim", "'s", "network", ",", "which", "suggests", "that", "remote", "system", "control", "was", "achieved", "via", "the", "SSH", "tunnels", "established", "previously", "."], ["It", "is", "possible", "that", "document", "exfiltration", "was", "carried", "out", "via", "executing", "upload/download", "commands", "similar", "to", "those", "described", "above", "."], ["Prior", "to", "the", "actual", "ransomware", "execution", "in", "both", "the", "attacks", ",", "the", "attackers", "carried", "out", "several", "preparatory", "actions", "on", "the", "systems", "to", "ensure", "successful", "execution", "."], ["At", "the", "time", "of", "the", "incident", ",", "the", "perpetrator", "accessed", "the", "domain", "controller", "and", "launched", "the", "group", "policy", "management", "interface", "."], ["Next", ",", "the", "attacker", "introduced", "and", "ran", "a", "file", "known", "as", "``", "apply.ps1", ".", "''", "The", "execution", "command", "utilized", "was", ":"], ["``", "c", ":", "\\windows\\system32\\windowspowershell\\v1.0\\powershell.exe", "-exec", "bypass", ".\\apply.ps1", "''", "."], ["This", "action", "led", "to", "the", "immediate", "storage", "of", "group", "policy", "files", "on", "the", "disk", "."], ["Following", "this", ",", "the", "attackers", "used", "a", "command", "to", "enforce", "the", "deployment", "of", "the", "group", "policy", "."], ["Shortly", "before", "the", "commencement", "of", "BlackCat", "ransomware", "'s", "encryption", "of", "files", ",", "the", "intruders", "initiated", "a", "script", "named", "``", "defender.vbs", ".", "''"], ["In", "the", "BlackMatter", "attack", ",", "a", "file", "with", "the", "same", "content", "was", "named", "``", "def.vbs", "''", "and", "executed", "a", "few", "moments", "before", "the", "encryption", "procedure", "began", "."], ["The", "command", "used", "for", "execution", "was", "``", "cmd.exe", "/c", "\\", "<", "domaincontroller", ">", "\\netlogon\\def.vbs", "''", "."], ["During", "the", "onset", "of", "encryption", ",", "a", "ransomware", "file", "was", "dropped", "on", "domain", "servers", "in", "the", "SYSVOL", "folder", "."], ["This", "made", "it", "easily", "accessible", "on", "the", "NETLOGON", "network", "share", "available", "to", "all", "domain", "users", "."], ["File", "encryption", "allowed", "all", "systems", "to", "execute", "these", "remotely", "shared", "files", "."], ["For", "instance", ",", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "--", "access-token", "<", "token", ">", "''", "or", "``", "cmd.exe", "-c", "\\", "<", "domain", "controller", ">", "\\netlogon", "<", "num", ">", ".exe", "''", "."], ["The", "BlackMatter", "and", "BlackCat", "attacks", "employed", "similar", "<", "num", ">", ".exe", "file", "names", "."], ["These", "executables", "were", "deployed", "with", "additional", "commands", "that", "bolstered", "their", "efficiency", "during", "execution", "."], ["One", "such", "command", "was", "``", "c", ":", "\\windows\\system32\\cmd.exe", "/c", "fsutil", "behavior", "set", "symlinkevaluation", "r2l:1", "''", "."]], "ner": [[[2, 3, "MP"], [9, 12, "MF"]], [[22, 22, "MP"]], [[52, 52, "MP"]], [[56, 57, "SO"], [61, 61, "MP"], [67, 68, "MF"]], [], [[107, 107, "MP"]], [], [], [[151, 151, "MP"], [164, 164, "SF"]], [], [], [], [[218, 219, "MP"], [222, 222, "MP"], [228, 228, "MF"]], [[236, 236, "MF"], [254, 255, "SO"]], [[264, 264, "MF"], [277, 278, "MP"]], [[292, 292, "MP"], [294, 294, "SF"]], [[314, 314, "MF"]], [], [[349, 353, "SF"], [356, 358, "MF"], [360, 360, "MF"]], [], [], [], [[384, 385, "MP"], [388, 388, "MF"], [395, 396, "MF"]], [], [[424, 426, "TF"], [429, 429, "MP"], [436, 436, "MF"]], [[448, 448, "MF"]], [], [[475, 476, "TF"], [479, 480, "MP"]], [[492, 492, "MP"], [495, 498, "TF"]], [], [[528, 529, "MF"], [535, 536, "SO"], [541, 541, "SF"]], [[555, 555, "MP"], [558, 558, "MF"], [561, 561, "MP"]], [], [], [], [], [], [[636, 636, "MP"], [638, 640, "MF"], [643, 643, "SF"]], [], [], [[703, 703, "MP"], [706, 707, "MF"]], [], [], [[791, 791, "MP"], [812, 813, "MF"]], [[821, 822, "TF"], [828, 829, "MF"]], [], [[870, 870, "MP"], [878, 881, "SF"]], [[886, 886, "MP"], [895, 895, "MF"]], [], [[921, 923, "MF"]], [[932, 932, "MP"], [935, 935, "MF"], [942, 943, "MF"]], [[950, 951, "MP"], [964, 964, "MF"]], [[969, 970, "MP"], [981, 981, "MF"]], [], [[1017, 1018, "MF"], [1022, 1023, "SO"]], [], [], [[1069, 1072, "MF"]], [[1098, 1099, "MP"], [1102, 1105, "MF"]], [], []], "relations": [[[2, 3, 9, 12, "EX"], [2, 3, 56, 57, "ST"], [2, 3, 56, 57, "RF"], [2, 3, 164, 164, "RD"], [2, 3, 22, 22, "CO"], [2, 3, 52, 52, "CO"], [2, 3, 61, 61, "CO"], [2, 3, 107, 107, "CO"], [2, 3, 151, 151, "CO"]], [], [], [[61, 61, 67, 68, "WR"]], [], [], [], [], [[151, 151, 164, 164, "WR"]], [], [], [], [[218, 219, 56, 57, "ST"], [218, 219, 56, 57, "RF"], [222, 222, 228, 228, "WR"], [218, 219, 254, 255, "ST"], [218, 219, 254, 255, "RF"], [222, 222, 264, 264, "EX"], [218, 219, 294, 294, "RD"], [218, 219, 222, 222, "CO"], [218, 219, 292, 292, "CO"]], [[236, 236, 228, 228, "CO"]], [[277, 278, 236, 236, "WR"], [277, 278, 254, 255, "ST"], [277, 278, 254, 255, "RF"], [277, 278, 264, 264, "RD"], [277, 278, 294, 294, "RD"], [277, 278, 294, 294, "RD"], [277, 278, 294, 294, "WR"]], [[292, 292, 294, 294, "WR"], [292, 292, 314, 314, "WR"], [292, 292, 349, 353, "CD"], [292, 292, 356, 358, "WR"], [292, 292, 360, 360, "WR"]], [], [], [], [], [], [], [[384, 385, 388, 388, "EX"], [384, 385, 395, 396, "WR"], [384, 385, 448, 448, "WR"], [384, 385, 429, 429, "CO"], [384, 385, 479, 480, "CO"], [384, 385, 492, 492, "CO"]], [], [[429, 429, 424, 426, "WR"], [429, 429, 436, 436, "EX"]], [], [], [[479, 480, 475, 476, "RD"]], [[492, 492, 495, 498, "RD"]], [], [[528, 529, 558, 558, "CO"]], [[555, 555, 448, 448, "WR"], [555, 555, 541, 541, "RD"], [555, 555, 535, 536, "ST"], [555, 555, 541, 541, "WR"], [555, 555, 558, 558, "EX"], [555, 555, 561, 561, "FR"], [555, 555, 636, 636, "CO"], [555, 555, 791, 791, "CO"], [555, 555, 932, 932, "CO"]], [], [], [], [], [], [[636, 636, 638, 640, "EX"], [636, 636, 643, 643, "CD"], [636, 636, 703, 703, "CO"]], [], [], [[703, 703, 706, 707, "EX"]], [], [], [[791, 791, 812, 813, "EX"], [791, 791, 821, 822, "WR"], [791, 791, 828, 829, "EX"]], [], [], [[870, 870, 878, 881, "RD"], [870, 870, 921, 923, "WR"], [870, 870, 886, 886, "CO"]], [[886, 886, 895, 895, "WR"], [886, 886, 895, 895, "EX"]], [], [], [[932, 932, 921, 923, "WR"], [932, 932, 935, 935, "EX"], [932, 932, 942, 943, "WR"], [932, 932, 1069, 1072, "WR"], [932, 932, 950, 951, "CO"], [932, 932, 969, 970, "CO"]], [[950, 951, 964, 964, "EX"]], [[969, 970, 981, 981, "WR"], [969, 970, 981, 981, "EX"], [969, 970, 1017, 1018, "WR"], [969, 970, 1022, 1023, "ST"]], [], [], [], [], [], [[1098, 1099, 1069, 1072, "WR"], [1098, 1099, 1102, 1105, "EX"]], [], []]}