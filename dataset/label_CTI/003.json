{"doc_key": "003", "sentences": [["The", "email", "message", "includes", "a", "compressed", "ZIP", "file", "attachment", ",", "holding", "a", "PE32", "executable", "that", "is", "written", "in", ".NET", "."], ["Upon", "execution", ",", "the", "executable", "functions", "as", "a", "downloader", "and", "proceeds", "to", "connect", "to", "an", "IPFS", "gateway", "."], ["The", "gateway", "provides", "access", "to", "a", "blob", "of", "data", "that", "has", "been", "hosted", "within", "the", "IPFS", "network", "."], ["This", "data", "comprises", "an", "obfuscated", "PE32", "executable", "that", "acts", "as", "the", "next-stage", "malware", "payload", "."], ["The", "downloader", "then", "retrieves", "this", "data", "from", "the", "IPFS", "gateway", "and", "stores", "each", "byte", "in", "an", "array", "."], ["A", "key", "value", "stored", "in", "the", "executable", "is", "then", "used", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", ".", "The", "converted", "file", "is", "loaded", "reflectively", "and", "executed", "."], ["This", "results", "in", "the", "launch", "of", "the", "next", "stage", "of", "infection", ",", "which", "is", "Agent", "Tesla", ",", "a", "remote", "access", "trojan", "(", "RAT", ")", "."], ["Across", "all", "three", "clusters", "observed", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "had", "similar", "operations", ",", "with", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "differing", "among", "them", "."], ["In", "most", "instances", ",", "the", "loader", "was", "not", "packed", "."], ["Nonetheless", ",", "we", "found", "samples", "that", "were", "packed", "using", "UPX", "."], ["Upon", "running", ",", "the", "loader", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", "by", "executing", "``", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "''", "."], ["The", "malware", "then", "attempts", "to", "obtain", "Python", "3.10", "by", "using", "cURL", "command", "to", "retrieve", "it", "from", "a", "legitimate", "software", "provider", "."], ["Subsequently", ",", "the", "ZIP", "archive", "is", "unzipped", "into", "the", "previously", "created", "directory", "by", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "then", "tries", "to", "retrieve", "the", "last", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", ",", "using", "the", "filename", "``", "Packages.txt", ".", "''"], ["An", "example", "of", "the", "loader", "retrieving", "Hannabi", "Grabber", ",", "written", "in", "Python", "and", "used", "as", "an", "information", "stealer", ",", "is", "presented", "below", "."], ["Finally", ",", "the", "loader", "sets", "the", "System", "and", "Hidden", "flags", "on", "the", "created", "directory", "along", "with", "the", "Python", "ZIP", "archive", "and", "the", "retrieved", "final", "payload", "through", "the", "attrib.exe", "utility", "."], ["To", "invoke", "the", "newly", "downloaded", "Python", "executable", ",", "the", "loader", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "allowing", "it", "to", "execute", "the", "next", "stage", "of", "the", "infection", "process", "."], ["Furthermore", ",", "in", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "located", "at", "specific", "locations", "."], ["While", "examining", "some", "samples", "connected", "with", "this", "loader", ",", "our", "team", "noticed", "that", "the", "IPFS", "gateway", "being", "used", "was", "no", "longer", "functional", "."], ["However", ",", "another", "IPFS", "gateway", "was", "used", "to", "acquire", "and", "analyze", "the", "next-stage", "payloads", "manually", "."], ["In", "one", "cluster", "that", "utilized", "this", "loader", ",", "we", "discovered", "that", "a", "Python", "script", "containing", "a", "base64", "encoded", "blob", "and", "the", "Python", "code", "responsible", "for", "decoding", "it", "were", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "of", "the", "layers", ",", "we", "found", "a", "deobfuscated", "reverse", "shell", "payload", "."], ["Unfortunately", ",", "during", "our", "analysis", ",", "the", "C2", "server", "was", "no", "longer", "servicing", "requests", "on", "TCP/4444", "."], ["In", "another", "cluster", "we", "investigated", ",", "the", "final", "payload", "hosted", "on", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["The", "batch", "file", "is", "downloaded", "and", "stored", "in", "the", "Network", "directory", "under", "the", "name", "``", "Script.bat", ".", "''"], ["The", "malware", "attempts", "to", "invoke", "the", "batch", "file", "incorrectly", "by", "using", "this", "command", ":", "``", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft\\Network", "&", "&", "powershell", "-Command", "start", "script.bat", "-Verb", "RunAs", "''", "."], ["In", "the", "final", "cluster", "related", "to", "this", "loader", ",", "the", "malware", "retrieves", "and", "runs", "Hannabi", "Grabber", ",", "an", "information", "stealer", "based", "on", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", "."], ["This", "application", "collects", "survey", "data", ",", "obtains", "the", "geographic", "location", "of", "the", "system", "through", "the", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "then", "sends", "that", "data", "to", "an", "attacker-controlled", "Discord", "server", "as", "JSON", "format", "."], ["Additionally", ",", "the", "malware", "can", "retrieve", "password", "and", "cookie", "data", "from", "Chrome", "and", "Mozilla", "Firefox", "browsers", "."], ["It", "is", "particularly", "interested", "in", "Discord", "and", "Roblox", "data", ",", "attempting", "to", "bypass", "them", "to", "obtain", "Discord", "tokens", "from", "victims", "if", "detected", "."], ["The", "collected", "data", "is", "stored", "in", "a", "directory", "structure", "within", "the", "%", "TEMP", "%", "directory", "inside", "a", "folder", "called", "``", "RedDiscord", "''", "created", "by", "the", "malware", "."], ["Before", "exfiltrating", "the", "data", ",", "the", "malware", "creates", "a", "ZIP", "archive", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "in", "the", "RedDiscord", "directory", "."], ["Instead", "of", "compiling", "their", "Python", "into", "a", "PE32", "file", "format", ",", "the", "attacker", "chose", "to", "include", "a", "Python", "installation", "process", "during", "the", "infection", ",", "leveraging", "Python", "directly", "to", "steal", "sensitive", "information", "."]], "ner": [[[1, 1, "SO"], [12, 13, "MF"]], [[24, 24, "MF"], [28, 28, "MP"], [35, 36, "SO"]], [[38, 39, "SO"], [46, 46, "MF"]], [[57, 57, "MF"], [61, 62, "MF"]], [[72, 72, "MP"], [76, 76, "MF"], [79, 80, "SO"]], [[95, 95, "MF"], [107, 107, "MF"]], [[132, 133, "MP"], [136, 138, "MP"], [140, 140, "MP"]], [[150, 151, "MP"], [163, 164, "MP"], [168, 169, "SO"]], [[179, 179, "MP"]], [], [[199, 199, "MP"], [205, 207, "SF"]], [[227, 227, "MP"], [232, 233, "TF"], [240, 240, "TF"], [244, 245, "SO"]], [[250, 251, "TF"]], [[269, 269, "MP"], [275, 276, "MF"], [283, 283, "MF"]], [], [[322, 322, "MP"], [336, 338, "TF"], [342, 343, "MF"], [346, 347, "TP"]], [[354, 355, "TP"], [358, 358, "MP"], [361, 362, "MF"]], [[388, 388, "MP"], [396, 397, "SF"]], [], [], [[448, 448, "MP"], [473, 474, "SO"]], [], [], [[515, 516, "MF"], [519, 519, "SO"], [522, 524, "MF"]], [[527, 528, "MF"]], [], [[585, 585, "MP"], [588, 588, "MP"], [592, 593, "MP"]], [[602, 602, "MP"], [604, 605, "MP"], [607, 607, "SO"]], [[612, 613, "MP"], [627, 628, "TP"], [641, 642, "SO"]], [[650, 650, "MP"], [658, 658, "SF"], [660, 661, "SF"]], [[664, 664, "MP"], [669, 669, "SF"], [671, 671, "SF"], [677, 677, "SF"]], [[689, 689, "TF"], [707, 707, "TF"], [712, 712, "MP"]], [[717, 717, "TF"], [720, 720, "MP"], [723, 724, "TF"], [727, 731, "TF"]], [[742, 742, "MF"], [745, 746, "MF"], [750, 750, "MP"], [755, 756, "TP"], [763, 763, "MP"], [767, 768, "TF"]]], "relations": [[[12, 13, 24, 24, "CO"], [12, 13, 95, 95, "CO"]], [[28, 28, 1, 1, "ST"], [28, 28, 1, 1, "RF"], [28, 28, 12, 13, "EX"], [28, 28, 35, 36, "ST"], [28, 28, 35, 36, "RF"], [35, 36, 38, 39, "CO"], [28, 28, 72, 72, "CO"]], [[46, 46, 61, 62, "CO"], [46, 46, 57, 57, "CO"], [46, 46, 76, 76, "CO"]], [], [[72, 72, 76, 76, "RD"], [72, 72, 79, 80, "ST"], [72, 72, 79, 80, "RF"], [72, 72, 95, 95, "EX"], [72, 72, 107, 107, "WR"]], [], [[132, 133, 140, 140, "CO"], [132, 133, 136, 138, "CO"]], [[150, 151, 107, 107, "RD"], [150, 151, 168, 169, "ST"], [150, 151, 168, 169, "RF"], [163, 164, 107, 107, "RD"], [163, 164, 168, 169, "ST"], [163, 164, 168, 169, "RF"], [163, 164, 168, 169, "ST"], [163, 164, 168, 169, "RF"]], [[179, 179, 168, 169, "ST"], [179, 179, 168, 169, "RF"], [179, 179, 168, 169, "ST"], [179, 179, 205, 207, "RD"], [179, 179, 168, 169, "RF"], [179, 179, 199, 199, "CO"], [179, 179, 199, 199, "CO"], [179, 179, 358, 358, "CO"], [179, 179, 448, 448, "CO"]], [], [[199, 199, 205, 207, "WR"], [199, 199, 227, 227, "CO"], [199, 199, 269, 269, "CO"], [199, 199, 322, 322, "CO"]], [[227, 227, 232, 233, "WR"], [227, 227, 244, 245, "ST"], [227, 227, 244, 245, "RF"], [227, 227, 250, 251, "RD"], [227, 227, 250, 251, "WR"], [232, 233, 240, 240, "CO"], [232, 233, 250, 251, "CO"]], [], [[269, 269, 275, 276, "RD"], [269, 269, 275, 276, "WR"], [275, 276, 283, 283, "CO"]], [], [[322, 322, 346, 347, "FR"], [346, 347, 336, 338, "CD"], [346, 347, 342, 343, "CD"]], [[358, 358, 354, 355, "FR"], [354, 355, 336, 338, "EX"], [358, 358, 361, 362, "RD"]], [[388, 388, 396, 397, "RD"], [388, 388, 396, 397, "WR"], [388, 388, 588, 588, "CO"], [388, 388, 650, 650, "CO"], [388, 388, 712, 712, "CO"]], [], [], [[448, 448, 396, 397, "RD"], [448, 448, 396, 397, "RD"], [448, 448, 396, 397, "WR"], [448, 448, 473, 474, "ST"], [448, 448, 473, 474, "RF"], [448, 448, 473, 474, "ST"], [448, 448, 473, 474, "RF"], [473, 474, 519, 519, "CO"]], [], [], [[515, 516, 522, 524, "CO"], [515, 516, 527, 528, "CO"]], [], [], [[588, 588, 592, 593, "FR"], [585, 585, 519, 519, "RF"], [585, 585, 519, 519, "ST"], [585, 585, 592, 593, "CO"], [585, 585, 602, 602, "CO"], [585, 585, 612, 613, "CO"]], [[602, 602, 604, 605, "FR"], [604, 605, 607, 607, "ST"], [604, 605, 607, 607, "RF"]], [[612, 613, 627, 628, "IJ"], [612, 613, 641, 642, "ST"], [612, 613, 641, 642, "RF"]], [[650, 650, 658, 658, "RD"], [650, 650, 658, 658, "RD"], [650, 650, 658, 658, "WR"], [650, 650, 660, 661, "RD"], [650, 650, 660, 661, "RD"], [650, 650, 660, 661, "WR"], [650, 650, 669, 669, "RD"], [650, 650, 671, 671, "RD"], [650, 650, 664, 664, "CO"]], [[664, 664, 669, 669, "RD"], [664, 664, 669, 669, "WR"], [664, 664, 671, 671, "RD"], [664, 664, 671, 671, "WR"], [669, 669, 671, 671, "CO"], [669, 669, 677, 677, "CO"]], [[712, 712, 707, 707, "WR"], [689, 689, 707, 707, "CO"], [689, 689, 717, 717, "CO"], [712, 712, 720, 720, "CO"]], [[720, 720, 723, 724, "WR"], [723, 724, 727, 731, "CO"]], [[750, 750, 742, 742, "RD"], [750, 750, 745, 746, "WR"], [750, 750, 755, 756, "FR"], [755, 756, 763, 763, "FR"], [763, 763, 767, 768, "RD"], [763, 763, 767, 768, "WR"]]]}