{"doc_key": "053", "sentences": [["The", "ZetaNile", "malware", "family", "implants", "their", "DLLs", "by", "packing", "them", "with", "commercial", "software", "protectors", "or", "encrypting", "them", "using", "customized", "algorithms", ".", "The", "malicious", "DLL", "contains", "a", "payload", "that", "is", "decrypted", "using", "a", "custom", "key", "which", "is", "passed", "during", "DLL", "search", "order", "hijacking", "of", "a", "legitimate", "Windows", "process", "."], ["To", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", ",", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "are", "used", "by", "the", "ZetaNile", "implants", ".", "The", "victim", "information", "is", "encoded", "in", "the", "parameters", "of", "common", "HTTP", "POSTs", "keywords", ",", "such", "as", "gametype", "or", "bbs", "for", "the", "C2", "communications", "to", "blend", "with", "legitimate", "traffic", "."], ["The", "ZINC", "operationalized", "the", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "after", "establishing", "a", "connection", "with", "their", "target", ".", "The", "recipient", "receives", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "to", "deploy", "ZetaNile", ",", "and", "running", "this", "file", "does", "not", "drop", "the", "implant", "."], ["The", "malicious", "PuTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", ".", "To", "load", "the", "second", "stage", "ZetaNile", "malware", ",", "colurui.dll", "is", "used", "by", "ZINC", "by", "DLL", "search", "order", "hijacking", "and", "the", "payload", "is", "decoded", "using", "a", "specific", "key", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "additional", "malware", "could", "be", "installed", "on", "the", "compromised", "device", "for", "other", "tasks", ",", "and", "persistence", "is", "established", "via", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "achieves", "this", "by", "using", "a", "scheduled", "task", "for", "PuTTY", "as", "part", "of", "persisting", "in", "the", "system", ".", "The", "executable", "firstly", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "and", "then", "sends", "the", "information", "to", "a", "hardcoded", "IP", "address", "of", "172.93.201.253", "via", "TCP/22", ",", "which", "does", "not", "require", "SSH", "protocol", "and", "the", "corresponding", "handshake", "to", "begin", "communication", "."], ["The", "KiTTY", "executable", ",", "upon", "successful", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "then", "deploys", "the", "zetanile", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "by", "using", "multiple", "rounds", "of", "decoding", ".", "The", "mscoree.dll", "file", "contains", "the", "embedded", "payload", "named", "EventHorizon", "present", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "PuTTY", "version", ",", "the", "malicious", "DLL", "files", "loaded", "through", "DLL", "search", "order", "hijacking", "to", "perform", "tasks", "within", "the", "context", "of", "real", "Windows", "processes", "operate", "through", "the", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", ".", "A", "screenshot", "of", "the", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking", "is", "also", "available", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "a", "way", "that", "additional", "malware", "for", "various", "tasks", "can", "be", "installed", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "via", "existing", "C2", "communication", ".", "An", "example", "of", "this", "is", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "user", "agent", "string", "hardcoded", "with", "a", "misspelled", "``", "Edge", ",", "''", "a", "unique", "ID", "for", "the", "field", "gametype", ",", "and", "a", "hardcoded", "value", "for", "the", "field", "type", ",", "for", "malware", "campaign", "tracking", "purposes", ".", "The", "malware", "has", "a", "unique", "PDBPath", ",", "and", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "within", "the", "archive", "."], ["To", "evade", "traditional", "defenses", ",", "the", "threat", "actor", "implemented", "a", "new", "malware", "technique", "with", "the", "malicious", "TightVNC", "Viewer", "pre-populated", "with", "a", "list", "of", "remote", "hosts", ".", "The", "backdoor", "is", "installed", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "."], ["As", "part", "of", "the", "victim", "check-in", "with", "the", "C2", ",", "the", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Upon", "successfully", "establishing", "a", "connection", "with", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", ".", "The", "recipient", "receives", "an", "executable", "file", "to", "run", "within", "the", "archive", "."], ["The", "malicious", "Sumatra", "PDF", "reader", "is", "fully", "functional", ",", "and", "the", "implanted", "fake", "PDF", "can", "be", "loaded", "through", "it", ".", "However", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "Furthermore", ",", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", ",", "''", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", ".", "Once", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "during", "the", "C2", "check-in", "process", "."], ["The", "C2", "communication", "enables", "the", "attackers", "to", "install", "additional", "malware", "on", "compromised", "devices", "as", "required", "."], ["The", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", "contains", "an", "embedded", "executable", "inside", "setup.exe", ",", "which", "setup.exe", "extracts", "upon", "checking", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", ".", "It", "writes", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", ",", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", ",", "and", "then", "creates", "a", "new", "process", "C", ":", "\\colorctrl\\colorcpl.exe", "with", "the", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "."], ["The", "C3A9B30B6A313F289297C9A36730DB6D", "argument", "gets", "passed", "on", "to", "colorui.dll", "as", "a", "decryption", "key", "for", "the", "second", "stage", "malware", ".", "Microsoft", "is", "tracking", "colorui.dll", "as", "part", "of", "the", "EventHorizon", "malware", "family", ",", "and", "the", "DLL", "is", "injected", "into", "C", ":", "\\Windows\\System\\credwiz.exe", "or", "iexpress.exe", "."], ["As", "part", "of", "the", "victim", "check-in", "process", ",", "the", "DLL", "colorui.dll", "sends", "C2", "HTTP", "requests", "and", "receives", "an", "additional", "payload", "."]], "ner": [[[6, 6, "MF"], [11, 13, "MP"], [18, 19, "MP"], [23, 23, "MF"], [26, 26, "MF"], [32, 33, "MP"], [38, 38, "MF"], [45, 46, "TP"]], [[61, 62, "SO"], [65, 66, "MP"], [69, 70, "MP"], [75, 76, "MP"], [79, 80, "MF"]], [[108, 108, "MP"], [115, 116, "MP"], [118, 118, "MP"], [120, 120, "MP"], [130, 131, "MP"], [138, 138, "SO"], [141, 141, "TP"], [144, 144, "TF"], [147, 148, "MF"]], [[167, 167, "MP"], [173, 175, "MP"], [177, 179, "SF"], [182, 184, "SF"], [186, 188, "SF"], [198, 198, "MF"], [202, 202, "MP"], [210, 210, "TF"]], [[223, 224, "SO"], [227, 227, "MP"], [237, 237, "MP"], [252, 252, "TP"], [261, 262, "MP"]], [[264, 264, "MP"], [273, 273, "MP"], [283, 283, "MP"], [287, 287, "TF"], [289, 289, "TF"], [305, 305, "SO"]], [[324, 325, "MP"], [334, 334, "SO"], [342, 345, "MF"], [354, 354, "MF"], [361, 361, "MP"]], [[371, 371, "MP"], [373, 373, "MP"], [378, 379, "MF"], [382, 385, "MP"], [394, 395, "TP"], [399, 404, "MF"], [411, 412, "MP"], [414, 414, "MP"]], [[426, 427, "MP"], [435, 435, "MP"], [448, 449, "SO"], [462, 464, "MF"], [470, 470, "MF"]], [[478, 480, "MF"], [499, 500, "TF"], [504, 505, "TF"], [522, 522, "TF"]], [[557, 558, "MP"], [564, 565, "SO"], [568, 568, "MP"], [576, 576, "MF"]], [[593, 593, "MP"], [604, 604, "SO"], [614, 614, "SO"]], [[626, 627, "SO"], [633, 634, "MF"], [636, 636, "MP"], [652, 652, "MP"], [655, 656, "MF"]], [[665, 667, "MP"], [674, 674, "MF"], [686, 687, "MP"], [693, 693, "MP"], [698, 699, "MF"], [703, 703, "MP"], [712, 713, "MP"], [720, 721, "MF"]], [[729, 729, "MF"], [738, 739, "TF"], [745, 745, "MF"], [748, 750, "MF"], [757, 759, "MP"], [773, 773, "MP"], [782, 782, "TF"], [784, 785, "TF"], [792, 794, "SO"], [797, 799, "MP"]], [[802, 803, "MP"], [806, 806, "MP"], [809, 810, "MP"]], [[821, 823, "MP"], [840, 840, "MP"], [843, 843, "MP"], [845, 847, "MF"], [852, 854, "MF"], [856, 858, "MF"]], [[881, 881, "MF"], [892, 892, "MP"], [910, 912, "MP"], [914, 914, "MP"]], [[935, 935, "MF"]]], "relations": [[[11, 13, 6, 6, "WR"], [18, 19, 6, 6, "WR"], [32, 33, 26, 26, "WR"], [45, 46, 38, 38, "RD"], [23, 23, 38, 38, "CO"]], [[75, 76, 61, 62, "ST"], [75, 76, 61, 62, "RF"], [75, 76, 65, 66, "IJ"], [75, 76, 69, 70, "IJ"], [75, 76, 79, 80, "WR"], [75, 76, 130, 131, "CO"]], [[108, 108, 79, 80, "WR"], [108, 108, 138, 138, "ST"], [108, 108, 138, 138, "RF"], [115, 116, 79, 80, "WR"], [115, 116, 138, 138, "ST"], [115, 116, 138, 138, "RF"], [118, 118, 79, 80, "WR"], [118, 118, 138, 138, "ST"], [118, 118, 138, 138, "RF"], [120, 120, 79, 80, "WR"], [120, 120, 138, 138, "ST"], [120, 120, 138, 138, "RF"], [141, 141, 147, 148, "EX"]], [[167, 167, 177, 179, "RD"], [167, 167, 173, 175, "FR"], [167, 167, 177, 179, "WR"], [167, 167, 186, 188, "RD"], [167, 167, 182, 184, "RD"], [167, 167, 186, 188, "WR"], [202, 202, 198, 198, "WR"], [202, 202, 210, 210, "RD"]], [[237, 237, 223, 224, "ST"], [237, 237, 223, 224, "RF"], [237, 237, 227, 227, "FR"], [261, 262, 252, 252, "FR"], [252, 252, 264, 264, "FR"]], [[283, 283, 287, 287, "RD"], [283, 283, 289, 289, "RD"], [264, 264, 305, 305, "ST"], [264, 264, 305, 305, "RF"], [273, 273, 305, 305, "ST"], [273, 273, 305, 305, "RF"], [283, 283, 305, 305, "ST"], [273, 273, 261, 262, "CO"]], [[324, 325, 334, 334, "ST"], [324, 325, 334, 334, "RF"], [324, 325, 342, 345, "WR"], [361, 361, 354, 354, "WR"], [361, 361, 354, 354, "WR"], [361, 361, 394, 395, "FR"], [354, 354, 342, 345, "CO"]], [[382, 385, 378, 379, "WR"], [371, 371, 354, 354, "WR"], [373, 373, 354, 354, "WR"], [394, 395, 378, 379, "EX"], [394, 395, 399, 404, "EX"], [411, 412, 399, 404, "RD"], [411, 412, 448, 449, "ST"], [411, 412, 448, 449, "RF"], [414, 414, 399, 404, "RD"], [414, 414, 448, 449, "ST"], [414, 414, 448, 449, "RF"]], [[426, 427, 448, 449, "ST"], [426, 427, 448, 449, "RF"], [435, 435, 462, 464, "EX"], [435, 435, 470, 470, "RD"], [435, 435, 478, 480, "WR"], [435, 435, 593, 593, "CO"], [435, 435, 773, 773, "CO"]], [], [[557, 558, 478, 480, "WR"], [557, 558, 564, 565, "ST"], [557, 558, 564, 565, "RF"], [557, 558, 568, 568, "FR"], [568, 568, 564, 565, "ST"], [568, 568, 564, 565, "RF"], [568, 568, 576, 576, "WR"]], [[593, 593, 576, 576, "WR"], [593, 593, 604, 604, "ST"], [593, 593, 604, 604, "RF"], [593, 593, 614, 614, "ST"], [593, 593, 614, 614, "RF"], [593, 593, 626, 627, "ST"], [593, 593, 626, 627, "RF"], [593, 593, 633, 634, "RD"]], [[636, 636, 633, 634, "WR"], [652, 652, 655, 656, "EX"]], [[665, 667, 674, 674, "RD"], [686, 687, 693, 693, "FR"], [693, 693, 698, 699, "WR"], [703, 703, 698, 699, "WR"], [703, 703, 712, 713, "FR"], [703, 703, 720, 721, "RD"], [712, 713, 729, 729, "WR"], [712, 713, 745, 745, "WR"]], [[757, 759, 745, 745, "WR"], [757, 759, 748, 750, "RD"], [773, 773, 782, 782, "RD"], [773, 773, 784, 785, "RD"], [773, 773, 792, 794, "ST"], [797, 799, 784, 785, "RD"], [729, 729, 748, 750, "CO"]], [[806, 806, 802, 803, "FR"], [806, 806, 809, 810, "FR"]], [[821, 823, 840, 840, "FR"], [843, 843, 845, 847, "WR"], [843, 843, 852, 854, "RD"], [843, 843, 856, 858, "WR"]], [[892, 892, 881, 881, "WR"], [892, 892, 910, 912, "IJ"], [892, 892, 914, 914, "IJ"], [892, 892, 935, 935, "RD"], [881, 881, 845, 847, "CO"]], []]}