{"doc_key": "065", "sentences": [["They", "both", "start", "with", "the", "exploitation", "of", "a", "public", "vulnerability", "on", "appliances", "where", "the", "malicious", "actors", "then", "dropped", "GoMet", "as", "a", "backdoor", "."], ["GoMet", "supports", "job", "scheduling", "(", "via", "Cron", "or", "task", "scheduler", "depending", "on", "the", "OS", ")", ",", "single", "command", "execution", ",", "file", "download", ",", "file", "upload", "or", "opening", "a", "shell", "."], ["An", "additional", "notable", "feature", "of", "GoMet", "lies", "in", "its", "ability", "to", "daisy", "chain", "whereby", "the", "attackers", "gain", "access", "to", "a", "network", "or", "machine", "and", "then", "use", "that", "same", "information", "to", "gain", "access", "to", "multiple", "networks", "and", "computers", "connections", "from", "one", "implanted", "host", "to", "another", "."], ["This", "version", "was", "changed", "by", "malicious", "actors", ",", "in", "the", "original", "code", ",", "the", "cronjob", "is", "configured", "to", "be", "executed", "once", "every", "hour", "on", "the", "hour", "."], ["The", "objective", "of", "the", "cron", "job", "defined", "in", "the", "main", "part", "of", "the", "malware", "is", "to", "check", "if", "it", "'s", "connected", "to", "the", "C2", ",", "if", "not", "it", "will", "start", "the", "agent", "component", "again", "and", "connect", "to", "the", "C2", "."], ["The", "picture", "below", "shows", "the", "execution", "flow", "of", "the", "C2", "setup", "routine", "Agent", "."], ["If", "the", "C2", "is", "unreachable", ",", "the", "sample", "will", "sleep", "for", "a", "random", "amount", "of", "time", "between", "five", "and", "10", "minutes", "."], ["GO", "'s", "sleep", "implementation", "uses", "nanoseconds", "."], ["The", "Pseudo", "Code", "would", "look", "like", "the", "following", ":", "time_Sleep", "(", "1000000000", "*", "(", "rnd_val", "+", "300", ")", ")", "."], ["The", "trick", "is", ",", "the", "Go", "compiler", "is", "changing", "the", "source", "code", "WaitGroup", "."], ["Done", "(", ")", "to", "WaitGroup.Add", "(", "-1", ")", "."], ["After", "the", "Agent.start", "routine", "is", "done", ",", "the", "next", "cron", "job", "triggered", "the", "execution", "of", "the", "serve", "(", ")", "routine", "and", "tried", "to", "start", "another", "instance", "of", "the", "Agent", "."], ["The", "simplified", "source", "code", "of", "the", "GitHub", "version", "looks", "like", "this", ":", "The", "simplified", "pseudo-code", "for", "the", "samples", "in", "the", "wild", "looks", "like", "this", ":", "Talos", "found", "two", "samples", "of", "this", "version", "of", "the", "backdoor", ":", "f24158c5132943fbdeee4de4cedd063541916175434f82047b6576f86897b1cb", "(", "FctSec.exe", ")", "950ba2cc9b1dfaadf6919e05c854c2eaabbacb769b2ff684de11c3094a03ee88", "(", "SQLocalM86.exe", ")", "These", "samples", "have", "minor", "differences", "but", "are", "likely", "built", "from", "the", "same", "source", "code", ",", "just", "with", "a", "slightly", "different", "configuration", "."], ["The", "malicious", "activity", "we", "detected", "included", "a", "fake", "Windows", "update", "scheduled", "tasks", "created", "by", "the", "GoMet", "dropper", "."], ["It", "enumerated", "the", "autorun", "values", "and", ",", "instead", "of", "creating", "a", "new", "one", ",", "replaced", "one", "of", "the", "existing", "goodware", "autorun", "executables", "with", "the", "malware", "."], ["In", "one", "of", "the", "cases", ",", "about", "60", "seconds", "before", "the", "schtask", "query", "is", "executed", ",", "a", "blank", "CMD", "process", "is", "opened", "and", "then", "subsequently", "executes", "systeminfo", "and", "schtask", "queries", "rather", "than", "these", "queries", "being", "chain", "opened", "by", "svchost", "or", "services", "or", "another", "process", "."], ["This", "execution", "looks", "like", ":", "C", ":", "\\WINDOWS\\system32\\cmd.exe", "7", ")", "systeminfoschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduledschtasks", "/query", "/tn", "microsoft\\windows\\windowsupdate\\scheduled", "/vInfrastructure", "Both", "samples", "have", "the", "command", "and", "control", "(", "C2", ")", "IP", "address", "hardcoded", ",", "which", "is", "111.90.139.122", "."], ["Communication", "occurs", "via", "HTTPS", "on", "the", "default", "port", "."]], "ner": [[[9, 9, "MF"], [15, 15, "MP"], [18, 18, "MP"], [21, 21, "MP"]], [[23, 23, "MP"], [31, 32, "MP"], [40, 41, "MP"], [43, 44, "MP"], [46, 47, "MP"], [49, 51, "MP"]], [[58, 58, "MP"], [68, 68, "MP"], [70, 70, "SF"]], [[99, 99, "MF"], [104, 104, "MP"], [112, 112, "MF"]], [[129, 130, "MF"], [138, 138, "MP"], [148, 148, "SO"], [156, 157, "MP"], [163, 163, "SO"]], [[174, 174, "SO"]], [[181, 181, "SO"], [186, 186, "MP"]], [], [[209, 210, "MF"]], [[233, 234, "TP"], [238, 239, "MF"]], [], [[260, 261, "MP"], [267, 270, "MF"], [279, 279, "MP"]], [[295, 295, "MF"], [309, 309, "MP"], [315, 315, "MP"], [326, 326, "MP"]], [[354, 356, "MF"], [362, 363, "MP"]], [[384, 384, "TP"], [389, 389, "MP"]], [[402, 403, "TP"], [409, 410, "TP"], [417, 417, "TP"], [419, 420, "TP"]], [], []], "relations": [[[15, 15, 9, 9, "EX"], [15, 15, 18, 18, "FR"], [18, 18, 21, 21, "CO"], [18, 18, 23, 23, "CO"], [18, 18, 58, 58, "CO"], [15, 15, 68, 68, "CO"], [15, 15, 104, 104, "CO"]], [[23, 23, 31, 32, "FR"], [23, 23, 40, 41, "FR"], [23, 23, 43, 44, "FR"], [23, 23, 46, 47, "FR"], [23, 23, 49, 51, "FR"]], [[68, 68, 70, 70, "CD"]], [[104, 104, 99, 99, "RD"], [104, 104, 99, 99, "WR"], [99, 99, 112, 112, "CO"], [99, 99, 129, 130, "CO"]], [[138, 138, 129, 130, "RD"], [138, 138, 148, 148, "ST"], [138, 138, 148, 148, "RF"], [138, 138, 156, 157, "FR"], [156, 157, 148, 148, "ST"], [156, 157, 148, 148, "RF"], [156, 157, 163, 163, "ST"], [156, 157, 163, 163, "RF"], [156, 157, 209, 210, "WR"], [138, 138, 186, 186, "CO"]], [[174, 174, 181, 181, "CO"], [174, 174, 163, 163, "CO"]], [[186, 186, 233, 234, "FR"]], [], [], [[233, 234, 181, 181, "ST"], [233, 234, 181, 181, "RF"], [233, 234, 209, 210, "WR"], [233, 234, 238, 239, "RD"], [233, 234, 238, 239, "WR"]], [], [[260, 261, 267, 270, "EX"], [260, 261, 279, 279, "FR"], [279, 279, 295, 295, "WR"], [260, 261, 384, 384, "IJ"]], [[309, 309, 295, 295, "WR"], [309, 309, 295, 295, "WR"], [315, 315, 295, 295, "WR"], [315, 315, 384, 384, "FR"], [309, 309, 326, 326, "CO"]], [[362, 363, 354, 356, "WR"], [362, 363, 402, 403, "FR"], [362, 363, 389, 389, "CO"]], [[389, 389, 384, 384, "UK"], [389, 389, 409, 410, "FR"]], [[409, 410, 417, 417, "FR"], [409, 410, 419, 420, "FR"]], [], []]}