{"doc_key": "002", "sentences": [["The", "email", "attachment", "is", "a", "ZIP", "file", "that", "contains", "a", "PE32", "executable", "."], ["This", "executable", ",", "written", "in", ".NET", ",", "works", "as", "a", "downloader", "to", "retrieve", "the", "next", "stage", "of", "the", "malware", "infection", "chain", "."], ["Once", "executed", ",", "the", "downloader", "connects", "to", "an", "IPFS", "gateway", "to", "obtain", "a", "blob", "of", "data", "that", "has", "been", "hosted", "on", "the", "IPFS", "network", "."], ["The", "data", "consists", "of", "an", "obfuscated", "PE32", "executable", "that", "functions", "as", "the", "next-stage", "payload", "."], ["The", "downloader", "stores", "each", "byte", "of", "this", "data", "retrieved", "from", "the", "IPFS", "gateway", "in", "an", "array", "and", "uses", "a", "key", "value", "stored", "in", "the", "executable", "to", "convert", "the", "byte", "array", "into", "the", "next-stage", "PE32", "."], ["This", "new", "payload", "is", "reflectively", "loaded", "and", "executed", ",", "initiating", "the", "remote", "access", "trojan", "(", "RAT", ")", "called", "Agent", "Tesla", "."], ["In", "all", "three", "clusters", ",", "the", "initial", "payload", "served", "as", "a", "loader", "and", "operated", "similarly", ",", "but", "the", "final", "payload", "hosted", "on", "the", "IPFS", "network", "was", "different", "for", "each", "cluster", "."], ["Most", "loaders", "were", "not", "packed", ",", "but", "some", "samples", "were", "observed", "to", "be", "packed", "using", "UPX", "."], ["When", "executed", ",", "the", "loader", "first", "creates", "a", "directory", "structure", "within", "%", "APPDATA", "%", ",", "using", "a", "command", "line", "syntax", ":", "C", ":", "\\Windows\\system32\\cmd.exe", "/c", "cd", "%", "appdata", "%", "\\Microsoft", "&", "&", "mkdir", "Network", "."], ["The", "malware", "then", "attempts", "to", "download", "Python", "3.10", "from", "the", "software", "provider", "using", "the", "cURL", "command", "."], ["Once", "the", "ZIP", "archive", "has", "been", "retrieved", ",", "it", "is", "unzipped", "and", "stored", "in", "the", "previously", "created", "directory", "using", "the", "PowerShell", "``", "Expand-Archive", "''", "cmdlet", "."], ["The", "malware", "also", "retrieves", "the", "final", "payload", "in", "the", "infection", "chain", "and", "stores", "it", "within", "the", "Network", "directory", "using", "the", "filename", "``", "Packages.txt", "''", "."], ["The", "loader", "then", "uses", "the", "attrib.exe", "utility", "to", "set", "the", "System", "and", "Hidden", "flags", "on", "the", "previously", "created", "directory", ",", "as", "well", "as", "the", "Python", "ZIP", "archive", "and", "final", "payload", "that", "was", "retrieved", "."], ["Finally", ",", "the", "loader", "invokes", "the", "newly", "downloaded", "Python", "executable", "and", "passes", "the", "final", "payload", "as", "a", "command", "line", "argument", ",", "executing", "the", "next", "stage", "of", "the", "infection", "process", "."], ["In", "some", "cases", ",", "the", "malware", "achieves", "persistence", "by", "adding", "entries", "into", "the", "Windows", "registry", "."], ["During", "our", "analysis", "of", "the", "loader-associated", "samples", ",", "we", "discovered", "that", "the", "IPFS", "gateway", "used", "was", "no", "longer", "active", "."], ["However", ",", "Talos", "manually", "retrieved", "and", "analyzed", "the", "next-stage", "payloads", "from", "another", "IPFS", "gateway", "."], ["In", "one", "of", "the", "clusters", "using", "this", "loader", ",", "a", "Python", "script", "containing", "a", "large", "base64", "encoded", "blob", "along", "with", "the", "Python", "code", "for", "decoding", "it", "was", "hosted", "within", "the", "IPFS", "network", "."], ["After", "decoding", "all", "layers", ",", "the", "deobfuscated", "reverse", "shell", "payload", "was", "obtained", "."], ["At", "the", "time", "of", "analysis", ",", "the", "C2", "server", "was", "not", "operational", "on", "TCP/4444", "."], ["In", "another", "cluster", ",", "we", "observed", "that", "the", "final", "payload", "stored", "in", "IPFS", "was", "a", "Windows", "batch", "file", "."], ["When", "retrieved", ",", "the", "batch", "file", "was", "saved", "in", "the", "Network", "directory", "as", "``", "Script.bat", "''", "."], ["It", "deleted", "volume", "shadow", "copies", ",", "cleared", "the", "contents", "of", "C", ":", "\\Users", "(", "associated", "with", "user", "profiles", ")", ",", "and", "eliminated", "contents", "stored", "on", "all", "mounted", "filesystems", "detected", "on", "the", "system", "."], ["The", "malware", "incorrectly", "tried", "to", "invoke", "the", "batch", "file", "in", "the", "analyzed", "samples", "."], ["The", "loader", "'s", "third", "cluster", "was", "tasked", "with", "retrieving", "and", "executing", "Hannabi", "Grabber", ",", "an", "information", "stealer", "written", "in", "Python", "."], ["It", "uses", "Discord", "Webhooks", "for", "C2", "and", "data", "exfiltration", ",", "collects", "survey", "data", ",", "geographic", "location", "via", "IPInfo", "service", ",", "takes", "screenshots", ",", "and", "sends", "JSON", "formatted", "data", "to", "an", "attacker-controlled", "Discord", "server", "."], ["In", "addition", ",", "the", "malware", "targets", "Chrome", "passwords", "and", "cookies", ",", "as", "well", "as", "Mozilla", "Firefox", "data", "."], ["Discord", "and", "Roblox", "data", "are", "of", "particular", "interest", "to", "the", "information", "stealer", "."], ["The", "collected", "application", "data", "is", "stored", "in", "a", "RedDiscord", "folder", "with", "a", "ZIP", "archive", "called", "``", "Hannabi-", "<", "USERNAME", ">", ".zip", "''", "created", "within", "it", "before", "being", "exfiltrated", "."], ["Unlike", "other", "attackers", "who", "tend", "to", "compile", "their", "Python", "into", "a", "PE32", "file", "format", "using", "PyInstaller", "or", "Py2EXE", "prior", "to", "distribution", "to", "victims", ",", "this", "attacker", "opted", "to", "include", "a", "Python", "installation", "process", "during", "the", "infection", "and", "employs", "Python", "directly", "to", "steal", "sensitive", "information", "from", "victims", "."]], "ner": [[[1, 1, "SO"], [10, 11, "MF"]], [[14, 14, "MF"]], [[39, 39, "MP"], [43, 44, "SO"], [50, 50, "MF"]], [[61, 61, "MF"], [66, 67, "MF"]], [[76, 76, "MP"], [82, 82, "MF"], [86, 87, "SO"], [99, 99, "MF"], [108, 108, "MF"]], [[112, 112, "MF"], [121, 123, "MP"], [125, 125, "MP"], [128, 129, "MP"]], [[137, 138, "MP"], [149, 150, "MP"], [154, 155, "SO"]], [[163, 163, "MP"]], [[183, 183, "MP"], [190, 192, "SF"]], [[215, 215, "MP"], [220, 221, "TF"], [224, 225, "SO"]], [[233, 234, "TF"], [239, 239, "TF"]], [[258, 258, "MP"], [262, 263, "MF"], [270, 270, "MF"]], [[283, 283, "MP"], [287, 287, "TP"], [306, 308, "TF"], [310, 311, "MF"]], [[319, 319, "MP"], [324, 325, "TP"], [329, 330, "MF"]], [[351, 351, "MP"], [359, 360, "SF"]], [[374, 375, "SO"]], [[384, 384, "MP"], [391, 391, "MF"], [394, 395, "SO"]], [[404, 404, "MP"], [427, 428, "SO"]], [], [], [[466, 467, "MF"], [470, 470, "SO"], [473, 475, "MF"]], [[481, 482, "MF"], [491, 491, "MP"]], [[494, 494, "MP"], [496, 498, "SF"], [504, 506, "SF"], [520, 521, "SF"], [525, 525, "SF"]], [], [[542, 542, "MP"], [552, 553, "MP"]], [[562, 562, "MP"], [564, 565, "MP"], [567, 567, "SO"], [579, 580, "TP"], [593, 594, "SO"]], [[600, 600, "MP"], [602, 602, "SF"], [610, 611, "SF"]], [[614, 614, "SF"], [616, 616, "SF"]], [[629, 630, "TF"], [635, 635, "TF"], [639, 640, "TF"], [643, 647, "TF"]], [[658, 658, "MP"], [664, 664, "MF"], [667, 668, "MF"], [671, 671, "MP"], [673, 673, "MP"], [681, 681, "MP"], [686, 687, "TF"], [694, 694, "TP"], [698, 699, "TF"]]], "relations": [[[10, 11, 99, 99, "CO"]], [], [[39, 39, 1, 1, "ST"], [39, 39, 1, 1, "RF"], [39, 39, 14, 14, "EX"], [39, 39, 43, 44, "ST"], [39, 39, 43, 44, "RF"], [50, 50, 66, 67, "CO"], [50, 50, 61, 61, "CO"], [50, 50, 82, 82, "CO"], [43, 44, 86, 87, "CO"], [39, 39, 76, 76, "CO"]], [], [[76, 76, 82, 82, "RD"], [76, 76, 86, 87, "ST"], [76, 76, 86, 87, "RF"], [76, 76, 108, 108, "WR"], [108, 108, 112, 112, "CO"]], [[121, 123, 125, 125, "CO"], [121, 123, 128, 129, "CO"]], [[137, 138, 108, 108, "RD"], [137, 138, 154, 155, "ST"], [137, 138, 154, 155, "RF"], [149, 150, 108, 108, "RD"], [149, 150, 154, 155, "ST"], [149, 150, 154, 155, "RF"], [149, 150, 154, 155, "ST"], [149, 150, 154, 155, "RF"]], [[163, 163, 154, 155, "ST"], [163, 163, 154, 155, "RF"], [163, 163, 154, 155, "ST"], [163, 163, 154, 155, "RF"], [163, 163, 190, 192, "RD"], [163, 163, 190, 192, "RD"], [163, 163, 190, 192, "WR"], [163, 163, 183, 183, "CO"], [163, 163, 404, 404, "CO"], [163, 163, 542, 542, "CO"]], [[183, 183, 190, 192, "RD"], [183, 183, 190, 192, "WR"], [183, 183, 215, 215, "CO"], [183, 183, 258, 258, "CO"], [183, 183, 283, 283, "CO"], [183, 183, 319, 319, "CO"]], [[215, 215, 220, 221, "RD"], [215, 215, 224, 225, "ST"], [215, 215, 224, 225, "RF"], [215, 215, 233, 234, "RD"], [220, 221, 233, 234, "CO"], [220, 221, 239, 239, "CO"]], [], [[258, 258, 262, 263, "RD"], [262, 263, 270, 270, "CO"]], [[283, 283, 287, 287, "FR"], [287, 287, 306, 308, "CD"], [287, 287, 310, 311, "CD"]], [[319, 319, 324, 325, "FR"], [324, 325, 306, 308, "EX"], [324, 325, 329, 330, "RD"]], [[351, 351, 359, 360, "RD"], [351, 351, 359, 360, "WR"], [351, 351, 374, 375, "ST"], [351, 351, 374, 375, "RF"], [351, 351, 600, 600, "CO"]], [], [[384, 384, 374, 375, "ST"], [384, 384, 374, 375, "RF"], [384, 384, 391, 391, "RD"], [384, 384, 391, 391, "WR"], [384, 384, 394, 395, "ST"], [384, 384, 394, 395, "RF"]], [[404, 404, 391, 391, "RD"], [404, 404, 427, 428, "ST"], [404, 404, 427, 428, "RF"], [404, 404, 427, 428, "ST"], [404, 404, 427, 428, "RF"], [427, 428, 470, 470, "CO"]], [], [], [[466, 467, 473, 475, "CO"], [466, 467, 481, 482, "CO"]], [[491, 491, 470, 470, "ST"], [491, 491, 496, 498, "RD"], [491, 491, 470, 470, "RF"], [491, 491, 504, 506, "RD"], [491, 491, 520, 521, "RD"], [491, 491, 494, 494, "CO"]], [[494, 494, 496, 498, "WR"], [494, 494, 504, 506, "WR"], [494, 494, 520, 521, "WR"], [520, 521, 525, 525, "CO"]], [], [[542, 542, 552, 553, "FR"], [552, 553, 562, 562, "CO"]], [[562, 562, 564, 565, "FR"], [564, 565, 567, 567, "ST"], [564, 565, 567, 567, "RF"], [562, 562, 579, 580, "IJ"], [562, 562, 593, 594, "ST"], [562, 562, 593, 594, "RF"]], [[600, 600, 602, 602, "RD"], [600, 600, 602, 602, "RD"], [600, 600, 602, 602, "WR"], [600, 600, 610, 611, "RD"], [600, 600, 610, 611, "RD"], [600, 600, 610, 611, "WR"], [600, 600, 614, 614, "RD"], [600, 600, 614, 614, "RD"], [600, 600, 614, 614, "WR"], [600, 600, 616, 616, "RD"], [600, 600, 616, 616, "RD"], [600, 600, 616, 616, "WR"]], [], [[639, 640, 643, 647, "CO"], [629, 630, 635, 635, "CO"]], [[658, 658, 671, 671, "FR"], [671, 671, 664, 664, "RD"], [671, 671, 667, 668, "WR"], [658, 658, 673, 673, "FR"], [673, 673, 664, 664, "RD"], [673, 673, 667, 668, "WR"], [681, 681, 694, 694, "FR"], [681, 681, 698, 699, "WR"], [658, 658, 681, 681, "CO"]]]}