{"doc_key": "071", "sentences": [["The", "actor", "uses", "the", "Micropsia", "implant", "in", "the", "most", "recent", "wave", "that", "started", "around", "October", "2021", "."], ["It", "is", "highly", "likely", "that", "the", "threat", "actor", "has", "continued", "to", "use", "the", "email", "vector", "to", "deliver", "their", "lures", "and", "implants", "."], ["Form1", "contentsAll", "the", "malicious", "functionalities", "are", "implemented", "through", "the", "timers", "configured", "in", "the", "implant", "."], ["Deploying", "the", "decoy", "documentOne", "of", "these", "timers", "is", "responsible", "for", "extracting", "the", "decoy", "document", "and", "saving", "it", "to", "the", "%", "TEMP", "%", "folder", "and", "then", "displaying", "it", "via", "ShellExecute", ":", "Decoy", "document", "extracted", "and", "displayed", "to", "the", "target", "."], ["Now", ",", "if", "the", "implant", "is", "started", "with", "the", "``", "-start", "''", "command-line", "switch", ",", "it", "will", "skip", "the", "process", "for", "dropping", "and", "displaying", "the", "decoy", "document", "and", "jump", "straight", "to", "its", "RAT", "functionalities", "."], ["Establishing", "persistenceAnother", "timer", "is", "used", "to", "establish", "persistence", "for", "the", "implant", "on", "the", "endpoint", "."], ["Here", ",", "the", "implant", "will", "establish", "persistence", "by", "obtaining", "its", "current", "command", "line", ",", "which", "is", "then", "used", "to", "create", "a", "shortcut", "for", "itself", "in", "the", "%", "TEMP", "%", "directory", "."], ["The", "shortcut", "to", "run", "the", "implant", "contains", "the", "``", "-start", "''", "switch", "(", "used", "to", "skip", "the", "displaying", "of", "the", "decoy", "document", ")", "."], ["This", "shortcut", "is", "then", "moved", "over", "to", "the", "currently", "logged-in", "user", "'s", "Startup", "folder", "to", "complete", "persistence", "across", "reboots", "and", "re-logins", "."], ["Information", "GatheringThe", "remaining", "two", "timers", "will", "gather", "preliminary", "system", "information", "and", "activate", "the", "RAT", "capabilities", "of", "the", "implant", "."], ["The", "sequence", "of", "actions", "followed", "for", "gathering", "system", "information", "from", "the", "endpoint", "are", "as", "follows", ":", "Generate", "a", "pc", "ID", "for", "the", "infected", "endpoint", "."], ["Save", "this", "value", "into", "a", "data", "file", ",", "such", "as", ":", "``", "%", "APPDATA", "%", "\\dsfjj45k.tmp", "''", "Gather", "the", "Computername", "and", "username", "from", "ENV", "."], ["Concatenate", "the", "computername", ",", "username", "and", "pcid", "into", "format", ":", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "Gather", "installed", "AV", "information", "from", "the", "endpoint", "via", "``", "winmgmts", ":", "\\\\localhost", "oot\\SecurityCenter2", "''", "using", "query", "``", "SELECT", "*", "FROM", "AntiVirusProduct", "''", "."], ["From", "the", "AV", "information", "obtained", ",", "record", "the", "DisplayName", "."], ["Get", "OS", "information", "specifically", "the", "installed", "product", "name", "."], ["Get", "the", "current", "implant", "'s", "command", "line", "and", "record", "it", "."], ["All", "this", "data", "gathered", "from", "the", "system", "is", "individually", "base64-encoded", "and", "assigned", "to", "HTTP", "form", "query", "variables", "with", "the", "following", "name-value", "pairs", ":", "vcqmxylcv=", "base64", "encoded", "<", "COMPNAME", ">", "_", "<", "username", ">", "_", "<", "pcid", ">", "vcnwaapcv=", "base64", "encoded", "AV", "Name", "list.vcllgracv=", "base64", "encoded", "OS", "version", "string.vcwjlxycv=", "base64", "encoded", "implant", "command", "line.vccodwfcv=", "base64", "encoded", "hardcoded", "flag", "."], ["The", "data", "is", "then", "sent", "to", "the", "implant", "'s", "C2", "server", "via", "an", "HTTP", "POST", "request", ",", "which", "is", "fairly", "standard", "in", "Micropsia", "implants", "."], ["RAT", "capabilitiesOnce", "the", "preliminary", "information", "has", "been", "sent", ",", "the", "implant", "now", "begins", "its", "remote", "access", "trojan", "(", "RAT", ")", "activity", "and", "waits", "for", "command", "codes", "from", "the", "C2", "server", "."], ["The", "implant", "now", "uses", "two", "additional", "HTTP", "form", "variables", "to", "transmit", "the", "output", "of", "the", "commands", "executed", "on", "the", "endpoint", ":", "vcgqjdlrcv", "=", "hardcoded", "value", "0.", "mugnaq", "=", "base64", "encoded", "screenshot", "or", "command", "output", "."], ["The", "C2", "issues", "distinct", "command", "codes", "to", "the", "implant", "to", "carry", "out", "various", "actions", "on", "the", "infected", "endpoint", "."], ["The", "command", "codes", "accepted", "by", "the", "implant", "are", "listed", "here", ":", "Command", "codeDescription", "''", "1", "''", "or", "``", "2", "''", "or", "``", "sh", "''", "Capture", "screenshots", "to", "the", "%", "TEMP", "%", "directory", "and", "exfiltrate", "."], ["``", "log", "''", "Send", "the", "current", "activity", "log", "(", "recorded", "in", "an", "internal", "Memo", ")", "to", "the", "C2", "."], ["``", "cmd", "''", "Execute", "the", "command", "specified", "and", "send", "output", "to", "C2", "."], ["``", "df", "''", "Download", "file", "from", "a", "specified", "remote", "location", "into", "a", "local", "path", "specified", "by", "the", "C2", "."], ["``", "lehar", "''", "Ask", "for", "the", "next", "command", "from", "the", "C2", "."], ["We", "have", "observed", "implants", "using", "two", "distinct", "URLs", "to", "instrument", "communications", "with", "the", "C2", ",", "one", "for", "exfiltration", "of", "screenshots", "and", "the", "other", "for", "all", "the", "other", "RAT", "commands", "."], ["For", "example", "one", "of", "the", "implants", "used", "a", "distinct", "URL", "for", "screenshots", ":", "hxxp", "[", "s", "]", ":", "//deangelomcnay.news/qWIlIdKf2buIH0k/GbrHoIfRqtE69hH/ZCgbo9EVhYMA8PXWhile", "another", "URL", "was", "used", "for", "all", "other", "commands", ":", "hxxp", "[", "s", "]", ":", "//deangelomcnay.news/qWIlIdKf2buIH0k/GbrHoIfRqtE69hH/bu5EmpJE7DUfzZDConclusionSince", "its", "initial", "disclosure", "by", "Talos", "in", "2017", ",", "this", "campaign", "from", "Arid", "Viper", "has", "become", "a", "long-standing", "offensive", "cyber", "attack", "spanning", "well", "into", "2021", "."]], "ner": [[[1, 1, "MP"], [4, 5, "MP"]], [[24, 24, "MP"], [30, 31, "MF"], [35, 35, "MF"], [37, 37, "MF"]], [[43, 43, "MF"], [48, 48, "TP"], [52, 52, "MP"]], [[60, 60, "TP"], [66, 67, "MF"], [73, 76, "SF"], [82, 82, "MP"]], [[97, 97, "MP"], [103, 103, "MP"], [118, 119, "MF"]], [[130, 130, "MP"], [138, 138, "MF"], [141, 141, "SO"]], [[146, 146, "MP"], [154, 155, "MP"], [164, 164, "MP"], [169, 172, "MF"]], [[175, 175, "MP"], [179, 179, "MF"]], [[199, 199, "MP"], [210, 211, "MF"]], [[224, 224, "MP"], [229, 229, "MF"], [233, 234, "MP"]], [[242, 242, "MP"], [246, 247, "SF"], [250, 250, "SO"], [257, 258, "SF"], [262, 262, "SO"]], [[269, 270, "MF"], [283, 283, "SF"], [285, 285, "SF"]], [[291, 291, "SF"], [293, 293, "SF"], [295, 295, "SF"], [312, 313, "TF"], [316, 316, "SO"]], [[335, 336, "TF"]], [[344, 345, "SF"]], [[357, 358, "MF"]], [[365, 365, "MF"], [378, 379, "MF"]], [[422, 422, "MF"], [430, 431, "SO"]], [[456, 456, "MP"], [461, 462, "MP"], [470, 471, "MF"], [474, 475, "SO"]], [[478, 478, "MP"], [492, 493, "MF"], [496, 496, "SO"]], [[513, 513, "SO"], [516, 517, "MP"], [529, 529, "SO"]], [[532, 533, "MP"], [537, 537, "MP"]], [[567, 567, "MP"], [572, 573, "MF"], [583, 583, "SO"]], [[596, 596, "SO"]], [[602, 602, "MF"], [606, 607, "SO"], [615, 615, "SO"]], [[618, 618, "MP"], [624, 624, "MF"], [627, 627, "SO"]], [[632, 632, "MF"], [642, 642, "SO"], [656, 657, "MP"]], [[664, 664, "MF"], [702, 702, "MP"]]], "relations": [[[1, 1, 4, 5, "FR"], [1, 1, 30, 31, "WR"], [4, 5, 30, 31, "RD"], [1, 1, 24, 24, "CO"]], [[24, 24, 35, 35, "RD"], [24, 24, 37, 37, "WR"]], [[48, 48, 37, 37, "RD"], [48, 48, 43, 43, "WR"], [48, 48, 52, 52, "FR"], [52, 52, 60, 60, "FR"]], [[60, 60, 66, 67, "RD"], [60, 60, 82, 82, "FR"], [82, 82, 73, 76, "RD"], [82, 82, 66, 67, "EX"], [82, 82, 73, 76, "WR"]], [[97, 97, 103, 103, "FR"], [103, 103, 118, 119, "WR"]], [[130, 130, 138, 138, "WR"], [130, 130, 141, 141, "ST"]], [[146, 146, 154, 155, "FR"], [154, 155, 164, 164, "FR"], [154, 155, 169, 172, "WR"], [164, 164, 175, 175, "CO"]], [[175, 175, 179, 179, "EX"], [175, 175, 199, 199, "FR"]], [[199, 199, 210, 211, "WR"]], [[224, 224, 229, 229, "RD"], [224, 224, 233, 234, "FR"]], [[242, 242, 246, 247, "RD"], [242, 242, 250, 250, "RF"], [242, 242, 257, 258, "RD"], [242, 242, 257, 258, "RD"], [242, 242, 257, 258, "WR"], [262, 262, 257, 258, "RD"], [262, 262, 257, 258, "WR"], [242, 242, 269, 270, "WR"], [242, 242, 283, 283, "RD"], [242, 242, 291, 291, "RD"], [242, 242, 285, 285, "RD"], [242, 242, 293, 293, "RD"], [242, 242, 291, 291, "WR"], [242, 242, 295, 295, "RD"], [242, 242, 293, 293, "WR"], [242, 242, 295, 295, "WR"], [242, 242, 312, 313, "WR"], [242, 242, 316, 316, "RF"], [242, 242, 344, 345, "RD"], [242, 242, 357, 358, "RD"], [242, 242, 365, 365, "RD"], [242, 242, 378, 379, "WR"], [242, 242, 422, 422, "WR"], [242, 242, 430, 431, "ST"], [262, 262, 316, 316, "CO"], [262, 262, 250, 250, "CO"]], [], [[312, 313, 335, 336, "CO"]], [], [], [], [], [], [[456, 456, 461, 462, "FR"], [456, 456, 470, 471, "RD"], [456, 456, 474, 475, "RF"]], [[478, 478, 492, 493, "EX"], [478, 478, 496, 496, "RF"], [478, 478, 537, 537, "CO"]], [[516, 517, 529, 529, "ST"], [516, 517, 529, 529, "RF"], [513, 513, 529, 529, "CO"]], [[537, 537, 532, 533, "FR"]], [[567, 567, 572, 573, "RD"], [567, 567, 583, 583, "ST"], [567, 567, 602, 602, "WR"], [567, 567, 606, 607, "RF"], [583, 583, 596, 596, "CO"], [583, 583, 615, 615, "CO"]], [], [], [[618, 618, 624, 624, "WR"], [618, 618, 627, 627, "RF"]], [[656, 657, 632, 632, "RD"], [656, 657, 642, 642, "ST"], [632, 632, 664, 664, "CO"]], []]}