{"doc_key": "090", "sentences": [["For", "example", ",", "blocking", "the", "URIs", "used", "by", "the", "mining", "pools", "and", "the", "malware", "'s", "intermediate", "stages", "."], ["Detection", "signatures", "can", "also", "prevent", "the", "XMRig", "miner", "from", "being", "dropped", "and", "executed", "on", "targeted", "hosts", "."], ["Once", "the", "initial", "infection", "was", "completed", "``", "Vivin", "''", "quickly", "moved", "to", "common", "Windows", "tools", "."], ["Initial", "infection", "occurs", "through", "the", "execution", "of", "malware", "made", "to", "resemble", "commonly", "used", "productivity", "software", ",", "tools", ",", "and", "games", "."], ["The", "pirated", "software", "from", "our", "observed", "sample", "run", "contains", "a", "second", "stage", "payload", "that", "is", "written", "to", "\\AppData\\Local\\Temp", "as", "``", "setup.exe.", "``"], ["Upon", "successful", "execution", ",", "the", "observed", "samples", "dropped", "both", "a", "JavaScript", "(", "``", "setup.js", "''", ")", "and", "VBScript", "(", "``", "dllm.vbs", "''", ")", "file", "to", "the", "victim", "host", "'s", "\\AppData\\Local\\Temp", "and", "\\Windows\\Start", "Menu\\Programs\\Startup", "folders", "."], ["As", "part", "of", "this", "execution", "chain", ",", "the", "malware", "also", "reaches", "out", "to", "``", "csrss.publicvpn.com", ",", "''", "a", "known", "malicious", "domain", ",", "to", "establish", "a", "TCP", "connection", "."], ["Finally", ",", "in", "addition", "to", "immediately", "running", "the", "malicious", "script", ",", "the", "dropper", "also", "creates", "a", "job", "using", "Windows", "Task", "Scheduler", "."], ["This", "job", ",", "called", "``", "anydesk", "''", "[", "1", "]", "in", "all", "of", "our", "samples", ",", "executes", "the", "dropped", "script", "every", "30", "minutes", ":", "c", ":", "\\windows\\system32\\schtasks.exe", "/create", "/sc", "minute", "/mo", "30", "/tn", "anydesk", "/tr", "c", ":", "\\users\\", "{", "username", "}", "\\appdata\\local", "emp\\setup.jsThe", "malicious", "script", "contains", "an", "obfuscated", "PowerShell", "command", "that", "executes", "a", "number", "of", "cascading", "PowerShell", "calls", "and", "additional", "payload", "stage", "downloads", "."], ["In", "the", "sample", "Talos", "originally", "discovered", ",", "the", "command", "reaches", "out", "to", "``", "pastebin.com/raw/gc5dfjh9", ",", "''", "a", "page", "containing", "a", "URL", "of", "a", "supposed", "image", "file", "at", "``", "www.m9c.net/uploads/15758872491.jpg.", "``"], ["These", "PowerShell", "commands", "reflectively", "load", "an", "included", "malicious", "."], ["The", "sample", "then", "calls", "the", "``", "exe", "''", "method", "of", "the", "``", "Hackitup", "''", "class", "shown", "below", ",", "which", "performs", "more", "deobfuscation", ",", "in", "addition", "to", "some", "additional", "logic", "checks", "through", "more", "chained", "method", "calls", ",", "such", "as", "whether", "it", "'s", "running", "on", "a", "32-", "or", "64-bit", "architecture", "."], ["Finally", ",", "it", "constructs", "the", "configuration", "options", "to", "be", "loaded", "and", "executed", "with", "its", "final", "payload", "by", "invoking", "``", "cmd.exe", "."], ["Examination", "of", "the", "reconstructed", "PE", "file", "reveals", "that", "it", "is", "compressed", "with", "UPX", "."], ["Additionally", ",", "the", "miner", "is", "launched", "with", "a", "common", "configuration", "that", "we", "were", "able", "to", "extract", "from", "the", "binary", "as", "shown", "in", "the", "figure", "below", "."], ["XMRig", "is", "set", "up", "to", "use", "a", "maximum", "of", "80", "percent", "of", "the", "host", "'s", "CPU", "resources", "with", "the", "``", "CryptoNight", "''", "algorithm", "in", "order", "to", "mine", "the", "Monero", "cryptocurrency", "."], ["The", "extracted", "configuration", "string", "also", "contains", "Vivin", "'s", "Monero", "payment", "address", ",", "which", "Talos", "used", "as", "a", "starting", "point", "to", "track", "this", "actor", "."], ["First", ",", "the", "initial", "droppers", "either", "install", "some", "form", "of", "the", "expected", "pirated", "software", "or", "they", "attempt", "to", "mimic", "a", "fake", "installation", "with", "paths", "that", "are", "named", "for", "associated", "programs", "."], ["For", "example", ",", "our", "``", "PhantomPDF", "''", "sample", "installed", "to", "``", "F", "%", "3A/Software/Adobe/", "''", "which", "is", "neither", "Adobe", "softwares", "'", "or", "PhantomPDF", "'s", "default", "install", "path", "."], ["Second", ",", "the", "source", "code", "in", "the", "dropped", "JavaScript", "and", "VBScript", "files", "are", "heavily", "manipulated", "for", "obfuscation", "."], ["Finally", ",", "all", "of", "the", "observable", "XMRIg", "payloads", "were", "packed", "using", "UPX", "."], ["The", "actor", "also", "used", "multiple", "methods", "of", "persistence", "to", "keep", "the", "XMRig", "mining", "software", "on", "the", "victimized", "hosts", "."], ["Windows", "Scheduler", "was", "used", "to", "create", "the", "job", "``", "anydesk", "''", "to", "execute", "setup.js", "every", "30", "minutes", "."], ["The", "sample", "copied", "various", "sources", "of", "execution", ":", "setup.exe", ",", "setup.js", ",", "and", "dllm.vbs", "to", "\\AppData\\Local\\Temp", "in", "order", "to", "have", "them", "persist", "on", "disk", "."], ["Additionally", ",", "the", "malware", "sample", "created", "startup", "items", "in", "two", "separate", "locations", ",", "thereby", "enabling", "re-execution", "of", "the", "malware", "following", "any", "system", "restarts", "."], ["One", "startup", "item", "was", "created", "by", "writing", "dllm.vbs", "and", "setup.js", "to", "\\Windows\\Start", "Menu\\Programs\\Startup", "."], ["The", "other", "was", "established", "by", "adding", "dllm.vbs", "to", "the", "``", "HKCU", ":", "\\Software\\Microsoft\\Windows\\CurrentVersion\\Run", "''", "registry", "key", "."], ["While", "all", "samples", "and", "execution", "chains", "Talos", "found", "associated", "with", "this", "actor", "dropped", "XMRig", "as", "their", "final", "payload", ",", "there", "were", "additional", "variations", "observed", "in", "some", "of", "them", "."], ["Some", "samples", "simply", "contained", "only", "one", "referenced", "PE", "file", "at", "the", "PowerShell", "stage", "and", "hid", "their", "XMRig", "payloads", "inside", "of", "the", "reflectively", "loaded", ".", "NET", "assembly", "as", "base-64", "encoded", "strings", "."], ["One", "of", "the", "more", "interesting", "samples", "first", "checked", "to", "see", "if", "it", "had", "access", "to", "``", "MSBuild.exe.", "``"], ["However", ",", "the", "sample", "that", "contained", "this", "check", "still", "only", "attempts", "to", "run", "the", "XMRig", "launch", "command", "to", "cmd.exe", ",", "rather", "than", "attempting", "to", "compile", "the", "next", "stage", "on", "the", "host", "or", "use", "the", "inline", "task", "function", "execution", "as", "other", "malware", "has", "been", "observed", "doing", "when", "attempting", "to", "access", "MSBuild", "."], ["Finally", ",", "some", "XMRig", "payloads", "used", "a", "dropped", "JSON", "configuration", "file", "rather", "than", "specifying", "them", "on", "the", "command-line", "or", "packing", "them", "into", "the", "final", "XMRig", "binary", "."], ["Upon", "too", "much", "exposure", ",", "Vivin", "rotates", "the", "wallet", "address", "used", "along", "with", "potentially", "updating", "their", "infrastructure", "used", "."], ["The", "actor", "also", "reuses", "the", "same", "or", "slight", "variations", "of", "the", "same", "username", "for", "a", "number", "of", "online", "accounts", ",", "including", "services", "used", "in", "the", "execution", "chains", "of", "the", "cryptomining", "malware", "."], ["We", "located", "the", "first", "username", "Talos", "linked", "to", "the", "actor", "through", "a", "Reddit", "post", "claiming", "the", "same", "Monero", "wallet", "address", "found", "hardcoded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "as", "their", "own", "."], ["The", "same", "user", "also", "posted", "about", "having", "issues", "with", "their", "account", "for", "the", "``", "minexmr.com", "''", "mining", "pool", ",", "the", "same", "pooling", "address", "used", "in", "the", "configurations", "of", "the", "XMRig", "payloads", "."], ["A", "GitHub", "account", "also", "uses", "the", "same", "username", "as", "the", "Reddit", "account", "linked", "to", "Vivin", "that", "contains", "a", "forked", "repository", "of", "the", "XMRig", "coinminer", "source", "."], ["Additionally", ",", "this", "user", "follows", "other", "accounts", "that", "house", "numerous", "repositories", "for", "file", "crypters", ",", "rootkits", ",", "process-hollowing", ",", "and", "other", "tools", "commonly", "used", "in", "malware", "packing", "and", "distribution", "."], ["After", "locating", "the", "initially", "executed", "file", "within", "this", "installation", ",", "dynamic", "and", "static", "analysis", "confirmed", "it", "as", "the", "infection", "source", "."], ["After", "tracing", "the", "file", "write", "operations", "for", "the", "software", "installation", ",", "we", "believe", "the", "dropper", "had", "been", "downloaded", "onto", "the", "victim", "host", "through", "BitTorrent", "."], ["The", "actor", "maintains", "multiple", "cryptocurrency", "wallet", "addresses", ",", "some", "of", "which", "have", "shown", "to", "go", "through", "cycles", "of", "dormancy", "and", "activity", "."], ["The", "first", ",", "``", "45VgqBWVhgu5LHSafj4q5sB3wuYXGvrSs5N9KLH5Tijze9NbsvUSaaSjVk1vuGBMwY2eXEHtQf95CULQHGQbghU21x4aWLY", ",", "''", "we", "found", "hard-coded", "in", "our", "original", "sample", "'s", "XMRig", "payload", "."], ["This", "time", ",", "the", "address", "is", "being", "observed", "on", "the", "``", "minexmr", "''", "mining", "pool", ",", "illustrated", "in", "the", "figure", "below", ",", "the", "same", "pool", "as", "our", "first", "active", "wallet", "address", "linked", "to", "Vivin", "."], ["At", "the", "time", "of", "writing", ",", "Talos", "has", "not", "yet", "observed", "any", "specific", "samples", "in", "our", "telemetry", "directly", "tied", "to", "the", "second", "wallet", "address", ";", "however", ",", "data", "from", "VirusTotal", "does", "link", "it", "to", "a", "cryptominer", "submitted", "back", "in", "December", "2017", "."], ["URIs", "used", "by", "Vivin", "'s", "malware", "can", "be", "blocklisted", "and", "blocked", "at", "the", "network", "level", ",", "such", "as", "the", "image", "host", "links", "used", "to", "download", "and", "deploy", "the", "malware", "'s", "intermediate", "stages", ",", "IP", "addresses", "associated", "with", "command", "and", "control", "infrastructure", ",", "and", "the", "domains", "used", "to", "connect", "to", "the", "mining", "pools", "themselves", "."], ["Aside", "from", "siphoning", "resources", "from", "organizations", ",", "the", "malware", "used", "to", "drop", "XMRig", "could", "also", "be", "modified", "for", "data", "theft", ",", "credential", "harvesting", ",", "and", "other", "malicious", "activity", "."]], "ner": [[[5, 5, "SO"], [9, 9, "MF"], [13, 13, "MF"]], [[24, 25, "MF"]], [[42, 42, "MF"]], [[58, 58, "MF"], [65, 65, "MF"], [67, 67, "MF"]], [[74, 74, "MP"], [78, 78, "MP"], [84, 84, "MF"], [92, 92, "MF"]], [[100, 100, "MP"], [107, 107, "MF"], [114, 114, "MF"]], [[137, 137, "MP"], [143, 143, "SO"]], [[169, 169, "MP"], [173, 173, "MF"]], [[184, 184, "MP"], [198, 198, "MF"], [222, 223, "MP"], [227, 228, "MP"], [239, 239, "MF"]], [[251, 251, "MP"], [271, 271, "MF"]], [[274, 275, "MP"]], [[283, 283, "MP"], [294, 294, "MP"]], [[333, 333, "MP"], [336, 337, "MF"], [346, 346, "MF"], [350, 350, "TP"]], [[356, 357, "MF"]], [[369, 369, "MP"], [375, 375, "MF"]], [[392, 392, "MF"]], [[425, 425, "MF"]], [[451, 451, "MP"], [460, 460, "MF"]], [[483, 483, "MF"]], [[514, 514, "MF"], [516, 516, "MF"]], [[530, 531, "MF"], [535, 535, "MP"]], [[548, 549, "MF"]], [[556, 557, "MP"], [565, 565, "MP"], [569, 569, "MF"]], [[575, 575, "MP"], [582, 582, "MF"], [584, 584, "MF"], [587, 587, "MF"]], [[602, 603, "MP"], [605, 606, "MF"]], [[624, 625, "MF"], [630, 630, "MF"], [632, 632, "MF"]], [[643, 643, "MF"], [647, 649, "TF"]], [[656, 656, "MF"], [658, 659, "MF"], [667, 667, "MF"]], [[694, 694, "TP"], [699, 700, "MP"], [706, 707, "TP"]], [[730, 730, "TP"]], [[746, 746, "MF"], [750, 750, "TP"]], [[786, 787, "MP"], [791, 792, "MF"]], [[815, 815, "MF"], [818, 819, "SO"]], [[830, 830, "MP"], [859, 859, "MF"]], [[870, 870, "MP"], [888, 889, "MP"]], [[908, 908, "SO"], [923, 924, "MP"]], [[940, 940, "MF"]], [[964, 965, "TF"], [967, 967, "MF"], [969, 969, "MF"]], [], [[1017, 1017, "MF"], [1026, 1026, "TP"]], [[1029, 1029, "MP"], [1033, 1034, "SO"]], [[1065, 1066, "MP"]], [[1072, 1072, "SO"], [1097, 1098, "SO"], [1101, 1101, "MF"]], [], [[1145, 1145, "SO"], [1148, 1150, "MF"], [1164, 1164, "MF"], [1173, 1173, "MF"]], [[1207, 1207, "MF"], [1211, 1211, "MF"]]], "relations": [[[13, 13, 58, 58, "CO"]], [], [], [], [[78, 78, 74, 74, "FR"], [74, 74, 5, 5, "ST"], [74, 74, 5, 5, "RF"], [74, 74, 9, 9, "WR"], [74, 74, 24, 25, "WR"], [74, 74, 42, 42, "WR"], [74, 74, 58, 58, "WR"], [74, 74, 65, 65, "WR"], [74, 74, 67, 67, "WR"], [74, 74, 84, 84, "WR"], [74, 74, 84, 84, "EX"], [84, 84, 92, 92, "CO"], [78, 78, 100, 100, "CO"], [74, 74, 137, 137, "CO"]], [[100, 100, 107, 107, "WR"], [100, 100, 114, 114, "WR"]], [[137, 137, 143, 143, "ST"]], [[169, 169, 184, 184, "FR"]], [[184, 184, 173, 173, "EX"], [184, 184, 222, 223, "FR"], [222, 223, 198, 198, "EX"], [222, 223, 227, 228, "FR"], [227, 228, 239, 239, "WR"], [227, 228, 251, 251, "CO"]], [[251, 251, 271, 271, "WR"]], [[274, 275, 271, 271, "RD"], [274, 275, 356, 357, "WR"]], [[283, 283, 271, 271, "RD"], [283, 283, 356, 357, "WR"], [294, 294, 333, 333, "CO"]], [[333, 333, 350, 350, "FR"], [350, 350, 336, 337, "WR"], [350, 350, 346, 346, "EX"], [350, 350, 356, 357, "RD"], [350, 350, 356, 357, "WR"], [350, 350, 356, 357, "EX"], [336, 337, 375, 375, "CO"]], [], [[369, 369, 356, 357, "WR"], [369, 369, 375, 375, "RD"], [369, 369, 392, 392, "WR"], [369, 369, 425, 425, "WR"]], [], [], [[451, 451, 392, 392, "WR"], [451, 451, 425, 425, "WR"], [451, 451, 460, 460, "WR"], [451, 451, 514, 514, "WR"], [451, 451, 516, 516, "WR"], [460, 460, 483, 483, "CO"]], [], [], [[535, 535, 514, 514, "WR"], [535, 535, 516, 516, "WR"], [535, 535, 530, 531, "WR"], [535, 535, 548, 549, "WR"]], [], [[556, 557, 548, 549, "WR"], [556, 557, 565, 565, "FR"], [565, 565, 569, 569, "EX"]], [[575, 575, 582, 582, "WR"], [575, 575, 584, 584, "WR"], [575, 575, 587, 587, "WR"], [575, 575, 656, 656, "WR"], [575, 575, 658, 659, "WR"], [575, 575, 667, 667, "WR"], [575, 575, 602, 603, "CO"]], [[602, 603, 630, 630, "WR"], [602, 603, 632, 632, "WR"], [602, 603, 647, 649, "WR"], [605, 606, 624, 625, "CO"]], [[630, 630, 643, 643, "CO"]], [], [], [[694, 694, 656, 656, "WR"], [694, 694, 658, 659, "WR"], [694, 694, 667, 667, "WR"], [694, 694, 699, 700, "FR"], [699, 700, 706, 707, "IJ"], [699, 700, 730, 730, "FR"], [694, 694, 750, 750, "CO"]], [[730, 730, 746, 746, "WR"]], [[750, 750, 786, 787, "FR"]], [[786, 787, 746, 746, "EX"], [786, 787, 791, 792, "RD"], [786, 787, 815, 815, "WR"], [786, 787, 818, 819, "ST"], [786, 787, 818, 819, "RF"]], [], [[830, 830, 815, 815, "WR"], [830, 830, 818, 819, "ST"], [830, 830, 818, 819, "RF"], [830, 830, 818, 819, "ST"], [830, 830, 818, 819, "RF"], [830, 830, 859, 859, "WR"], [830, 830, 859, 859, "WR"], [830, 830, 870, 870, "CO"]], [[870, 870, 859, 859, "WR"], [870, 870, 859, 859, "WR"], [870, 870, 908, 908, "ST"], [870, 870, 908, 908, "RF"], [888, 889, 859, 859, "WR"], [888, 889, 908, 908, "ST"], [888, 889, 908, 908, "RF"], [888, 889, 908, 908, "ST"], [888, 889, 908, 908, "RF"]], [[923, 924, 908, 908, "ST"], [923, 924, 908, 908, "RF"], [923, 924, 940, 940, "WR"], [923, 924, 964, 965, "WR"], [923, 924, 967, 967, "WR"], [923, 924, 969, 969, "WR"]], [], [], [], [[1026, 1026, 940, 940, "WR"], [1026, 1026, 967, 967, "WR"], [1026, 1026, 969, 969, "WR"], [1026, 1026, 1017, 1017, "WR"]], [], [], [], [], [], []]}