{"doc_key": "052", "sentences": [["The", "implant", "DLLs", "in", "the", "ZetaNile", "malware", "family", "are", "either", "packed", "with", "commercial", "software", "protectors", "such", "as", "Themida", "and", "VMProtect", "or", "are", "encrypted", "using", "custom", "algorithms", "."], ["The", "payload", "in", "the", "malicious", "DLL", "is", "decrypted", "using", "a", "custom", "key", ",", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "the", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", "."], ["The", "ZetaNile", "implants", "use", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["By", "encoding", "the", "victim", "information", "in", "the", "parameters", "for", "common", "keywords", "like", "gametype", "or", "bbs", "in", "the", "HTTP", "POSTs", ",", "these", "C2", "communications", "can", "blend", "in", "with", "legitimate", "traffic", "."], ["Once", "they", "have", "established", "a", "connection", "with", "their", "target", ",", "ZINC", "operationalized", "malicious", "versions", "of", "two", "SSH", "clients", ",", "PuTTY", "and", "KiTTY", ",", "that", "acted", "as", "the", "entry", "vector", "for", "the", "ZetaNile", "implant", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["As", "part", "of", "the", "evolution", "of", "ZINC", "'", "s", "malware", "development", ",", "and", "in", "an", "effort", "to", "evade", "traditional", "defenses", ",", "running", "the", "included", "executable", "does", "not", "drop", "the", "ZetaNile", "implant", "."], ["For", "ZetaNile", "to", "be", "deployed", ",", "the", "SSH", "utility", "requires", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "."], ["Server", ":", "137.184.15.189"], ["The", "malicious", "PUTTY.exe", "is", "configured", "to", "install", "the", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", "and", "subsequently", "copy", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["By", "using", "DLL", "search", "order", "hijacking", ",", "ZINC", "can", "load", "the", "second", "stage", "malware", ",", "colurui.dll", ",", "and", "decode", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "to", "be", "used", "for", "command", "and", "control", "."], ["Upon", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", "."], ["Lastly", ",", "persistence", "is", "established", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "configuration", "for", "the", "weaponized", "PuTTY", "."], ["ZINC", "accomplishes", "this", "with", "the", "following", "command", ":"], ["PuTTY", "scheduled", "task", "as", "part", "of", "persistence"], ["The", "executable", "first", "collects", "the", "username", "and", "hostname", "of", "the", "victim", "system", "."], ["It", "then", "sends", "that", "information", "to", "a", "hardcoded", "IP", "172.93.201.253", "over", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "then", "deploys", "the", "malware", "as", "%", "AppData", "%", "\\mscoree.dll", "following", "multiple", "rounds", "of", "decoding", "."], ["The", "mscoree.dll", "file", "is", "the", "embedded", "payload", ",", "detected", "as", "EventHorizon", ",", "in", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'", "s", "version", "of", "PuTTY", ",", "the", "actor", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "that", "perform", "tasks", "within", "the", "context", "of", "these", "legitimate", "Windows", "processes", ",", "specifically", "through", "%", "AppData", "%", "KiTTY", "%", "PresentationHost.exe", "-EmbeddingObject", "."], ["Screenshot", "of", "Windows", "process", "that", "ZINC", "hijacks", "through", "DLL", "search", "order", "hijacking"], ["The", "mscoree.dll", "malware", "is", "modularized", "in", "such", "a", "way", "that", ",", "upon", "successful", "connection", "to", "the", "compromised", "C2", "domain", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "target", "system", "as", "needed", "using", "the", "existing", "C2", "communication", ",", "such", "as", "executing", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["The", "HTTP", "POST", "requests", "contain", "the", "hardcoded", "user", "agent", "string", "with", "misspelled", "``", "Edge", "''", ",", "as", "detailed", "below", ",", "and", "contain", "a", "unique", "ID", "for", "the", "field", "gametype", "and", "the", "hardcoded", "value", "for", "the", "field", "type", "for", "malware", "campaign", "tracking", "purposes", ":"], ["This", "malware", "has", "a", "unique", "PDBPath", ":"], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "a", "ReadMe.txt", "and", "an", "executable", "file", "to", "run", "."], ["The", ".txt", "file", "has", "the", "following", "content", ":"], ["As", "part", "of", "the", "threat", "actor", "'", "s", "latest", "malware", "technique", "to", "evade", "traditional", "defenses", ",", "the", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", ",", "and", "it", "'", "s", "configured", "to", "install", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "in", "the", "TightVNC", "Viewer", ",", "as", "shown", "in", "Figure", "5", ":"], ["The", "malware", "was", "configured", "to", "send", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establish", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", "."], ["Once", "a", "successful", "connection", "is", "established", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "a", "known", "compromised", "domain", "."], ["Within", "that", "archive", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "to", "run", "."], ["While", "the", "malicious", "Sumatra", "PDF", "reader", "is", "a", "fully", "functional", "PDF", "reader", "that", "can", "load", "the", "malicious", "implant", "from", "a", "fake", "PDF", ",", "the", "muPDF/Subliminal", "Recording", "installer", "can", "set", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", "."], ["SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "contains", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Once", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "is", "configured", "to", "send", "the", "victim", "'", "s", "system", "hostname", "and", "device", "information", "using", "custom", "encoding", "algorithms", "to", "a", "C2", "communication", "server", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "can", "install", "additional", "malware", "onto", "the", "compromised", "devices", "using", "the", "C2", "communication", "as", "needed", "."], ["Within", "the", "trojanized", "version", "of", "muPDF/Subliminal", "Recording", "installer", ",", "setup.exe", "is", "configured", "to", "check", "if", "the", "file", "path", "ISSetupPrerequisites\\Setup64.exe", "exists", "and", "write", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", "after", "extracting", "the", "embedded", "executable", "inside", "setup.exe", "."], ["It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["For", "the", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "C", ":", "\\colorctrl\\colorcpl.exe", "C3A9B30B6A313F289297C9A36730DB6D", ",", "and", "the", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "gets", "passed", "on", "to", "colorui.dll", "as", "a", "decryption", "key", "."], ["The", "DLL", "colorui.dll", ",", "which", "Microsoft", "is", "tracking", "as", "the", "EventHorizon", "malware", "family", ",", "is", "injected", "into", "C", ":", "\\Windows\\System\\credwiz.exe", "or", "iexpress.exe", "to", "send", "C2", "HTTP", "requests", "as", "part", "of", "the", "victim", "check-in", "process", "and", "to", "get", "an", "additional", "payload", "."]], "ner": [[[1, 2, "MF"], [17, 17, "MP"], [19, 19, "MP"], [24, 25, "MP"]], [[28, 28, "MF"], [32, 32, "MF"], [37, 38, "MP"], [45, 45, "MF"], [52, 53, "TP"]], [[62, 63, "MP"], [66, 67, "MP"], [70, 71, "MP"], [85, 86, "SO"]], [[91, 92, "MF"]], [[119, 119, "MP"], [126, 126, "SO"], [128, 128, "MP"], [134, 135, "MP"], [137, 137, "MP"], [139, 139, "MP"], [149, 150, "MP"]], [[157, 157, "TP"], [161, 161, "TF"], [164, 165, "MF"]], [[175, 175, "MP"], [193, 193, "MF"], [198, 199, "MF"]], [[202, 202, "MP"], [208, 209, "MP"], [216, 217, "TF"]], [[219, 221, "SO"]], [[224, 224, "MP"], [230, 232, "MP"], [234, 236, "SF"], [240, 242, "SF"], [244, 246, "SF"]], [[255, 255, "MP"], [263, 263, "MF"], [268, 268, "TF"], [273, 273, "TF"]], [[288, 289, "SO"], [292, 292, "MP"], [296, 296, "MP"]], [[319, 319, "TP"], [328, 329, "MP"]], [[331, 331, "MP"]], [[339, 339, "MP"]], [[347, 347, "MP"], [351, 351, "TF"], [353, 353, "TF"]], [[359, 359, "MP"], [368, 368, "SO"]], [[396, 396, "SO"], [400, 401, "MP"], [407, 410, "MF"]], [[418, 418, "MF"], [427, 427, "MP"]], [[437, 437, "MP"], [442, 442, "MP"], [447, 450, "MP"], [454, 455, "MF"], [465, 466, "TP"], [470, 475, "MF"]], [[480, 481, "MP"], [483, 483, "MP"]], [[491, 492, "MP"], [507, 508, "SO"], [511, 511, "MP"], [515, 515, "MP"], [531, 533, "MF"], [539, 539, "MF"], [543, 544, "SO"]], [[547, 549, "MF"], [573, 574, "TF"], [577, 578, "TF"]], [[594, 594, "TF"]], [[605, 605, "TF"], [608, 609, "MF"]], [[614, 615, "TF"]], [[639, 640, "MP"], [646, 647, "SO"], [657, 657, "MP"], [663, 663, "MF"], [670, 671, "MP"]], [[680, 680, "MP"], [691, 691, "SO"], [710, 710, "SO"]], [[723, 724, "SO"], [730, 731, "MF"], [733, 733, "MP"]], [[753, 753, "MP"], [758, 759, "MF"]], [[766, 768, "MP"], [780, 780, "MF"], [787, 789, "MP"], [794, 794, "MP"], [799, 800, "MF"]], [[802, 802, "MP"], [811, 812, "MP"], [819, 820, "MF"]], [[828, 828, "MF"], [837, 838, "TF"], [844, 844, "MF"], [847, 849, "MF"], [856, 858, "MP"]], [[873, 873, "MP"], [883, 883, "TF"], [885, 886, "TF"], [893, 895, "SO"], [900, 902, "MP"]], [[905, 905, "MP"], [908, 909, "MP"], [916, 917, "MP"]], [[926, 928, "MP"], [930, 930, "MP"], [939, 939, "MF"], [943, 945, "MF"]], [[956, 956, "MP"], [959, 961, "MF"], [963, 965, "MF"]], [[974, 975, "MP"], [980, 982, "MP"], [993, 993, "MF"]], [[1001, 1001, "MF"], [1004, 1004, "MP"], [1016, 1018, "MP"], [1020, 1020, "MP"], [1038, 1038, "MF"]]], "relations": [[[17, 17, 1, 2, "WR"], [19, 19, 1, 2, "WR"], [24, 25, 1, 2, "WR"]], [[37, 38, 28, 28, "WR"], [52, 53, 45, 45, "RD"], [32, 32, 45, 45, "CO"]], [[66, 67, 62, 63, "IJ"], [70, 71, 62, 63, "IJ"], [62, 63, 85, 86, "ST"], [62, 63, 85, 86, "RF"], [70, 71, 91, 92, "WR"], [62, 63, 149, 150, "CO"], [62, 63, 202, 202, "CO"]], [], [[119, 119, 91, 92, "WR"], [119, 119, 126, 126, "ST"], [119, 119, 126, 126, "RF"], [134, 135, 91, 92, "WR"], [134, 135, 157, 157, "FR"], [137, 137, 91, 92, "WR"], [139, 139, 91, 92, "WR"], [119, 119, 128, 128, "CO"]], [[157, 157, 164, 165, "EX"], [161, 161, 216, 217, "CO"]], [[175, 175, 164, 165, "RD"], [175, 175, 193, 193, "WR"], [175, 175, 193, 193, "WR"], [175, 175, 198, 199, "WR"]], [[208, 209, 193, 193, "WR"], [208, 209, 198, 199, "WR"], [208, 209, 216, 217, "RD"], [208, 209, 219, 221, "ST"], [208, 209, 219, 221, "RF"]], [], [[224, 224, 219, 221, "ST"], [224, 224, 219, 221, "RF"], [224, 224, 234, 236, "RD"], [224, 224, 230, 232, "FR"], [224, 224, 234, 236, "WR"], [224, 224, 244, 246, "RD"], [224, 224, 240, 242, "RD"], [224, 224, 244, 246, "WR"]], [[255, 255, 263, 263, "WR"], [255, 255, 268, 268, "RD"], [255, 255, 273, 273, "RD"]], [[292, 292, 288, 289, "ST"], [292, 292, 288, 289, "RF"], [292, 292, 296, 296, "FR"], [292, 292, 511, 511, "CO"], [292, 292, 905, 905, "CO"]], [[328, 329, 319, 319, "FR"], [319, 319, 331, 331, "FR"]], [[331, 331, 368, 368, "ST"], [331, 331, 368, 368, "RF"]], [[339, 339, 368, 368, "ST"], [339, 339, 368, 368, "RF"], [339, 339, 328, 329, "CO"]], [[347, 347, 351, 351, "RD"], [347, 347, 353, 353, "RD"], [347, 347, 359, 359, "CO"]], [[359, 359, 368, 368, "ST"]], [[400, 401, 396, 396, "ST"], [400, 401, 396, 396, "RF"], [400, 401, 407, 410, "WR"]], [[427, 427, 418, 418, "WR"], [427, 427, 418, 418, "WR"], [427, 427, 465, 466, "FR"], [418, 418, 407, 410, "CO"]], [[447, 450, 454, 455, "WR"], [437, 437, 418, 418, "WR"], [442, 442, 418, 418, "WR"], [465, 466, 454, 455, "EX"], [465, 466, 470, 475, "EX"]], [[480, 481, 470, 475, "RD"], [480, 481, 507, 508, "ST"], [480, 481, 507, 508, "RF"], [483, 483, 470, 475, "RD"], [483, 483, 507, 508, "ST"], [483, 483, 507, 508, "RF"]], [[491, 492, 507, 508, "ST"], [491, 492, 507, 508, "RF"], [511, 511, 515, 515, "FR"], [515, 515, 531, 533, "EX"], [515, 515, 539, 539, "RD"], [515, 515, 543, 544, "RF"], [515, 515, 547, 549, "WR"], [515, 515, 608, 609, "WR"]], [], [], [], [], [[639, 640, 547, 549, "WR"], [639, 640, 608, 609, "WR"], [639, 640, 646, 647, "ST"], [639, 640, 646, 647, "RF"], [639, 640, 657, 657, "FR"], [657, 657, 646, 647, "ST"], [657, 657, 646, 647, "RF"], [657, 657, 663, 663, "WR"], [670, 671, 663, 663, "WR"], [670, 671, 663, 663, "WR"], [670, 671, 691, 691, "ST"], [670, 671, 691, 691, "RF"]], [[680, 680, 691, 691, "ST"], [680, 680, 691, 691, "RF"], [680, 680, 710, 710, "ST"], [680, 680, 710, 710, "RF"], [680, 680, 723, 724, "ST"], [680, 680, 723, 724, "RF"], [680, 680, 730, 731, "RD"], [691, 691, 710, 710, "CO"], [680, 680, 873, 873, "CO"]], [[733, 733, 730, 731, "WR"]], [[753, 753, 758, 759, "EX"]], [[766, 768, 780, 780, "RD"], [787, 789, 794, 794, "FR"], [794, 794, 799, 800, "WR"]], [[802, 802, 799, 800, "WR"], [802, 802, 811, 812, "FR"], [802, 802, 819, 820, "RD"], [811, 812, 828, 828, "WR"], [811, 812, 844, 844, "WR"]], [[856, 858, 844, 844, "WR"], [856, 858, 847, 849, "RD"], [828, 828, 847, 849, "CO"]], [[873, 873, 883, 883, "RD"], [873, 873, 885, 886, "RD"], [873, 873, 893, 895, "ST"], [900, 902, 885, 886, "RD"]], [[905, 905, 908, 909, "FR"], [905, 905, 916, 917, "FR"]], [[926, 928, 930, 930, "FR"], [930, 930, 939, 939, "RD"], [930, 930, 943, 945, "WR"], [930, 930, 956, 956, "CO"]], [[956, 956, 959, 961, "RD"], [956, 956, 963, 965, "WR"]], [[974, 975, 980, 982, "FR"], [974, 975, 993, 993, "WR"], [974, 975, 1001, 1001, "RD"], [974, 975, 1016, 1018, "IJ"], [974, 975, 1020, 1020, "IJ"], [974, 975, 1038, 1038, "RD"]], [[1004, 1004, 1001, 1001, "RD"], [1004, 1004, 1038, 1038, "WR"]]]}