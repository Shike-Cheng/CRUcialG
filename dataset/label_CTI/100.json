{"doc_key": "100", "sentences": [["The", "attacker", "deployed", "an", "open-source", "mobile", "device", "management", "(", "MDM", ")", "system", "to", "control", "enrolled", "devices", "."], ["In", "social", "engineering", "attacks", "the", "victim", "is", "tricked", "into", "clicking", "accept", "or", "giving", "the", "attacker", "physical", "access", "to", "a", "device", "."], ["An", "MDM", "is", "designed", "to", "deploy", "applications", "on", "enrolled", "devices", "."], ["The", "attacker", "used", "the", "BOptions", "sideloading", "technique", "to", "add", "features", "to", "legitimate", "apps", ",", "including", "the", "messaging", "apps", "WhatsApp", "and", "Telegram", ",", "that", "were", "then", "deployed", "by", "the", "MDM", "onto", "the", "13", "targeted", "devices", "in", "India", "."], ["The", "purpose", "of", "the", "BOptions", "sideloading", "technique", "is", "to", "inject", "a", "dynamic", "library", "in", "the", "application", "."], ["The", "malicious", "code", "inserted", "into", "these", "apps", "is", "capable", "of", "collecting", "and", "exfiltrating", "information", "from", "the", "device", ",", "such", "as", "the", "phone", "number", ",", "serial", "number", ",", "location", ",", "contacts", ",", "user", "'s", "photos", ",", "SMS", "and", "Telegram", "and", "WhatsApp", "chat", "messages", "."], ["The", "attacker", "left", "essential", "data", "on", "the", "servers", ",", "such", "as", "emails", "and", "usernames", "."], ["As", "part", "of", "the", "attacker", "'s", "development", "and", "testing", "it", "appears", "that", "they", "compromised", "their", "device", "we", "observed", "a", "device", "named", "``", "test", "''", "or", "``", "mdmdev.", "``"], ["The", "overall", "workflow", "of", "the", "deployment", "method", "and", "capabilities", "is", "pictured", "below.iOS", "MDM", "infrastructureMy", "tiny", "MDM", "Talos", "identified", "two", "different", "MDM", "servers", ":", "hxxp", ":", "//ios-certificate-update.comhxxp", ":", "//www.wpitcher.com", "Both", "servers", "above", "are", "based", "on", "the", "open-source", "projectmdm-server", "a", "small", "iOS", "MDM", "server", "."], ["A", "remote", "administrator", "can", "install", "or", "remove", "apps", ",", "install", "or", "revoke", "certificates", ",", "lock", "the", "device", ",", "or", "change", "password", "requirements", ",", "among", "other", "things", "."], ["The", "operator", "is", "able", "to", "uninstall", "legitimate", "applications", "such", "as", "Telegram", "and", "WhatsApp", "to", "install", "the", "malicious", "versions", "described", "in", "the", "next", "section", "."], ["Device", "enrollment", "Each", "step", "of", "the", "enrollment", "process", "needs", "some", "type", "of", "user", "interaction", "."], ["The", "first", "step", "for", "enrolling", "a", "device", "is", "to", "install", "the", "certificate", "authority", ":", "If", "the", "user", "clicks", "on", "``", "Allow", ",", "''", "the", "following", "message", "is", "displayed", ":", "By", "clicking", "on", "``", "Install", ",", "''", "the", "signature", "will", "switch", "to", "``", "Verified", ":", "''", "The", "device", "is", "ready", "to", "be", "enrolled", ":", "We", "can", "control", "the", "installed", "profile", ":", "The", "attacker", "is", "now", "able", "to", "control", "the", "device", "."], ["A", "pop-up", "appears", "when", "the", "attacker", "pushes", "a", "new", "app", "to", "the", "user", "device", "."], ["The", "attacker", "used", "a", "domain", "which", "allowed", "them", "to", "try", "and", "fool", "the", "user", "."], ["First", ",", "the", "certificate", "used", "by", "the", "MDM", ":", "CA.crt", ":", "Serial", "Number", ":", "13905745817900070731", "(", "0xc0fb222544ceb74b", ")", "Issuer", ":", "C=CR", ",", "ST=Split", ",", "L=Split", ",", "O=NA", ",", "OU=IT", ",", "CN=ios-certificate-update.com/emailAddress=nicholas.vukoja", "@", "mail.ruValidityNot", "Before", ":", "Sep", "6", "11:33:09", "2017", "GMTNot", "After", ":", "Sep", "6", "11:33:09", "2018", "GMTSubject", ":", "C=CR", ",", "ST=Split", ",", "L=Split", ",", "O=NA", ",", "OU=IT", ",", "CN=ios-certificate-update.com/emailAddress=nicholas.vukoja", "@", "mail.ruThe", "certificate", "was", "issued", "in", "September", "2017", "and", "contains", "an", "email", "address", "located", "in", "Russia", "."], ["Dushku", "@", "mail.ruThis", "is", "another", "certificate", ",", "which", "points", "to", "an", "apparent", "reference", "to", "Russia", "by", "using", "another", "mail.ru", "address", "."], ["Log", "analysisOne", "of", "the", "most", "interesting", "pieces", "of", "information", "about", "the", "MDM", "is", "found", "in", "the", "log", "file", "."], ["When", "the", "device", "was", "registered", "on", "the", "MDM", "server", ",", "roaming", "was", "disabled", "."], ["The", "purpose", "is", "to", "inject", "a", "dynamic", "library", "into", "the", "legitimate", "app", "."], ["The", "GitHub", "project", "was", "used", "by", "the", "attacker", "to", "create", "the", "malicious", "BOptionspro.dylib", "library", "held", "in", "the", "iOS", "package", "(", ".ipa", "file", ")", "."], ["The", "injection", "library", "can", "ask", "for", "additional", "permissions", ",", "execute", "code", "and", "steal", "information", "from", "the", "original", "application", ",", "among", "other", "things", "."], ["It", "simply", "opens", "a", "pop-up", "to", "the", "user", "confirming", "the", "execution", "of", "the", "dynamic", "library", "."], ["They", "first", "contain", "the", "same", "malicious", "code", "."], ["The", "purpose", "is", "to", "send", "collected", "data", "to", "a", "C2", "server", "located", "at", "hxxp", ":", "//techwach.com", "."], ["Here", "is", "the", "global", "workflow", "of", "it", ":", "For", "Telegram", ":", "Opens", "'tgdata.db", "'", ",", "an", "SQLite3", "database", "used", "by", "TelegramChecks", "for", "the", "key", "'UPLOADED_CHAT", "'", "in", "the", "key", "storeQueries", "``", "select", "users_v29.phone_number", ",", "users_v29.uid", "from", "users_v29", ";", "''", "Queries", "for", "``", "select", "messages_v29.from_id", "AS", "oid", ",", "users_v29.first_name", ",", "users_v29.last_name", ",", "users_v29.phone_number", ",", "messages_v29.message", ",", "messages_v29.mid", ",", "messages_v29.to_id", "from", "messages_v29", "join", "users_v29", "ON", "(", "messages_v29.from_id", "=", "users_v29.uid", ")", ";", "''", "Parses", "results", ",", "storing", "off", "counts", ",", "timesta"], ["Sends", "by", "posting", "to", "hxxp", ":", "//techwach.com", "Query", "screenshot", ":", "For", "WhatsApp", ":", "Opens", "'ChatStorage.sqlite", "'", ",", "the", "database", "used", "for", "WhatsApp", "messagesQueries", "'SELECT", "Z_PK", ",", "ZFROMJID", ",", "ZTOJID", ",", "ZPUSHNAME", ",", "ZTEXT", ",", "ZMESSAGEDATE", "FROM", "ZWAMESSAGE", "WHERE", "Z_PK", ">", "'", "%", "d", "''", "Parses", "results", ",", "storing", "off", "counts", ",", "timestamps", ",", "and", "other", "metadata", "."], ["Sends", "by", "posting", "to", "hxxp", ":", "//techwach.com", "Additionally", ",", "the", "malware", "is", "designed", "to", "be", "able", "to", "send", "the", "contacts", ",", "location", ",", "and", "images", "from", "the", "compromised", "device", "."], ["Here", "is", "the", "list", "of", "the", "PHP", "pages", "available", "on", "the", "techwach", "C2", "server", ":", "all.phpdyrKztORKwVWOGo.phpget.phphh.phpinfo.phpjDRucchWSoWQGpU.phpUfmcRxYDaVVbrBl.php", "Another", "intriguing", "aspect", "of", "this", "malware", "is", "the", "way", "in", "which", "the", "malicious", "code", "achieves", "periodic", "code", "execution", "when", "the", "legitimate", "app", "bundled", "with", "it", "is", "running", "."], ["One", "technique", "is", "to", "modify", "the", "app", "'s", "code", "at", "runtime", "to", "execute", "the", "malicious", "code", "this", "has", "been", "observed", "in", "previously", "analyzed", "iOS", "malware", "."], ["Instead", ",", "this", "malware", "remains", "almost", "entirely", "independent", "of", "the", "app", "and", "gains", "execution", "by", "creating", "a", "timer", "that", "eventually", "executes", "the", "malicious", "code", "in", "a", "background", "thread", "."], ["From", "there", ",", "it", "schedules", "tasks", "to", "be", "executed", "asynchronously", "in", "the", "background", "by", "leveraging", "the", "apps", "'", "background", "task", "queue", "."], ["The", "malicious", "code", "connects", "to", "the", "domain", "voguextra.com", "."], ["The", "purpose", "is", "to", "download", "and", "display", "specific", "ads", "to", "the", "user", "."], ["This", "app", "also", "leverages", "private", "frameworks", "to", "read", "the", "SMS", "messages", "on", "the", "device", "it", "is", "installed", "on", "and", "uploads", "these", "to", "the", "C2", "server", "."], ["However", ",", "the", "application", "does", "not", "do", "anything", "."], ["Techwach", "C2", "server", "The", "malicious", "code", "within", "Telegram", "and", "WhatsApp", "sent", "collected", "data", "to", "the", "server", "techwach.com", "."], ["Initially", ",", "the", "username", "used", "on", "the", "server", "was", "arnoldrex", "."], ["The", "attackers", "installed", "an", "open-source", "MDM", "and", "used", "this", "to", "deploy", "malicious", "code", "into", "secure", "chat", "applications", "such", "as", "Telegram", "and", "WhatsApp", "to", "surreptitiously", "retrieve", "the", "messages/chats", ",", "photos", "and", "user", "'s", "location", "from", "the", "victim", "'s", "phone", "."], ["The", "attacker", "tried", "to", "mimic", "Russian", "hackers", "by", "using", "mail.ru", "email", "."], ["However", ",", "we", "found", "testing", "devices", "enrolled", "on", "the", "MDM", "with", "an", "Indian", "phone", "number", "and", "registered", "on", "an", "Indian", "provider", "."], ["The", "fact", "that", "the", "attacker", "was", "also", "able", "to", "get", "devices", "onto", "his", "own", "malicious", "MDM", "shows", "that", "the", "attacker", "was", "indeed", "motivated", "to", "obtain", "initial", "access", "but", "also", "to", "maintain", "persistence", "across", "the", "devices", "."]], "ner": [[[1, 1, "MP"], [9, 9, "MF"]], [[22, 22, "TP"], [31, 31, "MP"], [32, 33, "TF"]], [[44, 44, "TF"]], [[50, 50, "MP"], [53, 53, "TP"], [60, 61, "SF"], [67, 67, "TF"], [69, 69, "TF"], [77, 77, "MP"]], [[90, 90, "TP"], [97, 98, "MF"], [101, 101, "TP"]], [[104, 105, "MF"], [116, 116, "TF"], [124, 125, "TF"], [127, 128, "TF"], [130, 132, "TF"], [134, 136, "TF"], [143, 144, "TF"]], [[147, 147, "MP"], [157, 157, "MF"]], [[165, 165, "MP"], [183, 183, "MF"], [187, 187, "MF"]], [], [[233, 234, "MP"], [252, 252, "SF"]], [[260, 260, "MP"], [265, 266, "TP"], [269, 269, "TP"], [271, 271, "TP"]], [], [[309, 310, "SF"], [314, 314, "TP"], [355, 356, "SF"], [359, 359, "MP"]], [[373, 373, "MP"], [377, 377, "SF"]], [[384, 384, "MP"], [387, 387, "MF"], [396, 396, "TP"]], [[405, 405, "MF"]], [], [[506, 506, "MF"]], [[521, 521, "SF"]], [[534, 535, "MF"], [538, 539, "TP"]], [[548, 548, "MP"], [553, 553, "MF"]], [[566, 567, "MP"], [571, 572, "TF"], [575, 575, "MF"]], [[601, 602, "MF"]], [[609, 610, "MF"]], [[621, 622, "SO"], [625, 627, "SO"]], [[638, 638, "TP"], [641, 641, "SF"], [645, 646, "SF"], [657, 658, "SF"], [700, 700, "TF"], [704, 704, "TF"], [706, 706, "TF"]], [[711, 713, "SO"], [718, 718, "TP"], [721, 721, "SF"], [752, 752, "TF"], [756, 756, "TF"], [758, 758, "TF"], [762, 762, "TF"]], [[768, 770, "SO"], [774, 774, "MP"], [783, 783, "TF"], [785, 785, "TF"], [788, 788, "TF"]], [[822, 823, "MF"], [830, 831, "TP"]], [[844, 846, "SF"], [852, 853, "MF"], [861, 862, "MP"]], [[867, 867, "MP"], [881, 881, "MP"], [886, 887, "MF"]], [[896, 896, "MP"], [898, 898, "MF"], [909, 911, "SF"]], [[922, 922, "SO"]], [[932, 932, "MF"]], [[938, 938, "TP"], [946, 947, "MF"], [960, 961, "SO"]], [], [[979, 979, "TP"], [981, 981, "TP"], [988, 988, "SO"]], [], [[1002, 1002, "MP"], [1006, 1006, "MF"], [1012, 1013, "MF"], [1020, 1020, "TP"], [1022, 1022, "TP"], [1027, 1027, "TF"], [1031, 1033, "TF"], [1036, 1038, "TF"]], [[1041, 1041, "MP"]], [[1061, 1061, "MF"]], [[1078, 1078, "MP"], [1089, 1089, "MF"], [1093, 1093, "MP"]]], "relations": [[[1, 1, 9, 9, "EX"], [1, 1, 31, 31, "CO"], [1, 1, 50, 50, "CO"], [1, 1, 147, 147, "CO"], [1, 1, 165, 165, "CO"], [1, 1, 359, 359, "CO"], [1, 1, 548, 548, "CO"]], [[31, 31, 22, 22, "FR"], [22, 22, 32, 33, "RD"], [31, 31, 32, 33, "CD"]], [], [[50, 50, 53, 53, "FR"], [53, 53, 60, 61, "RD"], [53, 53, 60, 61, "WR"], [77, 77, 67, 67, "WR"], [77, 77, 69, 69, "WR"], [77, 77, 101, 101, "FR"], [53, 53, 90, 90, "CO"]], [[90, 90, 97, 98, "RD"], [90, 90, 101, 101, "IJ"], [101, 101, 116, 116, "WR"], [101, 101, 124, 125, "WR"], [101, 101, 127, 128, "WR"], [101, 101, 130, 132, "WR"], [101, 101, 134, 136, "WR"], [101, 101, 143, 144, "WR"], [97, 98, 104, 105, "CO"]], [], [[147, 147, 143, 144, "RD"], [147, 147, 157, 157, "WR"], [147, 147, 157, 157, "WR"]], [[165, 165, 157, 157, "WR"], [165, 165, 183, 183, "UK"], [165, 165, 187, 187, "UK"]], [], [[233, 234, 157, 157, "WR"], [233, 234, 252, 252, "RD"], [233, 234, 252, 252, "RD"], [233, 234, 252, 252, "WR"], [233, 234, 252, 252, "RD"], [233, 234, 252, 252, "RD"], [233, 234, 252, 252, "WR"]], [[260, 260, 252, 252, "RD"], [260, 260, 252, 252, "RD"], [260, 260, 252, 252, "WR"], [260, 260, 252, 252, "RD"], [260, 260, 252, 252, "RD"], [260, 260, 252, 252, "WR"], [260, 260, 309, 310, "RD"], [260, 260, 309, 310, "RD"], [260, 260, 309, 310, "WR"], [265, 266, 271, 271, "CO"], [265, 266, 269, 269, "CO"]], [], [[314, 314, 309, 310, "RD"], [314, 314, 309, 310, "WR"], [314, 314, 309, 310, "EX"], [359, 359, 377, 377, "RD"], [359, 359, 355, 356, "CD"], [309, 310, 355, 356, "CO"], [359, 359, 373, 373, "CO"], [359, 359, 384, 384, "CO"], [314, 314, 396, 396, "CO"]], [[373, 373, 377, 377, "WR"]], [[384, 384, 387, 387, "WR"], [396, 396, 387, 387, "RD"], [396, 396, 387, 387, "EX"], [396, 396, 405, 405, "WR"], [396, 396, 405, 405, "WR"], [396, 396, 521, 521, "RD"], [396, 396, 521, 521, "RD"], [396, 396, 521, 521, "WR"]], [[405, 405, 506, 506, "CO"]], [], [], [], [[534, 535, 521, 521, "RD"], [534, 535, 521, 521, "WR"], [538, 539, 506, 506, "WR"], [534, 535, 553, 553, "CO"]], [[548, 548, 538, 539, "IJ"], [548, 548, 553, 553, "WR"], [548, 548, 566, 567, "FR"]], [[566, 567, 553, 553, "EX"], [566, 567, 571, 572, "WR"], [566, 567, 575, 575, "EX"], [566, 567, 601, 602, "WR"], [566, 567, 621, 622, "ST"], [566, 567, 621, 622, "RF"], [575, 575, 609, 610, "CO"]], [], [], [[621, 622, 625, 627, "CO"]], [[638, 638, 601, 602, "WR"], [638, 638, 641, 641, "RD"], [638, 638, 645, 646, "RD"], [638, 638, 657, 658, "RD"], [638, 638, 700, 700, "WR"], [638, 638, 704, 704, "WR"], [638, 638, 706, 706, "WR"], [638, 638, 711, 713, "ST"]], [[718, 718, 721, 721, "RD"], [718, 718, 752, 752, "WR"], [718, 718, 756, 756, "WR"], [718, 718, 758, 758, "WR"], [718, 718, 762, 762, "WR"], [718, 718, 768, 770, "ST"]], [[774, 774, 768, 770, "ST"], [774, 774, 783, 783, "WR"], [774, 774, 785, 785, "WR"], [774, 774, 788, 788, "WR"], [774, 774, 822, 823, "WR"]], [[830, 831, 822, 823, "WR"], [830, 831, 822, 823, "WR"], [830, 831, 844, 846, "RD"], [830, 831, 844, 846, "RD"], [830, 831, 844, 846, "WR"]], [[861, 862, 844, 846, "RD"], [861, 862, 844, 846, "WR"], [861, 862, 867, 867, "FR"], [852, 853, 886, 887, "CO"]], [[867, 867, 881, 881, "FR"], [881, 881, 886, 887, "EX"], [867, 867, 896, 896, "CO"]], [[896, 896, 898, 898, "WR"], [896, 896, 909, 911, "RD"], [896, 896, 922, 922, "ST"], [896, 896, 922, 922, "RF"], [896, 896, 932, 932, "WR"]], [], [], [[938, 938, 946, 947, "RD"], [938, 938, 960, 961, "ST"], [938, 938, 979, 979, "CO"], [938, 938, 981, 981, "CO"]], [], [[979, 979, 988, 988, "ST"], [981, 981, 988, 988, "ST"]], [], [], [], [], []]}