{"doc_key": "068", "sentences": [["The", "infections", "leverage", "process", "injection", "to", "evade", "detection", "by", "endpoint", "security", "software", "."], ["The", "threat", "actor", "(", "s", ")", "behind", "these", "campaigns", "have", "been", "using", "3LOSH", "to", "generate", "the", "obfuscated", "code", "responsible", "for", "the", "initial", "infection", "process", "."], ["Infection", "processThe", "infection", "process", "begins", "with", "an", "ISO", "that", "contains", "a", "malicious", "VBScript", "that", ",", "when", "executed", ",", "initiates", "a", "multi-stage", "infection", "process", "."], ["(", "VBS|ISO", ")", "$", "Stage", "1", "ExecutionThe", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Stage", "2", "retrievalAs", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["It", "is", "mainly", "responsible", "for", "creating", "a", "series", "of", "scripts", "that", "are", "executed", "and", "carry", "out", "various", "tasks", "needed", "for", "the", "malware", "to", "function.Across", "various", "samples", "analyzed", ",", "the", "directory", "locations", "and", "file", "names", "vary", ",", "but", "are", "functionally", "equivalent", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":", "C", ":", "\\ProgramData\\Facebook\\System32\\Microsoft\\SystemDataIf", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":", "Office.batOffice.vbsOffice.ps1Microsofd.batMicrosofd.vbsMicrosofd.ps1All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1'PowerShell", "execution", "."], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."], ["The", "infection", "chain", "is", "more", "complicated", ",", "featuring", "the", "use", "of", "multiple", "script-based", "components", "(", "BAT", ",", "VBS", ",", "PS1", ")", "that", "facilitate", "the", "infection", "process", "."], ["Additionally", ",", "while", "analyzing", "our", "original", "sample", "cluster", "and", "new", "samples", "created", "using", "the", "3LOSH", "crypter", ",", "we", "identified", "several", "final", "payloads", "in", "both", "clusters", "that", "use", "the", "same", "infrastructure", "for", "post-compromise", "C2", "communications", "."], ["Matching", "RAT", "configs", "in", "both", "sample", "clusters", "."], ["While", "analyzing", "one", "of", "the", "AsyncRAT", "payloads", "in", "our", "original", "sample", "cluster", ",", "we", "also", "observed", "that", "the", "Group_ID", "in", "the", "embedded", "RAT", "configuration", "was", "set", "to", "``", "3LOSH", "."], ["Orbital", "QueriesCisco", "Secure", "Endpoint", "users", "can", "use", "Orbital", "Advanced", "Search", "to", "run", "complex", "OSqueries", "to", "see", "if", "their", "endpoints", "are", "infected", "with", "this", "specific", "threat", "."]], "ner": [[], [[14, 15, "MP"], [25, 25, "MF"], [29, 30, "MF"]], [[40, 41, "MP"], [45, 45, "MF"], [50, 50, "MF"], [58, 60, "MP"]], [[69, 69, "MF"], [71, 72, "MF"]], [[89, 89, "MF"], [94, 94, "MP"], [103, 104, "SO"]], [[112, 113, "TF"], [116, 117, "TP"], [122, 125, "TP"]], [[134, 134, "MP"], [143, 143, "MF"]], [[178, 178, "MP"], [185, 185, "SF"]], [[206, 206, "MP"], [210, 211, "MF"]], [], [[254, 254, "TP"], [257, 257, "MF"]], [[274, 274, "MF"], [283, 283, "TP"], [286, 286, "TP"], [294, 294, "MF"]], [[302, 302, "TP"]], [[316, 316, "TP"], [319, 319, "MF"]], [], [[328, 328, "TP"], [342, 342, "MF"]], [[360, 361, "MP"], [365, 365, "MF"]], [[375, 376, "MP"]], [[384, 384, "MP"], [391, 391, "MF"]], [[411, 411, "TP"], [414, 414, "MF"]], [[419, 419, "MF"]], [[430, 430, "MF"], [434, 435, "MF"]], [[449, 449, "TP"], [454, 454, "MP"], [458, 458, "MF"]], [], [], [], [], []], "relations": [[], [[14, 15, 25, 25, "EX"], [14, 15, 29, 30, "WR"]], [[40, 41, 45, 45, "EX"], [40, 41, 58, 60, "FR"], [45, 45, 50, 50, "CO"], [45, 45, 71, 72, "CO"], [45, 45, 69, 69, "CO"]], [], [[94, 94, 89, 89, "EX"], [94, 94, 103, 104, "ST"], [94, 94, 103, 104, "RF"], [94, 94, 112, 113, "WR"], [94, 94, 122, 125, "IJ"]], [[122, 125, 116, 117, "FR"]], [[134, 134, 143, 143, "WR"], [134, 134, 178, 178, "FR"]], [[178, 178, 143, 143, "EX"], [178, 178, 185, 185, "RD"], [178, 178, 206, 206, "CO"]], [[206, 206, 210, 211, "WR"], [210, 211, 257, 257, "CO"], [210, 211, 294, 294, "CO"]], [], [[254, 254, 257, 257, "EX"], [254, 254, 274, 274, "WR"], [254, 254, 286, 286, "FR"]], [[286, 286, 283, 283, "FR"], [283, 283, 274, 274, "WR"], [283, 283, 294, 294, "EX"], [286, 286, 302, 302, "CO"]], [[302, 302, 316, 316, "FR"]], [[316, 316, 319, 319, "EX"], [316, 316, 328, 328, "CO"]], [], [[328, 328, 342, 342, "WR"], [328, 328, 360, 361, "FR"]], [[360, 361, 342, 342, "EX"], [360, 361, 365, 365, "EX"]], [[375, 376, 384, 384, "CO"]], [[384, 384, 391, 391, "EX"], [384, 384, 411, 411, "FR"]], [[411, 411, 414, 414, "EX"], [414, 414, 419, 419, "CO"], [414, 414, 434, 435, "CO"], [414, 414, 430, 430, "CO"], [414, 414, 458, 458, "CO"]], [], [], [[454, 454, 430, 430, "UK"], [454, 454, 449, 449, "IJ"]], [], [], [], [], []]}