{"doc_key": "022", "sentences": [["The", "infection", "process", "begins", "with", "an", "ISO", "that", "contains", "a", "malicious", "VBScript", "that", ",", "when", "executed", ",", "initiates", "a", "multi-stage", "infection", "process", "."], ["The", "VBS", "contains", "junk", "data", "and", "uses", "string", "replacement", "to", "attempt", "to", "obfuscate", "the", "executed", "code", "."], ["Obfuscated", "VBS", "."], ["Once", "deobfuscated", ",", "the", "VBS", "execution", "is", "straightforward", ":", "It", "retrieves", "and", "executes", "the", "next", "stage", "from", "an", "attacker-controlled", "server", "."], ["Deobfuscated", "VBS", "."], ["As", "expected", ",", "the", "retrieved", "content", "is", "a", "PowerShell", "script", "passed", "to", "the", "Invoke-Expression", "(", "IEX", ")", "cmdlet", "and", "executed", "to", "continue", "the", "infection", "process", "."], ["First", ",", "the", "script", "checks", "for", "the", "existence", "of", "a", "directory", "at", "the", "following", "location", ":"], ["If", "it", "does", "n't", "already", "exist", ",", "the", "directory", "is", "created", "."], ["The", "script", "then", "creates", "several", "additional", "scripts", ",", "writing", "content", "into", "each", "of", "them", "using", "a", "format", "similar", "to", "the", "following", "example", "."], ["The", "following", "files", "are", "created", "in", "this", "manner", ":"], ["All", "of", "these", "scripts", "are", "stored", "in", "the", "previously", "created", "directory", "."], ["Finally", ",", "the", "Stage", "2", "PowerShell", "executes", "``", "Office.vbs", "''", "to", "begin", "the", "next", "step", "of", "the", "infection", "process", "."], ["VBS", "execution", "."], ["The", "first", "script", ",", "``", "Office.vbs", ",", "''", "is", "executed", "by", "the", "Stage", "2", "PowerShell", "and", "invokes", "WScript", "to", "execute", "a", "batch", "file", "called", "``", "Office.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "batch", "file", "execution", "."], ["This", "batch", "file", ",", "in", "turn", ",", "executes", "a", "PowerShell", "script", "called", "'Office.ps1", "'", "."], ["PowerShell", "script", "execution", "."], ["The", "next", "PowerShell", "script", "attempts", "to", "achieve", "persistence", "by", "creating", "a", "new", "Scheduled", "Task", "called", "``", "Office", "''", "that", "is", "executed", "immediately", "and", "then", "repeated", "every", "two", "minutes", ",", "as", "shown", "below", "."], ["This", "scheduled", "task", "then", "executes", "``", "Microsofd.vbs", "''", "as", "part", "of", "the", "creation", "process", "."], ["This", "next", "VBS", "initiates", "a", "short", "sleep", "before", "continuing", "."], ["It", "is", "only", "responsible", "for", "executing", "``", "Microsofd.bat", "''", "to", "continue", "the", "infection", "process", "."], ["WScript", "execution", "."], ["This", "next", "batch", "file", "only", "contains", "a", "single", "line", ",", "which", "invokes", "PowerShell", "and", "executes", "'Microsofd.ps1", "'"], ["This", "PowerShell", "script", "is", "the", "final", "script", "executed", "in", "this", "chain", "."], ["This", "script", "contains", "two", "large", "GZIP", "blobs", "and", "another", "function", "responsible", "for", "decompressing", "them", "."], ["This", "is", "accomplished", "by", "invoking", "aspnet_compiler.exe", ",", "injecting", "the", "final", "payload", ",", "and", "executing", "it", "."]], "ner": [[[1, 2, "MP"], [11, 11, "MF"]], [[24, 24, "MF"]], [[41, 41, "MF"]], [[47, 48, "MP"], [61, 62, "SO"]], [], [[75, 76, "MF"], [80, 84, "TP"], [90, 91, "MP"]], [], [], [[122, 122, "MF"], [127, 127, "MF"]], [], [], [[170, 170, "TP"], [173, 173, "MF"]], [[185, 186, "MP"]], [[193, 193, "MF"], [202, 202, "TP"], [205, 205, "MP"], [213, 213, "MF"]], [[221, 221, "MP"]], [[235, 236, "MF"], [238, 238, "MF"]], [[241, 243, "MP"]], [[247, 247, "MP"], [261, 261, "MP"]], [[284, 284, "MF"]], [[295, 295, "MP"]], [[303, 303, "MP"], [310, 310, "MF"]], [[318, 319, "MP"]], [[333, 333, "MP"], [336, 336, "MF"]], [], [[355, 356, "MF"]], [[370, 370, "TP"], [375, 375, "MP"]]], "relations": [[[1, 2, 11, 11, "EX"], [1, 2, 24, 24, "WR"], [1, 2, 47, 48, "CO"], [1, 2, 90, 91, "CO"]], [[24, 24, 41, 41, "CO"]], [], [[47, 48, 61, 62, "ST"], [47, 48, 61, 62, "RF"]], [], [[90, 91, 80, 84, "FR"], [80, 84, 41, 41, "WR"], [80, 84, 75, 76, "EX"], [80, 84, 122, 122, "RD"], [80, 84, 122, 122, "WR"], [80, 84, 122, 122, "EX"], [90, 91, 127, 127, "WR"]], [], [], [[127, 127, 173, 173, "CO"], [127, 127, 193, 193, "CO"]], [], [], [[170, 170, 122, 122, "WR"], [170, 170, 185, 186, "FR"], [170, 170, 202, 202, "CO"]], [[185, 186, 193, 193, "EX"]], [[202, 202, 205, 205, "FR"], [205, 205, 213, 213, "EX"], [205, 205, 221, 221, "CO"]], [[221, 221, 241, 243, "FR"]], [[235, 236, 238, 238, "CO"]], [[241, 243, 238, 238, "EX"]], [[247, 247, 261, 261, "FR"], [261, 261, 284, 284, "EX"]], [], [[295, 295, 303, 303, "CO"]], [[303, 303, 318, 319, "FR"]], [[318, 319, 310, 310, "EX"], [318, 319, 333, 333, "FR"]], [[333, 333, 336, 336, "EX"], [333, 333, 370, 370, "FR"]], [], [], [[375, 375, 355, 356, "UK"], [375, 375, 370, 370, "IJ"]]]}