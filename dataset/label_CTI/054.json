{"doc_key": "054", "sentences": [["The", "ZetaNile", "malware", "family", "'s", "implant", "DLLs", "are", "either", "encrypted", "or", "packed", "with", "commercial", "software", "protectors", "such", "as", "Themida", "and", "VMProtect", "."], ["In", "the", "malicious", "DLL", ",", "the", "decrypted", "payload", "uses", "a", "custom", "key", "passed", "as", "part", "of", "the", "DLL", "search", "order", "hijacking", "of", "a", "legitimate", "Windows", "process", ",", "as", "shown", "in", "Figure", "3", ".", "The", "malware", "family", "uses", "unique", "custom", "encryption", "methods", "or", "AES", "encryption", "to", "generate", "command", "and", "control", "(", "C2", ")", "HTTP", "requests", "to", "known", "compromised", "C2", "domains", "."], ["To", "make", "C2", "communications", "blend", "in", "with", "legitimate", "traffic", ",", "ZetaNile", "encodes", "the", "victim", "information", "in", "parameters", "for", "common", "keywords", "such", "as", "gametype", "or", "bbs", "."], ["Upon", "establishing", "a", "connection", "with", "the", "target", ",", "ZINC", "operationalized", "PuTTY", "and", "KiTTY", ",", "malicious", "versions", "of", "two", "SSH", "clients", ",", "that", "act", "as", "entry", "vectors", "for", "the", "ZetaNile", "implant", ".", "The", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "ReadMe.txt", "to", "run", "after", "downloading", "the", "archive", "."], ["ZINC", "has", "developed", "the", "ZetaNile", "malware", "family", "to", "evade", "traditional", "defenses", ".", "The", "included", "executable", "file", "runs", "without", "dropping", "the", "ZetaNile", "implant", ",", "as", "part", "of", "this", "evolution", "."], ["For", "deployment", "of", "ZetaNile", ",", "the", "IP", "provided", "in", "the", "ReadMe.txt", "file", "is", "necessary", "for", "the", "SSH", "utility", ".", "The", "malicious", "PUTTY.exe", "is", "programmed", "to", "install", "Event", "Horizon", "malware", "in", "C", ":", "\\ProgramData\\colorui.dll", ",", "copying", "C", ":", "\\Windows\\System32\\colorcpl.exe", "to", "C", ":", "\\ProgramData\\colorcpl.exe", "."], ["ZINC", "loads", "the", "second", "stage", "malware", ",", "colorui.dll", ",", "using", "DLL", "search", "order", "hijacking", "and", "decodes", "the", "payload", "with", "the", "key", "``", "0CE1241A44557AA438F27BC6D4ACA246", "''", "for", "use", "in", "command", "and", "control", "."], ["After", "successful", "connection", "to", "the", "C2", "server", ",", "the", "attackers", "can", "install", "additional", "malware", "on", "the", "compromised", "device", "for", "other", "tasks", ".", "Lastly", ",", "ZINC", "establishes", "persistence", "with", "the", "creation", "of", "a", "daily", "scheduled", "task", ",", "PackageColor", ",", "as", "part", "of", "the", "weaponized", "PuTTY", "configuration", "."], ["To", "ensure", "persistence", ",", "the", "ZINC", "group", "establishes", "a", "daily", "scheduled", "task", "called", "PackageColor", "through", "the", "weaponized", "PuTTY", "configuration", ".", "The", "executable", "first", "acquires", "the", "username", "and", "hostname", "of", "the", "compromised", "system", "."], ["Once", "this", "information", "is", "obtained", ",", "the", "PuTTY", "executable", "sends", "it", "to", "a", "hardcoded", "IP", "address", ",", "172.93.201.253", ",", "via", "TCP/22", ",", "which", "does", "not", "use", "SSH", "protocol", "and", "does", "not", "require", "SSH", "handshake", "to", "establish", "communication", "."], ["Upon", "successful", "TCP", "connection", "to", "the", "server", "at", "137.184.15.189", ",", "the", "malicious", "KiTTY", "executable", "deploys", "the", "embedded", "payload", ",", "mscoree.dll", ",", "in", "%", "AppData", "%", "\\mscoree.dll", "through", "various", "decoding", "phases", ".", "Mscoree.dll", "is", "detected", "as", "EventHorizon", "and", "is", "part", "of", "the", "ZetaNile", "malware", "family", "."], ["Similar", "to", "ZINC", "'s", "version", "of", "PuTTY", ",", "the", "ZetaNile", "malware", "uses", "DLL", "search", "order", "hijacking", "to", "load", "malicious", "DLL", "files", "to", "perform", "tasks", "within", "the", "context", "of", "legitimate", "Windows", "processes", "such", "as", "%", "AppData", "%", "\\KiTTY\\PresentationHost.exe", "-EmbeddingObject", "."], ["The", "mscoree.dll", "malware", "is", "modularized", "so", "that", "once", "it", "establishes", "a", "connection", "to", "the", "compromised", "C2", "domain", ",", "it", "can", "install", "additional", "malware", "as", "necessary", "using", "existing", "C2", "communication", ".", "For", "instance", ",", "it", "can", "execute", "C", ":", "\\ProgramData\\Cisco\\fixmapi.exe", "-s", "AudioEndpointBuilder", "to", "load", "malicious", "mapistub.dll", "from", "the", "compromised", "C2", "server", "."], ["HTTP", "POST", "requests", "have", "a", "hardcoded", "UA", "string", "with", "a", "misspelled", "``", "Edge", "''", "and", "contain", "a", "unique", "ID", "for", "the", "gametype", "field", "and", "a", "hardcoded", "value", "for", "the", "type", "field", "for", "tracking", "purposes", "."], ["This", "malware", "has", "a", "unique", "PDBPath", ".", "Finally", ",", "the", "recipient", "is", "provided", "with", "an", "executable", "file", "and", "a", "readme.txt", "to", "aid", "them", "in", "running", "the", "archive", "."], ["The", "archive", "provided", "to", "recipients", "contains", "a", ".txt", "file", "with", "instructions", "and", "an", "executable", "file", "to", "run", "."], ["The", "malicious", "TightVNC", "Viewer", "has", "a", "pre-populated", "list", "of", "remote", "hosts", "and", "installs", "the", "backdoor", "only", "when", "the", "user", "selects", "ec2-aet-tech.w-ada.amazonaws", "from", "the", "drop-down", "menu", "displayed", ".", "The", "malware", "sends", "the", "username", "and", "hostname", "to", "IP", "44.238.74.84", "on", "TCP/22", "as", "part", "of", "the", "victim", "check-in", "with", "the", "C2", "and", "establishes", "VNC", "connections", "to", "the", "same", "IP", "on", "port", "TCP/5900", ".", "Once", "it", "establishes", "a", "connection", "to", "the", "server", "IP", ",", "the", "embedded", "second", "stage", "DLL", "payload", "from", "TightVNC.exe", "is", "loaded", "in", "memory", "to", "establish", "C2", "communication", "to", "known", "compromised", "domains", "."], ["In", "comparison", ",", "the", "Sumatra", "PDF", "reader", "is", "functional", ",", "and", "the", "muPDF/Subliminal", "Recording", "installer", "sets", "up", "the", "backdoor", "without", "loading", "any", "malicious", "PDF", "files", ".", "SecurePDF.exe", "is", "a", "modularized", "loader", "that", "can", "install", "the", "ZetaNile", "implant", "by", "loading", "a", "weaponized", "job", "application", "themed", "file", "with", "a", ".PDF", "extension", "."], ["The", "fake", "PDF", "includes", "a", "header", "``", "SPV005", "''", ",", "a", "decryption", "key", ",", "encrypted", "second", "stage", "implant", "payload", ",", "and", "an", "encrypted", "decoy", "PDF", ",", "which", "is", "rendered", "in", "the", "Sumatra", "PDF", "Reader", "when", "the", "file", "is", "opened", "."], ["Upon", "being", "loaded", "in", "memory", ",", "the", "second", "stage", "malware", "sends", "the", "victim", "'s", "system", "hostname", "and", "device", "information", "to", "a", "C2", "communication", "server", "using", "custom", "encoding", "algorithms", "as", "part", "of", "the", "C2", "check-in", "process", "."], ["The", "attackers", "have", "the", "ability", "to", "install", "extra", "malware", "onto", "compromised", "devices", "as", "required", "through", "the", "C2", "communication", "."], ["The", "version", "of", "muPDF/Subliminal", "Recording", "installer", "that", "is", "infected", "with", "backdoor", ",", "setup.exe", ",", "checks", "for", "the", "existence", "of", "file", "path", "ISSetupPrerequisites\\Setup64.exe", ",", "extracts", "an", "embedded", "executable", "within", "setup.exe", ",", "and", "writes", "C", ":", "\\colrctl\\colorui.dll", "on", "disk", ".", "It", "then", "copies", "C", ":", "\\Windows\\System32\\ColorCpl.exe", "to", "C", ":", "\\ColorCtrl\\ColorCpl.exe", "."], ["To", "execute", "the", "EventHorizon", "malware", "family", "'s", "colorui.dll", "as", "a", "second", "stage", "malware", ",", "the", "malicious", "installer", "creates", "a", "new", "process", "``", "C", ":", "\\colorctrl\\colorcpl.exe", "''", "with", "the", "decryption", "key", "argument", "C3A9B30B6A313F289297C9A36730DB6D", "passed", "on", "to", "colorui.dll", "."], ["During", "the", "victim", "check-in", "process", ",", "the", "colorui.dll", "DLL", "is", "injected", "into", "C", ":", "\\Windows\\System\\credwiz.exe", "or", "iexpress.exe", ",", "and", "it", "sends", "C2", "HTTP", "requests", "to", "receive", "an", "additional", "payload", "."]], "ner": [[[5, 6, "MF"], [18, 18, "MP"], [20, 20, "MP"]], [[25, 25, "MF"], [29, 29, "MF"], [32, 33, "MP"], [39, 39, "MF"], [46, 47, "TP"], [56, 57, "MP"], [60, 61, "MP"], [64, 65, "MP"], [79, 80, "SO"]], [[92, 92, "MP"], [95, 96, "MF"]], [[114, 114, "SO"], [116, 116, "MP"], [118, 118, "MP"], [120, 120, "MP"], [126, 127, "MP"], [136, 137, "MP"], [140, 140, "TP"], [145, 146, "MF"], [149, 149, "TF"]], [[157, 157, "MP"], [177, 178, "MF"]], [[189, 189, "MP"], [196, 196, "TF"], [202, 203, "MP"], [207, 207, "MP"], [212, 214, "MP"], [216, 218, "SF"], [221, 223, "SF"], [225, 227, "SF"]], [[229, 229, "MP"], [236, 236, "MF"], [246, 246, "TF"], [251, 251, "TF"]], [[265, 266, "SO"], [269, 269, "MP"], [273, 273, "MP"], [296, 296, "TP"], [302, 303, "MP"]], [[311, 311, "MP"], [319, 319, "MP"], [322, 323, "MP"], [327, 327, "MP"], [331, 331, "TF"], [333, 333, "TF"]], [[347, 347, "MP"], [356, 356, "SO"]], [[385, 385, "SO"], [389, 390, "MP"], [399, 402, "MF"], [408, 408, "MF"], [412, 412, "MP"]], [[424, 424, "MP"], [428, 428, "MP"], [434, 437, "MP"], [441, 442, "MF"], [451, 452, "MP"], [455, 459, "MF"]], [[462, 463, "MP"], [476, 477, "SO"], [479, 479, "MP"], [483, 483, "MP"], [497, 499, "MF"], [505, 505, "MF"], [509, 510, "SO"]], [[512, 514, "MF"], [533, 534, "TF"], [537, 538, "TF"]], [[552, 552, "TF"], [562, 563, "MF"], [566, 566, "TF"]], [], [[595, 596, "MP"], [602, 603, "SO"], [607, 607, "MP"], [613, 613, "MF"], [621, 621, "MP"], [629, 629, "SO"], [648, 648, "SO"], [660, 661, "SO"], [667, 668, "MF"], [670, 670, "MP"]], [[688, 689, "MP"], [710, 710, "MP"], [719, 720, "MP"], [727, 728, "MF"]], [[736, 736, "MF"], [745, 746, "TF"], [752, 752, "MF"], [756, 758, "MF"], [765, 767, "MP"]], [[783, 783, "MP"], [789, 789, "TF"], [791, 792, "MF"], [795, 797, "SO"], [806, 808, "MP"]], [[811, 811, "MP"], [818, 818, "MP"], [826, 827, "MP"]], [[832, 834, "MP"], [841, 841, "MP"], [850, 850, "MF"], [861, 863, "MF"], [867, 867, "MP"], [870, 872, "MF"], [874, 876, "MF"]], [[893, 894, "MP"], [900, 902, "MP"], [913, 913, "MF"]], [[922, 922, "MF"], [927, 929, "MP"], [931, 931, "MP"], [943, 943, "MF"]]], "relations": [[[18, 18, 5, 6, "WR"], [20, 20, 5, 6, "WR"], [20, 20, 25, 25, "WR"]], [[32, 33, 25, 25, "WR"], [32, 33, 29, 29, "WR"], [46, 47, 39, 39, "RD"], [56, 57, 60, 61, "IJ"], [56, 57, 64, 65, "IJ"], [56, 57, 79, 80, "ST"], [56, 57, 79, 80, "RF"], [29, 29, 39, 39, "CO"]], [[92, 92, 95, 96, "RD"], [92, 92, 136, 137, "CO"]], [[116, 116, 114, 114, "ST"], [116, 116, 114, 114, "RF"], [118, 118, 140, 140, "FR"], [140, 140, 145, 146, "EX"], [149, 149, 196, 196, "CO"]], [[157, 157, 145, 146, "RD"], [157, 157, 177, 178, "WR"], [157, 157, 177, 178, "WR"]], [[189, 189, 177, 178, "WR"], [189, 189, 177, 178, "WR"], [202, 203, 196, 196, "RD"], [207, 207, 216, 218, "RD"], [207, 207, 212, 214, "FR"], [207, 207, 216, 218, "WR"], [207, 207, 225, 227, "RD"], [207, 207, 221, 223, "RD"], [207, 207, 225, 227, "WR"]], [[229, 229, 236, 236, "WR"], [229, 229, 246, 246, "RD"], [229, 229, 251, 251, "RD"]], [[269, 269, 265, 266, "ST"], [269, 269, 265, 266, "RF"], [269, 269, 273, 273, "FR"], [302, 303, 296, 296, "FR"], [296, 296, 311, 311, "FR"], [269, 269, 811, 811, "CO"]], [[322, 323, 319, 319, "FR"], [327, 327, 331, 331, "RD"], [327, 327, 333, 333, "RD"], [327, 327, 347, 347, "CO"]], [[347, 347, 356, 356, "ST"]], [[389, 390, 385, 385, "ST"], [389, 390, 385, 385, "RF"], [389, 390, 399, 402, "WR"], [389, 390, 408, 408, "WR"], [412, 412, 408, 408, "WR"], [412, 412, 408, 408, "WR"]], [[424, 424, 408, 408, "WR"], [428, 428, 408, 408, "WR"], [434, 437, 441, 442, "WR"], [451, 452, 441, 442, "EX"], [451, 452, 455, 459, "EX"]], [[462, 463, 476, 477, "ST"], [462, 463, 476, 477, "RF"], [479, 479, 483, 483, "FR"], [483, 483, 497, 499, "EX"], [483, 483, 505, 505, "RD"], [483, 483, 509, 510, "RF"], [483, 483, 512, 514, "WR"], [483, 483, 562, 563, "WR"]], [], [], [], [[595, 596, 512, 514, "WR"], [595, 596, 562, 563, "WR"], [595, 596, 602, 603, "ST"], [595, 596, 602, 603, "RF"], [595, 596, 607, 607, "FR"], [607, 607, 602, 603, "ST"], [607, 607, 602, 603, "RF"], [607, 607, 613, 613, "WR"], [621, 621, 613, 613, "WR"], [621, 621, 629, 629, "ST"], [621, 621, 629, 629, "RF"], [621, 621, 648, 648, "ST"], [621, 621, 648, 648, "RF"], [621, 621, 660, 661, "ST"], [621, 621, 660, 661, "RF"], [621, 621, 667, 668, "RD"], [670, 670, 667, 668, "WR"], [621, 621, 783, 783, "CO"]], [[688, 689, 667, 668, "RD"], [710, 710, 719, 720, "FR"], [710, 710, 727, 728, "RD"], [688, 689, 736, 736, "WR"], [719, 720, 736, 736, "WR"], [719, 720, 752, 752, "WR"]], [[765, 767, 752, 752, "WR"], [765, 767, 756, 758, "RD"], [736, 736, 756, 758, "CO"]], [[783, 783, 789, 789, "RD"], [783, 783, 791, 792, "RD"], [783, 783, 795, 797, "ST"], [806, 808, 791, 792, "RD"]], [[811, 811, 818, 818, "FR"], [811, 811, 826, 827, "FR"]], [[832, 834, 841, 841, "FR"], [832, 834, 850, 850, "RD"], [832, 834, 861, 863, "WR"], [867, 867, 870, 872, "RD"], [867, 867, 874, 876, "WR"], [841, 841, 867, 867, "CO"]], [[893, 894, 900, 902, "FR"], [893, 894, 913, 913, "WR"], [893, 894, 922, 922, "RD"], [893, 894, 927, 929, "IJ"], [893, 894, 931, 931, "IJ"], [893, 894, 943, 943, "RD"]], []]}