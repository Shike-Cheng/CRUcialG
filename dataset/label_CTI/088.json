{"doc_key": "088", "sentences": [["The", "malware", "mimics", "legit", "services", "such", "as", "Google", "service", ",", "GooglePlay", "or", "Flash", "update", "."], ["They", "mentioned", "an", "Android", ",", "iOS", "and", "Windows", "remote", "access", "tool", "(", "RAT", ")", "."], ["One", "of", "the", "samples", "(", "e19823a1ba4a0e40cf459f4a0489fc257720cc0d71ecfb7ad94b3ca86fbd85d1", ")", "uses", "the", "C2", "server", "svcws.ponethus.com", "."], ["The", "C2", "server", "domain", "is", "linked", "to", "Thai", "food", ":", "Nampriknum.net", ":", "Nam", "Phrik", "NumSomtum.today", ":", "Som", "TumWe", "also", "identified", "comments", "in", "Thai", "on", "the", "C2", "infrastructure", "mentioned", "in", "the", "previous", "chapter", ":", "Malware", "DenDroid", "The", "Android", "malware", "is", "based", "on", "the", "DenDroid", "Android", "malware", "."], ["Permissions", "The", "package", "name", "follows", "the", "original", "style", "name", "used", "on", "DenDroid", "."], ["This", "malware", "also", "contains", "a", "screen", "recorder", "."], ["The", "service", "is", "implemented", "in", "the", "class", "com.serenegiant.service", "."], ["ScreenRecorderService", "which", "is", "declared", "in", "the", "package", "manifest", "."], ["A", "new", "class", "was", "added", "called", "com.utils", "."], ["Just", "like", "in", "previous", "examples", ",", "the", "malware", "author", "does", "not", "use", "this", "package", "."], ["This", "is", "also", "the", "first", "version", "where", "the", "package", "name", "changes", "into", "something", "that", "a", "less", "aware", "user", "may", "be", "tricked", "by", ",", "lokd.co1ayup", "."], ["This", "version", "brings", "back", "the", "ACCESS_SUPERUSER", "and", "READ_FRAME_BUFFER", "permissions", "."], ["However", ",", "this", "time", ",", "the", "permission", "is", "actually", "used", "."], ["WhatsApp", "message", "capture", "The", "service", "lokd.co1ayup", "."], ["ScreenRecorderService", ",", "is", "invoked", "by", "the", "ScreenRecorderActivity", "."], ["Upon", "creation", ",", "this", "activity", "launches", "a", "thread", "that", "will", "loop", "on", "a", "50-second", "interval", "."], ["In", "the", "first", "iteration", ",", "the", "screen", "recording", "is", "started", "and", "will", "only", "stop", "when", "the", "RAT", "determines", "that", "WhatsApp", "is", "not", "running", "."], ["It", "'s", "restarted", "in", "the", "next", "cycle", "independently", "based", "on", "if", "WhatsApp", "is", "running", "."], ["In", "this", "version", ",", "the", "developer", "added", "more", "classes", "from", "the", "same", "package", "."], ["One", "of", "the", "uses", "the", "malware", "gives", "to", "this", "package", "is", "the", "execution", "of", "the", "command", "``", "dumpsys", "''", "to", "determine", "if", "certain", "activities", "are", "running", "."], ["Check", "if", "chat", "apps", "are", "running", "In", "the", "above", "example", ",", "the", "malware", "is", "searching", "for", "Line", ",", "Facebook", "Messenger", "and", "WhatsApp", "activities", "."], ["Upon", "creation", "the", "class", "will", "start", "to", "take", "screenshots", "that", "will", "be", "stopped", "and", "uploaded", "to", "the", "C2", "once", "the", "service", "ca", "n't", "find", "the", "targeted", "applications", "running", "."], ["First", "of", "all", "the", "new", "package", "name", "is", "lokd.co4rvices", ",", "which", "can", "easily", "be", "confused", "with", "a", "legitimate", "Google", "service", "."], ["WolfRAT", "application", "screen", "The", "Google", "GMS", "and", "Firebase", "service", "has", "been", "added", ",", "however", ",", "no", "configuration", "has", "been", "found", ",", "even", "though", "services", "seem", "to", "be", "referenced", "in", "the", "of", "a", "new", "class", "."], ["The", "new", "class", "is", "called", "NotificationListener", "and", "extends", "the", "NotificationListenerService", "class", "."], ["Notification", "handling", "method", "The", "class", "is", "only", "implemented", "in", "debug", "mode", ",", "pushing", "all", "captured", "information", "into", "the", "log", "."], ["This", "version", "adds", "one", "significant", "class", "it", "requests", "DEVICE_ADMIN", "privileges", "."], ["The", "malware", "will", "start", "the", "main", "service", "if", "all", "the", "requested", "permissions", "and", "the", "device", "admin", "privileges", "are", "granted", "."], ["Otherwise", ",", "it", "will", "launch", "an", "ACTION_APPLICATION_SETTINGS", "intent", "trying", "to", "trick", "the", "user", "to", "grant", "the", "permissions", "."], ["Each", "sample", "contains", "a", "userId", "hardcoded", ",", "meaning", "that", "each", "sample", "can", "only", "be", "used", "in", "a", "victim", "."], ["It", "seems", ",", "however", ",", "if", "the", "same", "victim", "has", "more", "than", "one", "device", "the", "malware", "can", "be", "reused", "since", "the", "IMEI", "is", "sent", "along", "with", "each", "data", "exfiltration", "."]], "ner": [[[1, 1, "MP"], [7, 8, "TP"], [10, 10, "TP"], [12, 13, "TP"]], [[18, 18, "SF"], [20, 20, "SF"], [27, 27, "MF"]], [[35, 35, "MP"], [41, 41, "SO"]], [[44, 46, "SO"], [79, 80, "MF"], [85, 87, "MF"]], [[100, 100, "MF"]], [[103, 103, "MP"], [107, 108, "MP"]], [[111, 111, "MP"], [117, 117, "MF"]], [[119, 119, "MF"]], [[129, 130, "MF"], [134, 134, "MF"]], [[143, 143, "MP"], [149, 149, "MF"]], [[159, 159, "MF"], [174, 174, "MF"]], [], [], [[202, 202, "MP"]], [[204, 204, "MP"], [210, 210, "MP"]], [[216, 216, "MP"], [219, 219, "MP"]], [[234, 235, "MP"], [244, 244, "MP"], [247, 247, "SF"]], [[252, 252, "MP"], [263, 263, "SF"]], [], [[286, 286, "MP"], [290, 290, "MF"], [304, 304, "SF"]], [[310, 311, "SF"], [320, 320, "MP"], [324, 324, "SF"], [326, 327, "SF"], [329, 330, "SF"]], [[335, 335, "MP"], [340, 340, "SF"], [349, 349, "SO"], [352, 352, "MP"], [358, 358, "SF"]], [[366, 366, "MF"], [369, 369, "MF"], [379, 380, "SF"]], [[382, 384, "MF"], [386, 387, "MF"], [389, 389, "MF"], [405, 405, "MF"], [415, 415, "MF"]], [[419, 419, "MF"], [422, 422, "MF"], [426, 427, "MF"]], [[429, 431, "MF"], [433, 433, "MP"], [444, 444, "SF"], [447, 447, "SF"]], [[454, 454, "MF"], [455, 455, "MP"], [457, 458, "SF"]], [[461, 461, "MP"], [465, 466, "MP"]], [[482, 482, "MP"], [486, 486, "MP"], [492, 492, "TP"], [496, 496, "SF"]], [[499, 499, "MF"], [502, 502, "SF"], [508, 508, "MF"], [515, 515, "TP"]], [[525, 525, "TP"], [532, 532, "MF"], [544, 544, "SF"]]], "relations": [[[1, 1, 7, 8, "FR"], [1, 1, 10, 10, "FR"], [1, 1, 12, 13, "FR"], [7, 8, 18, 18, "RD"], [7, 8, 18, 18, "RD"], [7, 8, 18, 18, "WR"], [10, 10, 18, 18, "RD"], [10, 10, 18, 18, "RD"], [10, 10, 18, 18, "WR"], [12, 13, 18, 18, "RD"], [12, 13, 18, 18, "RD"], [12, 13, 18, 18, "WR"], [12, 13, 18, 18, "RD"], [12, 13, 18, 18, "RD"], [12, 13, 18, 18, "WR"], [12, 13, 20, 20, "RD"], [12, 13, 20, 20, "RD"], [12, 13, 20, 20, "WR"], [12, 13, 27, 27, "WR"], [1, 1, 143, 143, "CO"], [1, 1, 286, 286, "CO"], [1, 1, 320, 320, "CO"], [1, 1, 461, 461, "CO"]], [[27, 27, 18, 18, "RD"], [27, 27, 18, 18, "WR"], [27, 27, 20, 20, "RD"], [27, 27, 20, 20, "WR"]], [[35, 35, 27, 27, "WR"], [35, 35, 41, 41, "ST"], [35, 35, 41, 41, "RF"], [35, 35, 44, 46, "ST"], [35, 35, 44, 46, "RF"], [35, 35, 79, 80, "WR"]], [[79, 80, 85, 87, "CO"], [79, 80, 100, 100, "CO"]], [], [[103, 103, 44, 46, "ST"], [103, 103, 44, 46, "RF"], [103, 103, 100, 100, "WR"], [103, 103, 107, 108, "FR"], [107, 108, 111, 111, "CO"]], [[117, 117, 119, 119, "CO"]], [], [[129, 130, 134, 134, "CO"], [129, 130, 149, 149, "CO"], [129, 130, 174, 174, "CO"], [129, 130, 159, 159, "CO"]], [[143, 143, 103, 103, "CO"]], [], [], [], [[202, 202, 100, 100, "WR"]], [[210, 210, 204, 204, "FR"], [204, 204, 216, 216, "CO"]], [[216, 216, 219, 219, "FR"]], [[244, 244, 247, 247, "RD"], [234, 235, 252, 252, "CO"], [247, 247, 263, 263, "CO"]], [], [], [[286, 286, 290, 290, "EX"], [286, 286, 304, 304, "RD"], [286, 286, 310, 311, "RD"], [286, 286, 310, 311, "RD"], [286, 286, 310, 311, "WR"]], [[320, 320, 310, 311, "RD"], [320, 320, 310, 311, "RD"], [320, 320, 310, 311, "WR"], [320, 320, 324, 324, "RD"], [320, 320, 326, 327, "RD"], [320, 320, 329, 330, "RD"]], [[335, 335, 340, 340, "RD"], [335, 335, 340, 340, "WR"], [335, 335, 349, 349, "ST"], [335, 335, 349, 349, "RF"], [352, 352, 358, 358, "RD"], [352, 352, 379, 380, "RD"], [352, 352, 379, 380, "RD"], [352, 352, 379, 380, "WR"], [352, 352, 382, 384, "WR"], [352, 352, 426, 427, "WR"]], [[366, 366, 369, 369, "CO"], [366, 366, 415, 415, "CO"], [366, 366, 422, 422, "CO"], [366, 366, 419, 419, "CO"]], [[382, 384, 379, 380, "RD"], [382, 384, 379, 380, "WR"], [389, 389, 405, 405, "CO"], [389, 389, 386, 387, "CO"]], [], [[433, 433, 382, 384, "WR"], [433, 433, 426, 427, "WR"], [433, 433, 429, 431, "EX"], [433, 433, 447, 447, "RD"], [433, 433, 444, 444, "RD"], [433, 433, 447, 447, "WR"]], [[455, 455, 454, 454, "EX"], [455, 455, 457, 458, "RD"]], [[461, 461, 465, 466, "FR"], [461, 461, 482, 482, "CO"]], [[492, 492, 496, 496, "RD"], [482, 482, 486, 486, "FR"], [492, 492, 496, 496, "WR"], [492, 492, 502, 502, "RD"], [492, 492, 502, 502, "RD"], [492, 492, 502, 502, "WR"], [492, 492, 515, 515, "CO"]], [[515, 515, 508, 508, "EX"], [508, 508, 502, 502, "RD"], [508, 508, 502, 502, "WR"], [499, 499, 508, 508, "CO"], [515, 515, 525, 525, "CO"]], [[525, 525, 532, 532, "EX"]]]}